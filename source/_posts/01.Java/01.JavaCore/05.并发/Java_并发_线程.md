---
title: Java å¹¶å‘ä¹‹çº¿ç¨‹
date: 2019-12-24 23:52:25
categories:
  - Java
  - JavaCore
  - å¹¶å‘
tags:
  - Java
  - JavaCore
  - å¹¶å‘
  - çº¿ç¨‹
  - Thread
  - Runnable
  - Callable
  - Future
  - FutureTask
  - çº¿ç¨‹ç”Ÿå‘½å‘¨æœŸ
permalink: /pages/cec05f27/
---

# Java å¹¶å‘ä¹‹çº¿ç¨‹

## çº¿ç¨‹ç®€ä»‹

- **è¿›ç¨‹ï¼ˆProcessï¼‰** - è¿›ç¨‹æ˜¯å…·æœ‰ä¸€å®šç‹¬ç«‹åŠŸèƒ½çš„ç¨‹åºå…³äºæŸä¸ªæ•°æ®é›†åˆä¸Šçš„ä¸€æ¬¡è¿è¡Œæ´»åŠ¨ã€‚è¿›ç¨‹æ˜¯æ“ä½œç³»ç»Ÿè¿›è¡Œèµ„æºåˆ†é…çš„åŸºæœ¬å•ä½ã€‚**è¿›ç¨‹å¯è§†ä¸ºä¸€ä¸ªæ­£åœ¨è¿è¡Œçš„ç¨‹åº**ã€‚
- **çº¿ç¨‹ï¼ˆThreadï¼‰** - **çº¿ç¨‹æ˜¯æ“ä½œç³»ç»Ÿè¿›è¡Œè°ƒåº¦çš„åŸºæœ¬å•ä½**ã€‚
- **ç®¡ç¨‹ï¼ˆMonitorï¼‰** - **ç®¡ç¨‹æ˜¯æŒ‡ç®¡ç†å…±äº«å˜é‡ä»¥åŠå¯¹å…±äº«å˜é‡çš„æ“ä½œè¿‡ç¨‹ï¼Œè®©ä»–ä»¬æ”¯æŒå¹¶å‘**ã€‚
  - Java é€šè¿‡ synchronized å…³é”®å­—åŠ wait()ã€notify()ã€notifyAll() è¿™ä¸‰ä¸ªæ–¹æ³•æ¥å®ç°ç®¡ç¨‹æŠ€æœ¯ã€‚
  - **ç®¡ç¨‹å’Œä¿¡å·é‡æ˜¯ç­‰ä»·çš„ï¼Œæ‰€è°“ç­‰ä»·æŒ‡çš„æ˜¯ç”¨ç®¡ç¨‹èƒ½å¤Ÿå®ç°ä¿¡å·é‡ï¼Œä¹Ÿèƒ½ç”¨ä¿¡å·é‡å®ç°ç®¡ç¨‹**ã€‚
- **åç¨‹ï¼ˆCoroutineï¼‰** - **åç¨‹å¯ä»¥ç†è§£ä¸ºä¸€ç§è½»é‡çº§çš„çº¿ç¨‹**ã€‚
  - ä»æ“ä½œç³»ç»Ÿçš„è§’åº¦æ¥çœ‹ï¼Œçº¿ç¨‹æ˜¯åœ¨å†…æ ¸æ€ä¸­è°ƒåº¦çš„ï¼Œè€Œåç¨‹æ˜¯åœ¨ç”¨æˆ·æ€è°ƒåº¦çš„ï¼Œæ‰€ä»¥ç›¸å¯¹äºçº¿ç¨‹æ¥è¯´ï¼Œåç¨‹åˆ‡æ¢çš„æˆæœ¬æ›´ä½ã€‚
  - åç¨‹è™½ç„¶ä¹Ÿæœ‰è‡ªå·±çš„æ ˆï¼Œä½†æ˜¯ç›¸æ¯”çº¿ç¨‹æ ˆè¦å°å¾—å¤šï¼Œå…¸å‹çš„çº¿ç¨‹æ ˆå¤§å°å·®ä¸å¤šæœ‰ 1Mï¼Œè€Œåç¨‹æ ˆçš„å¤§å°å¾€å¾€åªæœ‰å‡  K æˆ–è€…å‡ å Kã€‚æ‰€ä»¥ï¼Œæ— è®ºæ˜¯ä»æ—¶é—´ç»´åº¦è¿˜æ˜¯ç©ºé—´ç»´åº¦æ¥çœ‹ï¼Œåç¨‹éƒ½æ¯”çº¿ç¨‹è½»é‡å¾—å¤šã€‚
  - Goã€Pythonã€Luaã€Kotlin ç­‰è¯­è¨€éƒ½æ”¯æŒåç¨‹ï¼›Java OpenSDK ä¸­çš„ Loom é¡¹ç›®ç›®æ ‡å°±æ˜¯æ”¯æŒåç¨‹ã€‚

è¿›ç¨‹å’Œçº¿ç¨‹çš„å·®å¼‚ï¼š

- ä¸€ä¸ªç¨‹åºè‡³å°‘æœ‰ä¸€ä¸ªè¿›ç¨‹ï¼Œä¸€ä¸ªè¿›ç¨‹è‡³å°‘æœ‰ä¸€ä¸ªçº¿ç¨‹ã€‚
- çº¿ç¨‹æ¯”è¿›ç¨‹åˆ’åˆ†æ›´ç»†ï¼Œæ‰€ä»¥æ‰§è¡Œå¼€é”€æ›´å°ï¼Œå¹¶å‘æ€§æ›´é«˜
- è¿›ç¨‹æ˜¯ä¸€ä¸ªå®ä½“ï¼Œæ‹¥æœ‰ç‹¬ç«‹çš„èµ„æºï¼›è€ŒåŒä¸€ä¸ªè¿›ç¨‹ä¸­çš„å¤šä¸ªçº¿ç¨‹å…±äº«è¿›ç¨‹çš„èµ„æºã€‚

![img](https://raw.githubusercontent.com/dunwu/images/master/cs/java/javacore/concurrent/processes-vs-threads.jpg)

JVM åœ¨å•ä¸ªè¿›ç¨‹ä¸­è¿è¡Œï¼ŒJVM ä¸­çš„çº¿ç¨‹å…±äº«å±äºè¯¥è¿›ç¨‹çš„å †ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆå‡ ä¸ªçº¿ç¨‹å¯ä»¥è®¿é—®åŒä¸€ä¸ªå¯¹è±¡ã€‚çº¿ç¨‹å…±äº«å †å¹¶æ‹¥æœ‰è‡ªå·±çš„å †æ ˆç©ºé—´ã€‚è¿™æ˜¯ä¸€ä¸ªçº¿ç¨‹å¦‚ä½•è°ƒç”¨ä¸€ä¸ªæ–¹æ³•ä»¥åŠå®ƒçš„å±€éƒ¨å˜é‡æ˜¯å¦‚ä½•ä¿æŒçº¿ç¨‹å®‰å…¨çš„ã€‚ä½†æ˜¯å †ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„å¹¶ä¸”ä¸ºäº†çº¿ç¨‹å®‰å…¨å¿…é¡»è¿›è¡ŒåŒæ­¥ã€‚

## çº¿ç¨‹åˆ›å»º

ä¸€èˆ¬æ¥è¯´ï¼Œåˆ›å»ºçº¿ç¨‹æœ‰å¾ˆå¤šç§æ–¹å¼ï¼Œä¾‹å¦‚ï¼š

- å®ç° `Runnable` æ¥å£
- å®ç° `Callable` æ¥å£
- ç»§æ‰¿ `Thread` ç±»
- é€šè¿‡çº¿ç¨‹æ± åˆ›å»ºçº¿ç¨‹
- ä½¿ç”¨ `CompletableFuture` åˆ›å»ºçº¿ç¨‹
- ...

ä¸‹é¢æ˜¯å‡ ç§åˆ›å»ºçº¿ç¨‹çš„ç¤ºä¾‹ï¼š

::: tabs#åˆ›å»ºçº¿ç¨‹

@tab Thread

### Thread

ã€ç¤ºä¾‹ã€‘ç»§æ‰¿ `Thread` ç±»åˆ›å»ºçº¿ç¨‹

1. å®šä¹‰ `Thread` ç±»çš„å­ç±»ï¼Œå¹¶è¦†å†™è¯¥ç±»çš„ `run` æ–¹æ³•ã€‚`run` æ–¹æ³•çš„æ–¹æ³•ä½“å°±ä»£è¡¨äº†çº¿ç¨‹è¦å®Œæˆçš„ä»»åŠ¡ï¼Œå› æ­¤æŠŠ `run` æ–¹æ³•ç§°ä¸ºæ‰§è¡Œä½“ã€‚
2. åˆ›å»º `Thread` å­ç±»çš„å®ä¾‹ï¼Œå³åˆ›å»ºäº†çº¿ç¨‹å¯¹è±¡ã€‚
3. è°ƒç”¨çº¿ç¨‹å¯¹è±¡çš„ `start` æ–¹æ³•æ¥å¯åŠ¨è¯¥çº¿ç¨‹ã€‚

```java
public class ThreadDemo {

    public static void main(String[] args) {
        // å®ä¾‹åŒ–å¯¹è±¡
        MyThread tA = new MyThread("Thread çº¿ç¨‹-A");
        MyThread tB = new MyThread("Thread çº¿ç¨‹-B");
        // è°ƒç”¨çº¿ç¨‹ä¸»ä½“
        tA.start();
        tB.start();
    }

    static class MyThread extends Thread {

        private int ticket = 5;

        MyThread(String name) {
            super(name);
        }

        @Override
        public void run() {
            while (ticket > 0) {
                System.out.println(Thread.currentThread().getName() + " å–å‡ºäº†ç¬¬ " + ticket + " å¼ ç¥¨");
                ticket--;
            }
        }

    }

}
```

@tab Runnable

### Runnable

**å®ç° `Runnable` æ¥å£ä¼˜äºç»§æ‰¿ `Thread` ç±»**ï¼Œå› ä¸ºï¼š

- Java ä¸æ”¯æŒå¤šé‡ç»§æ‰¿ï¼Œæ‰€æœ‰çš„ç±»éƒ½åªå…è®¸ç»§æ‰¿ä¸€ä¸ªçˆ¶ç±»ï¼Œä½†å¯ä»¥å®ç°å¤šä¸ªæ¥å£ã€‚å¦‚æœç»§æ‰¿äº† `Thread` ç±»å°±æ— æ³•ç»§æ‰¿å…¶å®ƒç±»ï¼Œè¿™ä¸åˆ©äºæ‰©å±•ã€‚
- ç±»å¯èƒ½åªè¦æ±‚å¯æ‰§è¡Œå°±è¡Œï¼Œç»§æ‰¿æ•´ä¸ª `Thread` ç±»å¼€é”€è¿‡å¤§ã€‚

ã€ç¤ºä¾‹ã€‘å®ç° `Runnable` æ¥å£åˆ›å»ºçº¿ç¨‹

1. å®šä¹‰ `Runnable` æ¥å£çš„å®ç°ç±»ï¼Œå¹¶è¦†å†™è¯¥æ¥å£çš„ `run` æ–¹æ³•ã€‚è¯¥ `run` æ–¹æ³•çš„æ–¹æ³•ä½“åŒæ ·æ˜¯è¯¥çº¿ç¨‹çš„çº¿ç¨‹æ‰§è¡Œä½“ã€‚
2. åˆ›å»º `Runnable` å®ç°ç±»çš„å®ä¾‹ï¼Œå¹¶ä»¥æ­¤å®ä¾‹ä½œä¸º `Thread` çš„ target æ¥åˆ›å»º `Thread` å¯¹è±¡ï¼Œè¯¥ `Thread` å¯¹è±¡æ‰æ˜¯çœŸæ­£çš„çº¿ç¨‹å¯¹è±¡ã€‚
3. è°ƒç”¨çº¿ç¨‹å¯¹è±¡çš„ `start` æ–¹æ³•æ¥å¯åŠ¨è¯¥çº¿ç¨‹ã€‚

```java
public class RunnableDemo {

    public static void main(String[] args) {
        // å®ä¾‹åŒ–å¯¹è±¡
        Thread tA = new Thread(new MyThread(), "Runnable çº¿ç¨‹-A");
        Thread tB = new Thread(new MyThread(), "Runnable çº¿ç¨‹-B");
        // è°ƒç”¨çº¿ç¨‹ä¸»ä½“
        tA.start();
        tB.start();
    }

    static class MyThread implements Runnable {

        private int ticket = 5;

        @Override
        public void run() {
            while (ticket > 0) {
                System.out.println(Thread.currentThread().getName() + " å–å‡ºäº†ç¬¬ " + ticket + " å¼ ç¥¨");
                ticket--;
            }
        }

    }

}
```

@tab Callable

### Callableã€Futureã€FutureTask

**ç»§æ‰¿ Thread ç±»å’Œå®ç° Runnable æ¥å£è¿™ä¸¤ç§åˆ›å»ºçº¿ç¨‹çš„æ–¹å¼éƒ½æ²¡æœ‰è¿”å›å€¼**ã€‚æ‰€ä»¥ï¼Œçº¿ç¨‹æ‰§è¡Œå®Œåï¼Œæ— æ³•å¾—åˆ°æ‰§è¡Œç»“æœã€‚ä½†å¦‚æœæœŸæœ›å¾—åˆ°æ‰§è¡Œç»“æœè¯¥æ€ä¹ˆåšï¼Ÿ

ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒJava 1.5 åï¼Œæä¾›äº† `Callable` æ¥å£å’Œ `Future` æ¥å£ï¼Œé€šè¿‡å®ƒä»¬ï¼Œå¯ä»¥åœ¨çº¿ç¨‹æ‰§è¡Œç»“æŸåï¼Œè¿”å›æ‰§è¡Œç»“æœã€‚

#### Callable

`Callable` æ¥å£åªå£°æ˜äº†ä¸€ä¸ª `call` æ–¹æ³•ï¼š

```java
public interface Callable<V> {
    /**
     * Computes a result, or throws an exception if unable to do so.
     *
     * @return computed result
     * @throws Exception if unable to compute a result
     */
    V call() throws Exception;
}
```

é‚£ä¹ˆæ€ä¹ˆä½¿ç”¨ `Callable` å‘¢ï¼Ÿä¸€èˆ¬æƒ…å†µä¸‹æ˜¯é…åˆ `ExecutorService` æ¥ä½¿ç”¨çš„ï¼Œåœ¨ `ExecutorService` æ¥å£ä¸­å£°æ˜äº†è‹¥å¹²ä¸ª `submit` æ–¹æ³•çš„é‡è½½ç‰ˆæœ¬ï¼š

```java
<T> Future<T> submit(Callable<T> task);
<T> Future<T> submit(Runnable task, T result);
Future<?> submit(Runnable task);
```

ç¬¬ä¸€ä¸ª `submit` æ–¹æ³•é‡Œé¢çš„å‚æ•°ç±»å‹å°±æ˜¯ `Callable`ã€‚

#### Future

`Future` å°±æ˜¯å¯¹äºå…·ä½“çš„ `Callable` ä»»åŠ¡çš„æ‰§è¡Œç»“æœè¿›è¡Œå–æ¶ˆã€æŸ¥è¯¢æ˜¯å¦å®Œæˆã€è·å–ç»“æœã€‚å¿…è¦æ—¶å¯ä»¥é€šè¿‡ `get` æ–¹æ³•è·å–æ‰§è¡Œç»“æœï¼Œè¯¥æ–¹æ³•ä¼šé˜»å¡ç›´åˆ°ä»»åŠ¡è¿”å›ç»“æœã€‚

```java
public interface Future<V> {
    boolean cancel(boolean mayInterruptIfRunning);
    boolean isCancelled();
    boolean isDone();
    V get() throws InterruptedException, ExecutionException;
    V get(long timeout, TimeUnit unit)
        throws InterruptedException, ExecutionException, TimeoutException;
}
```

#### FutureTask

`FutureTask` ç±»å®ç°äº† `RunnableFuture` æ¥å£ï¼Œ`RunnableFuture` ç»§æ‰¿äº† `Runnable` æ¥å£å’Œ `Future` æ¥å£ã€‚

æ‰€ä»¥ï¼Œ`FutureTask` æ—¢å¯ä»¥ä½œä¸º `Runnable` è¢«çº¿ç¨‹æ‰§è¡Œï¼Œåˆå¯ä»¥ä½œä¸º `Future` å¾—åˆ° `Callable` çš„è¿”å›å€¼ã€‚

```java
public class FutureTask<V> implements RunnableFuture<V> {
    // ...
    public FutureTask(Callable<V> callable) {}
    public FutureTask(Runnable runnable, V result) {}
}

public interface RunnableFuture<V> extends Runnable, Future<V> {
    void run();
}
```

äº‹å®ä¸Šï¼Œ`FutureTask` æ˜¯ `Future` æ¥å£çš„ä¸€ä¸ªå”¯ä¸€å®ç°ç±»ã€‚

#### Callable + Future + FutureTask ç¤ºä¾‹

é€šè¿‡å®ç° `Callable` æ¥å£åˆ›å»ºçº¿ç¨‹çš„æ­¥éª¤ï¼š

1. åˆ›å»º `Callable` æ¥å£çš„å®ç°ç±»ï¼Œå¹¶å®ç° `call` æ–¹æ³•ã€‚è¯¥ `call` æ–¹æ³•å°†ä½œä¸ºçº¿ç¨‹æ‰§è¡Œä½“ï¼Œå¹¶ä¸”æœ‰è¿”å›å€¼ã€‚
2. åˆ›å»º `Callable` å®ç°ç±»çš„å®ä¾‹ï¼Œä½¿ç”¨ `FutureTask` ç±»æ¥åŒ…è£… `Callable` å¯¹è±¡ï¼Œè¯¥ `FutureTask` å¯¹è±¡å°è£…äº†è¯¥ `Callable` å¯¹è±¡çš„ `call` æ–¹æ³•çš„è¿”å›å€¼ã€‚
3. ä½¿ç”¨ `FutureTask` å¯¹è±¡ä½œä¸º `Thread` å¯¹è±¡çš„ target åˆ›å»ºå¹¶å¯åŠ¨æ–°çº¿ç¨‹ã€‚
4. è°ƒç”¨ `FutureTask` å¯¹è±¡çš„ `get` æ–¹æ³•æ¥è·å¾—çº¿ç¨‹æ‰§è¡Œç»“æŸåçš„è¿”å›å€¼ã€‚

```java
public class CallableDemo {

    public static void main(String[] args) {
        Callable<Long> callable = new MyThread();
        FutureTask<Long> future = new FutureTask<>(callable);
        new Thread(future, "Callable çº¿ç¨‹").start();
        try {
            System.out.println("ä»»åŠ¡è€—æ—¶ï¼š" + (future.get() / 1000000) + "æ¯«ç§’");
        } catch (InterruptedException | ExecutionException e) {
            e.printStackTrace();
        }
    }

    static class MyThread implements Callable<Long> {

        private int ticket = 10000;

        @Override
        public Long call() {
            long begin = System.nanoTime();
            while (ticket > 0) {
                System.out.println(Thread.currentThread().getName() + " å–å‡ºäº†ç¬¬ " + ticket + " å¼ ç¥¨");
                ticket--;
            }

            long end = System.nanoTime();
            return (end - begin);
        }

    }

}
```

:::

è™½ç„¶ï¼Œçœ‹ä¼¼æœ‰å¤šç§å¤šæ ·çš„åˆ›å»ºçº¿ç¨‹æ–¹å¼ã€‚ä½†æ˜¯ï¼Œ**ä»æœ¬è´¨ä¸Šæ¥è¯´ï¼ŒJava å°±åªæœ‰ä¸€ç§æ–¹å¼å¯ä»¥åˆ›å»ºçº¿ç¨‹ï¼Œé‚£å°±æ˜¯é€šè¿‡ `new Thread().start() ` åˆ›å»º**ã€‚ä¸ç®¡æ˜¯å“ªç§æ–¹å¼ï¼Œæœ€ç»ˆè¿˜æ˜¯ä¾èµ–äº `new Thread().start()`ã€‚

> ğŸ‘‰ æ‰©å±•é˜…è¯»ï¼š[å¤§å®¶éƒ½è¯´ Java æœ‰ä¸‰ç§åˆ›å»ºçº¿ç¨‹çš„æ–¹å¼ï¼å¹¶å‘ç¼–ç¨‹ä¸­çš„æƒŠå¤©éª—å±€ï¼](https://mp.weixin.qq.com/s/NspUsyhEmKnJ-4OprRFp9g)ã€‚

## çº¿ç¨‹ç»ˆæ­¢

### å¦‚ä½•æ­£ç¡®åœæ­¢çº¿ç¨‹

é€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¸ä¼šæ‰‹åŠ¨åœæ­¢ä¸€ä¸ªçº¿ç¨‹ï¼Œè€Œæ˜¯å…è®¸çº¿ç¨‹è¿è¡Œåˆ°ç»“æŸï¼Œç„¶åè®©å®ƒè‡ªç„¶åœæ­¢ã€‚ä½†æ˜¯ä¾ç„¶ä¼šæœ‰è®¸å¤šç‰¹æ®Šçš„æƒ…å†µéœ€è¦æˆ‘ä»¬æå‰åœæ­¢çº¿ç¨‹ï¼Œæ¯”å¦‚ï¼šç”¨æˆ·çªç„¶å…³é—­ç¨‹åºï¼Œæˆ–ç¨‹åºè¿è¡Œå‡ºé”™é‡å¯ç­‰ã€‚

**å¯¹äº Java è€Œè¨€ï¼Œæœ€æ­£ç¡®çš„åœæ­¢çº¿ç¨‹çš„æ–¹å¼æ˜¯ï¼šé€šè¿‡ `Thread.interrupt` å’Œ `Thread.isInterrupted` é…åˆæ¥æ§åˆ¶çº¿ç¨‹ç»ˆæ­¢**ã€‚ä½† `Thread.interrupt` ä»…ä»…èµ·åˆ°é€šçŸ¥è¢«åœæ­¢çº¿ç¨‹çš„ä½œç”¨ã€‚è€Œå¯¹äºè¢«åœæ­¢çš„çº¿ç¨‹è€Œè¨€ï¼Œå®ƒæ‹¥æœ‰å®Œå…¨çš„è‡ªä¸»æƒï¼Œå®ƒæ—¢å¯ä»¥é€‰æ‹©ç«‹å³åœæ­¢ï¼Œä¹Ÿå¯ä»¥é€‰æ‹©ä¸€æ®µæ—¶é—´ååœæ­¢ï¼Œä¹Ÿå¯ä»¥é€‰æ‹©å‹æ ¹ä¸åœæ­¢ã€‚

äº‹å®ä¸Šï¼ŒJava å¸Œæœ›ç¨‹åºé—´èƒ½å¤Ÿç›¸äº’é€šçŸ¥ã€ç›¸äº’åä½œåœ°ç®¡ç†çº¿ç¨‹ï¼Œå› ä¸ºå¦‚æœä¸äº†è§£å¯¹æ–¹æ­£åœ¨åšçš„å·¥ä½œï¼Œè´¸ç„¶å¼ºåˆ¶åœæ­¢çº¿ç¨‹å°±å¯èƒ½ä¼šé€ æˆä¸€äº›å®‰å…¨çš„é—®é¢˜ï¼Œä¸ºäº†é¿å…é€ æˆé—®é¢˜å°±éœ€è¦ç»™å¯¹æ–¹ä¸€å®šçš„æ—¶é—´æ¥æ•´ç†æ”¶å°¾å·¥ä½œã€‚æ¯”å¦‚ï¼šçº¿ç¨‹æ­£åœ¨å†™å…¥ä¸€ä¸ªæ–‡ä»¶ï¼Œè¿™æ—¶æ”¶åˆ°ç»ˆæ­¢ä¿¡å·ï¼Œå®ƒå°±éœ€è¦æ ¹æ®è‡ªèº«ä¸šåŠ¡åˆ¤æ–­ï¼Œæ˜¯é€‰æ‹©ç«‹å³åœæ­¢ï¼Œè¿˜æ˜¯å°†æ•´ä¸ªæ–‡ä»¶å†™å…¥æˆåŠŸååœæ­¢ï¼Œè€Œå¦‚æœé€‰æ‹©ç«‹å³åœæ­¢å°±å¯èƒ½é€ æˆæ•°æ®ä¸å®Œæ•´ï¼Œä¸ç®¡æ˜¯ä¸­æ–­å‘½ä»¤å‘èµ·è€…ï¼Œè¿˜æ˜¯æ¥æ”¶è€…éƒ½ä¸å¸Œæœ›æ•°æ®å‡ºç°é—®é¢˜ã€‚

ä¸€æ—¦è°ƒç”¨æŸä¸ªçº¿ç¨‹çš„ `Thread.interrupt` ä¹‹åï¼Œè¿™ä¸ªçº¿ç¨‹çš„ä¸­æ–­æ ‡è®°ä½å°±ä¼šè¢«è®¾ç½®æˆ `true`ã€‚æ¯ä¸ªçº¿ç¨‹éƒ½æœ‰è¿™æ ·çš„æ ‡è®°ä½ï¼Œå½“çº¿ç¨‹æ‰§è¡Œæ—¶ï¼Œåº”è¯¥å®šæœŸæ£€æŸ¥è¿™ä¸ªæ ‡è®°ä½ï¼Œå¦‚æœæ ‡è®°ä½è¢«è®¾ç½®æˆ `true`ï¼Œå°±è¯´æ˜æœ‰ç¨‹åºæƒ³ç»ˆæ­¢è¯¥çº¿ç¨‹ã€‚å›åˆ°æºç ï¼Œå¯ä»¥çœ‹åˆ°åœ¨ `while` å¾ªç¯ä½“åˆ¤æ–­è¯­å¥ä¸­ï¼Œé¦–å…ˆé€šè¿‡ `Thread.currentThread().isInterrupt()` åˆ¤æ–­çº¿ç¨‹æ˜¯å¦è¢«ä¸­æ–­ï¼Œéšåæ£€æŸ¥æ˜¯å¦è¿˜æœ‰å·¥ä½œè¦åšã€‚&& é€»è¾‘è¡¨ç¤ºåªæœ‰å½“ä¸¤ä¸ªåˆ¤æ–­æ¡ä»¶åŒæ—¶æ»¡è¶³çš„æƒ…å†µä¸‹ï¼Œæ‰ä¼šå»æ‰§è¡Œä¸‹é¢çš„å·¥ä½œã€‚

éœ€è¦ç•™æ„ä¸€ä¸ªç‰¹æ®Šåœºæ™¯ï¼š**`Thread.sleep` åï¼Œçº¿ç¨‹ä¾ç„¶å¯ä»¥æ„ŸçŸ¥ `Thread.interrupt`**ã€‚

ã€ç¤ºä¾‹ã€‘æ­£ç¡®åœæ­¢çº¿ç¨‹çš„æ–¹å¼â€”â€”`Thread.interrupt`

```java
public class ThreadStopDemo {

    public static void main(String[] args) throws Exception {
        Thread thread = new Thread(new MyTask(), "MyTask");
        thread.start();
        TimeUnit.MILLISECONDS.sleep(10);
        thread.interrupt();
    }

    private static class MyTask implements Runnable {

        private long count = 0L;

        @Override
        public void run() {
            System.out.println(Thread.currentThread().getName() + " çº¿ç¨‹å¯åŠ¨");
            // é€šè¿‡ Thread.interrupted å’Œ interrupt é…åˆæ¥æ§åˆ¶çº¿ç¨‹ç»ˆæ­¢
            while (!Thread.currentThread().isInterrupted() && count < 10000) {
                System.out.println("count = " + count++);
            }
            System.out.println(Thread.currentThread().getName() + " çº¿ç¨‹ç»ˆæ­¢");
        }

    }

}
// è¾“å‡ºï¼ˆcount æœªåˆ° 10000ï¼Œçº¿ç¨‹å°±ä¸»åŠ¨ç»“æŸï¼‰ï¼š
// MyTask çº¿ç¨‹å¯åŠ¨
// count = 0
// count = 1
// ...
// count = 840
// count = 841
// count = 842
// MyTask çº¿ç¨‹ç»ˆæ­¢
```

### å¯ä»¥ä½¿ç”¨ `Thread.stop`ï¼Œ`Thread.suspend` å’Œ `Thread.resume` åœæ­¢çº¿ç¨‹å—ï¼Ÿ

`Thread.stop`ï¼Œ`Thread.suspend` å’Œ `Thread.resume` æ–¹æ³•å·²ç»è¢« Java æ ‡è®°ä¸º `@Deprecated`ã€‚ä¸ºä»€ä¹ˆåºŸå¼ƒå‘¢ï¼Ÿ

- **`Thread.stop` ä¼šç›´æ¥æŠŠçº¿ç¨‹åœæ­¢ï¼Œè¿™æ ·å°±æ²¡æœ‰ç»™çº¿ç¨‹è¶³å¤Ÿçš„æ—¶é—´æ¥å¤„ç†æƒ³è¦åœ¨åœæ­¢å‰ä¿å­˜æ•°æ®çš„é€»è¾‘ï¼Œä»»åŠ¡æˆ›ç„¶è€Œæ­¢ï¼Œä¼šå¯¼è‡´å‡ºç°æ•°æ®å®Œæ•´æ€§ç­‰é—®é¢˜**ã€‚
- è€Œå¯¹äº`Thread.suspend` å’Œ `Thread.resume` è€Œè¨€ï¼Œå®ƒä»¬çš„é—®é¢˜åœ¨äºï¼š**å¦‚æœçº¿ç¨‹è°ƒç”¨ `Thread.suspend`ï¼Œå®ƒå¹¶ä¸ä¼šé‡Šæ”¾é”ï¼Œå°±å¼€å§‹è¿›å…¥ä¼‘çœ ï¼Œä½†æ­¤æ—¶æœ‰å¯èƒ½ä»æŒæœ‰é”ï¼Œè¿™æ ·å°±å®¹æ˜“å¯¼è‡´æ­»é”é—®é¢˜**ã€‚å› ä¸ºè¿™æŠŠé”åœ¨çº¿ç¨‹è¢« `Thread.resume` ä¹‹å‰ï¼Œæ˜¯ä¸ä¼šè¢«é‡Šæ”¾çš„ã€‚å‡è®¾çº¿ç¨‹ A è°ƒç”¨äº† `Thread.suspend` æ–¹æ³•è®©çº¿ç¨‹ B æŒ‚èµ·ï¼Œçº¿ç¨‹ B è¿›å…¥ä¼‘çœ ï¼Œè€Œçº¿ç¨‹ B åˆåˆšå¥½æŒæœ‰ä¸€æŠŠé”ï¼Œæ­¤æ—¶å‡è®¾çº¿ç¨‹ A æƒ³è®¿é—®çº¿ç¨‹ B æŒæœ‰çš„é”ï¼Œä½†ç”±äºçº¿ç¨‹ B å¹¶æ²¡æœ‰é‡Šæ”¾é”å°±è¿›å…¥ä¼‘çœ äº†ï¼Œæ‰€ä»¥å¯¹äºçº¿ç¨‹ A è€Œè¨€ï¼Œæ­¤æ—¶æ‹¿ä¸åˆ°é”ï¼Œä¹Ÿä¼šé™·å…¥é˜»å¡ï¼Œé‚£ä¹ˆçº¿ç¨‹ A å’Œçº¿ç¨‹ B å°±éƒ½æ— æ³•ç»§ç»­å‘ä¸‹æ‰§è¡Œã€‚

ã€ç¤ºä¾‹ã€‘`Thread.stop` ç»ˆæ­¢çº¿ç¨‹ï¼Œå¯¼è‡´çº¿ç¨‹ä»»åŠ¡æˆ›ç„¶è€Œæ­¢

```java
public class ThreadStopErrorDemo {

    public static void main(String[] args) {
        MyTask thread = new MyTask();
        thread.start();
        try {
            Thread.sleep(1000);
        } catch (InterruptedException e) {
            e.printStackTrace();
        }
        // ç»ˆæ­¢çº¿ç¨‹
        thread.stop();
        // ç¡®ä¿çº¿ç¨‹ç»ˆæ­¢åï¼Œæ‰æ‰§è¡Œä¸‹é¢çš„ä»£ç 
        while (thread.isAlive()) { }
        // è¾“å‡ºä¸¤ä¸ªè®¡æ•°å™¨çš„æœ€ç»ˆçŠ¶æ€
        thread.print();
    }

    /**
     * æŒæœ‰ä¸¤ä¸ªè®¡æ•°å™¨ï¼Œrun æ–¹æ³•ä¸­æ¯æ¬¡æ‰§è¡Œéƒ½ä¼šä½¿è®¡æ•°å™¨è‡ªå¢
     */
    private static class MyTask extends Thread {

        private int i = 0;

        private int j = 0;

        @Override
        public void run() {
            synchronized (this) {
                ++i;
                try {
                    // æ¨¡æ‹Ÿè€—æ—¶æ“ä½œ
                    TimeUnit.SECONDS.sleep(5);
                } catch (InterruptedException e) {
                    e.printStackTrace();
                }
                ++j;
            }
        }

        public void print() {
            System.out.println("i=" + i + " j=" + j);
        }

    }

}
```

### ä½¿ç”¨ `volatile` æ ‡è®°æ–¹å¼åœæ­¢çº¿ç¨‹æ­£ç¡®å—ï¼Ÿ

ä½¿ç”¨ `volatile` æ ‡è®°æ–¹å¼åœæ­¢çº¿ç¨‹å¹¶ä¸æ€»æ˜¯æ­£ç¡®çš„ã€‚è™½ç„¶ `volatile` å˜é‡å¯ä»¥ç¡®ä¿å¯è§æ€§ï¼Œå³å½“ä¸€ä¸ªçº¿ç¨‹ä¿®æ”¹äº† `volatile` å˜é‡çš„å€¼ï¼Œå…¶ä»–çº¿ç¨‹èƒ½å¤Ÿç«‹å³çœ‹åˆ°æœ€æ–°çš„å€¼ï¼Œä½†å®ƒå¹¶ä¸èƒ½ä¿è¯åŸå­æ€§ï¼Œä¹Ÿå°±æ˜¯è¯´å¹¶ä¸èƒ½ä¿è¯å¤šä¸ªçº¿ç¨‹å¯¹ `volatile` å˜é‡çš„æ“ä½œæ˜¯äº’æ–¥çš„ã€‚

å½“æˆ‘ä»¬ä½¿ç”¨ `volatile` å˜é‡æ¥æ§åˆ¶çº¿ç¨‹çš„åœæ­¢ï¼Œé€šå¸¸æ˜¯é€šè¿‡è®¾ç½®ä¸€ä¸ª `volatile` æ ‡å¿—ä½æ¥å‘Šè¯‰çº¿ç¨‹åœæ­¢æ‰§è¡Œã€‚ä¾‹å¦‚ï¼š

```java
public class MyTask extends Thread {
    private volatile boolean canceled = false;

    public void run() {
        while (!canceled) {
            // æ‰§è¡Œä»»åŠ¡
        }
    }

    public void stopTask() {
        canceled = true;
    }
}
```

åœ¨ä¸Šè¿°ä¾‹å­ä¸­ï¼Œ`canceled` æ˜¯ä¸€ä¸ª `volatile` å˜é‡ï¼Œç”¨æ¥æ§åˆ¶çº¿ç¨‹çš„åœæ­¢ã€‚è™½ç„¶è¿™ç§æ–¹å¼åœ¨æŸäº›æƒ…å†µä¸‹å¯ä»¥å·¥ä½œï¼Œä½†å®ƒå¹¶**ä¸æ˜¯ä¸€ä¸ªå¯é çš„åœæ­¢çº¿ç¨‹çš„æ–¹å¼ï¼Œå› ä¸ºåœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸­ï¼Œå…¶ä»–çº¿ç¨‹ä¿®æ”¹ `canceled` çš„å€¼æ—¶ï¼Œå¯èƒ½ä¼šå‡ºç°ç«æ€æ¡ä»¶ï¼Œå¯¼è‡´çº¿ç¨‹æ— æ³•æ­£ç¡®åœæ­¢**ã€‚

## çº¿ç¨‹åŸºæœ¬æ–¹æ³•

çº¿ç¨‹ï¼ˆ`Thread`ï¼‰åŸºæœ¬æ–¹æ³•æ¸…å•ï¼š

| æ–¹æ³•            | æè¿°                                                                                                                                                                                                         |
| --------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| `run`           | çº¿ç¨‹çš„æ‰§è¡Œå®ä½“ã€‚                                                                                                                                                                                             |
| `start`         | çº¿ç¨‹çš„å¯åŠ¨æ–¹æ³•ã€‚                                                                                                                                                                                             |
| `currentThread` | è¿”å›å¯¹å½“å‰æ­£åœ¨æ‰§è¡Œçš„çº¿ç¨‹å¯¹è±¡çš„å¼•ç”¨ã€‚                                                                                                                                                                         |
| `setName`       | è®¾ç½®çº¿ç¨‹åç§°ã€‚                                                                                                                                                                                               |
| `getName`       | è·å–çº¿ç¨‹åç§°ã€‚                                                                                                                                                                                               |
| `setPriority`   | è®¾ç½®çº¿ç¨‹ä¼˜å…ˆçº§ã€‚Java ä¸­çš„çº¿ç¨‹ä¼˜å…ˆçº§çš„èŒƒå›´æ˜¯ [1,10]ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œé«˜ä¼˜å…ˆçº§çš„çº¿ç¨‹åœ¨è¿è¡Œæ—¶ä¼šå…·æœ‰ä¼˜å…ˆæƒã€‚å¯ä»¥é€šè¿‡ `thread.setPriority(Thread.MAX_PRIORITY)` çš„æ–¹å¼è®¾ç½®ï¼Œé»˜è®¤ä¼˜å…ˆçº§ä¸º 5ã€‚                            |
| `getPriority`   | è·å–çº¿ç¨‹ä¼˜å…ˆçº§ã€‚                                                                                                                                                                                             |
| `setDaemon`     | è®¾ç½®çº¿ç¨‹ä¸ºå®ˆæŠ¤çº¿ç¨‹ã€‚                                                                                                                                                                                         |
| `isDaemon`      | åˆ¤æ–­çº¿ç¨‹æ˜¯å¦ä¸ºå®ˆæŠ¤çº¿ç¨‹ã€‚                                                                                                                                                                                     |
| `isAlive`       | åˆ¤æ–­çº¿ç¨‹æ˜¯å¦å¯åŠ¨ã€‚                                                                                                                                                                                           |
| `interrupt`     | ä¸­æ–­å¦ä¸€ä¸ªçº¿ç¨‹çš„è¿è¡ŒçŠ¶æ€ã€‚                                                                                                                                                                                   |
| `interrupted`   | æµ‹è¯•å½“å‰çº¿ç¨‹æ˜¯å¦å·²è¢«ä¸­æ–­ã€‚é€šè¿‡æ­¤æ–¹æ³•å¯ä»¥æ¸…é™¤çº¿ç¨‹çš„ä¸­æ–­çŠ¶æ€ã€‚æ¢å¥è¯è¯´ï¼Œå¦‚æœè¦è¿ç»­è°ƒç”¨æ­¤æ–¹æ³•ä¸¤æ¬¡ï¼Œåˆ™ç¬¬äºŒæ¬¡è°ƒç”¨å°†è¿”å› falseï¼ˆé™¤éå½“å‰çº¿ç¨‹åœ¨ç¬¬ä¸€æ¬¡è°ƒç”¨æ¸…é™¤å…¶ä¸­æ–­çŠ¶æ€ä¹‹åä¸”åœ¨ç¬¬äºŒæ¬¡è°ƒç”¨æ£€æŸ¥å…¶çŠ¶æ€ä¹‹å‰å†æ¬¡ä¸­æ–­ï¼‰ã€‚ |
| `join`          | å¯ä»¥ä½¿ä¸€ä¸ªçº¿ç¨‹å¼ºåˆ¶è¿è¡Œï¼Œçº¿ç¨‹å¼ºåˆ¶è¿è¡ŒæœŸé—´ï¼Œå…¶ä»–çº¿ç¨‹æ— æ³•è¿è¡Œï¼Œå¿…é¡»ç­‰å¾…æ­¤çº¿ç¨‹å®Œæˆä¹‹åæ‰å¯ä»¥ç»§ç»­æ‰§è¡Œã€‚                                                                                                           |
| `Thread.sleep`  | é™æ€æ–¹æ³•ã€‚å°†å½“å‰æ­£åœ¨æ‰§è¡Œçš„çº¿ç¨‹ä¼‘çœ ã€‚                                                                                                                                                                         |
| `Thread.yield`  | é™æ€æ–¹æ³•ã€‚å°†å½“å‰æ­£åœ¨æ‰§è¡Œçš„çº¿ç¨‹æš‚åœï¼Œè®©å…¶ä»–çº¿ç¨‹æ‰§è¡Œã€‚                                                                                                                                                         |

### çº¿ç¨‹ä¼‘çœ 

**ä½¿ç”¨ `Thread.sleep` æ–¹æ³•å¯ä»¥ä½¿å¾—å½“å‰æ­£åœ¨æ‰§è¡Œçš„çº¿ç¨‹è¿›å…¥ä¼‘çœ çŠ¶æ€ã€‚**

ä½¿ç”¨ `Thread.sleep` éœ€è¦å‘å…¶ä¼ å…¥ä¸€ä¸ªæ•´æ•°å€¼ï¼Œè¿™ä¸ªå€¼è¡¨ç¤ºçº¿ç¨‹å°†è¦ä¼‘çœ çš„æ¯«ç§’æ•°ã€‚

`Thread.sleep` æ–¹æ³•å¯èƒ½ä¼šæŠ›å‡º `InterruptedException`ï¼Œå› ä¸ºå¼‚å¸¸ä¸èƒ½è·¨çº¿ç¨‹ä¼ æ’­å› `main` ä¸­ï¼Œå› æ­¤å¿…é¡»åœ¨æœ¬åœ°è¿›è¡Œå¤„ç†ã€‚çº¿ç¨‹ä¸­æŠ›å‡ºçš„å…¶å®ƒå¼‚å¸¸ä¹ŸåŒæ ·éœ€è¦åœ¨æœ¬åœ°è¿›è¡Œå¤„ç†ã€‚

```java
public class ThreadSleepDemo {

    public static void main(String[] args) {
        new Thread(new MyThread("çº¿ç¨‹ A", 500)).start();
        new Thread(new MyThread("çº¿ç¨‹ B", 1000)).start();
        new Thread(new MyThread("çº¿ç¨‹ C", 1500)).start();
    }

    static class MyThread implements Runnable {

        /** çº¿ç¨‹åç§° */
        private String name;

        /** ä¼‘çœ æ—¶é—´ */
        private int time;

        private MyThread(String name, int time) {
            this.name = name;
            this.time = time;
        }

        @Override
        public void run() {
            try {
                // ä¼‘çœ æŒ‡å®šçš„æ—¶é—´
                Thread.sleep(this.time);
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
            System.out.println(this.name + "ä¼‘çœ " + this.time + "æ¯«ç§’ã€‚");
        }

    }

}
```

### çº¿ç¨‹ç¤¼è®©

`Thread.yield` æ–¹æ³•çš„è°ƒç”¨å£°æ˜äº†å½“å‰çº¿ç¨‹å·²ç»å®Œæˆäº†ç”Ÿå‘½å‘¨æœŸä¸­æœ€é‡è¦çš„éƒ¨åˆ†ï¼Œå¯ä»¥åˆ‡æ¢ç»™å…¶å®ƒçº¿ç¨‹æ¥æ‰§è¡Œ ã€‚è¯¥æ–¹æ³•åªæ˜¯å¯¹çº¿ç¨‹è°ƒåº¦å™¨çš„ä¸€ä¸ªå»ºè®®ï¼Œè€Œä¸”ä¹Ÿåªæ˜¯å»ºè®®å…·æœ‰ç›¸åŒä¼˜å…ˆçº§çš„å…¶å®ƒçº¿ç¨‹å¯ä»¥è¿è¡Œã€‚

```java
public class ThreadYieldDemo {

    public static void main(String[] args) {
        MyThread t = new MyThread();
        new Thread(t, "çº¿ç¨‹ A").start();
        new Thread(t, "çº¿ç¨‹ B").start();
    }

    static class MyThread implements Runnable {

        @Override
        public void run() {
            for (int i = 0; i < 5; i++) {
                try {
                    Thread.sleep(1000);
                } catch (Exception e) {
                    e.printStackTrace();
                }
                System.out.println(Thread.currentThread().getName() + "è¿è¡Œï¼Œi = " + i);
                if (i == 2) {
                    System.out.print("çº¿ç¨‹ç¤¼è®©ï¼š");
                    Thread.yield();
                }
            }
        }
    }
}
```

### å®ˆæŠ¤çº¿ç¨‹

ä»€ä¹ˆæ˜¯å®ˆæŠ¤çº¿ç¨‹ï¼Ÿ

- **å®ˆæŠ¤çº¿ç¨‹ï¼ˆDaemon Threadï¼‰æ˜¯åœ¨åå°æ‰§è¡Œå¹¶ä¸”ä¸ä¼šé˜»æ­¢ JVM ç»ˆæ­¢çš„çº¿ç¨‹**ã€‚**å½“æ‰€æœ‰éå®ˆæŠ¤çº¿ç¨‹ç»“æŸæ—¶ï¼Œç¨‹åºä¹Ÿå°±ç»ˆæ­¢ï¼ŒåŒæ—¶ä¼šæ€æ­»æ‰€æœ‰å®ˆæŠ¤çº¿ç¨‹**ã€‚
- ä¸å®ˆæŠ¤çº¿ç¨‹ï¼ˆDaemon Threadï¼‰ç›¸åçš„ï¼Œå«ç”¨æˆ·çº¿ç¨‹ï¼ˆUser Threadï¼‰ï¼Œä¹Ÿå°±æ˜¯éå®ˆæŠ¤çº¿ç¨‹ã€‚

ä¸ºä»€ä¹ˆéœ€è¦å®ˆæŠ¤çº¿ç¨‹ï¼Ÿ

- å®ˆæŠ¤çº¿ç¨‹çš„ä¼˜å…ˆçº§æ¯”è¾ƒä½ï¼Œç”¨äºä¸ºç³»ç»Ÿä¸­çš„å…¶å®ƒå¯¹è±¡å’Œçº¿ç¨‹æä¾›æœåŠ¡ã€‚å…¸å‹çš„åº”ç”¨å°±æ˜¯åƒåœ¾å›æ”¶å™¨ã€‚

å¦‚ä½•ä½¿ç”¨å®ˆæŠ¤çº¿ç¨‹ï¼Ÿ

- å¯ä»¥ä½¿ç”¨ `isDaemon` æ–¹æ³•åˆ¤æ–­çº¿ç¨‹æ˜¯å¦ä¸ºå®ˆæŠ¤çº¿ç¨‹ã€‚
- å¯ä»¥ä½¿ç”¨ `setDaemon` æ–¹æ³•è®¾ç½®çº¿ç¨‹ä¸ºå®ˆæŠ¤çº¿ç¨‹ã€‚
  - æ­£åœ¨è¿è¡Œçš„ç”¨æˆ·çº¿ç¨‹æ— æ³•è®¾ç½®ä¸ºå®ˆæŠ¤çº¿ç¨‹ï¼Œæ‰€ä»¥ `setDaemon` å¿…é¡»åœ¨ `thread.start` æ–¹æ³•ä¹‹å‰è®¾ç½®ï¼Œå¦åˆ™ä¼šæŠ›å‡º `llegalThreadStateException` å¼‚å¸¸ï¼›
  - ä¸€ä¸ªå®ˆæŠ¤çº¿ç¨‹åˆ›å»ºçš„å­çº¿ç¨‹ä¾ç„¶æ˜¯å®ˆæŠ¤çº¿ç¨‹ã€‚
  - ä¸è¦è®¤ä¸ºæ‰€æœ‰çš„åº”ç”¨éƒ½å¯ä»¥åˆ†é…ç»™å®ˆæŠ¤çº¿ç¨‹æ¥è¿›è¡ŒæœåŠ¡ï¼Œæ¯”å¦‚è¯»å†™æ“ä½œæˆ–è€…è®¡ç®—é€»è¾‘ã€‚

```java
public class ThreadDaemonDemo {

    public static void main(String[] args) {
        Thread t = new Thread(new MyThread(), "çº¿ç¨‹");
        t.setDaemon(true); // æ­¤çº¿ç¨‹åœ¨åå°è¿è¡Œ
        System.out.println("çº¿ç¨‹ t æ˜¯å¦æ˜¯å®ˆæŠ¤è¿›ç¨‹ï¼š" + t.isDaemon());
        t.start(); // å¯åŠ¨çº¿ç¨‹
    }

    static class MyThread implements Runnable {

        @Override
        public void run() {
            while (true) {
                System.out.println(Thread.currentThread().getName() + "åœ¨è¿è¡Œã€‚");
            }
        }
    }
}
```

> å‚è€ƒé˜…è¯»ï¼š[Java ä¸­å®ˆæŠ¤çº¿ç¨‹çš„æ€»ç»“](https://blog.csdn.net/shimiso/article/details/8964414)

## çº¿ç¨‹é€šä¿¡

> å½“å¤šä¸ªçº¿ç¨‹å¯ä»¥ä¸€èµ·å·¥ä½œå»è§£å†³æŸä¸ªé—®é¢˜æ—¶ï¼Œå¦‚æœæŸäº›éƒ¨åˆ†å¿…é¡»åœ¨å…¶å®ƒéƒ¨åˆ†ä¹‹å‰å®Œæˆï¼Œé‚£ä¹ˆå°±éœ€è¦å¯¹çº¿ç¨‹è¿›è¡Œåè°ƒã€‚

### wait/notify/notifyAll

- `wait` - `wait` ä¼šè‡ªåŠ¨é‡Šæ”¾å½“å‰çº¿ç¨‹å æœ‰çš„å¯¹è±¡é”ï¼Œå¹¶è¯·æ±‚æ“ä½œç³»ç»ŸæŒ‚èµ·å½“å‰çº¿ç¨‹ï¼Œ**è®©çº¿ç¨‹ä» `RUNNING` çŠ¶æ€è½¬å…¥ `WAITING` çŠ¶æ€**ï¼Œç­‰å¾… `notify` / `notifyAll` æ¥å”¤é†’ã€‚å¦‚æœæ²¡æœ‰é‡Šæ”¾é”ï¼Œé‚£ä¹ˆå…¶å®ƒçº¿ç¨‹å°±æ— æ³•è¿›å…¥å¯¹è±¡çš„åŒæ­¥æ–¹æ³•æˆ–è€…åŒæ­¥æ§åˆ¶å—ä¸­ï¼Œé‚£ä¹ˆå°±æ— æ³•æ‰§è¡Œ `notify` æˆ–è€… `notifyAll` æ¥å”¤é†’æŒ‚èµ·çš„çº¿ç¨‹ï¼Œé€ æˆæ­»é”ã€‚
- `notify` - å”¤é†’ä¸€ä¸ªæ­£åœ¨ `WAITING` çŠ¶æ€çš„çº¿ç¨‹ï¼Œå¹¶è®©å®ƒæ‹¿åˆ°å¯¹è±¡é”ï¼Œå…·ä½“å”¤é†’å“ªä¸€ä¸ªçº¿ç¨‹ç”± JVM æ§åˆ¶ ã€‚
- `notifyAll` - å”¤é†’æ‰€æœ‰æ­£åœ¨ `WAITING` çŠ¶æ€çš„çº¿ç¨‹ï¼Œæ¥ä¸‹æ¥å®ƒä»¬éœ€è¦ç«äº‰å¯¹è±¡é”ã€‚

> æ³¨æ„ï¼š
>
> - **`wait`ã€`notify`ã€`notifyAll` éƒ½æ˜¯ `Object` ç±»ä¸­çš„æ–¹æ³•**ï¼Œè€Œé `Thread`ã€‚
> - **`wait`ã€`notify`ã€`notifyAll` åªèƒ½ç”¨åœ¨ `synchronized` æ–¹æ³•æˆ–è€… `synchronized` ä»£ç å—ä¸­ä½¿ç”¨ï¼Œå¦åˆ™ä¼šåœ¨è¿è¡Œæ—¶æŠ›å‡º `IllegalMonitorStateException`**ã€‚

ç”Ÿäº§è€…ã€æ¶ˆè´¹è€…æ¨¡å¼æ˜¯ `wait`ã€`notify`ã€`notifyAll` çš„ä¸€ä¸ªç»å…¸ä½¿ç”¨æ¡ˆä¾‹ï¼š

```java
public class ThreadWaitNotifyDemo02 {

    private static final int QUEUE_SIZE = 10;
    private static final PriorityQueue<Integer> queue = new PriorityQueue<>(QUEUE_SIZE);

    public static void main(String[] args) {
        new Producer("ç”Ÿäº§è€… A").start();
        new Producer("ç”Ÿäº§è€… B").start();
        new Consumer("æ¶ˆè´¹è€… A").start();
        new Consumer("æ¶ˆè´¹è€… B").start();
    }

    static class Consumer extends Thread {

        Consumer(String name) {
            super(name);
        }

        @Override
        public void run() {
            while (true) {
                synchronized (queue) {
                    while (queue.size() == 0) {
                        try {
                            System.out.println("é˜Ÿåˆ—ç©ºï¼Œç­‰å¾…æ•°æ®");
                            queue.wait();
                        } catch (InterruptedException e) {
                            e.printStackTrace();
                            queue.notifyAll();
                        }
                    }
                    queue.poll(); // æ¯æ¬¡ç§»èµ°é˜Ÿé¦–å…ƒç´ 
                    queue.notifyAll();
                    try {
                        Thread.sleep(500);
                    } catch (InterruptedException e) {
                        e.printStackTrace();
                    }
                    System.out.println(Thread.currentThread().getName() + " ä»é˜Ÿåˆ—å–èµ°ä¸€ä¸ªå…ƒç´ ï¼Œé˜Ÿåˆ—å½“å‰æœ‰ï¼š" + queue.size() + "ä¸ªå…ƒç´ ");
                }
            }
        }
    }

    static class Producer extends Thread {

        Producer(String name) {
            super(name);
        }

        @Override
        public void run() {
            while (true) {
                synchronized (queue) {
                    while (queue.size() == QUEUE_SIZE) {
                        try {
                            System.out.println("é˜Ÿåˆ—æ»¡ï¼Œç­‰å¾…æœ‰ç©ºä½™ç©ºé—´");
                            queue.wait();
                        } catch (InterruptedException e) {
                            e.printStackTrace();
                            queue.notifyAll();
                        }
                    }
                    queue.offer(1); // æ¯æ¬¡æ’å…¥ä¸€ä¸ªå…ƒç´ 
                    queue.notifyAll();
                    try {
                        Thread.sleep(500);
                    } catch (InterruptedException e) {
                        e.printStackTrace();
                    }
                    System.out.println(Thread.currentThread().getName() + " å‘é˜Ÿåˆ—å–ä¸­æ’å…¥ä¸€ä¸ªå…ƒç´ ï¼Œé˜Ÿåˆ—å½“å‰æœ‰ï¼š" + queue.size() + "ä¸ªå…ƒç´ ");
                }
            }
        }
    }
}
```

### join

åœ¨çº¿ç¨‹æ“ä½œä¸­ï¼Œå¯ä»¥ä½¿ç”¨ `join` æ–¹æ³•è®©ä¸€ä¸ªçº¿ç¨‹å¼ºåˆ¶è¿è¡Œï¼Œçº¿ç¨‹å¼ºåˆ¶è¿è¡ŒæœŸé—´ï¼Œå…¶ä»–çº¿ç¨‹æ— æ³•è¿è¡Œï¼Œå¿…é¡»ç­‰å¾…æ­¤çº¿ç¨‹å®Œæˆä¹‹åæ‰å¯ä»¥ç»§ç»­æ‰§è¡Œã€‚

```java
public class ThreadJoinDemo {

    public static void main(String[] args) {
        MyThread mt = new MyThread(); // å®ä¾‹åŒ– Runnable å­ç±»å¯¹è±¡
        Thread t = new Thread(mt, "mythread"); // å®ä¾‹åŒ– Thread å¯¹è±¡
        t.start(); // å¯åŠ¨çº¿ç¨‹
        for (int i = 0; i < 50; i++) {
            if (i > 10) {
                try {
                    t.join(); // çº¿ç¨‹å¼ºåˆ¶è¿è¡Œ
                } catch (InterruptedException e) {
                    e.printStackTrace();
                }
            }
            System.out.println("Main çº¿ç¨‹è¿è¡Œ --> " + i);
        }
    }

    static class MyThread implements Runnable {

        @Override
        public void run() {
            for (int i = 0; i < 50; i++) {
                System.out.println(Thread.currentThread().getName() + " è¿è¡Œï¼Œi = " + i); // å–å¾—å½“å‰çº¿ç¨‹çš„åå­—
            }
        }
    }
}
```

### ç®¡é“

ç®¡é“è¾“å…¥/è¾“å‡ºæµå’Œæ™®é€šçš„æ–‡ä»¶è¾“å…¥/è¾“å‡ºæµæˆ–è€…ç½‘ç»œè¾“å…¥/è¾“å‡ºæµä¸åŒä¹‹å¤„åœ¨äºï¼Œå®ƒä¸»è¦ç”¨äºçº¿ç¨‹ä¹‹é—´çš„æ•°æ®ä¼ è¾“ï¼Œè€Œä¼ è¾“çš„åª’ä»‹ä¸ºå†…å­˜ã€‚
ç®¡é“è¾“å…¥/è¾“å‡ºæµä¸»è¦åŒ…æ‹¬äº†å¦‚ä¸‹ 4 ç§å…·ä½“å®ç°ï¼š`PipedOutputStream`ã€`PipedInputStream`ã€`PipedReader` å’Œ `PipedWriter`ï¼Œå‰ä¸¤ç§é¢å‘å­—èŠ‚ï¼Œè€Œåä¸¤ç§é¢å‘å­—ç¬¦ã€‚

```java
public class Piped {

    public static void main(String[] args) throws Exception {
        PipedWriter out = new PipedWriter();
        PipedReader in = new PipedReader();
        // å°†è¾“å‡ºæµå’Œè¾“å…¥æµè¿›è¡Œè¿æ¥ï¼Œå¦åˆ™åœ¨ä½¿ç”¨æ—¶ä¼šæŠ›å‡º IOException
        out.connect(in);
        Thread printThread = new Thread(new Print(in), "PrintThread");
        printThread.start();
        int receive = 0;
        try {
            while ((receive = System.in.read()) != -1) {
                out.write(receive);
            }
        } finally {
            out.close();
        }
    }

    static class Print implements Runnable {

        private PipedReader in;

        Print(PipedReader in) {
            this.in = in;
        }

        public void run() {
            int receive = 0;
            try {
                while ((receive = in.read()) != -1) {
                    System.out.print((char) receive);
                }
            } catch (IOException e) {
                e.printStackTrace();
            }
        }
    }
}
```

## çº¿ç¨‹ç”Ÿå‘½å‘¨æœŸ

![](https://raw.githubusercontent.com/dunwu/images/master/snap/202408290809602.png)

`java.lang.Thread.State` ä¸­å®šä¹‰äº† **6** ç§ä¸åŒçš„çº¿ç¨‹çŠ¶æ€ï¼Œåœ¨ç»™å®šçš„ä¸€ä¸ªæ—¶åˆ»ï¼Œçº¿ç¨‹åªèƒ½å¤„äºå…¶ä¸­çš„ä¸€ä¸ªçŠ¶æ€ã€‚

ä»¥ä¸‹æ˜¯å„çŠ¶æ€çš„è¯´æ˜ï¼Œä»¥åŠçŠ¶æ€é—´çš„è”ç³»ï¼š

- **å¼€å§‹ï¼ˆNEWï¼‰** - å°šæœªè°ƒç”¨ `start` æ–¹æ³•çš„çº¿ç¨‹å¤„äºæ­¤çŠ¶æ€ã€‚æ­¤çŠ¶æ€æ„å‘³ç€ï¼š**åˆ›å»ºçš„çº¿ç¨‹å°šæœªå¯åŠ¨**ã€‚
- **å¯è¿è¡Œï¼ˆRUNNABLEï¼‰** - å·²ç»è°ƒç”¨äº† `start` æ–¹æ³•çš„çº¿ç¨‹å¤„äºæ­¤çŠ¶æ€ã€‚æ­¤çŠ¶æ€æ„å‘³ç€ï¼Œ**çº¿ç¨‹å·²ç»å‡†å¤‡å¥½äº†**ï¼Œä¸€æ—¦è¢«çº¿ç¨‹è°ƒåº¦å™¨åˆ†é…äº† CPU æ—¶é—´ç‰‡ï¼Œå°±å¯ä»¥è¿è¡Œçº¿ç¨‹ã€‚
  - åœ¨æ“ä½œç³»ç»Ÿå±‚é¢ï¼Œçº¿ç¨‹æœ‰ READY å’Œ RUNNING çŠ¶æ€ï¼›è€Œåœ¨ JVM å±‚é¢ï¼Œåªèƒ½çœ‹åˆ° RUNNABLE çŠ¶æ€ï¼Œæ‰€ä»¥ Java ç³»ç»Ÿä¸€èˆ¬å°†è¿™ä¸¤ä¸ªçŠ¶æ€ç»Ÿç§°ä¸º RUNNABLEï¼ˆè¿è¡Œä¸­ï¼‰ çŠ¶æ€ ã€‚
- **é˜»å¡ï¼ˆBLOCKEDï¼‰** - æ­¤çŠ¶æ€æ„å‘³ç€ï¼š**çº¿ç¨‹å¤„äºè¢«é˜»å¡çŠ¶æ€**ã€‚è¡¨ç¤ºçº¿ç¨‹åœ¨ç­‰å¾… `synchronized` çš„éšå¼é”ï¼ˆMonitor lockï¼‰ã€‚`synchronized` ä¿®é¥°çš„æ–¹æ³•ã€ä»£ç å—åŒä¸€æ—¶åˆ»åªå…è®¸ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œï¼Œå…¶ä»–çº¿ç¨‹åªèƒ½ç­‰å¾…ï¼Œå³å¤„äºé˜»å¡çŠ¶æ€ã€‚å½“å ç”¨ `synchronized` éšå¼é”çš„çº¿ç¨‹é‡Šæ”¾é”ï¼Œå¹¶ä¸”ç­‰å¾…çš„çº¿ç¨‹è·å¾— `synchronized` éšå¼é”æ—¶ï¼Œå°±åˆä¼šä» `BLOCKED` è½¬æ¢åˆ° `RUNNABLE` çŠ¶æ€ã€‚
- **ç­‰å¾…ï¼ˆWAITINGï¼‰** - æ­¤çŠ¶æ€æ„å‘³ç€ï¼š**çº¿ç¨‹æ— é™æœŸç­‰å¾…ï¼Œç›´åˆ°è¢«å…¶ä»–çº¿ç¨‹æ˜¾å¼åœ°å”¤é†’**ã€‚ é˜»å¡å’Œç­‰å¾…çš„åŒºåˆ«åœ¨äºï¼Œé˜»å¡æ˜¯è¢«åŠ¨çš„ï¼Œå®ƒæ˜¯åœ¨ç­‰å¾…è·å– `synchronized` çš„éšå¼é”ã€‚è€Œç­‰å¾…æ˜¯ä¸»åŠ¨çš„ï¼Œé€šè¿‡è°ƒç”¨ `Object.wait` ç­‰æ–¹æ³•è¿›å…¥ã€‚
  - è¿›å…¥ï¼š`Object.wait()`ï¼›é€€å‡ºï¼š`Object.notify` / `Object.notifyAll`
  - è¿›å…¥ï¼š`Thread.join()`ï¼›é€€å‡ºï¼šè¢«è°ƒç”¨çš„çº¿ç¨‹æ‰§è¡Œå®Œæ¯•
  - è¿›å…¥ï¼š`LockSupport.park()`ï¼›é€€å‡ºï¼š`LockSupport.unpark`
- **å®šæ—¶ç­‰å¾…ï¼ˆTIMED_WAITINGï¼‰** - ç­‰å¾…æŒ‡å®šæ—¶é—´çš„çŠ¶æ€ã€‚ä¸€ä¸ªçº¿ç¨‹å¤„äºå®šæ—¶ç­‰å¾…çŠ¶æ€ï¼Œæ˜¯ç”±äºæ‰§è¡Œäº†ä»¥ä¸‹æ–¹æ³•ä¸­çš„ä»»æ„æ–¹æ³•ï¼š
  - è¿›å…¥ï¼š`Thread.sleep(long)`ï¼›é€€å‡ºï¼šæ—¶é—´ç»“æŸ
  - è¿›å…¥ï¼š`Object.wait(long)`ï¼›é€€å‡ºï¼šæ—¶é—´ç»“æŸ / `Object.notify` / `Object.notifyAll`
  - è¿›å…¥ï¼š`Thread.join(long)`ï¼›é€€å‡ºï¼šæ—¶é—´ç»“æŸ / è¢«è°ƒç”¨çš„çº¿ç¨‹æ‰§è¡Œå®Œæ¯•
  - è¿›å…¥ï¼š`LockSupport.parkNanos(long)`ï¼›é€€å‡ºï¼š`LockSupport.unpark`
  - è¿›å…¥ï¼š`LockSupport.parkUntil(long)`ï¼›é€€å‡ºï¼š`LockSupport.unpark`
- **ç»ˆæ­¢ (TERMINATED)** - çº¿ç¨‹ `run()` æ–¹æ³•æ‰§è¡Œç»“æŸï¼Œæˆ–è€…å› å¼‚å¸¸é€€å‡ºäº† `run()` æ–¹æ³•ï¼Œåˆ™è¯¥çº¿ç¨‹ç»“æŸç”Ÿå‘½å‘¨æœŸã€‚æ­»äº¡çš„çº¿ç¨‹ä¸å¯å†æ¬¡å¤ç”Ÿã€‚

> ğŸ‘‰ æ‰©å±•é˜…è¯»ï¼š
>
> - [Java Thread Methods and Thread States](https://www.w3resource.com/java-tutorial/java-threadclass-methods-and-threadstates.php)
> - [Java çº¿ç¨‹çš„ 5 ç§çŠ¶æ€åŠåˆ‡æ¢ï¼ˆé€å½»è®²è§£ï¼‰](https://blog.csdn.net/pange1991/article/details/53860651)
> - [Java çº¿ç¨‹è¿è¡Œæ€ä¹ˆæœ‰ç¬¬å…­ç§çŠ¶æ€ï¼Ÿ - Dawell çš„å›ç­”](https://www.zhihu.com/question/56494969/answer/154053599)

## çº¿ç¨‹å¸¸è§é—®é¢˜

### çº¿ç¨‹å¯åŠ¨

**å…¸å‹é—®é¢˜**

ï¼ˆ1ï¼‰`Thread.start()` å’Œ `Thread.run()` æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ

ï¼ˆ2ï¼‰å¯ä»¥ç›´æ¥è°ƒç”¨ `Thread.run()` æ–¹æ³•ä¹ˆï¼Ÿ

ï¼ˆ3ï¼‰ä¸€ä¸ªçº¿ç¨‹ä¸¤æ¬¡è°ƒç”¨ `Thread.start()` æ–¹æ³•ä¼šæ€æ ·

**çŸ¥è¯†ç‚¹**

ï¼ˆ1ï¼‰`Thread.start()` å’Œ `Thread.run()` çš„åŒºåˆ«ï¼š

- `run()` æ–¹æ³•æ˜¯çº¿ç¨‹çš„æ‰§è¡Œä½“ã€‚
- `start()` æ–¹æ³•è´Ÿè´£å¯åŠ¨çº¿ç¨‹ï¼Œç„¶å JVM ä¼šè®©è¿™ä¸ªçº¿ç¨‹å»æ‰§è¡Œ `run()` æ–¹æ³•ã€‚

ï¼ˆ2ï¼‰å¯ä»¥ç›´æ¥è°ƒç”¨ `Thread.run()` æ–¹æ³•ï¼Œä½†æ˜¯å®ƒçš„è¡Œä¸ºå’Œæ™®é€šæ–¹æ³•ä¸€æ ·ï¼Œä¸ä¼šå¯åŠ¨æ–°çº¿ç¨‹å»æ‰§è¡Œã€‚**è°ƒç”¨ `start()` æ–¹æ³•æ–¹å¯å¯åŠ¨çº¿ç¨‹å¹¶ä½¿çº¿ç¨‹è¿›å…¥å°±ç»ªçŠ¶æ€ï¼Œç›´æ¥æ‰§è¡Œ `run()` æ–¹æ³•çš„è¯ä¸ä¼šä»¥å¤šçº¿ç¨‹çš„æ–¹å¼æ‰§è¡Œã€‚**

ï¼ˆ3ï¼‰Java çš„çº¿ç¨‹æ˜¯ä¸å…è®¸å¯åŠ¨ä¸¤æ¬¡çš„ï¼Œç¬¬äºŒæ¬¡è°ƒç”¨å¿…ç„¶ä¼šæŠ›å‡º `IllegalThreadStateException`ã€‚

### çº¿ç¨‹ç­‰å¾…

**å…¸å‹é—®é¢˜**

ï¼ˆ1ï¼‰`Thread.sleep()`ã€`Thread.yield()`ã€`Thread.join()`ã€`Object.wait()` æ–¹æ³•æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ

ï¼ˆ2ï¼‰ä¸ºä»€ä¹ˆ `Thread.sleep()`ã€`Thread.yield()` è®¾è®¡ä¸ºé™æ€æ–¹æ³•ï¼Ÿ

**çŸ¥è¯†ç‚¹**

ï¼ˆ1ï¼‰`Thread.sleep()`ã€`Thread.yield()`ã€`Thread.join()` æ–¹æ³•çš„åŒºåˆ«ï¼š

- `Thread.sleep()`
  - `Thread.sleep()` æ–¹æ³•éœ€è¦æŒ‡å®šç­‰å¾…çš„æ—¶é—´ï¼Œå®ƒå¯ä»¥è®©å½“å‰æ­£åœ¨æ‰§è¡Œçš„çº¿ç¨‹åœ¨æŒ‡å®šçš„æ—¶é—´å†…æš‚åœæ‰§è¡Œï¼Œè¿›å…¥ **TIMED_WAITING** çŠ¶æ€ã€‚
  - è¯¥æ–¹æ³•æ—¢å¯ä»¥è®©å…¶ä»–åŒä¼˜å…ˆçº§æˆ–è€…é«˜ä¼˜å…ˆçº§çš„çº¿ç¨‹å¾—åˆ°æ‰§è¡Œçš„æœºä¼šï¼Œä¹Ÿå¯ä»¥è®©ä½ä¼˜å…ˆçº§çš„çº¿ç¨‹å¾—åˆ°æ‰§è¡Œæœºä¼šã€‚
  - ä½†æ˜¯ï¼Œ`Thread.sleep()` æ–¹æ³•ä¸ä¼šé‡Šæ”¾â€œé”æ ‡å¿—â€ï¼Œä¹Ÿå°±æ˜¯è¯´å¦‚æœæœ‰ `synchronized` åŒæ­¥å—ï¼Œå…¶ä»–çº¿ç¨‹ä»ç„¶ä¸èƒ½è®¿é—®å…±äº«æ•°æ®ã€‚
- `Thread.yield()`
  - `Thread.yield()` æ–¹æ³•å¯ä»¥è®©å½“å‰æ­£åœ¨æ‰§è¡Œçš„çº¿ç¨‹æš‚åœï¼Œä½†å®ƒä¸ä¼šé˜»å¡è¯¥çº¿ç¨‹ï¼Œå®ƒåªæ˜¯å°†è¯¥çº¿ç¨‹ä» **RUNNING** çŠ¶æ€è½¬å…¥ **RUNNABLE** çŠ¶æ€ã€‚
  - å½“æŸä¸ªçº¿ç¨‹è°ƒç”¨äº† `Thread.yield()` æ–¹æ³•æš‚åœä¹‹åï¼Œåªæœ‰ä¼˜å…ˆçº§å¤§äºç­‰äºå½“å‰çº¿ç¨‹çš„å¤„äºå°±ç»ªçŠ¶æ€çš„çº¿ç¨‹æ‰ä¼šè·å¾—æ‰§è¡Œçš„æœºä¼šã€‚
- `Thread.join()`
  - `Thread.join()` æ–¹æ³•ä¼šä½¿å½“å‰çº¿ç¨‹è½¬å…¥ **WAITING** æˆ– **TIMED_WAITING** çŠ¶æ€ï¼Œç­‰å¾…è°ƒç”¨ `Thread.join()` æ–¹æ³•çš„çº¿ç¨‹ç»“æŸåæ‰èƒ½ç»§ç»­æ‰§è¡Œã€‚
- `Object.wait()`
  - `Object.wait()` ç”¨äºä½¿å½“å‰çº¿ç¨‹ç­‰å¾…ï¼Œç›´åˆ°å…¶ä»–çº¿ç¨‹è°ƒç”¨ç›¸åŒå¯¹è±¡çš„ `Object.notify()` æˆ– `Object.notifyAll()` æ–¹æ³•å”¤é†’å®ƒã€‚
  - è°ƒç”¨ `Object.wait()` æ—¶ï¼Œçº¿ç¨‹ä¼šé‡Šæ”¾å¯¹è±¡é”ï¼Œå¹¶è¿›å…¥ç­‰å¾…çŠ¶æ€ã€‚

ï¼ˆ2ï¼‰ä¸ºä»€ä¹ˆ `Thread.sleep()`ã€`Thread.yield()` è®¾è®¡ä¸ºé™æ€æ–¹æ³•ï¼Ÿ

`Thread.sleep()`ã€`Thread.yield()` é’ˆå¯¹çš„æ˜¯ **RUNNING** çŠ¶æ€çš„çº¿ç¨‹ï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨é **RUNNING** çŠ¶æ€çš„çº¿ç¨‹ä¸Šæ‰§è¡Œè¿™ä¸¤ä¸ªæ–¹æ³•æ²¡æœ‰æ„ä¹‰ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆè¿™ä¸¤ä¸ªæ–¹æ³•è¢«è®¾è®¡ä¸ºé™æ€çš„ã€‚å®ƒä»¬åªé’ˆå¯¹æ­£åœ¨ **RUNNING** çŠ¶æ€çš„çº¿ç¨‹å·¥ä½œï¼Œé¿å…ç¨‹åºå‘˜é”™è¯¯çš„è®¤ä¸ºå¯ä»¥åœ¨å…¶ä»–é **RUNNING** çŠ¶æ€çº¿ç¨‹ä¸Šè°ƒç”¨ã€‚

> ğŸ‘‰ æ‰©å±•é˜…è¯»ï¼š[Java çº¿ç¨‹ä¸­ yield ä¸ join æ–¹æ³•çš„åŒºåˆ«](http://www.importnew.com/14958.html)
> ğŸ‘‰ æ‰©å±•é˜…è¯»ï¼š[sleep()ï¼Œwait()ï¼Œyield() å’Œ join() æ–¹æ³•çš„åŒºåˆ«](https://blog.csdn.net/xiangwanpeng/article/details/54972952)

### çº¿ç¨‹é€šä¿¡

çº¿ç¨‹é—´é€šä¿¡æ˜¯çº¿ç¨‹é—´å…±äº«èµ„æºçš„ä¸€ç§æ–¹å¼ã€‚`Object.wait()`, `Object.notify()` å’Œ `Object.notifyAll()` æ˜¯ç”¨äºçº¿ç¨‹ä¹‹é—´åä½œå’Œé€šä¿¡çš„æ–¹æ³•ï¼Œå®ƒä»¬é€šå¸¸ä¸`synchronized` å…³é”®å­—ä¸€èµ·ä½¿ç”¨æ¥å®ç°çº¿ç¨‹çš„åŒæ­¥ã€‚

**å…¸å‹é—®é¢˜**

ï¼ˆ1ï¼‰ä¸ºä»€ä¹ˆçº¿ç¨‹é€šä¿¡çš„æ–¹æ³• `Object.wait()`ã€`Object.notify()` å’Œ `Object.notifyAll()` è¢«å®šä¹‰åœ¨ `Object` ç±»é‡Œï¼Ÿ

ï¼ˆ2ï¼‰ä¸ºä»€ä¹ˆ `Object.wait()`ã€`Object.notify()` å’Œ `Object.notifyAll()` å¿…é¡»åœ¨ `synchronized` æ–¹æ³•/å—ä¸­è¢«è°ƒç”¨ï¼Ÿ

ï¼ˆ3ï¼‰ `Object.wait()` å’Œ `Thread.sleep` æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ

**çŸ¥è¯†ç‚¹**

ï¼ˆ1ï¼‰ä¸ºä»€ä¹ˆçº¿ç¨‹é€šä¿¡çš„æ–¹æ³• `Object.wait()`ã€`Object.notify()` å’Œ `Object.notifyAll()` è¢«å®šä¹‰åœ¨ `Object` ç±»é‡Œï¼Ÿ

Java çš„æ¯ä¸ªå¯¹è±¡ä¸­éƒ½æœ‰ä¸€ä¸ªç§°ä¹‹ä¸º monitor ç›‘è§†å™¨çš„é”ï¼Œç”±äºæ¯ä¸ªå¯¹è±¡éƒ½å¯ä»¥ä¸Šé”ï¼Œè¿™å°±è¦æ±‚åœ¨å¯¹è±¡å¤´ä¸­æœ‰ä¸€ä¸ªç”¨æ¥ä¿å­˜é”ä¿¡æ¯çš„ä½ç½®ã€‚è¿™ä¸ªé”æ˜¯å¯¹è±¡çº§åˆ«çš„ï¼Œè€Œéçº¿ç¨‹çº§åˆ«çš„ï¼Œwait/notify/notifyAll ä¹Ÿéƒ½æ˜¯é”çº§åˆ«çš„æ“ä½œï¼Œå®ƒä»¬çš„é”å±äºå¯¹è±¡ï¼Œæ‰€ä»¥æŠŠå®ƒä»¬å®šä¹‰åœ¨ Object ç±»ä¸­æ˜¯æœ€åˆé€‚ï¼Œå› ä¸º Object ç±»æ˜¯æ‰€æœ‰å¯¹è±¡çš„çˆ¶ç±»ã€‚

å¦‚æœæŠŠ wait/notify/notifyAll æ–¹æ³•å®šä¹‰åœ¨ Thread ç±»ä¸­ï¼Œä¼šå¸¦æ¥å¾ˆå¤§çš„å±€é™æ€§ï¼Œæ¯”å¦‚ä¸€ä¸ªçº¿ç¨‹å¯èƒ½æŒæœ‰å¤šæŠŠé”ï¼Œä»¥ä¾¿å®ç°ç›¸äº’é…åˆçš„å¤æ‚é€»è¾‘ï¼Œå‡è®¾æ­¤æ—¶ wait æ–¹æ³•å®šä¹‰åœ¨ Thread ç±»ä¸­ï¼Œå¦‚ä½•å®ç°è®©ä¸€ä¸ªçº¿ç¨‹æŒæœ‰å¤šæŠŠé”å‘¢ï¼Ÿåˆå¦‚ä½•æ˜ç¡®çº¿ç¨‹ç­‰å¾…çš„æ˜¯å“ªæŠŠé”å‘¢ï¼Ÿæ—¢ç„¶æˆ‘ä»¬æ˜¯è®©å½“å‰çº¿ç¨‹å»ç­‰å¾…æŸä¸ªå¯¹è±¡çš„é”ï¼Œè‡ªç„¶åº”è¯¥é€šè¿‡æ“ä½œå¯¹è±¡æ¥å®ç°ï¼Œè€Œä¸æ˜¯æ“ä½œçº¿ç¨‹ã€‚

- `Object.wait()`
  - `Object.wait()` æ–¹æ³•ç”¨äºä½¿å½“å‰çº¿ç¨‹è¿›å…¥ç­‰å¾…çŠ¶æ€ï¼Œç›´åˆ°å…¶ä»–çº¿ç¨‹è°ƒç”¨ç›¸åŒå¯¹è±¡çš„ `notify()` æˆ– `notifyAll()` æ–¹æ³•å”¤é†’å®ƒã€‚
  - åœ¨è°ƒç”¨ `wait()` æ–¹æ³•æ—¶ï¼Œçº¿ç¨‹ä¼šé‡Šæ”¾å¯¹è±¡çš„é”ï¼Œå¹¶è¿›å…¥ç­‰å¾…çŠ¶æ€ã€‚é€šå¸¸åœ¨ä½¿ç”¨ `wait()` æ–¹æ³•æ—¶éœ€è¦æ”¾åœ¨ä¸€ä¸ªå¾ªç¯ä¸­ï¼Œä»¥é¿å…è™šå‡å”¤é†’ï¼ˆspurious wakeupsï¼‰ã€‚
- `Object.notify()`
  - `Object.notify()` æ–¹æ³•ç”¨äºå”¤é†’æ­£åœ¨ç­‰å¾…è¯¥å¯¹è±¡çš„é”çš„ä¸€ä¸ªçº¿ç¨‹ã€‚
  - è¢«å”¤é†’çš„çº¿ç¨‹å°†ä¼šå°è¯•é‡æ–°è·å–å¯¹è±¡çš„é”ï¼Œä¸€æ—¦è·å–åˆ°é”ï¼Œå®ƒå°†ç»§ç»­æ‰§è¡Œã€‚
- `Object.notifyAll()`
  - `Object.notifyAll()` æ–¹æ³•ç”¨äºå”¤é†’æ­£åœ¨ç­‰å¾…è¯¥å¯¹è±¡çš„é”çš„æ‰€æœ‰çº¿ç¨‹ã€‚
  - æ‰€æœ‰è¢«å”¤é†’çš„çº¿ç¨‹å°†ä¼šç«äº‰å¯¹è±¡çš„é”ï¼Œä¸€æ—¦è·å–åˆ°é”ï¼Œå®ƒä»¬å°†ç»§ç»­æ‰§è¡Œã€‚

ï¼ˆ2ï¼‰ä¸ºä»€ä¹ˆ `Object.wait()`ã€`Object.notify()` å’Œ `Object.notifyAll()` å¿…é¡»åœ¨ `synchronized` æ–¹æ³•/å—ä¸­è¢«è°ƒç”¨ï¼Ÿ

å½“ä¸€ä¸ªçº¿ç¨‹éœ€è¦è°ƒç”¨å¯¹è±¡çš„ `wait()` æ–¹æ³•çš„æ—¶å€™ï¼Œè¿™ä¸ªçº¿ç¨‹å¿…é¡»æ‹¥æœ‰è¯¥å¯¹è±¡çš„é”ï¼Œæ¥ç€å®ƒå°±ä¼šé‡Šæ”¾è¿™ä¸ªå¯¹è±¡é”å¹¶è¿›å…¥ç­‰å¾…çŠ¶æ€ç›´åˆ°å…¶ä»–çº¿ç¨‹è°ƒç”¨è¿™ä¸ªå¯¹è±¡ä¸Šçš„ `notify()` æ–¹æ³•ã€‚åŒæ ·çš„ï¼Œå½“ä¸€ä¸ªçº¿ç¨‹éœ€è¦è°ƒç”¨å¯¹è±¡çš„ `notify()` æ–¹æ³•æ—¶ï¼Œå®ƒä¼šé‡Šæ”¾è¿™ä¸ªå¯¹è±¡çš„é”ï¼Œä»¥ä¾¿å…¶ä»–åœ¨ç­‰å¾…çš„çº¿ç¨‹å°±å¯ä»¥å¾—åˆ°è¿™ä¸ªå¯¹è±¡é”ã€‚

ç”±äºæ‰€æœ‰çš„è¿™äº›æ–¹æ³•éƒ½éœ€è¦çº¿ç¨‹æŒæœ‰å¯¹è±¡çš„é”ï¼Œè¿™æ ·å°±åªèƒ½é€šè¿‡ `synchronized` æ¥å®ç°ï¼Œæ‰€ä»¥ä»–ä»¬åªèƒ½åœ¨ `synchronized` æ–¹æ³•/å—ä¸­è¢«è°ƒç”¨ã€‚

ï¼ˆ3ï¼‰ `Object.wait()` å’Œ `Thread.sleep` æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ

ç›¸åŒç‚¹ï¼š

1. å®ƒä»¬éƒ½å¯ä»¥è®©çº¿ç¨‹é˜»å¡ã€‚
2. å®ƒä»¬éƒ½å¯ä»¥å“åº” interrupt ä¸­æ–­ï¼šåœ¨ç­‰å¾…çš„è¿‡ç¨‹ä¸­å¦‚æœæ”¶åˆ°ä¸­æ–­ä¿¡å·ï¼Œéƒ½å¯ä»¥è¿›è¡Œå“åº”ï¼Œå¹¶æŠ›å‡º InterruptedException å¼‚å¸¸ã€‚

ä¸åŒç‚¹ï¼š

1. wait æ–¹æ³•å¿…é¡»åœ¨ synchronized ä¿æŠ¤çš„ä»£ç ä¸­ä½¿ç”¨ï¼Œè€Œ sleep æ–¹æ³•å¹¶æ²¡æœ‰è¿™ä¸ªè¦æ±‚ã€‚
2. åœ¨åŒæ­¥ä»£ç ä¸­æ‰§è¡Œ sleep æ–¹æ³•æ—¶ï¼Œå¹¶ä¸ä¼šé‡Šæ”¾ monitor é”ï¼Œä½†æ‰§è¡Œ wait æ–¹æ³•æ—¶ä¼šä¸»åŠ¨é‡Šæ”¾ monitor é”ã€‚
3. sleep æ–¹æ³•ä¸­ä¼šè¦æ±‚å¿…é¡»å®šä¹‰ä¸€ä¸ªæ—¶é—´ï¼Œæ—¶é—´åˆ°æœŸåä¼šä¸»åŠ¨æ¢å¤ï¼Œè€Œå¯¹äºæ²¡æœ‰å‚æ•°çš„ wait æ–¹æ³•è€Œè¨€ï¼Œæ„å‘³ç€æ°¸ä¹…ç­‰å¾…ï¼Œç›´åˆ°è¢«ä¸­æ–­æˆ–è¢«å”¤é†’æ‰èƒ½æ¢å¤ï¼Œå®ƒå¹¶ä¸ä¼šä¸»åŠ¨æ¢å¤ã€‚
4. wait/notify æ˜¯ Object ç±»çš„æ–¹æ³•ï¼Œè€Œ sleep æ˜¯ Thread ç±»çš„æ–¹æ³•ã€‚

> ğŸ‘‰ æ‰©å±•é˜…è¯»ï¼š[Java å¹¶å‘ç¼–ç¨‹ï¼šçº¿ç¨‹é—´åä½œçš„ä¸¤ç§æ–¹å¼ï¼šwaitã€notifyã€notifyAll å’Œ Condition](http://www.cnblogs.com/dolphin0520/p/3920385.html)

### çº¿ç¨‹ä¼˜å…ˆçº§

**å…¸å‹é—®é¢˜**

ï¼ˆ1ï¼‰Java çš„çº¿ç¨‹ä¼˜å…ˆçº§å¦‚ä½•æ§åˆ¶ï¼Ÿ

ï¼ˆ2ï¼‰é«˜ä¼˜å…ˆçº§çš„ Java çº¿ç¨‹ä¸€å®šå…ˆæ‰§è¡Œå—ï¼Ÿ

**çŸ¥è¯†ç‚¹**

ï¼ˆ1ï¼‰Java ä¸­çš„çº¿ç¨‹ä¼˜å…ˆçº§çš„èŒƒå›´æ˜¯ `[1,10]`ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œé«˜ä¼˜å…ˆçº§çš„çº¿ç¨‹åœ¨è¿è¡Œæ—¶ä¼šå…·æœ‰ä¼˜å…ˆæƒã€‚å¯ä»¥é€šè¿‡ `thread.setPriority(Thread.MAX_PRIORITY)` çš„æ–¹å¼è®¾ç½®ï¼Œé»˜è®¤ä¼˜å…ˆçº§ä¸º `5`ã€‚

ï¼ˆ2ï¼‰å³ä½¿è®¾ç½®äº†çº¿ç¨‹çš„ä¼˜å…ˆçº§ï¼Œä¹Ÿ**æ— æ³•ä¿è¯é«˜ä¼˜å…ˆçº§çš„çº¿ç¨‹ä¸€å®šå…ˆæ‰§è¡Œ**ã€‚

è¿™æ˜¯å› ä¸º **Java çº¿ç¨‹ä¼˜å…ˆçº§ä¾èµ–äºæ“ä½œç³»ç»Ÿçš„æ”¯æŒ**ï¼Œç„¶è€Œï¼Œä¸åŒçš„æ“ä½œç³»ç»Ÿæ”¯æŒçš„çº¿ç¨‹ä¼˜å…ˆçº§å¹¶ä¸ç›¸åŒï¼Œä¸èƒ½å¾ˆå¥½çš„å’Œ Java ä¸­çº¿ç¨‹ä¼˜å…ˆçº§ä¸€ä¸€å¯¹åº”ã€‚å› æ­¤ï¼ŒJava çº¿ç¨‹ä¼˜å…ˆçº§æ§åˆ¶å¹¶ä¸å¯é ã€‚

### å®ˆæŠ¤çº¿ç¨‹

**å…¸å‹é—®é¢˜**

ï¼ˆ1ï¼‰ä»€ä¹ˆæ˜¯å®ˆæŠ¤çº¿ç¨‹ï¼Ÿ

ï¼ˆ2ï¼‰å¦‚ä½•åˆ›å»ºå®ˆæŠ¤çº¿ç¨‹ï¼Ÿ

**çŸ¥è¯†ç‚¹**

ï¼ˆ1ï¼‰ä»€ä¹ˆæ˜¯å®ˆæŠ¤çº¿ç¨‹ï¼Ÿ

å®ˆæŠ¤çº¿ç¨‹ï¼ˆDaemon Threadï¼‰æ˜¯åœ¨åå°æ‰§è¡Œå¹¶ä¸”ä¸ä¼šé˜»æ­¢ JVM ç»ˆæ­¢çš„çº¿ç¨‹ã€‚ä¸å®ˆæŠ¤çº¿ç¨‹ï¼ˆDaemon Threadï¼‰ç›¸åçš„ï¼Œå«ç”¨æˆ·çº¿ç¨‹ï¼ˆUser Threadï¼‰ï¼Œä¹Ÿå°±æ˜¯éå®ˆæŠ¤çº¿ç¨‹ã€‚

å®ˆæŠ¤çº¿ç¨‹çš„ä¼˜å…ˆçº§æ¯”è¾ƒä½ï¼Œä¸€èˆ¬ç”¨äºä¸ºç³»ç»Ÿä¸­çš„å…¶å®ƒå¯¹è±¡å’Œçº¿ç¨‹æä¾›æœåŠ¡ã€‚å…¸å‹çš„åº”ç”¨å°±æ˜¯åƒåœ¾å›æ”¶å™¨ã€‚

ï¼ˆ2ï¼‰åˆ›å»ºå®ˆæŠ¤çº¿ç¨‹çš„æ–¹å¼ï¼š

- ä½¿ç”¨ `thread.setDaemon(true)` å¯ä»¥è®¾ç½® thread çº¿ç¨‹ä¸ºå®ˆæŠ¤çº¿ç¨‹ã€‚
- æ­£åœ¨è¿è¡Œçš„ç”¨æˆ·çº¿ç¨‹æ— æ³•è®¾ç½®ä¸ºå®ˆæŠ¤çº¿ç¨‹ï¼Œæ‰€ä»¥ `thread.setDaemon(true)` å¿…é¡»åœ¨ `thread.start()` ä¹‹å‰è®¾ç½®ï¼Œå¦åˆ™ä¼šæŠ›å‡º `llegalThreadStateException` å¼‚å¸¸ï¼›
- ä¸€ä¸ªå®ˆæŠ¤çº¿ç¨‹åˆ›å»ºçš„å­çº¿ç¨‹ä¾ç„¶æ˜¯å®ˆæŠ¤çº¿ç¨‹ã€‚
- ä¸è¦è®¤ä¸ºæ‰€æœ‰çš„åº”ç”¨éƒ½å¯ä»¥åˆ†é…ç»™å®ˆæŠ¤çº¿ç¨‹æ¥è¿›è¡ŒæœåŠ¡ï¼Œæ¯”å¦‚è¯»å†™æ“ä½œæˆ–è€…è®¡ç®—é€»è¾‘ã€‚

> ğŸ‘‰ æ‰©å±•é˜…è¯»ï¼š[Java ä¸­å®ˆæŠ¤çº¿ç¨‹çš„æ€»ç»“](https://blog.csdn.net/shimiso/article/details/8964414)

### çº¿ç¨‹æ•°

**å…¸å‹é—®é¢˜**

ï¼ˆ1ï¼‰çº¿ç¨‹æ•°æ˜¯ä¸æ˜¯è¶Šå¤šè¶Šå¥½ï¼Ÿ

ï¼ˆ2ï¼‰åˆ›å»ºå¤šå°‘çº¿ç¨‹æ‰åˆé€‚ï¼Ÿ

**çŸ¥è¯†ç‚¹**

ä½¿ç”¨å¤šçº¿ç¨‹ï¼Œåˆè¡·æ˜¯ä¸ºäº†æå‡ç¨‹åºæ€§èƒ½ã€‚åº¦é‡æ€§èƒ½çš„æ ¸å¿ƒæŒ‡æ ‡æ˜¯**å»¶è¿Ÿ**å’Œ**ååé‡**ã€‚æ‰€è°“æå‡æ€§èƒ½ï¼Œä»åº¦é‡çš„è§’åº¦ï¼Œä¸»è¦æ˜¯**é™ä½å»¶è¿Ÿï¼Œæé«˜ååé‡**ã€‚åœ¨å¹¶å‘ç¼–ç¨‹é¢†åŸŸï¼Œæå‡æ€§èƒ½æœ¬è´¨ä¸Šå°±æ˜¯æå‡ç¡¬ä»¶çš„åˆ©ç”¨ç‡ï¼Œå†å…·ä½“ç‚¹æ¥è¯´ï¼Œå°±æ˜¯æå‡ I/O çš„åˆ©ç”¨ç‡å’Œ CPU çš„åˆ©ç”¨ç‡ã€‚

å¤šçº¿ç¨‹å¹¶éè¶Šå¤šè¶Šå¥½ï¼Œè¿‡å¤šçš„çº¿ç¨‹å¯èƒ½ä¼šå¯¼è‡´è¿‡å¤šçš„ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œåè€Œé™ä½ç³»ç»Ÿæ€§èƒ½ã€‚ é€šå¸¸éœ€è¦æ ¹æ®æœåŠ¡å™¨ç¡¬ä»¶èµ„æºå’Œé¢„æœŸè´Ÿè½½æ¥åˆç†è®¾å®šçº¿ç¨‹æ•°å¤§å°ã€‚

ç¨‹åºä¸€èˆ¬éƒ½æ˜¯ CPU è®¡ç®—å’Œ I/O æ“ä½œäº¤å‰æ‰§è¡Œçš„ï¼Œç”±äº I/O è®¾å¤‡çš„é€Ÿåº¦ç›¸å¯¹äº CPU æ¥è¯´éƒ½å¾ˆæ…¢ï¼Œæ‰€ä»¥å¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼ŒI/O æ“ä½œæ‰§è¡Œçš„æ—¶é—´ç›¸å¯¹äº CPU è®¡ç®—æ¥è¯´éƒ½éå¸¸é•¿ï¼Œè¿™ç§åœºæ™¯æˆ‘ä»¬ä¸€èˆ¬éƒ½ç§°ä¸º I/O å¯†é›†å‹è®¡ç®—ï¼›å’Œ I/O å¯†é›†å‹è®¡ç®—ç›¸å¯¹çš„å°±æ˜¯ CPU å¯†é›†å‹è®¡ç®—äº†ï¼ŒCPU å¯†é›†å‹è®¡ç®—å¤§éƒ¨åˆ†åœºæ™¯ä¸‹éƒ½æ˜¯çº¯ CPU è®¡ç®—ã€‚I/O å¯†é›†å‹ç¨‹åºå’Œ CPU å¯†é›†å‹ç¨‹åºï¼Œè®¡ç®—æœ€ä½³çº¿ç¨‹æ•°çš„æ–¹æ³•æ˜¯ä¸åŒçš„ã€‚

**å¯¹äº CPU å¯†é›†å‹çš„è®¡ç®—åœºæ™¯ï¼Œç†è®ºä¸Šâ€œçº¿ç¨‹çš„æ•°é‡=CPU æ ¸æ•°â€å°±æ˜¯æœ€åˆé€‚çš„**ã€‚ä¸è¿‡åœ¨å·¥ç¨‹ä¸Šï¼Œ**çº¿ç¨‹çš„æ•°é‡ä¸€èˆ¬ä¼šè®¾ç½®ä¸ºâ€œCPU æ ¸æ•°+1â€**ï¼Œè¿™æ ·çš„è¯ï¼Œå½“çº¿ç¨‹å› ä¸ºå¶å°”çš„å†…å­˜é¡µå¤±æ•ˆæˆ–å…¶ä»–åŸå› å¯¼è‡´é˜»å¡æ—¶ï¼Œè¿™ä¸ªé¢å¤–çš„çº¿ç¨‹å¯ä»¥é¡¶ä¸Šï¼Œä»è€Œä¿è¯ CPU çš„åˆ©ç”¨ç‡ã€‚

å¯¹äº I/O å¯†é›†å‹è®¡ç®—åœºæ™¯ï¼Œæœ€ä½³çš„çº¿ç¨‹æ•°æ˜¯ä¸ç¨‹åºä¸­ CPU è®¡ç®—å’Œ I/O æ“ä½œçš„è€—æ—¶æ¯”ç›¸å…³çš„ï¼Œæˆ‘ä»¬å¯ä»¥æ€»ç»“å‡ºè¿™æ ·ä¸€ä¸ªå…¬å¼ï¼š

> æœ€ä½³çº¿ç¨‹æ•°=1 +ï¼ˆI/O è€—æ—¶ / CPU è€—æ—¶ï¼‰

## å‚è€ƒèµ„æ–™

- [ã€ŠJava å¹¶å‘ç¼–ç¨‹å®æˆ˜ã€‹](https://book.douban.com/subject/10484692/)
- [ã€ŠJava å¹¶å‘ç¼–ç¨‹çš„è‰ºæœ¯ã€‹](https://book.douban.com/subject/26591326/)
- [è¿›ç¨‹å’Œçº¿ç¨‹å…³ç³»åŠåŒºåˆ«](https://blog.csdn.net/yaosiming2011/article/details/44280797)
- [Java çº¿ç¨‹ä¸­ yield ä¸ join æ–¹æ³•çš„åŒºåˆ«](http://www.importnew.com/14958.html)
- [sleep()ï¼Œwait()ï¼Œyield() å’Œ join() æ–¹æ³•çš„åŒºåˆ«](https://blog.csdn.net/xiangwanpeng/article/details/54972952)
- [Java å¹¶å‘ç¼–ç¨‹ï¼šçº¿ç¨‹é—´åä½œçš„ä¸¤ç§æ–¹å¼ï¼šwaitã€notifyã€notifyAll å’Œ Condition](https://www.cnblogs.com/dolphin0520/p/3920385.html)
- [Java å¹¶å‘ç¼–ç¨‹ï¼šCallableã€Future å’Œ FutureTask](https://www.cnblogs.com/dolphin0520/p/3949310.html)
- [StackOverflow VisualVM - Thread States](https://stackoverflow.com/questions/27406200/visualvm-thread-states)
- [Java ä¸­å®ˆæŠ¤çº¿ç¨‹çš„æ€»ç»“](https://blog.csdn.net/shimiso/article/details/8964414)
- [Java å¹¶å‘](https://github.com/CyC2018/CS-Notes/blob/master/notes/Java%20%E5%B9%B6%E5%8F%91.md)
- [Why must wait() always be in synchronized block](https://stackoverflow.com/questions/2779484/why-must-wait-always-be-in-synchronized-block)
- [Java Thread Methods and Thread States](https://www.w3resource.com/java-tutorial/java-threadclass-methods-and-threadstates.php)
- [Java çº¿ç¨‹çš„ 5 ç§çŠ¶æ€åŠåˆ‡æ¢ï¼ˆé€å½»è®²è§£ï¼‰](https://blog.csdn.net/pange1991/article/details/53860651)
- [Java çº¿ç¨‹è¿è¡Œæ€ä¹ˆæœ‰ç¬¬å…­ç§çŠ¶æ€ï¼Ÿ - Dawell çš„å›ç­”](https://www.zhihu.com/question/56494969/answer/154053599)