<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/blog/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/blog/uploads/favicon.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/blog/uploads/favicon.ico">
  <link rel="mask-icon" href="/blog/images/logo.svg" color="#222">

<link rel="stylesheet" href="/blog/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.0.0/css/all.min.css" integrity="sha256-VHqXKFhhMxcpubYf9xiWdCiojEbY9NexQ4jh8AxbvcM=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/themes/blue/pace-theme-minimal.css">
  <script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous" defer></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"dunwu.github.io","root":"/blog/","images":"/blog/images","scheme":"Pisces","darkmode":true,"version":"8.25.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"codeblock":{"theme":{"light":"atom-one-light","dark":"atom-one-dark"},"prism":{"light":"atom-one-light","dark":"atom-one-dark"},"copy_button":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"language":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"gitalk","storage":true,"lazyload":true,"nav":null,"activeClass":"gitalk"},"stickytabs":false,"motion":{"enable":true,"async":false,"duration":200,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"æœç´¢...","empty":"æ²¡æœ‰æ‰¾åˆ°ä»»ä½•æœç´¢ç»“æœï¼š${query}","hits_time":"æ‰¾åˆ° ${hits} ä¸ªæœç´¢ç»“æœï¼ˆç”¨æ—¶ ${time} æ¯«ç§’ï¼‰","hits":"æ‰¾åˆ° ${hits} ä¸ªæœç´¢ç»“æœ"},"path":"/blog/search.xml","localsearch":{"enable":true,"top_n_per_article":1,"unescape":false,"preload":false,"trigger":"auto"}}</script><script src="/blog/js/config.js" defer></script>

    <meta name="description" content="é’æ‚Ÿçš„ä¸ªäººåšå®¢">
<meta property="og:type" content="website">
<meta property="og:title" content="Dunwu Blog">
<meta property="og:url" content="https://dunwu.github.io/blog/page/37/index.html">
<meta property="og:site_name" content="Dunwu Blog">
<meta property="og:description" content="é’æ‚Ÿçš„ä¸ªäººåšå®¢">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="é’æ‚Ÿ â—¾ Dunwu">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://dunwu.github.io/blog/page/37/">


<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"zh-CN","comments":"","permalink":"","path":"page/37/index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Dunwu Blog</title>
  








  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous" defer></script>
<script src="/blog/js/utils.js" defer></script><script src="/blog/js/motion.js" defer></script><script src="/blog/js/sidebar.js" defer></script><script src="/blog/js/next-boot.js" defer></script>

  <script src="https://cdn.jsdelivr.net/npm/hexo-generator-searchdb@1.5.0/dist/search.js" integrity="sha256-xFC6PJ82SL9b3WkGjFavNiA9gm5z6UBxWPiu4CYjptg=" crossorigin="anonymous" defer></script>
<script src="/blog/js/third-party/search/local-search.js" defer></script>





  <script src="/blog/js/third-party/pace.js" defer></script>


  





  <noscript>
    <link rel="stylesheet" href="/blog/css/noscript.css">
  </noscript>
<style>.darkmode--activated{--body-bg-color:#282828;--content-bg-color:#333;--card-bg-color:#555;--text-color:#ccc;--blockquote-color:#bbb;--link-color:#ccc;--link-hover-color:#eee;--brand-color:#ddd;--brand-hover-color:#ddd;--table-row-odd-bg-color:#282828;--table-row-hover-bg-color:#363636;--menu-item-bg-color:#555;--btn-default-bg:#222;--btn-default-color:#ccc;--btn-default-border-color:#555;--btn-default-hover-bg:#666;--btn-default-hover-color:#ccc;--btn-default-hover-border-color:#666;--highlight-background:#282b2e;--highlight-foreground:#a9b7c6;--highlight-gutter-background:#34393d;--highlight-gutter-foreground:#9ca9b6}.darkmode--activated img{opacity:.75}.darkmode--activated img:hover{opacity:.9}.darkmode--activated code{color:#69dbdc;background:0 0}button.darkmode-toggle{z-index:9999}.darkmode-ignore,img{display:flex!important}.beian img{display:inline-block!important}</style></head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ " role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/blog/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">Dunwu Blog</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">å¤§é“è‡³ç®€ï¼ŒçŸ¥æ˜“è¡Œéš¾</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="æœç´¢" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/blog/" rel="section"><i class="fa fa-home fa-fw"></i>é¦–é¡µ</a></li><li class="menu-item menu-item-about"><a href="/blog/about/" rel="section"><i class="fa fa-user fa-fw"></i>å…³äº</a></li><li class="menu-item menu-item-tags"><a href="/blog/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>æ ‡ç­¾<span class="badge">428</span></a></li><li class="menu-item menu-item-categories"><a href="/blog/categories/" rel="section"><i class="fa fa-th fa-fw"></i>åˆ†ç±»<span class="badge">124</span></a></li><li class="menu-item menu-item-archives"><a href="/blog/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>å½’æ¡£<span class="badge">508</span></a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>æœç´¢
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
      <div class="search-header">
        <span class="search-icon">
          <i class="fa fa-search"></i>
        </span>
        <div class="search-input-container">
          <input autocomplete="off" autocapitalize="off" maxlength="80"
                placeholder="æœç´¢..." spellcheck="false"
                type="search" class="search-input">
        </div>
        <span class="popup-btn-close" role="button">
          <i class="fa fa-times-circle"></i>
        </span>
      </div>
      <div class="search-result-container">
        <div class="search-result-icon">
          <i class="fa fa-spinner fa-pulse fa-5x"></i>
        </div>
      </div>
    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="é’æ‚Ÿ â—¾ Dunwu"
      src="/blog/uploads/avatar.gif">
  <p class="site-author-name" itemprop="name">é’æ‚Ÿ â—¾ Dunwu</p>
  <div class="site-description" itemprop="description">é’æ‚Ÿçš„ä¸ªäººåšå®¢</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/blog/archives/">
          <span class="site-state-item-count">508</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/blog/categories/">
        <span class="site-state-item-count">124</span>
        <span class="site-state-item-name">åˆ†ç±»</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/blog/tags/">
        <span class="site-state-item-count">428</span>
        <span class="site-state-item-name">æ ‡ç­¾</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/dunwu" title="GitHub â†’ https:&#x2F;&#x2F;github.com&#x2F;dunwu" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:forbreak@163.com" title="E-Mail â†’ mailto:forbreak@163.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>
  <div class="cc-license animated" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" class="cc-opacity" rel="noopener" target="_blank"><img src="https://cdn.jsdelivr.net/npm/@creativecommons/vocabulary@2020.11.3/assets/license_badges/small/by_nc_sa.svg" alt="Creative Commons"></a>
  </div>

        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="è¿”å›é¡¶éƒ¨">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://dunwu.github.io/blog/pages/cec05f27/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/blog/uploads/avatar.gif">
      <meta itemprop="name" content="é’æ‚Ÿ â—¾ Dunwu">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Dunwu Blog">
      <meta itemprop="description" content="é’æ‚Ÿçš„ä¸ªäººåšå®¢">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content=" | Dunwu Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/blog/pages/cec05f27/" class="post-title-link" itemprop="url">Java å¹¶å‘ä¹‹çº¿ç¨‹</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">å‘è¡¨äº</span>

      <time title="åˆ›å»ºæ—¶é—´ï¼š2019-12-24 23:52:25" itemprop="dateCreated datePublished" datetime="2019-12-24T23:52:25+08:00">2019-12-24</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">æ›´æ–°äº</span>
      <time title="ä¿®æ”¹æ—¶é—´ï¼š2025-09-13 17:56:53" itemprop="dateModified" datetime="2025-09-13T17:56:53+08:00">2025-09-13</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">åˆ†ç±»äº</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/blog/categories/Java/" itemprop="url" rel="index"><span itemprop="name">Java</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/blog/categories/Java/JavaCore/" itemprop="url" rel="index"><span itemprop="name">JavaCore</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/blog/categories/Java/JavaCore/%E5%B9%B6%E5%8F%91/" itemprop="url" rel="index"><span itemprop="name">å¹¶å‘</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
      <span>21k</span>
    </span>
    <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
      <span>19 åˆ†é’Ÿ</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="Java-å¹¶å‘ä¹‹çº¿ç¨‹"><a href="#Java-å¹¶å‘ä¹‹çº¿ç¨‹" class="headerlink" title="Java å¹¶å‘ä¹‹çº¿ç¨‹"></a>Java å¹¶å‘ä¹‹çº¿ç¨‹</h1><h2 id="çº¿ç¨‹ç®€ä»‹"><a href="#çº¿ç¨‹ç®€ä»‹" class="headerlink" title="çº¿ç¨‹ç®€ä»‹"></a>çº¿ç¨‹ç®€ä»‹</h2><ul>
<li><strong>è¿›ç¨‹ï¼ˆProcessï¼‰</strong> - è¿›ç¨‹æ˜¯å…·æœ‰ä¸€å®šç‹¬ç«‹åŠŸèƒ½çš„ç¨‹åºå…³äºæŸä¸ªæ•°æ®é›†åˆä¸Šçš„ä¸€æ¬¡è¿è¡Œæ´»åŠ¨ã€‚è¿›ç¨‹æ˜¯æ“ä½œç³»ç»Ÿè¿›è¡Œèµ„æºåˆ†é…çš„åŸºæœ¬å•ä½ã€‚<strong>è¿›ç¨‹å¯è§†ä¸ºä¸€ä¸ªæ­£åœ¨è¿è¡Œçš„ç¨‹åº</strong>ã€‚</li>
<li><strong>çº¿ç¨‹ï¼ˆThreadï¼‰</strong> - <strong>çº¿ç¨‹æ˜¯æ“ä½œç³»ç»Ÿè¿›è¡Œè°ƒåº¦çš„åŸºæœ¬å•ä½</strong>ã€‚</li>
<li><strong>ç®¡ç¨‹ï¼ˆMonitorï¼‰</strong> - <strong>ç®¡ç¨‹æ˜¯æŒ‡ç®¡ç†å…±äº«å˜é‡ä»¥åŠå¯¹å…±äº«å˜é‡çš„æ“ä½œè¿‡ç¨‹ï¼Œè®©ä»–ä»¬æ”¯æŒå¹¶å‘</strong>ã€‚<ul>
<li>Java é€šè¿‡ synchronized å…³é”®å­—åŠ wait()ã€notify()ã€notifyAll() è¿™ä¸‰ä¸ªæ–¹æ³•æ¥å®ç°ç®¡ç¨‹æŠ€æœ¯ã€‚</li>
<li><strong>ç®¡ç¨‹å’Œä¿¡å·é‡æ˜¯ç­‰ä»·çš„ï¼Œæ‰€è°“ç­‰ä»·æŒ‡çš„æ˜¯ç”¨ç®¡ç¨‹èƒ½å¤Ÿå®ç°ä¿¡å·é‡ï¼Œä¹Ÿèƒ½ç”¨ä¿¡å·é‡å®ç°ç®¡ç¨‹</strong>ã€‚</li>
</ul>
</li>
<li><strong>åç¨‹ï¼ˆCoroutineï¼‰</strong> - <strong>åç¨‹å¯ä»¥ç†è§£ä¸ºä¸€ç§è½»é‡çº§çš„çº¿ç¨‹</strong>ã€‚<ul>
<li>ä»æ“ä½œç³»ç»Ÿçš„è§’åº¦æ¥çœ‹ï¼Œçº¿ç¨‹æ˜¯åœ¨å†…æ ¸æ€ä¸­è°ƒåº¦çš„ï¼Œè€Œåç¨‹æ˜¯åœ¨ç”¨æˆ·æ€è°ƒåº¦çš„ï¼Œæ‰€ä»¥ç›¸å¯¹äºçº¿ç¨‹æ¥è¯´ï¼Œåç¨‹åˆ‡æ¢çš„æˆæœ¬æ›´ä½ã€‚</li>
<li>åç¨‹è™½ç„¶ä¹Ÿæœ‰è‡ªå·±çš„æ ˆï¼Œä½†æ˜¯ç›¸æ¯”çº¿ç¨‹æ ˆè¦å°å¾—å¤šï¼Œå…¸å‹çš„çº¿ç¨‹æ ˆå¤§å°å·®ä¸å¤šæœ‰ 1Mï¼Œè€Œåç¨‹æ ˆçš„å¤§å°å¾€å¾€åªæœ‰å‡  K æˆ–è€…å‡ å Kã€‚æ‰€ä»¥ï¼Œæ— è®ºæ˜¯ä»æ—¶é—´ç»´åº¦è¿˜æ˜¯ç©ºé—´ç»´åº¦æ¥çœ‹ï¼Œåç¨‹éƒ½æ¯”çº¿ç¨‹è½»é‡å¾—å¤šã€‚</li>
<li>Goã€Pythonã€Luaã€Kotlin ç­‰è¯­è¨€éƒ½æ”¯æŒåç¨‹ï¼›Java OpenSDK ä¸­çš„ Loom é¡¹ç›®ç›®æ ‡å°±æ˜¯æ”¯æŒåç¨‹ã€‚</li>
</ul>
</li>
</ul>
<p>è¿›ç¨‹å’Œçº¿ç¨‹çš„å·®å¼‚ï¼š</p>
<ul>
<li>ä¸€ä¸ªç¨‹åºè‡³å°‘æœ‰ä¸€ä¸ªè¿›ç¨‹ï¼Œä¸€ä¸ªè¿›ç¨‹è‡³å°‘æœ‰ä¸€ä¸ªçº¿ç¨‹ã€‚</li>
<li>çº¿ç¨‹æ¯”è¿›ç¨‹åˆ’åˆ†æ›´ç»†ï¼Œæ‰€ä»¥æ‰§è¡Œå¼€é”€æ›´å°ï¼Œå¹¶å‘æ€§æ›´é«˜</li>
<li>è¿›ç¨‹æ˜¯ä¸€ä¸ªå®ä½“ï¼Œæ‹¥æœ‰ç‹¬ç«‹çš„èµ„æºï¼›è€ŒåŒä¸€ä¸ªè¿›ç¨‹ä¸­çš„å¤šä¸ªçº¿ç¨‹å…±äº«è¿›ç¨‹çš„èµ„æºã€‚</li>
</ul>
<p><img src="https://raw.githubusercontent.com/dunwu/images/master/cs/java/javacore/concurrent/processes-vs-threads.jpg" alt="img"></p>
<p>JVM åœ¨å•ä¸ªè¿›ç¨‹ä¸­è¿è¡Œï¼ŒJVM ä¸­çš„çº¿ç¨‹å…±äº«å±äºè¯¥è¿›ç¨‹çš„å †ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆå‡ ä¸ªçº¿ç¨‹å¯ä»¥è®¿é—®åŒä¸€ä¸ªå¯¹è±¡ã€‚çº¿ç¨‹å…±äº«å †å¹¶æ‹¥æœ‰è‡ªå·±çš„å †æ ˆç©ºé—´ã€‚è¿™æ˜¯ä¸€ä¸ªçº¿ç¨‹å¦‚ä½•è°ƒç”¨ä¸€ä¸ªæ–¹æ³•ä»¥åŠå®ƒçš„å±€éƒ¨å˜é‡æ˜¯å¦‚ä½•ä¿æŒçº¿ç¨‹å®‰å…¨çš„ã€‚ä½†æ˜¯å †ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„å¹¶ä¸”ä¸ºäº†çº¿ç¨‹å®‰å…¨å¿…é¡»è¿›è¡ŒåŒæ­¥ã€‚</p>
<h2 id="çº¿ç¨‹åˆ›å»º"><a href="#çº¿ç¨‹åˆ›å»º" class="headerlink" title="çº¿ç¨‹åˆ›å»º"></a>çº¿ç¨‹åˆ›å»º</h2><p>ä¸€èˆ¬æ¥è¯´ï¼Œåˆ›å»ºçº¿ç¨‹æœ‰å¾ˆå¤šç§æ–¹å¼ï¼Œä¾‹å¦‚ï¼š</p>
<ul>
<li>å®ç° <code>Runnable</code> æ¥å£</li>
<li>å®ç° <code>Callable</code> æ¥å£</li>
<li>ç»§æ‰¿ <code>Thread</code> ç±»</li>
<li>é€šè¿‡çº¿ç¨‹æ± åˆ›å»ºçº¿ç¨‹</li>
<li>ä½¿ç”¨ <code>CompletableFuture</code> åˆ›å»ºçº¿ç¨‹</li>
<li>â€¦</li>
</ul>
<p>ä¸‹é¢æ˜¯å‡ ç§åˆ›å»ºçº¿ç¨‹çš„ç¤ºä¾‹ï¼š</p>
<p>::: tabs#åˆ›å»ºçº¿ç¨‹</p>
<p>@tab Thread</p>
<h3 id="Thread"><a href="#Thread" class="headerlink" title="Thread"></a>Thread</h3><p>ã€ç¤ºä¾‹ã€‘ç»§æ‰¿ <code>Thread</code> ç±»åˆ›å»ºçº¿ç¨‹</p>
<ol>
<li>å®šä¹‰ <code>Thread</code> ç±»çš„å­ç±»ï¼Œå¹¶è¦†å†™è¯¥ç±»çš„ <code>run</code> æ–¹æ³•ã€‚<code>run</code> æ–¹æ³•çš„æ–¹æ³•ä½“å°±ä»£è¡¨äº†çº¿ç¨‹è¦å®Œæˆçš„ä»»åŠ¡ï¼Œå› æ­¤æŠŠ <code>run</code> æ–¹æ³•ç§°ä¸ºæ‰§è¡Œä½“ã€‚</li>
<li>åˆ›å»º <code>Thread</code> å­ç±»çš„å®ä¾‹ï¼Œå³åˆ›å»ºäº†çº¿ç¨‹å¯¹è±¡ã€‚</li>
<li>è°ƒç”¨çº¿ç¨‹å¯¹è±¡çš„ <code>start</code> æ–¹æ³•æ¥å¯åŠ¨è¯¥çº¿ç¨‹ã€‚</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ThreadDemo</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">// å®ä¾‹åŒ–å¯¹è±¡</span></span><br><span class="line">        <span class="type">MyThread</span> <span class="variable">tA</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MyThread</span>(<span class="string">&quot;Thread çº¿ç¨‹-A&quot;</span>);</span><br><span class="line">        <span class="type">MyThread</span> <span class="variable">tB</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MyThread</span>(<span class="string">&quot;Thread çº¿ç¨‹-B&quot;</span>);</span><br><span class="line">        <span class="comment">// è°ƒç”¨çº¿ç¨‹ä¸»ä½“</span></span><br><span class="line">        tA.start();</span><br><span class="line">        tB.start();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">MyThread</span> <span class="keyword">extends</span> <span class="title class_">Thread</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> <span class="type">int</span> <span class="variable">ticket</span> <span class="operator">=</span> <span class="number">5</span>;</span><br><span class="line"></span><br><span class="line">        MyThread(String name) &#123;</span><br><span class="line">            <span class="built_in">super</span>(name);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">while</span> (ticket &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                System.out.println(Thread.currentThread().getName() + <span class="string">&quot; å–å‡ºäº†ç¬¬ &quot;</span> + ticket + <span class="string">&quot; å¼ ç¥¨&quot;</span>);</span><br><span class="line">                ticket--;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>@tab Runnable</p>
<h3 id="Runnable"><a href="#Runnable" class="headerlink" title="Runnable"></a>Runnable</h3><p><strong>å®ç° <code>Runnable</code> æ¥å£ä¼˜äºç»§æ‰¿ <code>Thread</code> ç±»</strong>ï¼Œå› ä¸ºï¼š</p>
<ul>
<li>Java ä¸æ”¯æŒå¤šé‡ç»§æ‰¿ï¼Œæ‰€æœ‰çš„ç±»éƒ½åªå…è®¸ç»§æ‰¿ä¸€ä¸ªçˆ¶ç±»ï¼Œä½†å¯ä»¥å®ç°å¤šä¸ªæ¥å£ã€‚å¦‚æœç»§æ‰¿äº† <code>Thread</code> ç±»å°±æ— æ³•ç»§æ‰¿å…¶å®ƒç±»ï¼Œè¿™ä¸åˆ©äºæ‰©å±•ã€‚</li>
<li>ç±»å¯èƒ½åªè¦æ±‚å¯æ‰§è¡Œå°±è¡Œï¼Œç»§æ‰¿æ•´ä¸ª <code>Thread</code> ç±»å¼€é”€è¿‡å¤§ã€‚</li>
</ul>
<p>ã€ç¤ºä¾‹ã€‘å®ç° <code>Runnable</code> æ¥å£åˆ›å»ºçº¿ç¨‹</p>
<ol>
<li>å®šä¹‰ <code>Runnable</code> æ¥å£çš„å®ç°ç±»ï¼Œå¹¶è¦†å†™è¯¥æ¥å£çš„ <code>run</code> æ–¹æ³•ã€‚è¯¥ <code>run</code> æ–¹æ³•çš„æ–¹æ³•ä½“åŒæ ·æ˜¯è¯¥çº¿ç¨‹çš„çº¿ç¨‹æ‰§è¡Œä½“ã€‚</li>
<li>åˆ›å»º <code>Runnable</code> å®ç°ç±»çš„å®ä¾‹ï¼Œå¹¶ä»¥æ­¤å®ä¾‹ä½œä¸º <code>Thread</code> çš„ target æ¥åˆ›å»º <code>Thread</code> å¯¹è±¡ï¼Œè¯¥ <code>Thread</code> å¯¹è±¡æ‰æ˜¯çœŸæ­£çš„çº¿ç¨‹å¯¹è±¡ã€‚</li>
<li>è°ƒç”¨çº¿ç¨‹å¯¹è±¡çš„ <code>start</code> æ–¹æ³•æ¥å¯åŠ¨è¯¥çº¿ç¨‹ã€‚</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RunnableDemo</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">// å®ä¾‹åŒ–å¯¹è±¡</span></span><br><span class="line">        <span class="type">Thread</span> <span class="variable">tA</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Thread</span>(<span class="keyword">new</span> <span class="title class_">MyThread</span>(), <span class="string">&quot;Runnable çº¿ç¨‹-A&quot;</span>);</span><br><span class="line">        <span class="type">Thread</span> <span class="variable">tB</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Thread</span>(<span class="keyword">new</span> <span class="title class_">MyThread</span>(), <span class="string">&quot;Runnable çº¿ç¨‹-B&quot;</span>);</span><br><span class="line">        <span class="comment">// è°ƒç”¨çº¿ç¨‹ä¸»ä½“</span></span><br><span class="line">        tA.start();</span><br><span class="line">        tB.start();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">MyThread</span> <span class="keyword">implements</span> <span class="title class_">Runnable</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> <span class="type">int</span> <span class="variable">ticket</span> <span class="operator">=</span> <span class="number">5</span>;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">while</span> (ticket &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                System.out.println(Thread.currentThread().getName() + <span class="string">&quot; å–å‡ºäº†ç¬¬ &quot;</span> + ticket + <span class="string">&quot; å¼ ç¥¨&quot;</span>);</span><br><span class="line">                ticket--;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>@tab Callable</p>
<h3 id="Callableã€Futureã€FutureTask"><a href="#Callableã€Futureã€FutureTask" class="headerlink" title="Callableã€Futureã€FutureTask"></a>Callableã€Futureã€FutureTask</h3><p><strong>ç»§æ‰¿ Thread ç±»å’Œå®ç° Runnable æ¥å£è¿™ä¸¤ç§åˆ›å»ºçº¿ç¨‹çš„æ–¹å¼éƒ½æ²¡æœ‰è¿”å›å€¼</strong>ã€‚æ‰€ä»¥ï¼Œçº¿ç¨‹æ‰§è¡Œå®Œåï¼Œæ— æ³•å¾—åˆ°æ‰§è¡Œç»“æœã€‚ä½†å¦‚æœæœŸæœ›å¾—åˆ°æ‰§è¡Œç»“æœè¯¥æ€ä¹ˆåšï¼Ÿ</p>
<p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒJava 1.5 åï¼Œæä¾›äº† <code>Callable</code> æ¥å£å’Œ <code>Future</code> æ¥å£ï¼Œé€šè¿‡å®ƒä»¬ï¼Œå¯ä»¥åœ¨çº¿ç¨‹æ‰§è¡Œç»“æŸåï¼Œè¿”å›æ‰§è¡Œç»“æœã€‚</p>
<h4 id="Callable"><a href="#Callable" class="headerlink" title="Callable"></a>Callable</h4><p><code>Callable</code> æ¥å£åªå£°æ˜äº†ä¸€ä¸ª <code>call</code> æ–¹æ³•ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Callable</span>&lt;V&gt; &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Computes a result, or throws an exception if unable to do so.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> computed result</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> Exception if unable to compute a result</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    V <span class="title function_">call</span><span class="params">()</span> <span class="keyword">throws</span> Exception;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>é‚£ä¹ˆæ€ä¹ˆä½¿ç”¨ <code>Callable</code> å‘¢ï¼Ÿä¸€èˆ¬æƒ…å†µä¸‹æ˜¯é…åˆ <code>ExecutorService</code> æ¥ä½¿ç”¨çš„ï¼Œåœ¨ <code>ExecutorService</code> æ¥å£ä¸­å£°æ˜äº†è‹¥å¹²ä¸ª <code>submit</code> æ–¹æ³•çš„é‡è½½ç‰ˆæœ¬ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;T&gt; Future&lt;T&gt; <span class="title function_">submit</span><span class="params">(Callable&lt;T&gt; task)</span>;</span><br><span class="line">&lt;T&gt; Future&lt;T&gt; <span class="title function_">submit</span><span class="params">(Runnable task, T result)</span>;</span><br><span class="line">Future&lt;?&gt; submit(Runnable task);</span><br></pre></td></tr></table></figure>

<p>ç¬¬ä¸€ä¸ª <code>submit</code> æ–¹æ³•é‡Œé¢çš„å‚æ•°ç±»å‹å°±æ˜¯ <code>Callable</code>ã€‚</p>
<h4 id="Future"><a href="#Future" class="headerlink" title="Future"></a>Future</h4><p><code>Future</code> å°±æ˜¯å¯¹äºå…·ä½“çš„ <code>Callable</code> ä»»åŠ¡çš„æ‰§è¡Œç»“æœè¿›è¡Œå–æ¶ˆã€æŸ¥è¯¢æ˜¯å¦å®Œæˆã€è·å–ç»“æœã€‚å¿…è¦æ—¶å¯ä»¥é€šè¿‡ <code>get</code> æ–¹æ³•è·å–æ‰§è¡Œç»“æœï¼Œè¯¥æ–¹æ³•ä¼šé˜»å¡ç›´åˆ°ä»»åŠ¡è¿”å›ç»“æœã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Future</span>&lt;V&gt; &#123;</span><br><span class="line">    <span class="type">boolean</span> <span class="title function_">cancel</span><span class="params">(<span class="type">boolean</span> mayInterruptIfRunning)</span>;</span><br><span class="line">    <span class="type">boolean</span> <span class="title function_">isCancelled</span><span class="params">()</span>;</span><br><span class="line">    <span class="type">boolean</span> <span class="title function_">isDone</span><span class="params">()</span>;</span><br><span class="line">    V <span class="title function_">get</span><span class="params">()</span> <span class="keyword">throws</span> InterruptedException, ExecutionException;</span><br><span class="line">    V <span class="title function_">get</span><span class="params">(<span class="type">long</span> timeout, TimeUnit unit)</span></span><br><span class="line">        <span class="keyword">throws</span> InterruptedException, ExecutionException, TimeoutException;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="FutureTask"><a href="#FutureTask" class="headerlink" title="FutureTask"></a>FutureTask</h4><p><code>FutureTask</code> ç±»å®ç°äº† <code>RunnableFuture</code> æ¥å£ï¼Œ<code>RunnableFuture</code> ç»§æ‰¿äº† <code>Runnable</code> æ¥å£å’Œ <code>Future</code> æ¥å£ã€‚</p>
<p>æ‰€ä»¥ï¼Œ<code>FutureTask</code> æ—¢å¯ä»¥ä½œä¸º <code>Runnable</code> è¢«çº¿ç¨‹æ‰§è¡Œï¼Œåˆå¯ä»¥ä½œä¸º <code>Future</code> å¾—åˆ° <code>Callable</code> çš„è¿”å›å€¼ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FutureTask</span>&lt;V&gt; <span class="keyword">implements</span> <span class="title class_">RunnableFuture</span>&lt;V&gt; &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">FutureTask</span><span class="params">(Callable&lt;V&gt; callable)</span> &#123;&#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">FutureTask</span><span class="params">(Runnable runnable, V result)</span> &#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">RunnableFuture</span>&lt;V&gt; <span class="keyword">extends</span> <span class="title class_">Runnable</span>, Future&lt;V&gt; &#123;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>äº‹å®ä¸Šï¼Œ<code>FutureTask</code> æ˜¯ <code>Future</code> æ¥å£çš„ä¸€ä¸ªå”¯ä¸€å®ç°ç±»ã€‚</p>
<h4 id="Callable-Future-FutureTask-ç¤ºä¾‹"><a href="#Callable-Future-FutureTask-ç¤ºä¾‹" class="headerlink" title="Callable + Future + FutureTask ç¤ºä¾‹"></a>Callable + Future + FutureTask ç¤ºä¾‹</h4><p>é€šè¿‡å®ç° <code>Callable</code> æ¥å£åˆ›å»ºçº¿ç¨‹çš„æ­¥éª¤ï¼š</p>
<ol>
<li>åˆ›å»º <code>Callable</code> æ¥å£çš„å®ç°ç±»ï¼Œå¹¶å®ç° <code>call</code> æ–¹æ³•ã€‚è¯¥ <code>call</code> æ–¹æ³•å°†ä½œä¸ºçº¿ç¨‹æ‰§è¡Œä½“ï¼Œå¹¶ä¸”æœ‰è¿”å›å€¼ã€‚</li>
<li>åˆ›å»º <code>Callable</code> å®ç°ç±»çš„å®ä¾‹ï¼Œä½¿ç”¨ <code>FutureTask</code> ç±»æ¥åŒ…è£… <code>Callable</code> å¯¹è±¡ï¼Œè¯¥ <code>FutureTask</code> å¯¹è±¡å°è£…äº†è¯¥ <code>Callable</code> å¯¹è±¡çš„ <code>call</code> æ–¹æ³•çš„è¿”å›å€¼ã€‚</li>
<li>ä½¿ç”¨ <code>FutureTask</code> å¯¹è±¡ä½œä¸º <code>Thread</code> å¯¹è±¡çš„ target åˆ›å»ºå¹¶å¯åŠ¨æ–°çº¿ç¨‹ã€‚</li>
<li>è°ƒç”¨ <code>FutureTask</code> å¯¹è±¡çš„ <code>get</code> æ–¹æ³•æ¥è·å¾—çº¿ç¨‹æ‰§è¡Œç»“æŸåçš„è¿”å›å€¼ã€‚</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CallableDemo</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        Callable&lt;Long&gt; callable = <span class="keyword">new</span> <span class="title class_">MyThread</span>();</span><br><span class="line">        FutureTask&lt;Long&gt; future = <span class="keyword">new</span> <span class="title class_">FutureTask</span>&lt;&gt;(callable);</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Thread</span>(future, <span class="string">&quot;Callable çº¿ç¨‹&quot;</span>).start();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;ä»»åŠ¡è€—æ—¶ï¼š&quot;</span> + (future.get() / <span class="number">1000000</span>) + <span class="string">&quot;æ¯«ç§’&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException | ExecutionException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">MyThread</span> <span class="keyword">implements</span> <span class="title class_">Callable</span>&lt;Long&gt; &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> <span class="type">int</span> <span class="variable">ticket</span> <span class="operator">=</span> <span class="number">10000</span>;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> Long <span class="title function_">call</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="type">long</span> <span class="variable">begin</span> <span class="operator">=</span> System.nanoTime();</span><br><span class="line">            <span class="keyword">while</span> (ticket &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                System.out.println(Thread.currentThread().getName() + <span class="string">&quot; å–å‡ºäº†ç¬¬ &quot;</span> + ticket + <span class="string">&quot; å¼ ç¥¨&quot;</span>);</span><br><span class="line">                ticket--;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="type">long</span> <span class="variable">end</span> <span class="operator">=</span> System.nanoTime();</span><br><span class="line">            <span class="keyword">return</span> (end - begin);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>:::</p>
<p>è™½ç„¶ï¼Œçœ‹ä¼¼æœ‰å¤šç§å¤šæ ·çš„åˆ›å»ºçº¿ç¨‹æ–¹å¼ã€‚ä½†æ˜¯ï¼Œ<strong>ä»æœ¬è´¨ä¸Šæ¥è¯´ï¼ŒJava å°±åªæœ‰ä¸€ç§æ–¹å¼å¯ä»¥åˆ›å»ºçº¿ç¨‹ï¼Œé‚£å°±æ˜¯é€šè¿‡ <code>new Thread().start() </code> åˆ›å»º</strong>ã€‚ä¸ç®¡æ˜¯å“ªç§æ–¹å¼ï¼Œæœ€ç»ˆè¿˜æ˜¯ä¾èµ–äº <code>new Thread().start()</code>ã€‚</p>
<blockquote>
<p>ğŸ‘‰ æ‰©å±•é˜…è¯»ï¼š<a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/NspUsyhEmKnJ-4OprRFp9g">å¤§å®¶éƒ½è¯´ Java æœ‰ä¸‰ç§åˆ›å»ºçº¿ç¨‹çš„æ–¹å¼ï¼å¹¶å‘ç¼–ç¨‹ä¸­çš„æƒŠå¤©éª—å±€ï¼</a>ã€‚</p>
</blockquote>
<h2 id="çº¿ç¨‹ç»ˆæ­¢"><a href="#çº¿ç¨‹ç»ˆæ­¢" class="headerlink" title="çº¿ç¨‹ç»ˆæ­¢"></a>çº¿ç¨‹ç»ˆæ­¢</h2><h3 id="å¦‚ä½•æ­£ç¡®åœæ­¢çº¿ç¨‹"><a href="#å¦‚ä½•æ­£ç¡®åœæ­¢çº¿ç¨‹" class="headerlink" title="å¦‚ä½•æ­£ç¡®åœæ­¢çº¿ç¨‹"></a>å¦‚ä½•æ­£ç¡®åœæ­¢çº¿ç¨‹</h3><p>é€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¸ä¼šæ‰‹åŠ¨åœæ­¢ä¸€ä¸ªçº¿ç¨‹ï¼Œè€Œæ˜¯å…è®¸çº¿ç¨‹è¿è¡Œåˆ°ç»“æŸï¼Œç„¶åè®©å®ƒè‡ªç„¶åœæ­¢ã€‚ä½†æ˜¯ä¾ç„¶ä¼šæœ‰è®¸å¤šç‰¹æ®Šçš„æƒ…å†µéœ€è¦æˆ‘ä»¬æå‰åœæ­¢çº¿ç¨‹ï¼Œæ¯”å¦‚ï¼šç”¨æˆ·çªç„¶å…³é—­ç¨‹åºï¼Œæˆ–ç¨‹åºè¿è¡Œå‡ºé”™é‡å¯ç­‰ã€‚</p>
<p><strong>å¯¹äº Java è€Œè¨€ï¼Œæœ€æ­£ç¡®çš„åœæ­¢çº¿ç¨‹çš„æ–¹å¼æ˜¯ï¼šé€šè¿‡ <code>Thread.interrupt</code> å’Œ <code>Thread.isInterrupted</code> é…åˆæ¥æ§åˆ¶çº¿ç¨‹ç»ˆæ­¢</strong>ã€‚ä½† <code>Thread.interrupt</code> ä»…ä»…èµ·åˆ°é€šçŸ¥è¢«åœæ­¢çº¿ç¨‹çš„ä½œç”¨ã€‚è€Œå¯¹äºè¢«åœæ­¢çš„çº¿ç¨‹è€Œè¨€ï¼Œå®ƒæ‹¥æœ‰å®Œå…¨çš„è‡ªä¸»æƒï¼Œå®ƒæ—¢å¯ä»¥é€‰æ‹©ç«‹å³åœæ­¢ï¼Œä¹Ÿå¯ä»¥é€‰æ‹©ä¸€æ®µæ—¶é—´ååœæ­¢ï¼Œä¹Ÿå¯ä»¥é€‰æ‹©å‹æ ¹ä¸åœæ­¢ã€‚</p>
<p>äº‹å®ä¸Šï¼ŒJava å¸Œæœ›ç¨‹åºé—´èƒ½å¤Ÿç›¸äº’é€šçŸ¥ã€ç›¸äº’åä½œåœ°ç®¡ç†çº¿ç¨‹ï¼Œå› ä¸ºå¦‚æœä¸äº†è§£å¯¹æ–¹æ­£åœ¨åšçš„å·¥ä½œï¼Œè´¸ç„¶å¼ºåˆ¶åœæ­¢çº¿ç¨‹å°±å¯èƒ½ä¼šé€ æˆä¸€äº›å®‰å…¨çš„é—®é¢˜ï¼Œä¸ºäº†é¿å…é€ æˆé—®é¢˜å°±éœ€è¦ç»™å¯¹æ–¹ä¸€å®šçš„æ—¶é—´æ¥æ•´ç†æ”¶å°¾å·¥ä½œã€‚æ¯”å¦‚ï¼šçº¿ç¨‹æ­£åœ¨å†™å…¥ä¸€ä¸ªæ–‡ä»¶ï¼Œè¿™æ—¶æ”¶åˆ°ç»ˆæ­¢ä¿¡å·ï¼Œå®ƒå°±éœ€è¦æ ¹æ®è‡ªèº«ä¸šåŠ¡åˆ¤æ–­ï¼Œæ˜¯é€‰æ‹©ç«‹å³åœæ­¢ï¼Œè¿˜æ˜¯å°†æ•´ä¸ªæ–‡ä»¶å†™å…¥æˆåŠŸååœæ­¢ï¼Œè€Œå¦‚æœé€‰æ‹©ç«‹å³åœæ­¢å°±å¯èƒ½é€ æˆæ•°æ®ä¸å®Œæ•´ï¼Œä¸ç®¡æ˜¯ä¸­æ–­å‘½ä»¤å‘èµ·è€…ï¼Œè¿˜æ˜¯æ¥æ”¶è€…éƒ½ä¸å¸Œæœ›æ•°æ®å‡ºç°é—®é¢˜ã€‚</p>
<p>ä¸€æ—¦è°ƒç”¨æŸä¸ªçº¿ç¨‹çš„ <code>Thread.interrupt</code> ä¹‹åï¼Œè¿™ä¸ªçº¿ç¨‹çš„ä¸­æ–­æ ‡è®°ä½å°±ä¼šè¢«è®¾ç½®æˆ <code>true</code>ã€‚æ¯ä¸ªçº¿ç¨‹éƒ½æœ‰è¿™æ ·çš„æ ‡è®°ä½ï¼Œå½“çº¿ç¨‹æ‰§è¡Œæ—¶ï¼Œåº”è¯¥å®šæœŸæ£€æŸ¥è¿™ä¸ªæ ‡è®°ä½ï¼Œå¦‚æœæ ‡è®°ä½è¢«è®¾ç½®æˆ <code>true</code>ï¼Œå°±è¯´æ˜æœ‰ç¨‹åºæƒ³ç»ˆæ­¢è¯¥çº¿ç¨‹ã€‚å›åˆ°æºç ï¼Œå¯ä»¥çœ‹åˆ°åœ¨ <code>while</code> å¾ªç¯ä½“åˆ¤æ–­è¯­å¥ä¸­ï¼Œé¦–å…ˆé€šè¿‡ <code>Thread.currentThread().isInterrupt()</code> åˆ¤æ–­çº¿ç¨‹æ˜¯å¦è¢«ä¸­æ–­ï¼Œéšåæ£€æŸ¥æ˜¯å¦è¿˜æœ‰å·¥ä½œè¦åšã€‚&amp;&amp; é€»è¾‘è¡¨ç¤ºåªæœ‰å½“ä¸¤ä¸ªåˆ¤æ–­æ¡ä»¶åŒæ—¶æ»¡è¶³çš„æƒ…å†µä¸‹ï¼Œæ‰ä¼šå»æ‰§è¡Œä¸‹é¢çš„å·¥ä½œã€‚</p>
<p>éœ€è¦ç•™æ„ä¸€ä¸ªç‰¹æ®Šåœºæ™¯ï¼š**<code>Thread.sleep</code> åï¼Œçº¿ç¨‹ä¾ç„¶å¯ä»¥æ„ŸçŸ¥ <code>Thread.interrupt</code>**ã€‚</p>
<p>ã€ç¤ºä¾‹ã€‘æ­£ç¡®åœæ­¢çº¿ç¨‹çš„æ–¹å¼â€”â€”<code>Thread.interrupt</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ThreadStopDemo</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">Thread</span> <span class="variable">thread</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Thread</span>(<span class="keyword">new</span> <span class="title class_">MyTask</span>(), <span class="string">&quot;MyTask&quot;</span>);</span><br><span class="line">        thread.start();</span><br><span class="line">        TimeUnit.MILLISECONDS.sleep(<span class="number">10</span>);</span><br><span class="line">        thread.interrupt();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">MyTask</span> <span class="keyword">implements</span> <span class="title class_">Runnable</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> <span class="type">long</span> <span class="variable">count</span> <span class="operator">=</span> <span class="number">0L</span>;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">            System.out.println(Thread.currentThread().getName() + <span class="string">&quot; çº¿ç¨‹å¯åŠ¨&quot;</span>);</span><br><span class="line">            <span class="comment">// é€šè¿‡ Thread.interrupted å’Œ interrupt é…åˆæ¥æ§åˆ¶çº¿ç¨‹ç»ˆæ­¢</span></span><br><span class="line">            <span class="keyword">while</span> (!Thread.currentThread().isInterrupted() &amp;&amp; count &lt; <span class="number">10000</span>) &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;count = &quot;</span> + count++);</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println(Thread.currentThread().getName() + <span class="string">&quot; çº¿ç¨‹ç»ˆæ­¢&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// è¾“å‡ºï¼ˆcount æœªåˆ° 10000ï¼Œçº¿ç¨‹å°±ä¸»åŠ¨ç»“æŸï¼‰ï¼š</span></span><br><span class="line"><span class="comment">// MyTask çº¿ç¨‹å¯åŠ¨</span></span><br><span class="line"><span class="comment">// count = 0</span></span><br><span class="line"><span class="comment">// count = 1</span></span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line"><span class="comment">// count = 840</span></span><br><span class="line"><span class="comment">// count = 841</span></span><br><span class="line"><span class="comment">// count = 842</span></span><br><span class="line"><span class="comment">// MyTask çº¿ç¨‹ç»ˆæ­¢</span></span><br></pre></td></tr></table></figure>

<h3 id="å¯ä»¥ä½¿ç”¨-Thread-stopï¼ŒThread-suspend-å’Œ-Thread-resume-åœæ­¢çº¿ç¨‹å—ï¼Ÿ"><a href="#å¯ä»¥ä½¿ç”¨-Thread-stopï¼ŒThread-suspend-å’Œ-Thread-resume-åœæ­¢çº¿ç¨‹å—ï¼Ÿ" class="headerlink" title="å¯ä»¥ä½¿ç”¨ Thread.stopï¼ŒThread.suspend å’Œ Thread.resume åœæ­¢çº¿ç¨‹å—ï¼Ÿ"></a>å¯ä»¥ä½¿ç”¨ <code>Thread.stop</code>ï¼Œ<code>Thread.suspend</code> å’Œ <code>Thread.resume</code> åœæ­¢çº¿ç¨‹å—ï¼Ÿ</h3><p><code>Thread.stop</code>ï¼Œ<code>Thread.suspend</code> å’Œ <code>Thread.resume</code> æ–¹æ³•å·²ç»è¢« Java æ ‡è®°ä¸º <code>@Deprecated</code>ã€‚ä¸ºä»€ä¹ˆåºŸå¼ƒå‘¢ï¼Ÿ</p>
<ul>
<li><strong><code>Thread.stop</code> ä¼šç›´æ¥æŠŠçº¿ç¨‹åœæ­¢ï¼Œè¿™æ ·å°±æ²¡æœ‰ç»™çº¿ç¨‹è¶³å¤Ÿçš„æ—¶é—´æ¥å¤„ç†æƒ³è¦åœ¨åœæ­¢å‰ä¿å­˜æ•°æ®çš„é€»è¾‘ï¼Œä»»åŠ¡æˆ›ç„¶è€Œæ­¢ï¼Œä¼šå¯¼è‡´å‡ºç°æ•°æ®å®Œæ•´æ€§ç­‰é—®é¢˜</strong>ã€‚</li>
<li>è€Œå¯¹äº<code>Thread.suspend</code> å’Œ <code>Thread.resume</code> è€Œè¨€ï¼Œå®ƒä»¬çš„é—®é¢˜åœ¨äºï¼š<strong>å¦‚æœçº¿ç¨‹è°ƒç”¨ <code>Thread.suspend</code>ï¼Œå®ƒå¹¶ä¸ä¼šé‡Šæ”¾é”ï¼Œå°±å¼€å§‹è¿›å…¥ä¼‘çœ ï¼Œä½†æ­¤æ—¶æœ‰å¯èƒ½ä»æŒæœ‰é”ï¼Œè¿™æ ·å°±å®¹æ˜“å¯¼è‡´æ­»é”é—®é¢˜</strong>ã€‚å› ä¸ºè¿™æŠŠé”åœ¨çº¿ç¨‹è¢« <code>Thread.resume</code> ä¹‹å‰ï¼Œæ˜¯ä¸ä¼šè¢«é‡Šæ”¾çš„ã€‚å‡è®¾çº¿ç¨‹ A è°ƒç”¨äº† <code>Thread.suspend</code> æ–¹æ³•è®©çº¿ç¨‹ B æŒ‚èµ·ï¼Œçº¿ç¨‹ B è¿›å…¥ä¼‘çœ ï¼Œè€Œçº¿ç¨‹ B åˆåˆšå¥½æŒæœ‰ä¸€æŠŠé”ï¼Œæ­¤æ—¶å‡è®¾çº¿ç¨‹ A æƒ³è®¿é—®çº¿ç¨‹ B æŒæœ‰çš„é”ï¼Œä½†ç”±äºçº¿ç¨‹ B å¹¶æ²¡æœ‰é‡Šæ”¾é”å°±è¿›å…¥ä¼‘çœ äº†ï¼Œæ‰€ä»¥å¯¹äºçº¿ç¨‹ A è€Œè¨€ï¼Œæ­¤æ—¶æ‹¿ä¸åˆ°é”ï¼Œä¹Ÿä¼šé™·å…¥é˜»å¡ï¼Œé‚£ä¹ˆçº¿ç¨‹ A å’Œçº¿ç¨‹ B å°±éƒ½æ— æ³•ç»§ç»­å‘ä¸‹æ‰§è¡Œã€‚</li>
</ul>
<p>ã€ç¤ºä¾‹ã€‘<code>Thread.stop</code> ç»ˆæ­¢çº¿ç¨‹ï¼Œå¯¼è‡´çº¿ç¨‹ä»»åŠ¡æˆ›ç„¶è€Œæ­¢</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ThreadStopErrorDemo</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">MyTask</span> <span class="variable">thread</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MyTask</span>();</span><br><span class="line">        thread.start();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Thread.sleep(<span class="number">1000</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// ç»ˆæ­¢çº¿ç¨‹</span></span><br><span class="line">        thread.stop();</span><br><span class="line">        <span class="comment">// ç¡®ä¿çº¿ç¨‹ç»ˆæ­¢åï¼Œæ‰æ‰§è¡Œä¸‹é¢çš„ä»£ç </span></span><br><span class="line">        <span class="keyword">while</span> (thread.isAlive()) &#123; &#125;</span><br><span class="line">        <span class="comment">// è¾“å‡ºä¸¤ä¸ªè®¡æ•°å™¨çš„æœ€ç»ˆçŠ¶æ€</span></span><br><span class="line">        thread.print();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æŒæœ‰ä¸¤ä¸ªè®¡æ•°å™¨ï¼Œrun æ–¹æ³•ä¸­æ¯æ¬¡æ‰§è¡Œéƒ½ä¼šä½¿è®¡æ•°å™¨è‡ªå¢</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">MyTask</span> <span class="keyword">extends</span> <span class="title class_">Thread</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> <span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">synchronized</span> (<span class="built_in">this</span>) &#123;</span><br><span class="line">                ++i;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    <span class="comment">// æ¨¡æ‹Ÿè€—æ—¶æ“ä½œ</span></span><br><span class="line">                    TimeUnit.SECONDS.sleep(<span class="number">5</span>);</span><br><span class="line">                &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">                ++j;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">print</span><span class="params">()</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;i=&quot;</span> + i + <span class="string">&quot; j=&quot;</span> + j);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="ä½¿ç”¨-volatile-æ ‡è®°æ–¹å¼åœæ­¢çº¿ç¨‹æ­£ç¡®å—ï¼Ÿ"><a href="#ä½¿ç”¨-volatile-æ ‡è®°æ–¹å¼åœæ­¢çº¿ç¨‹æ­£ç¡®å—ï¼Ÿ" class="headerlink" title="ä½¿ç”¨ volatile æ ‡è®°æ–¹å¼åœæ­¢çº¿ç¨‹æ­£ç¡®å—ï¼Ÿ"></a>ä½¿ç”¨ <code>volatile</code> æ ‡è®°æ–¹å¼åœæ­¢çº¿ç¨‹æ­£ç¡®å—ï¼Ÿ</h3><p>ä½¿ç”¨ <code>volatile</code> æ ‡è®°æ–¹å¼åœæ­¢çº¿ç¨‹å¹¶ä¸æ€»æ˜¯æ­£ç¡®çš„ã€‚è™½ç„¶ <code>volatile</code> å˜é‡å¯ä»¥ç¡®ä¿å¯è§æ€§ï¼Œå³å½“ä¸€ä¸ªçº¿ç¨‹ä¿®æ”¹äº† <code>volatile</code> å˜é‡çš„å€¼ï¼Œå…¶ä»–çº¿ç¨‹èƒ½å¤Ÿç«‹å³çœ‹åˆ°æœ€æ–°çš„å€¼ï¼Œä½†å®ƒå¹¶ä¸èƒ½ä¿è¯åŸå­æ€§ï¼Œä¹Ÿå°±æ˜¯è¯´å¹¶ä¸èƒ½ä¿è¯å¤šä¸ªçº¿ç¨‹å¯¹ <code>volatile</code> å˜é‡çš„æ“ä½œæ˜¯äº’æ–¥çš„ã€‚</p>
<p>å½“æˆ‘ä»¬ä½¿ç”¨ <code>volatile</code> å˜é‡æ¥æ§åˆ¶çº¿ç¨‹çš„åœæ­¢ï¼Œé€šå¸¸æ˜¯é€šè¿‡è®¾ç½®ä¸€ä¸ª <code>volatile</code> æ ‡å¿—ä½æ¥å‘Šè¯‰çº¿ç¨‹åœæ­¢æ‰§è¡Œã€‚ä¾‹å¦‚ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyTask</span> <span class="keyword">extends</span> <span class="title class_">Thread</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">volatile</span> <span class="type">boolean</span> <span class="variable">canceled</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">while</span> (!canceled) &#123;</span><br><span class="line">            <span class="comment">// æ‰§è¡Œä»»åŠ¡</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">stopTask</span><span class="params">()</span> &#123;</span><br><span class="line">        canceled = <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åœ¨ä¸Šè¿°ä¾‹å­ä¸­ï¼Œ<code>canceled</code> æ˜¯ä¸€ä¸ª <code>volatile</code> å˜é‡ï¼Œç”¨æ¥æ§åˆ¶çº¿ç¨‹çš„åœæ­¢ã€‚è™½ç„¶è¿™ç§æ–¹å¼åœ¨æŸäº›æƒ…å†µä¸‹å¯ä»¥å·¥ä½œï¼Œä½†å®ƒå¹¶<strong>ä¸æ˜¯ä¸€ä¸ªå¯é çš„åœæ­¢çº¿ç¨‹çš„æ–¹å¼ï¼Œå› ä¸ºåœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸­ï¼Œå…¶ä»–çº¿ç¨‹ä¿®æ”¹ <code>canceled</code> çš„å€¼æ—¶ï¼Œå¯èƒ½ä¼šå‡ºç°ç«æ€æ¡ä»¶ï¼Œå¯¼è‡´çº¿ç¨‹æ— æ³•æ­£ç¡®åœæ­¢</strong>ã€‚</p>
<h2 id="çº¿ç¨‹åŸºæœ¬æ–¹æ³•"><a href="#çº¿ç¨‹åŸºæœ¬æ–¹æ³•" class="headerlink" title="çº¿ç¨‹åŸºæœ¬æ–¹æ³•"></a>çº¿ç¨‹åŸºæœ¬æ–¹æ³•</h2><p>çº¿ç¨‹ï¼ˆ<code>Thread</code>ï¼‰åŸºæœ¬æ–¹æ³•æ¸…å•ï¼š</p>
<table>
<thead>
<tr>
<th>æ–¹æ³•</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td><code>run</code></td>
<td>çº¿ç¨‹çš„æ‰§è¡Œå®ä½“ã€‚</td>
</tr>
<tr>
<td><code>start</code></td>
<td>çº¿ç¨‹çš„å¯åŠ¨æ–¹æ³•ã€‚</td>
</tr>
<tr>
<td><code>currentThread</code></td>
<td>è¿”å›å¯¹å½“å‰æ­£åœ¨æ‰§è¡Œçš„çº¿ç¨‹å¯¹è±¡çš„å¼•ç”¨ã€‚</td>
</tr>
<tr>
<td><code>setName</code></td>
<td>è®¾ç½®çº¿ç¨‹åç§°ã€‚</td>
</tr>
<tr>
<td><code>getName</code></td>
<td>è·å–çº¿ç¨‹åç§°ã€‚</td>
</tr>
<tr>
<td><code>setPriority</code></td>
<td>è®¾ç½®çº¿ç¨‹ä¼˜å…ˆçº§ã€‚Java ä¸­çš„çº¿ç¨‹ä¼˜å…ˆçº§çš„èŒƒå›´æ˜¯ [1,10]ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œé«˜ä¼˜å…ˆçº§çš„çº¿ç¨‹åœ¨è¿è¡Œæ—¶ä¼šå…·æœ‰ä¼˜å…ˆæƒã€‚å¯ä»¥é€šè¿‡ <code>thread.setPriority(Thread.MAX_PRIORITY)</code> çš„æ–¹å¼è®¾ç½®ï¼Œé»˜è®¤ä¼˜å…ˆçº§ä¸º 5ã€‚</td>
</tr>
<tr>
<td><code>getPriority</code></td>
<td>è·å–çº¿ç¨‹ä¼˜å…ˆçº§ã€‚</td>
</tr>
<tr>
<td><code>setDaemon</code></td>
<td>è®¾ç½®çº¿ç¨‹ä¸ºå®ˆæŠ¤çº¿ç¨‹ã€‚</td>
</tr>
<tr>
<td><code>isDaemon</code></td>
<td>åˆ¤æ–­çº¿ç¨‹æ˜¯å¦ä¸ºå®ˆæŠ¤çº¿ç¨‹ã€‚</td>
</tr>
<tr>
<td><code>isAlive</code></td>
<td>åˆ¤æ–­çº¿ç¨‹æ˜¯å¦å¯åŠ¨ã€‚</td>
</tr>
<tr>
<td><code>interrupt</code></td>
<td>ä¸­æ–­å¦ä¸€ä¸ªçº¿ç¨‹çš„è¿è¡ŒçŠ¶æ€ã€‚</td>
</tr>
<tr>
<td><code>interrupted</code></td>
<td>æµ‹è¯•å½“å‰çº¿ç¨‹æ˜¯å¦å·²è¢«ä¸­æ–­ã€‚é€šè¿‡æ­¤æ–¹æ³•å¯ä»¥æ¸…é™¤çº¿ç¨‹çš„ä¸­æ–­çŠ¶æ€ã€‚æ¢å¥è¯è¯´ï¼Œå¦‚æœè¦è¿ç»­è°ƒç”¨æ­¤æ–¹æ³•ä¸¤æ¬¡ï¼Œåˆ™ç¬¬äºŒæ¬¡è°ƒç”¨å°†è¿”å› falseï¼ˆé™¤éå½“å‰çº¿ç¨‹åœ¨ç¬¬ä¸€æ¬¡è°ƒç”¨æ¸…é™¤å…¶ä¸­æ–­çŠ¶æ€ä¹‹åä¸”åœ¨ç¬¬äºŒæ¬¡è°ƒç”¨æ£€æŸ¥å…¶çŠ¶æ€ä¹‹å‰å†æ¬¡ä¸­æ–­ï¼‰ã€‚</td>
</tr>
<tr>
<td><code>join</code></td>
<td>å¯ä»¥ä½¿ä¸€ä¸ªçº¿ç¨‹å¼ºåˆ¶è¿è¡Œï¼Œçº¿ç¨‹å¼ºåˆ¶è¿è¡ŒæœŸé—´ï¼Œå…¶ä»–çº¿ç¨‹æ— æ³•è¿è¡Œï¼Œå¿…é¡»ç­‰å¾…æ­¤çº¿ç¨‹å®Œæˆä¹‹åæ‰å¯ä»¥ç»§ç»­æ‰§è¡Œã€‚</td>
</tr>
<tr>
<td><code>Thread.sleep</code></td>
<td>é™æ€æ–¹æ³•ã€‚å°†å½“å‰æ­£åœ¨æ‰§è¡Œçš„çº¿ç¨‹ä¼‘çœ ã€‚</td>
</tr>
<tr>
<td><code>Thread.yield</code></td>
<td>é™æ€æ–¹æ³•ã€‚å°†å½“å‰æ­£åœ¨æ‰§è¡Œçš„çº¿ç¨‹æš‚åœï¼Œè®©å…¶ä»–çº¿ç¨‹æ‰§è¡Œã€‚</td>
</tr>
</tbody></table>
<h3 id="çº¿ç¨‹ä¼‘çœ "><a href="#çº¿ç¨‹ä¼‘çœ " class="headerlink" title="çº¿ç¨‹ä¼‘çœ "></a>çº¿ç¨‹ä¼‘çœ </h3><p><strong>ä½¿ç”¨ <code>Thread.sleep</code> æ–¹æ³•å¯ä»¥ä½¿å¾—å½“å‰æ­£åœ¨æ‰§è¡Œçš„çº¿ç¨‹è¿›å…¥ä¼‘çœ çŠ¶æ€ã€‚</strong></p>
<p>ä½¿ç”¨ <code>Thread.sleep</code> éœ€è¦å‘å…¶ä¼ å…¥ä¸€ä¸ªæ•´æ•°å€¼ï¼Œè¿™ä¸ªå€¼è¡¨ç¤ºçº¿ç¨‹å°†è¦ä¼‘çœ çš„æ¯«ç§’æ•°ã€‚</p>
<p><code>Thread.sleep</code> æ–¹æ³•å¯èƒ½ä¼šæŠ›å‡º <code>InterruptedException</code>ï¼Œå› ä¸ºå¼‚å¸¸ä¸èƒ½è·¨çº¿ç¨‹ä¼ æ’­å› <code>main</code> ä¸­ï¼Œå› æ­¤å¿…é¡»åœ¨æœ¬åœ°è¿›è¡Œå¤„ç†ã€‚çº¿ç¨‹ä¸­æŠ›å‡ºçš„å…¶å®ƒå¼‚å¸¸ä¹ŸåŒæ ·éœ€è¦åœ¨æœ¬åœ°è¿›è¡Œå¤„ç†ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ThreadSleepDemo</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Thread</span>(<span class="keyword">new</span> <span class="title class_">MyThread</span>(<span class="string">&quot;çº¿ç¨‹ A&quot;</span>, <span class="number">500</span>)).start();</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Thread</span>(<span class="keyword">new</span> <span class="title class_">MyThread</span>(<span class="string">&quot;çº¿ç¨‹ B&quot;</span>, <span class="number">1000</span>)).start();</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Thread</span>(<span class="keyword">new</span> <span class="title class_">MyThread</span>(<span class="string">&quot;çº¿ç¨‹ C&quot;</span>, <span class="number">1500</span>)).start();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">MyThread</span> <span class="keyword">implements</span> <span class="title class_">Runnable</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/** çº¿ç¨‹åç§° */</span></span><br><span class="line">        <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/** ä¼‘çœ æ—¶é—´ */</span></span><br><span class="line">        <span class="keyword">private</span> <span class="type">int</span> time;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> <span class="title function_">MyThread</span><span class="params">(String name, <span class="type">int</span> time)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.name = name;</span><br><span class="line">            <span class="built_in">this</span>.time = time;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="comment">// ä¼‘çœ æŒ‡å®šçš„æ—¶é—´</span></span><br><span class="line">                Thread.sleep(<span class="built_in">this</span>.time);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println(<span class="built_in">this</span>.name + <span class="string">&quot;ä¼‘çœ &quot;</span> + <span class="built_in">this</span>.time + <span class="string">&quot;æ¯«ç§’ã€‚&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="çº¿ç¨‹ç¤¼è®©"><a href="#çº¿ç¨‹ç¤¼è®©" class="headerlink" title="çº¿ç¨‹ç¤¼è®©"></a>çº¿ç¨‹ç¤¼è®©</h3><p><code>Thread.yield</code> æ–¹æ³•çš„è°ƒç”¨å£°æ˜äº†å½“å‰çº¿ç¨‹å·²ç»å®Œæˆäº†ç”Ÿå‘½å‘¨æœŸä¸­æœ€é‡è¦çš„éƒ¨åˆ†ï¼Œå¯ä»¥åˆ‡æ¢ç»™å…¶å®ƒçº¿ç¨‹æ¥æ‰§è¡Œ ã€‚è¯¥æ–¹æ³•åªæ˜¯å¯¹çº¿ç¨‹è°ƒåº¦å™¨çš„ä¸€ä¸ªå»ºè®®ï¼Œè€Œä¸”ä¹Ÿåªæ˜¯å»ºè®®å…·æœ‰ç›¸åŒä¼˜å…ˆçº§çš„å…¶å®ƒçº¿ç¨‹å¯ä»¥è¿è¡Œã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ThreadYieldDemo</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">MyThread</span> <span class="variable">t</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MyThread</span>();</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Thread</span>(t, <span class="string">&quot;çº¿ç¨‹ A&quot;</span>).start();</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Thread</span>(t, <span class="string">&quot;çº¿ç¨‹ B&quot;</span>).start();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">MyThread</span> <span class="keyword">implements</span> <span class="title class_">Runnable</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">5</span>; i++) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    Thread.sleep(<span class="number">1000</span>);</span><br><span class="line">                &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">                System.out.println(Thread.currentThread().getName() + <span class="string">&quot;è¿è¡Œï¼Œi = &quot;</span> + i);</span><br><span class="line">                <span class="keyword">if</span> (i == <span class="number">2</span>) &#123;</span><br><span class="line">                    System.out.print(<span class="string">&quot;çº¿ç¨‹ç¤¼è®©ï¼š&quot;</span>);</span><br><span class="line">                    Thread.<span class="keyword">yield</span>();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="å®ˆæŠ¤çº¿ç¨‹"><a href="#å®ˆæŠ¤çº¿ç¨‹" class="headerlink" title="å®ˆæŠ¤çº¿ç¨‹"></a>å®ˆæŠ¤çº¿ç¨‹</h3><p>ä»€ä¹ˆæ˜¯å®ˆæŠ¤çº¿ç¨‹ï¼Ÿ</p>
<ul>
<li><strong>å®ˆæŠ¤çº¿ç¨‹ï¼ˆDaemon Threadï¼‰æ˜¯åœ¨åå°æ‰§è¡Œå¹¶ä¸”ä¸ä¼šé˜»æ­¢ JVM ç»ˆæ­¢çš„çº¿ç¨‹</strong>ã€‚<strong>å½“æ‰€æœ‰éå®ˆæŠ¤çº¿ç¨‹ç»“æŸæ—¶ï¼Œç¨‹åºä¹Ÿå°±ç»ˆæ­¢ï¼ŒåŒæ—¶ä¼šæ€æ­»æ‰€æœ‰å®ˆæŠ¤çº¿ç¨‹</strong>ã€‚</li>
<li>ä¸å®ˆæŠ¤çº¿ç¨‹ï¼ˆDaemon Threadï¼‰ç›¸åçš„ï¼Œå«ç”¨æˆ·çº¿ç¨‹ï¼ˆUser Threadï¼‰ï¼Œä¹Ÿå°±æ˜¯éå®ˆæŠ¤çº¿ç¨‹ã€‚</li>
</ul>
<p>ä¸ºä»€ä¹ˆéœ€è¦å®ˆæŠ¤çº¿ç¨‹ï¼Ÿ</p>
<ul>
<li>å®ˆæŠ¤çº¿ç¨‹çš„ä¼˜å…ˆçº§æ¯”è¾ƒä½ï¼Œç”¨äºä¸ºç³»ç»Ÿä¸­çš„å…¶å®ƒå¯¹è±¡å’Œçº¿ç¨‹æä¾›æœåŠ¡ã€‚å…¸å‹çš„åº”ç”¨å°±æ˜¯åƒåœ¾å›æ”¶å™¨ã€‚</li>
</ul>
<p>å¦‚ä½•ä½¿ç”¨å®ˆæŠ¤çº¿ç¨‹ï¼Ÿ</p>
<ul>
<li>å¯ä»¥ä½¿ç”¨ <code>isDaemon</code> æ–¹æ³•åˆ¤æ–­çº¿ç¨‹æ˜¯å¦ä¸ºå®ˆæŠ¤çº¿ç¨‹ã€‚</li>
<li>å¯ä»¥ä½¿ç”¨ <code>setDaemon</code> æ–¹æ³•è®¾ç½®çº¿ç¨‹ä¸ºå®ˆæŠ¤çº¿ç¨‹ã€‚<ul>
<li>æ­£åœ¨è¿è¡Œçš„ç”¨æˆ·çº¿ç¨‹æ— æ³•è®¾ç½®ä¸ºå®ˆæŠ¤çº¿ç¨‹ï¼Œæ‰€ä»¥ <code>setDaemon</code> å¿…é¡»åœ¨ <code>thread.start</code> æ–¹æ³•ä¹‹å‰è®¾ç½®ï¼Œå¦åˆ™ä¼šæŠ›å‡º <code>llegalThreadStateException</code> å¼‚å¸¸ï¼›</li>
<li>ä¸€ä¸ªå®ˆæŠ¤çº¿ç¨‹åˆ›å»ºçš„å­çº¿ç¨‹ä¾ç„¶æ˜¯å®ˆæŠ¤çº¿ç¨‹ã€‚</li>
<li>ä¸è¦è®¤ä¸ºæ‰€æœ‰çš„åº”ç”¨éƒ½å¯ä»¥åˆ†é…ç»™å®ˆæŠ¤çº¿ç¨‹æ¥è¿›è¡ŒæœåŠ¡ï¼Œæ¯”å¦‚è¯»å†™æ“ä½œæˆ–è€…è®¡ç®—é€»è¾‘ã€‚</li>
</ul>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ThreadDaemonDemo</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Thread</span> <span class="variable">t</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Thread</span>(<span class="keyword">new</span> <span class="title class_">MyThread</span>(), <span class="string">&quot;çº¿ç¨‹&quot;</span>);</span><br><span class="line">        t.setDaemon(<span class="literal">true</span>); <span class="comment">// æ­¤çº¿ç¨‹åœ¨åå°è¿è¡Œ</span></span><br><span class="line">        System.out.println(<span class="string">&quot;çº¿ç¨‹ t æ˜¯å¦æ˜¯å®ˆæŠ¤è¿›ç¨‹ï¼š&quot;</span> + t.isDaemon());</span><br><span class="line">        t.start(); <span class="comment">// å¯åŠ¨çº¿ç¨‹</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">MyThread</span> <span class="keyword">implements</span> <span class="title class_">Runnable</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">                System.out.println(Thread.currentThread().getName() + <span class="string">&quot;åœ¨è¿è¡Œã€‚&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>å‚è€ƒé˜…è¯»ï¼š<a target="_blank" rel="noopener" href="https://blog.csdn.net/shimiso/article/details/8964414">Java ä¸­å®ˆæŠ¤çº¿ç¨‹çš„æ€»ç»“</a></p>
</blockquote>
<h2 id="çº¿ç¨‹é€šä¿¡"><a href="#çº¿ç¨‹é€šä¿¡" class="headerlink" title="çº¿ç¨‹é€šä¿¡"></a>çº¿ç¨‹é€šä¿¡</h2><blockquote>
<p>å½“å¤šä¸ªçº¿ç¨‹å¯ä»¥ä¸€èµ·å·¥ä½œå»è§£å†³æŸä¸ªé—®é¢˜æ—¶ï¼Œå¦‚æœæŸäº›éƒ¨åˆ†å¿…é¡»åœ¨å…¶å®ƒéƒ¨åˆ†ä¹‹å‰å®Œæˆï¼Œé‚£ä¹ˆå°±éœ€è¦å¯¹çº¿ç¨‹è¿›è¡Œåè°ƒã€‚</p>
</blockquote>
<h3 id="wait-notify-notifyAll"><a href="#wait-notify-notifyAll" class="headerlink" title="wait&#x2F;notify&#x2F;notifyAll"></a>wait&#x2F;notify&#x2F;notifyAll</h3><ul>
<li><code>wait</code> - <code>wait</code> ä¼šè‡ªåŠ¨é‡Šæ”¾å½“å‰çº¿ç¨‹å æœ‰çš„å¯¹è±¡é”ï¼Œå¹¶è¯·æ±‚æ“ä½œç³»ç»ŸæŒ‚èµ·å½“å‰çº¿ç¨‹ï¼Œ<strong>è®©çº¿ç¨‹ä» <code>RUNNING</code> çŠ¶æ€è½¬å…¥ <code>WAITING</code> çŠ¶æ€</strong>ï¼Œç­‰å¾… <code>notify</code> &#x2F; <code>notifyAll</code> æ¥å”¤é†’ã€‚å¦‚æœæ²¡æœ‰é‡Šæ”¾é”ï¼Œé‚£ä¹ˆå…¶å®ƒçº¿ç¨‹å°±æ— æ³•è¿›å…¥å¯¹è±¡çš„åŒæ­¥æ–¹æ³•æˆ–è€…åŒæ­¥æ§åˆ¶å—ä¸­ï¼Œé‚£ä¹ˆå°±æ— æ³•æ‰§è¡Œ <code>notify</code> æˆ–è€… <code>notifyAll</code> æ¥å”¤é†’æŒ‚èµ·çš„çº¿ç¨‹ï¼Œé€ æˆæ­»é”ã€‚</li>
<li><code>notify</code> - å”¤é†’ä¸€ä¸ªæ­£åœ¨ <code>WAITING</code> çŠ¶æ€çš„çº¿ç¨‹ï¼Œå¹¶è®©å®ƒæ‹¿åˆ°å¯¹è±¡é”ï¼Œå…·ä½“å”¤é†’å“ªä¸€ä¸ªçº¿ç¨‹ç”± JVM æ§åˆ¶ ã€‚</li>
<li><code>notifyAll</code> - å”¤é†’æ‰€æœ‰æ­£åœ¨ <code>WAITING</code> çŠ¶æ€çš„çº¿ç¨‹ï¼Œæ¥ä¸‹æ¥å®ƒä»¬éœ€è¦ç«äº‰å¯¹è±¡é”ã€‚</li>
</ul>
<blockquote>
<p>æ³¨æ„ï¼š</p>
<ul>
<li><strong><code>wait</code>ã€<code>notify</code>ã€<code>notifyAll</code> éƒ½æ˜¯ <code>Object</code> ç±»ä¸­çš„æ–¹æ³•</strong>ï¼Œè€Œé <code>Thread</code>ã€‚</li>
<li>**<code>wait</code>ã€<code>notify</code>ã€<code>notifyAll</code> åªèƒ½ç”¨åœ¨ <code>synchronized</code> æ–¹æ³•æˆ–è€… <code>synchronized</code> ä»£ç å—ä¸­ä½¿ç”¨ï¼Œå¦åˆ™ä¼šåœ¨è¿è¡Œæ—¶æŠ›å‡º <code>IllegalMonitorStateException</code>**ã€‚</li>
</ul>
</blockquote>
<p>ç”Ÿäº§è€…ã€æ¶ˆè´¹è€…æ¨¡å¼æ˜¯ <code>wait</code>ã€<code>notify</code>ã€<code>notifyAll</code> çš„ä¸€ä¸ªç»å…¸ä½¿ç”¨æ¡ˆä¾‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ThreadWaitNotifyDemo02</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">QUEUE_SIZE</span> <span class="operator">=</span> <span class="number">10</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> PriorityQueue&lt;Integer&gt; queue = <span class="keyword">new</span> <span class="title class_">PriorityQueue</span>&lt;&gt;(QUEUE_SIZE);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Producer</span>(<span class="string">&quot;ç”Ÿäº§è€… A&quot;</span>).start();</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Producer</span>(<span class="string">&quot;ç”Ÿäº§è€… B&quot;</span>).start();</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Consumer</span>(<span class="string">&quot;æ¶ˆè´¹è€… A&quot;</span>).start();</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Consumer</span>(<span class="string">&quot;æ¶ˆè´¹è€… B&quot;</span>).start();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Consumer</span> <span class="keyword">extends</span> <span class="title class_">Thread</span> &#123;</span><br><span class="line"></span><br><span class="line">        Consumer(String name) &#123;</span><br><span class="line">            <span class="built_in">super</span>(name);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">                <span class="keyword">synchronized</span> (queue) &#123;</span><br><span class="line">                    <span class="keyword">while</span> (queue.size() == <span class="number">0</span>) &#123;</span><br><span class="line">                        <span class="keyword">try</span> &#123;</span><br><span class="line">                            System.out.println(<span class="string">&quot;é˜Ÿåˆ—ç©ºï¼Œç­‰å¾…æ•°æ®&quot;</span>);</span><br><span class="line">                            queue.wait();</span><br><span class="line">                        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                            e.printStackTrace();</span><br><span class="line">                            queue.notifyAll();</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                    queue.poll(); <span class="comment">// æ¯æ¬¡ç§»èµ°é˜Ÿé¦–å…ƒç´ </span></span><br><span class="line">                    queue.notifyAll();</span><br><span class="line">                    <span class="keyword">try</span> &#123;</span><br><span class="line">                        Thread.sleep(<span class="number">500</span>);</span><br><span class="line">                    &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                        e.printStackTrace();</span><br><span class="line">                    &#125;</span><br><span class="line">                    System.out.println(Thread.currentThread().getName() + <span class="string">&quot; ä»é˜Ÿåˆ—å–èµ°ä¸€ä¸ªå…ƒç´ ï¼Œé˜Ÿåˆ—å½“å‰æœ‰ï¼š&quot;</span> + queue.size() + <span class="string">&quot;ä¸ªå…ƒç´ &quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Producer</span> <span class="keyword">extends</span> <span class="title class_">Thread</span> &#123;</span><br><span class="line"></span><br><span class="line">        Producer(String name) &#123;</span><br><span class="line">            <span class="built_in">super</span>(name);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">                <span class="keyword">synchronized</span> (queue) &#123;</span><br><span class="line">                    <span class="keyword">while</span> (queue.size() == QUEUE_SIZE) &#123;</span><br><span class="line">                        <span class="keyword">try</span> &#123;</span><br><span class="line">                            System.out.println(<span class="string">&quot;é˜Ÿåˆ—æ»¡ï¼Œç­‰å¾…æœ‰ç©ºä½™ç©ºé—´&quot;</span>);</span><br><span class="line">                            queue.wait();</span><br><span class="line">                        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                            e.printStackTrace();</span><br><span class="line">                            queue.notifyAll();</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                    queue.offer(<span class="number">1</span>); <span class="comment">// æ¯æ¬¡æ’å…¥ä¸€ä¸ªå…ƒç´ </span></span><br><span class="line">                    queue.notifyAll();</span><br><span class="line">                    <span class="keyword">try</span> &#123;</span><br><span class="line">                        Thread.sleep(<span class="number">500</span>);</span><br><span class="line">                    &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                        e.printStackTrace();</span><br><span class="line">                    &#125;</span><br><span class="line">                    System.out.println(Thread.currentThread().getName() + <span class="string">&quot; å‘é˜Ÿåˆ—å–ä¸­æ’å…¥ä¸€ä¸ªå…ƒç´ ï¼Œé˜Ÿåˆ—å½“å‰æœ‰ï¼š&quot;</span> + queue.size() + <span class="string">&quot;ä¸ªå…ƒç´ &quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="join"><a href="#join" class="headerlink" title="join"></a>join</h3><p>åœ¨çº¿ç¨‹æ“ä½œä¸­ï¼Œå¯ä»¥ä½¿ç”¨ <code>join</code> æ–¹æ³•è®©ä¸€ä¸ªçº¿ç¨‹å¼ºåˆ¶è¿è¡Œï¼Œçº¿ç¨‹å¼ºåˆ¶è¿è¡ŒæœŸé—´ï¼Œå…¶ä»–çº¿ç¨‹æ— æ³•è¿è¡Œï¼Œå¿…é¡»ç­‰å¾…æ­¤çº¿ç¨‹å®Œæˆä¹‹åæ‰å¯ä»¥ç»§ç»­æ‰§è¡Œã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ThreadJoinDemo</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">MyThread</span> <span class="variable">mt</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MyThread</span>(); <span class="comment">// å®ä¾‹åŒ– Runnable å­ç±»å¯¹è±¡</span></span><br><span class="line">        <span class="type">Thread</span> <span class="variable">t</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Thread</span>(mt, <span class="string">&quot;mythread&quot;</span>); <span class="comment">// å®ä¾‹åŒ– Thread å¯¹è±¡</span></span><br><span class="line">        t.start(); <span class="comment">// å¯åŠ¨çº¿ç¨‹</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">50</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (i &gt; <span class="number">10</span>) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    t.join(); <span class="comment">// çº¿ç¨‹å¼ºåˆ¶è¿è¡Œ</span></span><br><span class="line">                &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println(<span class="string">&quot;Main çº¿ç¨‹è¿è¡Œ --&gt; &quot;</span> + i);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">MyThread</span> <span class="keyword">implements</span> <span class="title class_">Runnable</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">50</span>; i++) &#123;</span><br><span class="line">                System.out.println(Thread.currentThread().getName() + <span class="string">&quot; è¿è¡Œï¼Œi = &quot;</span> + i); <span class="comment">// å–å¾—å½“å‰çº¿ç¨‹çš„åå­—</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="ç®¡é“"><a href="#ç®¡é“" class="headerlink" title="ç®¡é“"></a>ç®¡é“</h3><p>ç®¡é“è¾“å…¥&#x2F;è¾“å‡ºæµå’Œæ™®é€šçš„æ–‡ä»¶è¾“å…¥&#x2F;è¾“å‡ºæµæˆ–è€…ç½‘ç»œè¾“å…¥&#x2F;è¾“å‡ºæµä¸åŒä¹‹å¤„åœ¨äºï¼Œå®ƒä¸»è¦ç”¨äºçº¿ç¨‹ä¹‹é—´çš„æ•°æ®ä¼ è¾“ï¼Œè€Œä¼ è¾“çš„åª’ä»‹ä¸ºå†…å­˜ã€‚<br>ç®¡é“è¾“å…¥&#x2F;è¾“å‡ºæµä¸»è¦åŒ…æ‹¬äº†å¦‚ä¸‹ 4 ç§å…·ä½“å®ç°ï¼š<code>PipedOutputStream</code>ã€<code>PipedInputStream</code>ã€<code>PipedReader</code> å’Œ <code>PipedWriter</code>ï¼Œå‰ä¸¤ç§é¢å‘å­—èŠ‚ï¼Œè€Œåä¸¤ç§é¢å‘å­—ç¬¦ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Piped</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">PipedWriter</span> <span class="variable">out</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">PipedWriter</span>();</span><br><span class="line">        <span class="type">PipedReader</span> <span class="variable">in</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">PipedReader</span>();</span><br><span class="line">        <span class="comment">// å°†è¾“å‡ºæµå’Œè¾“å…¥æµè¿›è¡Œè¿æ¥ï¼Œå¦åˆ™åœ¨ä½¿ç”¨æ—¶ä¼šæŠ›å‡º IOException</span></span><br><span class="line">        out.connect(in);</span><br><span class="line">        <span class="type">Thread</span> <span class="variable">printThread</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Thread</span>(<span class="keyword">new</span> <span class="title class_">Print</span>(in), <span class="string">&quot;PrintThread&quot;</span>);</span><br><span class="line">        printThread.start();</span><br><span class="line">        <span class="type">int</span> <span class="variable">receive</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">while</span> ((receive = System.in.read()) != -<span class="number">1</span>) &#123;</span><br><span class="line">                out.write(receive);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            out.close();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Print</span> <span class="keyword">implements</span> <span class="title class_">Runnable</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> PipedReader in;</span><br><span class="line"></span><br><span class="line">        Print(PipedReader in) &#123;</span><br><span class="line">            <span class="built_in">this</span>.in = in;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">receive</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="keyword">while</span> ((receive = in.read()) != -<span class="number">1</span>) &#123;</span><br><span class="line">                    System.out.print((<span class="type">char</span>) receive);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="çº¿ç¨‹ç”Ÿå‘½å‘¨æœŸ"><a href="#çº¿ç¨‹ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="çº¿ç¨‹ç”Ÿå‘½å‘¨æœŸ"></a>çº¿ç¨‹ç”Ÿå‘½å‘¨æœŸ</h2><p><img src="https://raw.githubusercontent.com/dunwu/images/master/snap/202408290809602.png"></p>
<p><code>java.lang.Thread.State</code> ä¸­å®šä¹‰äº† <strong>6</strong> ç§ä¸åŒçš„çº¿ç¨‹çŠ¶æ€ï¼Œåœ¨ç»™å®šçš„ä¸€ä¸ªæ—¶åˆ»ï¼Œçº¿ç¨‹åªèƒ½å¤„äºå…¶ä¸­çš„ä¸€ä¸ªçŠ¶æ€ã€‚</p>
<p>ä»¥ä¸‹æ˜¯å„çŠ¶æ€çš„è¯´æ˜ï¼Œä»¥åŠçŠ¶æ€é—´çš„è”ç³»ï¼š</p>
<ul>
<li><strong>å¼€å§‹ï¼ˆNEWï¼‰</strong> - å°šæœªè°ƒç”¨ <code>start</code> æ–¹æ³•çš„çº¿ç¨‹å¤„äºæ­¤çŠ¶æ€ã€‚æ­¤çŠ¶æ€æ„å‘³ç€ï¼š<strong>åˆ›å»ºçš„çº¿ç¨‹å°šæœªå¯åŠ¨</strong>ã€‚</li>
<li><strong>å¯è¿è¡Œï¼ˆRUNNABLEï¼‰</strong> - å·²ç»è°ƒç”¨äº† <code>start</code> æ–¹æ³•çš„çº¿ç¨‹å¤„äºæ­¤çŠ¶æ€ã€‚æ­¤çŠ¶æ€æ„å‘³ç€ï¼Œ<strong>çº¿ç¨‹å·²ç»å‡†å¤‡å¥½äº†</strong>ï¼Œä¸€æ—¦è¢«çº¿ç¨‹è°ƒåº¦å™¨åˆ†é…äº† CPU æ—¶é—´ç‰‡ï¼Œå°±å¯ä»¥è¿è¡Œçº¿ç¨‹ã€‚<ul>
<li>åœ¨æ“ä½œç³»ç»Ÿå±‚é¢ï¼Œçº¿ç¨‹æœ‰ READY å’Œ RUNNING çŠ¶æ€ï¼›è€Œåœ¨ JVM å±‚é¢ï¼Œåªèƒ½çœ‹åˆ° RUNNABLE çŠ¶æ€ï¼Œæ‰€ä»¥ Java ç³»ç»Ÿä¸€èˆ¬å°†è¿™ä¸¤ä¸ªçŠ¶æ€ç»Ÿç§°ä¸º RUNNABLEï¼ˆè¿è¡Œä¸­ï¼‰ çŠ¶æ€ ã€‚</li>
</ul>
</li>
<li><strong>é˜»å¡ï¼ˆBLOCKEDï¼‰</strong> - æ­¤çŠ¶æ€æ„å‘³ç€ï¼š<strong>çº¿ç¨‹å¤„äºè¢«é˜»å¡çŠ¶æ€</strong>ã€‚è¡¨ç¤ºçº¿ç¨‹åœ¨ç­‰å¾… <code>synchronized</code> çš„éšå¼é”ï¼ˆMonitor lockï¼‰ã€‚<code>synchronized</code> ä¿®é¥°çš„æ–¹æ³•ã€ä»£ç å—åŒä¸€æ—¶åˆ»åªå…è®¸ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œï¼Œå…¶ä»–çº¿ç¨‹åªèƒ½ç­‰å¾…ï¼Œå³å¤„äºé˜»å¡çŠ¶æ€ã€‚å½“å ç”¨ <code>synchronized</code> éšå¼é”çš„çº¿ç¨‹é‡Šæ”¾é”ï¼Œå¹¶ä¸”ç­‰å¾…çš„çº¿ç¨‹è·å¾— <code>synchronized</code> éšå¼é”æ—¶ï¼Œå°±åˆä¼šä» <code>BLOCKED</code> è½¬æ¢åˆ° <code>RUNNABLE</code> çŠ¶æ€ã€‚</li>
<li><strong>ç­‰å¾…ï¼ˆWAITINGï¼‰</strong> - æ­¤çŠ¶æ€æ„å‘³ç€ï¼š<strong>çº¿ç¨‹æ— é™æœŸç­‰å¾…ï¼Œç›´åˆ°è¢«å…¶ä»–çº¿ç¨‹æ˜¾å¼åœ°å”¤é†’</strong>ã€‚ é˜»å¡å’Œç­‰å¾…çš„åŒºåˆ«åœ¨äºï¼Œé˜»å¡æ˜¯è¢«åŠ¨çš„ï¼Œå®ƒæ˜¯åœ¨ç­‰å¾…è·å– <code>synchronized</code> çš„éšå¼é”ã€‚è€Œç­‰å¾…æ˜¯ä¸»åŠ¨çš„ï¼Œé€šè¿‡è°ƒç”¨ <code>Object.wait</code> ç­‰æ–¹æ³•è¿›å…¥ã€‚<ul>
<li>è¿›å…¥ï¼š<code>Object.wait()</code>ï¼›é€€å‡ºï¼š<code>Object.notify</code> &#x2F; <code>Object.notifyAll</code></li>
<li>è¿›å…¥ï¼š<code>Thread.join()</code>ï¼›é€€å‡ºï¼šè¢«è°ƒç”¨çš„çº¿ç¨‹æ‰§è¡Œå®Œæ¯•</li>
<li>è¿›å…¥ï¼š<code>LockSupport.park()</code>ï¼›é€€å‡ºï¼š<code>LockSupport.unpark</code></li>
</ul>
</li>
<li><strong>å®šæ—¶ç­‰å¾…ï¼ˆTIMED_WAITINGï¼‰</strong> - ç­‰å¾…æŒ‡å®šæ—¶é—´çš„çŠ¶æ€ã€‚ä¸€ä¸ªçº¿ç¨‹å¤„äºå®šæ—¶ç­‰å¾…çŠ¶æ€ï¼Œæ˜¯ç”±äºæ‰§è¡Œäº†ä»¥ä¸‹æ–¹æ³•ä¸­çš„ä»»æ„æ–¹æ³•ï¼š<ul>
<li>è¿›å…¥ï¼š<code>Thread.sleep(long)</code>ï¼›é€€å‡ºï¼šæ—¶é—´ç»“æŸ</li>
<li>è¿›å…¥ï¼š<code>Object.wait(long)</code>ï¼›é€€å‡ºï¼šæ—¶é—´ç»“æŸ &#x2F; <code>Object.notify</code> &#x2F; <code>Object.notifyAll</code></li>
<li>è¿›å…¥ï¼š<code>Thread.join(long)</code>ï¼›é€€å‡ºï¼šæ—¶é—´ç»“æŸ &#x2F; è¢«è°ƒç”¨çš„çº¿ç¨‹æ‰§è¡Œå®Œæ¯•</li>
<li>è¿›å…¥ï¼š<code>LockSupport.parkNanos(long)</code>ï¼›é€€å‡ºï¼š<code>LockSupport.unpark</code></li>
<li>è¿›å…¥ï¼š<code>LockSupport.parkUntil(long)</code>ï¼›é€€å‡ºï¼š<code>LockSupport.unpark</code></li>
</ul>
</li>
<li><strong>ç»ˆæ­¢ (TERMINATED)</strong> - çº¿ç¨‹ <code>run()</code> æ–¹æ³•æ‰§è¡Œç»“æŸï¼Œæˆ–è€…å› å¼‚å¸¸é€€å‡ºäº† <code>run()</code> æ–¹æ³•ï¼Œåˆ™è¯¥çº¿ç¨‹ç»“æŸç”Ÿå‘½å‘¨æœŸã€‚æ­»äº¡çš„çº¿ç¨‹ä¸å¯å†æ¬¡å¤ç”Ÿã€‚</li>
</ul>
<blockquote>
<p>ğŸ‘‰ æ‰©å±•é˜…è¯»ï¼š</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.w3resource.com/java-tutorial/java-threadclass-methods-and-threadstates.php">Java Thread Methods and Thread States</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/pange1991/article/details/53860651">Java çº¿ç¨‹çš„ 5 ç§çŠ¶æ€åŠåˆ‡æ¢ï¼ˆé€å½»è®²è§£ï¼‰</a></li>
<li><a target="_blank" rel="noopener" href="https://www.zhihu.com/question/56494969/answer/154053599">Java çº¿ç¨‹è¿è¡Œæ€ä¹ˆæœ‰ç¬¬å…­ç§çŠ¶æ€ï¼Ÿ - Dawell çš„å›ç­”</a></li>
</ul>
</blockquote>
<h2 id="çº¿ç¨‹å¸¸è§é—®é¢˜"><a href="#çº¿ç¨‹å¸¸è§é—®é¢˜" class="headerlink" title="çº¿ç¨‹å¸¸è§é—®é¢˜"></a>çº¿ç¨‹å¸¸è§é—®é¢˜</h2><h3 id="çº¿ç¨‹å¯åŠ¨"><a href="#çº¿ç¨‹å¯åŠ¨" class="headerlink" title="çº¿ç¨‹å¯åŠ¨"></a>çº¿ç¨‹å¯åŠ¨</h3><p><strong>å…¸å‹é—®é¢˜</strong></p>
<p>ï¼ˆ1ï¼‰<code>Thread.start()</code> å’Œ <code>Thread.run()</code> æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</p>
<p>ï¼ˆ2ï¼‰å¯ä»¥ç›´æ¥è°ƒç”¨ <code>Thread.run()</code> æ–¹æ³•ä¹ˆï¼Ÿ</p>
<p>ï¼ˆ3ï¼‰ä¸€ä¸ªçº¿ç¨‹ä¸¤æ¬¡è°ƒç”¨ <code>Thread.start()</code> æ–¹æ³•ä¼šæ€æ ·</p>
<p><strong>çŸ¥è¯†ç‚¹</strong></p>
<p>ï¼ˆ1ï¼‰<code>Thread.start()</code> å’Œ <code>Thread.run()</code> çš„åŒºåˆ«ï¼š</p>
<ul>
<li><code>run()</code> æ–¹æ³•æ˜¯çº¿ç¨‹çš„æ‰§è¡Œä½“ã€‚</li>
<li><code>start()</code> æ–¹æ³•è´Ÿè´£å¯åŠ¨çº¿ç¨‹ï¼Œç„¶å JVM ä¼šè®©è¿™ä¸ªçº¿ç¨‹å»æ‰§è¡Œ <code>run()</code> æ–¹æ³•ã€‚</li>
</ul>
<p>ï¼ˆ2ï¼‰å¯ä»¥ç›´æ¥è°ƒç”¨ <code>Thread.run()</code> æ–¹æ³•ï¼Œä½†æ˜¯å®ƒçš„è¡Œä¸ºå’Œæ™®é€šæ–¹æ³•ä¸€æ ·ï¼Œä¸ä¼šå¯åŠ¨æ–°çº¿ç¨‹å»æ‰§è¡Œã€‚<strong>è°ƒç”¨ <code>start()</code> æ–¹æ³•æ–¹å¯å¯åŠ¨çº¿ç¨‹å¹¶ä½¿çº¿ç¨‹è¿›å…¥å°±ç»ªçŠ¶æ€ï¼Œç›´æ¥æ‰§è¡Œ <code>run()</code> æ–¹æ³•çš„è¯ä¸ä¼šä»¥å¤šçº¿ç¨‹çš„æ–¹å¼æ‰§è¡Œã€‚</strong></p>
<p>ï¼ˆ3ï¼‰Java çš„çº¿ç¨‹æ˜¯ä¸å…è®¸å¯åŠ¨ä¸¤æ¬¡çš„ï¼Œç¬¬äºŒæ¬¡è°ƒç”¨å¿…ç„¶ä¼šæŠ›å‡º <code>IllegalThreadStateException</code>ã€‚</p>
<h3 id="çº¿ç¨‹ç­‰å¾…"><a href="#çº¿ç¨‹ç­‰å¾…" class="headerlink" title="çº¿ç¨‹ç­‰å¾…"></a>çº¿ç¨‹ç­‰å¾…</h3><p><strong>å…¸å‹é—®é¢˜</strong></p>
<p>ï¼ˆ1ï¼‰<code>Thread.sleep()</code>ã€<code>Thread.yield()</code>ã€<code>Thread.join()</code>ã€<code>Object.wait()</code> æ–¹æ³•æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</p>
<p>ï¼ˆ2ï¼‰ä¸ºä»€ä¹ˆ <code>Thread.sleep()</code>ã€<code>Thread.yield()</code> è®¾è®¡ä¸ºé™æ€æ–¹æ³•ï¼Ÿ</p>
<p><strong>çŸ¥è¯†ç‚¹</strong></p>
<p>ï¼ˆ1ï¼‰<code>Thread.sleep()</code>ã€<code>Thread.yield()</code>ã€<code>Thread.join()</code> æ–¹æ³•çš„åŒºåˆ«ï¼š</p>
<ul>
<li><code>Thread.sleep()</code><ul>
<li><code>Thread.sleep()</code> æ–¹æ³•éœ€è¦æŒ‡å®šç­‰å¾…çš„æ—¶é—´ï¼Œå®ƒå¯ä»¥è®©å½“å‰æ­£åœ¨æ‰§è¡Œçš„çº¿ç¨‹åœ¨æŒ‡å®šçš„æ—¶é—´å†…æš‚åœæ‰§è¡Œï¼Œè¿›å…¥ <strong>TIMED_WAITING</strong> çŠ¶æ€ã€‚</li>
<li>è¯¥æ–¹æ³•æ—¢å¯ä»¥è®©å…¶ä»–åŒä¼˜å…ˆçº§æˆ–è€…é«˜ä¼˜å…ˆçº§çš„çº¿ç¨‹å¾—åˆ°æ‰§è¡Œçš„æœºä¼šï¼Œä¹Ÿå¯ä»¥è®©ä½ä¼˜å…ˆçº§çš„çº¿ç¨‹å¾—åˆ°æ‰§è¡Œæœºä¼šã€‚</li>
<li>ä½†æ˜¯ï¼Œ<code>Thread.sleep()</code> æ–¹æ³•ä¸ä¼šé‡Šæ”¾â€œé”æ ‡å¿—â€ï¼Œä¹Ÿå°±æ˜¯è¯´å¦‚æœæœ‰ <code>synchronized</code> åŒæ­¥å—ï¼Œå…¶ä»–çº¿ç¨‹ä»ç„¶ä¸èƒ½è®¿é—®å…±äº«æ•°æ®ã€‚</li>
</ul>
</li>
<li><code>Thread.yield()</code><ul>
<li><code>Thread.yield()</code> æ–¹æ³•å¯ä»¥è®©å½“å‰æ­£åœ¨æ‰§è¡Œçš„çº¿ç¨‹æš‚åœï¼Œä½†å®ƒä¸ä¼šé˜»å¡è¯¥çº¿ç¨‹ï¼Œå®ƒåªæ˜¯å°†è¯¥çº¿ç¨‹ä» <strong>RUNNING</strong> çŠ¶æ€è½¬å…¥ <strong>RUNNABLE</strong> çŠ¶æ€ã€‚</li>
<li>å½“æŸä¸ªçº¿ç¨‹è°ƒç”¨äº† <code>Thread.yield()</code> æ–¹æ³•æš‚åœä¹‹åï¼Œåªæœ‰ä¼˜å…ˆçº§å¤§äºç­‰äºå½“å‰çº¿ç¨‹çš„å¤„äºå°±ç»ªçŠ¶æ€çš„çº¿ç¨‹æ‰ä¼šè·å¾—æ‰§è¡Œçš„æœºä¼šã€‚</li>
</ul>
</li>
<li><code>Thread.join()</code><ul>
<li><code>Thread.join()</code> æ–¹æ³•ä¼šä½¿å½“å‰çº¿ç¨‹è½¬å…¥ <strong>WAITING</strong> æˆ– <strong>TIMED_WAITING</strong> çŠ¶æ€ï¼Œç­‰å¾…è°ƒç”¨ <code>Thread.join()</code> æ–¹æ³•çš„çº¿ç¨‹ç»“æŸåæ‰èƒ½ç»§ç»­æ‰§è¡Œã€‚</li>
</ul>
</li>
<li><code>Object.wait()</code><ul>
<li><code>Object.wait()</code> ç”¨äºä½¿å½“å‰çº¿ç¨‹ç­‰å¾…ï¼Œç›´åˆ°å…¶ä»–çº¿ç¨‹è°ƒç”¨ç›¸åŒå¯¹è±¡çš„ <code>Object.notify()</code> æˆ– <code>Object.notifyAll()</code> æ–¹æ³•å”¤é†’å®ƒã€‚</li>
<li>è°ƒç”¨ <code>Object.wait()</code> æ—¶ï¼Œçº¿ç¨‹ä¼šé‡Šæ”¾å¯¹è±¡é”ï¼Œå¹¶è¿›å…¥ç­‰å¾…çŠ¶æ€ã€‚</li>
</ul>
</li>
</ul>
<p>ï¼ˆ2ï¼‰ä¸ºä»€ä¹ˆ <code>Thread.sleep()</code>ã€<code>Thread.yield()</code> è®¾è®¡ä¸ºé™æ€æ–¹æ³•ï¼Ÿ</p>
<p><code>Thread.sleep()</code>ã€<code>Thread.yield()</code> é’ˆå¯¹çš„æ˜¯ <strong>RUNNING</strong> çŠ¶æ€çš„çº¿ç¨‹ï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨é <strong>RUNNING</strong> çŠ¶æ€çš„çº¿ç¨‹ä¸Šæ‰§è¡Œè¿™ä¸¤ä¸ªæ–¹æ³•æ²¡æœ‰æ„ä¹‰ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆè¿™ä¸¤ä¸ªæ–¹æ³•è¢«è®¾è®¡ä¸ºé™æ€çš„ã€‚å®ƒä»¬åªé’ˆå¯¹æ­£åœ¨ <strong>RUNNING</strong> çŠ¶æ€çš„çº¿ç¨‹å·¥ä½œï¼Œé¿å…ç¨‹åºå‘˜é”™è¯¯çš„è®¤ä¸ºå¯ä»¥åœ¨å…¶ä»–é <strong>RUNNING</strong> çŠ¶æ€çº¿ç¨‹ä¸Šè°ƒç”¨ã€‚</p>
<blockquote>
<p>ğŸ‘‰ æ‰©å±•é˜…è¯»ï¼š<a target="_blank" rel="noopener" href="http://www.importnew.com/14958.html">Java çº¿ç¨‹ä¸­ yield ä¸ join æ–¹æ³•çš„åŒºåˆ«</a><br>ğŸ‘‰ æ‰©å±•é˜…è¯»ï¼š<a target="_blank" rel="noopener" href="https://blog.csdn.net/xiangwanpeng/article/details/54972952">sleep()ï¼Œwait()ï¼Œyield() å’Œ join() æ–¹æ³•çš„åŒºåˆ«</a></p>
</blockquote>
<h3 id="çº¿ç¨‹é€šä¿¡-1"><a href="#çº¿ç¨‹é€šä¿¡-1" class="headerlink" title="çº¿ç¨‹é€šä¿¡"></a>çº¿ç¨‹é€šä¿¡</h3><p>çº¿ç¨‹é—´é€šä¿¡æ˜¯çº¿ç¨‹é—´å…±äº«èµ„æºçš„ä¸€ç§æ–¹å¼ã€‚<code>Object.wait()</code>, <code>Object.notify()</code> å’Œ <code>Object.notifyAll()</code> æ˜¯ç”¨äºçº¿ç¨‹ä¹‹é—´åä½œå’Œé€šä¿¡çš„æ–¹æ³•ï¼Œå®ƒä»¬é€šå¸¸ä¸<code>synchronized</code> å…³é”®å­—ä¸€èµ·ä½¿ç”¨æ¥å®ç°çº¿ç¨‹çš„åŒæ­¥ã€‚</p>
<p><strong>å…¸å‹é—®é¢˜</strong></p>
<p>ï¼ˆ1ï¼‰ä¸ºä»€ä¹ˆçº¿ç¨‹é€šä¿¡çš„æ–¹æ³• <code>Object.wait()</code>ã€<code>Object.notify()</code> å’Œ <code>Object.notifyAll()</code> è¢«å®šä¹‰åœ¨ <code>Object</code> ç±»é‡Œï¼Ÿ</p>
<p>ï¼ˆ2ï¼‰ä¸ºä»€ä¹ˆ <code>Object.wait()</code>ã€<code>Object.notify()</code> å’Œ <code>Object.notifyAll()</code> å¿…é¡»åœ¨ <code>synchronized</code> æ–¹æ³•&#x2F;å—ä¸­è¢«è°ƒç”¨ï¼Ÿ</p>
<p>ï¼ˆ3ï¼‰ <code>Object.wait()</code> å’Œ <code>Thread.sleep</code> æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</p>
<p><strong>çŸ¥è¯†ç‚¹</strong></p>
<p>ï¼ˆ1ï¼‰ä¸ºä»€ä¹ˆçº¿ç¨‹é€šä¿¡çš„æ–¹æ³• <code>Object.wait()</code>ã€<code>Object.notify()</code> å’Œ <code>Object.notifyAll()</code> è¢«å®šä¹‰åœ¨ <code>Object</code> ç±»é‡Œï¼Ÿ</p>
<p>Java çš„æ¯ä¸ªå¯¹è±¡ä¸­éƒ½æœ‰ä¸€ä¸ªç§°ä¹‹ä¸º monitor ç›‘è§†å™¨çš„é”ï¼Œç”±äºæ¯ä¸ªå¯¹è±¡éƒ½å¯ä»¥ä¸Šé”ï¼Œè¿™å°±è¦æ±‚åœ¨å¯¹è±¡å¤´ä¸­æœ‰ä¸€ä¸ªç”¨æ¥ä¿å­˜é”ä¿¡æ¯çš„ä½ç½®ã€‚è¿™ä¸ªé”æ˜¯å¯¹è±¡çº§åˆ«çš„ï¼Œè€Œéçº¿ç¨‹çº§åˆ«çš„ï¼Œwait&#x2F;notify&#x2F;notifyAll ä¹Ÿéƒ½æ˜¯é”çº§åˆ«çš„æ“ä½œï¼Œå®ƒä»¬çš„é”å±äºå¯¹è±¡ï¼Œæ‰€ä»¥æŠŠå®ƒä»¬å®šä¹‰åœ¨ Object ç±»ä¸­æ˜¯æœ€åˆé€‚ï¼Œå› ä¸º Object ç±»æ˜¯æ‰€æœ‰å¯¹è±¡çš„çˆ¶ç±»ã€‚</p>
<p>å¦‚æœæŠŠ wait&#x2F;notify&#x2F;notifyAll æ–¹æ³•å®šä¹‰åœ¨ Thread ç±»ä¸­ï¼Œä¼šå¸¦æ¥å¾ˆå¤§çš„å±€é™æ€§ï¼Œæ¯”å¦‚ä¸€ä¸ªçº¿ç¨‹å¯èƒ½æŒæœ‰å¤šæŠŠé”ï¼Œä»¥ä¾¿å®ç°ç›¸äº’é…åˆçš„å¤æ‚é€»è¾‘ï¼Œå‡è®¾æ­¤æ—¶ wait æ–¹æ³•å®šä¹‰åœ¨ Thread ç±»ä¸­ï¼Œå¦‚ä½•å®ç°è®©ä¸€ä¸ªçº¿ç¨‹æŒæœ‰å¤šæŠŠé”å‘¢ï¼Ÿåˆå¦‚ä½•æ˜ç¡®çº¿ç¨‹ç­‰å¾…çš„æ˜¯å“ªæŠŠé”å‘¢ï¼Ÿæ—¢ç„¶æˆ‘ä»¬æ˜¯è®©å½“å‰çº¿ç¨‹å»ç­‰å¾…æŸä¸ªå¯¹è±¡çš„é”ï¼Œè‡ªç„¶åº”è¯¥é€šè¿‡æ“ä½œå¯¹è±¡æ¥å®ç°ï¼Œè€Œä¸æ˜¯æ“ä½œçº¿ç¨‹ã€‚</p>
<ul>
<li><code>Object.wait()</code><ul>
<li><code>Object.wait()</code> æ–¹æ³•ç”¨äºä½¿å½“å‰çº¿ç¨‹è¿›å…¥ç­‰å¾…çŠ¶æ€ï¼Œç›´åˆ°å…¶ä»–çº¿ç¨‹è°ƒç”¨ç›¸åŒå¯¹è±¡çš„ <code>notify()</code> æˆ– <code>notifyAll()</code> æ–¹æ³•å”¤é†’å®ƒã€‚</li>
<li>åœ¨è°ƒç”¨ <code>wait()</code> æ–¹æ³•æ—¶ï¼Œçº¿ç¨‹ä¼šé‡Šæ”¾å¯¹è±¡çš„é”ï¼Œå¹¶è¿›å…¥ç­‰å¾…çŠ¶æ€ã€‚é€šå¸¸åœ¨ä½¿ç”¨ <code>wait()</code> æ–¹æ³•æ—¶éœ€è¦æ”¾åœ¨ä¸€ä¸ªå¾ªç¯ä¸­ï¼Œä»¥é¿å…è™šå‡å”¤é†’ï¼ˆspurious wakeupsï¼‰ã€‚</li>
</ul>
</li>
<li><code>Object.notify()</code><ul>
<li><code>Object.notify()</code> æ–¹æ³•ç”¨äºå”¤é†’æ­£åœ¨ç­‰å¾…è¯¥å¯¹è±¡çš„é”çš„ä¸€ä¸ªçº¿ç¨‹ã€‚</li>
<li>è¢«å”¤é†’çš„çº¿ç¨‹å°†ä¼šå°è¯•é‡æ–°è·å–å¯¹è±¡çš„é”ï¼Œä¸€æ—¦è·å–åˆ°é”ï¼Œå®ƒå°†ç»§ç»­æ‰§è¡Œã€‚</li>
</ul>
</li>
<li><code>Object.notifyAll()</code><ul>
<li><code>Object.notifyAll()</code> æ–¹æ³•ç”¨äºå”¤é†’æ­£åœ¨ç­‰å¾…è¯¥å¯¹è±¡çš„é”çš„æ‰€æœ‰çº¿ç¨‹ã€‚</li>
<li>æ‰€æœ‰è¢«å”¤é†’çš„çº¿ç¨‹å°†ä¼šç«äº‰å¯¹è±¡çš„é”ï¼Œä¸€æ—¦è·å–åˆ°é”ï¼Œå®ƒä»¬å°†ç»§ç»­æ‰§è¡Œã€‚</li>
</ul>
</li>
</ul>
<p>ï¼ˆ2ï¼‰ä¸ºä»€ä¹ˆ <code>Object.wait()</code>ã€<code>Object.notify()</code> å’Œ <code>Object.notifyAll()</code> å¿…é¡»åœ¨ <code>synchronized</code> æ–¹æ³•&#x2F;å—ä¸­è¢«è°ƒç”¨ï¼Ÿ</p>
<p>å½“ä¸€ä¸ªçº¿ç¨‹éœ€è¦è°ƒç”¨å¯¹è±¡çš„ <code>wait()</code> æ–¹æ³•çš„æ—¶å€™ï¼Œè¿™ä¸ªçº¿ç¨‹å¿…é¡»æ‹¥æœ‰è¯¥å¯¹è±¡çš„é”ï¼Œæ¥ç€å®ƒå°±ä¼šé‡Šæ”¾è¿™ä¸ªå¯¹è±¡é”å¹¶è¿›å…¥ç­‰å¾…çŠ¶æ€ç›´åˆ°å…¶ä»–çº¿ç¨‹è°ƒç”¨è¿™ä¸ªå¯¹è±¡ä¸Šçš„ <code>notify()</code> æ–¹æ³•ã€‚åŒæ ·çš„ï¼Œå½“ä¸€ä¸ªçº¿ç¨‹éœ€è¦è°ƒç”¨å¯¹è±¡çš„ <code>notify()</code> æ–¹æ³•æ—¶ï¼Œå®ƒä¼šé‡Šæ”¾è¿™ä¸ªå¯¹è±¡çš„é”ï¼Œä»¥ä¾¿å…¶ä»–åœ¨ç­‰å¾…çš„çº¿ç¨‹å°±å¯ä»¥å¾—åˆ°è¿™ä¸ªå¯¹è±¡é”ã€‚</p>
<p>ç”±äºæ‰€æœ‰çš„è¿™äº›æ–¹æ³•éƒ½éœ€è¦çº¿ç¨‹æŒæœ‰å¯¹è±¡çš„é”ï¼Œè¿™æ ·å°±åªèƒ½é€šè¿‡ <code>synchronized</code> æ¥å®ç°ï¼Œæ‰€ä»¥ä»–ä»¬åªèƒ½åœ¨ <code>synchronized</code> æ–¹æ³•&#x2F;å—ä¸­è¢«è°ƒç”¨ã€‚</p>
<p>ï¼ˆ3ï¼‰ <code>Object.wait()</code> å’Œ <code>Thread.sleep</code> æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</p>
<p>ç›¸åŒç‚¹ï¼š</p>
<ol>
<li>å®ƒä»¬éƒ½å¯ä»¥è®©çº¿ç¨‹é˜»å¡ã€‚</li>
<li>å®ƒä»¬éƒ½å¯ä»¥å“åº” interrupt ä¸­æ–­ï¼šåœ¨ç­‰å¾…çš„è¿‡ç¨‹ä¸­å¦‚æœæ”¶åˆ°ä¸­æ–­ä¿¡å·ï¼Œéƒ½å¯ä»¥è¿›è¡Œå“åº”ï¼Œå¹¶æŠ›å‡º InterruptedException å¼‚å¸¸ã€‚</li>
</ol>
<p>ä¸åŒç‚¹ï¼š</p>
<ol>
<li>wait æ–¹æ³•å¿…é¡»åœ¨ synchronized ä¿æŠ¤çš„ä»£ç ä¸­ä½¿ç”¨ï¼Œè€Œ sleep æ–¹æ³•å¹¶æ²¡æœ‰è¿™ä¸ªè¦æ±‚ã€‚</li>
<li>åœ¨åŒæ­¥ä»£ç ä¸­æ‰§è¡Œ sleep æ–¹æ³•æ—¶ï¼Œå¹¶ä¸ä¼šé‡Šæ”¾ monitor é”ï¼Œä½†æ‰§è¡Œ wait æ–¹æ³•æ—¶ä¼šä¸»åŠ¨é‡Šæ”¾ monitor é”ã€‚</li>
<li>sleep æ–¹æ³•ä¸­ä¼šè¦æ±‚å¿…é¡»å®šä¹‰ä¸€ä¸ªæ—¶é—´ï¼Œæ—¶é—´åˆ°æœŸåä¼šä¸»åŠ¨æ¢å¤ï¼Œè€Œå¯¹äºæ²¡æœ‰å‚æ•°çš„ wait æ–¹æ³•è€Œè¨€ï¼Œæ„å‘³ç€æ°¸ä¹…ç­‰å¾…ï¼Œç›´åˆ°è¢«ä¸­æ–­æˆ–è¢«å”¤é†’æ‰èƒ½æ¢å¤ï¼Œå®ƒå¹¶ä¸ä¼šä¸»åŠ¨æ¢å¤ã€‚</li>
<li>wait&#x2F;notify æ˜¯ Object ç±»çš„æ–¹æ³•ï¼Œè€Œ sleep æ˜¯ Thread ç±»çš„æ–¹æ³•ã€‚</li>
</ol>
<blockquote>
<p>ğŸ‘‰ æ‰©å±•é˜…è¯»ï¼š<a target="_blank" rel="noopener" href="http://www.cnblogs.com/dolphin0520/p/3920385.html">Java å¹¶å‘ç¼–ç¨‹ï¼šçº¿ç¨‹é—´åä½œçš„ä¸¤ç§æ–¹å¼ï¼šwaitã€notifyã€notifyAll å’Œ Condition</a></p>
</blockquote>
<h3 id="çº¿ç¨‹ä¼˜å…ˆçº§"><a href="#çº¿ç¨‹ä¼˜å…ˆçº§" class="headerlink" title="çº¿ç¨‹ä¼˜å…ˆçº§"></a>çº¿ç¨‹ä¼˜å…ˆçº§</h3><p><strong>å…¸å‹é—®é¢˜</strong></p>
<p>ï¼ˆ1ï¼‰Java çš„çº¿ç¨‹ä¼˜å…ˆçº§å¦‚ä½•æ§åˆ¶ï¼Ÿ</p>
<p>ï¼ˆ2ï¼‰é«˜ä¼˜å…ˆçº§çš„ Java çº¿ç¨‹ä¸€å®šå…ˆæ‰§è¡Œå—ï¼Ÿ</p>
<p><strong>çŸ¥è¯†ç‚¹</strong></p>
<p>ï¼ˆ1ï¼‰Java ä¸­çš„çº¿ç¨‹ä¼˜å…ˆçº§çš„èŒƒå›´æ˜¯ <code>[1,10]</code>ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œé«˜ä¼˜å…ˆçº§çš„çº¿ç¨‹åœ¨è¿è¡Œæ—¶ä¼šå…·æœ‰ä¼˜å…ˆæƒã€‚å¯ä»¥é€šè¿‡ <code>thread.setPriority(Thread.MAX_PRIORITY)</code> çš„æ–¹å¼è®¾ç½®ï¼Œé»˜è®¤ä¼˜å…ˆçº§ä¸º <code>5</code>ã€‚</p>
<p>ï¼ˆ2ï¼‰å³ä½¿è®¾ç½®äº†çº¿ç¨‹çš„ä¼˜å…ˆçº§ï¼Œä¹Ÿ<strong>æ— æ³•ä¿è¯é«˜ä¼˜å…ˆçº§çš„çº¿ç¨‹ä¸€å®šå…ˆæ‰§è¡Œ</strong>ã€‚</p>
<p>è¿™æ˜¯å› ä¸º <strong>Java çº¿ç¨‹ä¼˜å…ˆçº§ä¾èµ–äºæ“ä½œç³»ç»Ÿçš„æ”¯æŒ</strong>ï¼Œç„¶è€Œï¼Œä¸åŒçš„æ“ä½œç³»ç»Ÿæ”¯æŒçš„çº¿ç¨‹ä¼˜å…ˆçº§å¹¶ä¸ç›¸åŒï¼Œä¸èƒ½å¾ˆå¥½çš„å’Œ Java ä¸­çº¿ç¨‹ä¼˜å…ˆçº§ä¸€ä¸€å¯¹åº”ã€‚å› æ­¤ï¼ŒJava çº¿ç¨‹ä¼˜å…ˆçº§æ§åˆ¶å¹¶ä¸å¯é ã€‚</p>
<h3 id="å®ˆæŠ¤çº¿ç¨‹-1"><a href="#å®ˆæŠ¤çº¿ç¨‹-1" class="headerlink" title="å®ˆæŠ¤çº¿ç¨‹"></a>å®ˆæŠ¤çº¿ç¨‹</h3><p><strong>å…¸å‹é—®é¢˜</strong></p>
<p>ï¼ˆ1ï¼‰ä»€ä¹ˆæ˜¯å®ˆæŠ¤çº¿ç¨‹ï¼Ÿ</p>
<p>ï¼ˆ2ï¼‰å¦‚ä½•åˆ›å»ºå®ˆæŠ¤çº¿ç¨‹ï¼Ÿ</p>
<p><strong>çŸ¥è¯†ç‚¹</strong></p>
<p>ï¼ˆ1ï¼‰ä»€ä¹ˆæ˜¯å®ˆæŠ¤çº¿ç¨‹ï¼Ÿ</p>
<p>å®ˆæŠ¤çº¿ç¨‹ï¼ˆDaemon Threadï¼‰æ˜¯åœ¨åå°æ‰§è¡Œå¹¶ä¸”ä¸ä¼šé˜»æ­¢ JVM ç»ˆæ­¢çš„çº¿ç¨‹ã€‚ä¸å®ˆæŠ¤çº¿ç¨‹ï¼ˆDaemon Threadï¼‰ç›¸åçš„ï¼Œå«ç”¨æˆ·çº¿ç¨‹ï¼ˆUser Threadï¼‰ï¼Œä¹Ÿå°±æ˜¯éå®ˆæŠ¤çº¿ç¨‹ã€‚</p>
<p>å®ˆæŠ¤çº¿ç¨‹çš„ä¼˜å…ˆçº§æ¯”è¾ƒä½ï¼Œä¸€èˆ¬ç”¨äºä¸ºç³»ç»Ÿä¸­çš„å…¶å®ƒå¯¹è±¡å’Œçº¿ç¨‹æä¾›æœåŠ¡ã€‚å…¸å‹çš„åº”ç”¨å°±æ˜¯åƒåœ¾å›æ”¶å™¨ã€‚</p>
<p>ï¼ˆ2ï¼‰åˆ›å»ºå®ˆæŠ¤çº¿ç¨‹çš„æ–¹å¼ï¼š</p>
<ul>
<li>ä½¿ç”¨ <code>thread.setDaemon(true)</code> å¯ä»¥è®¾ç½® thread çº¿ç¨‹ä¸ºå®ˆæŠ¤çº¿ç¨‹ã€‚</li>
<li>æ­£åœ¨è¿è¡Œçš„ç”¨æˆ·çº¿ç¨‹æ— æ³•è®¾ç½®ä¸ºå®ˆæŠ¤çº¿ç¨‹ï¼Œæ‰€ä»¥ <code>thread.setDaemon(true)</code> å¿…é¡»åœ¨ <code>thread.start()</code> ä¹‹å‰è®¾ç½®ï¼Œå¦åˆ™ä¼šæŠ›å‡º <code>llegalThreadStateException</code> å¼‚å¸¸ï¼›</li>
<li>ä¸€ä¸ªå®ˆæŠ¤çº¿ç¨‹åˆ›å»ºçš„å­çº¿ç¨‹ä¾ç„¶æ˜¯å®ˆæŠ¤çº¿ç¨‹ã€‚</li>
<li>ä¸è¦è®¤ä¸ºæ‰€æœ‰çš„åº”ç”¨éƒ½å¯ä»¥åˆ†é…ç»™å®ˆæŠ¤çº¿ç¨‹æ¥è¿›è¡ŒæœåŠ¡ï¼Œæ¯”å¦‚è¯»å†™æ“ä½œæˆ–è€…è®¡ç®—é€»è¾‘ã€‚</li>
</ul>
<blockquote>
<p>ğŸ‘‰ æ‰©å±•é˜…è¯»ï¼š<a target="_blank" rel="noopener" href="https://blog.csdn.net/shimiso/article/details/8964414">Java ä¸­å®ˆæŠ¤çº¿ç¨‹çš„æ€»ç»“</a></p>
</blockquote>
<h3 id="çº¿ç¨‹æ•°"><a href="#çº¿ç¨‹æ•°" class="headerlink" title="çº¿ç¨‹æ•°"></a>çº¿ç¨‹æ•°</h3><p><strong>å…¸å‹é—®é¢˜</strong></p>
<p>ï¼ˆ1ï¼‰çº¿ç¨‹æ•°æ˜¯ä¸æ˜¯è¶Šå¤šè¶Šå¥½ï¼Ÿ</p>
<p>ï¼ˆ2ï¼‰åˆ›å»ºå¤šå°‘çº¿ç¨‹æ‰åˆé€‚ï¼Ÿ</p>
<p><strong>çŸ¥è¯†ç‚¹</strong></p>
<p>ä½¿ç”¨å¤šçº¿ç¨‹ï¼Œåˆè¡·æ˜¯ä¸ºäº†æå‡ç¨‹åºæ€§èƒ½ã€‚åº¦é‡æ€§èƒ½çš„æ ¸å¿ƒæŒ‡æ ‡æ˜¯<strong>å»¶è¿Ÿ</strong>å’Œ<strong>ååé‡</strong>ã€‚æ‰€è°“æå‡æ€§èƒ½ï¼Œä»åº¦é‡çš„è§’åº¦ï¼Œä¸»è¦æ˜¯<strong>é™ä½å»¶è¿Ÿï¼Œæé«˜ååé‡</strong>ã€‚åœ¨å¹¶å‘ç¼–ç¨‹é¢†åŸŸï¼Œæå‡æ€§èƒ½æœ¬è´¨ä¸Šå°±æ˜¯æå‡ç¡¬ä»¶çš„åˆ©ç”¨ç‡ï¼Œå†å…·ä½“ç‚¹æ¥è¯´ï¼Œå°±æ˜¯æå‡ I&#x2F;O çš„åˆ©ç”¨ç‡å’Œ CPU çš„åˆ©ç”¨ç‡ã€‚</p>
<p>å¤šçº¿ç¨‹å¹¶éè¶Šå¤šè¶Šå¥½ï¼Œè¿‡å¤šçš„çº¿ç¨‹å¯èƒ½ä¼šå¯¼è‡´è¿‡å¤šçš„ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œåè€Œé™ä½ç³»ç»Ÿæ€§èƒ½ã€‚ é€šå¸¸éœ€è¦æ ¹æ®æœåŠ¡å™¨ç¡¬ä»¶èµ„æºå’Œé¢„æœŸè´Ÿè½½æ¥åˆç†è®¾å®šçº¿ç¨‹æ•°å¤§å°ã€‚</p>
<p>ç¨‹åºä¸€èˆ¬éƒ½æ˜¯ CPU è®¡ç®—å’Œ I&#x2F;O æ“ä½œäº¤å‰æ‰§è¡Œçš„ï¼Œç”±äº I&#x2F;O è®¾å¤‡çš„é€Ÿåº¦ç›¸å¯¹äº CPU æ¥è¯´éƒ½å¾ˆæ…¢ï¼Œæ‰€ä»¥å¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼ŒI&#x2F;O æ“ä½œæ‰§è¡Œçš„æ—¶é—´ç›¸å¯¹äº CPU è®¡ç®—æ¥è¯´éƒ½éå¸¸é•¿ï¼Œè¿™ç§åœºæ™¯æˆ‘ä»¬ä¸€èˆ¬éƒ½ç§°ä¸º I&#x2F;O å¯†é›†å‹è®¡ç®—ï¼›å’Œ I&#x2F;O å¯†é›†å‹è®¡ç®—ç›¸å¯¹çš„å°±æ˜¯ CPU å¯†é›†å‹è®¡ç®—äº†ï¼ŒCPU å¯†é›†å‹è®¡ç®—å¤§éƒ¨åˆ†åœºæ™¯ä¸‹éƒ½æ˜¯çº¯ CPU è®¡ç®—ã€‚I&#x2F;O å¯†é›†å‹ç¨‹åºå’Œ CPU å¯†é›†å‹ç¨‹åºï¼Œè®¡ç®—æœ€ä½³çº¿ç¨‹æ•°çš„æ–¹æ³•æ˜¯ä¸åŒçš„ã€‚</p>
<p><strong>å¯¹äº CPU å¯†é›†å‹çš„è®¡ç®—åœºæ™¯ï¼Œç†è®ºä¸Šâ€œçº¿ç¨‹çš„æ•°é‡&#x3D;CPU æ ¸æ•°â€å°±æ˜¯æœ€åˆé€‚çš„</strong>ã€‚ä¸è¿‡åœ¨å·¥ç¨‹ä¸Šï¼Œ<strong>çº¿ç¨‹çš„æ•°é‡ä¸€èˆ¬ä¼šè®¾ç½®ä¸ºâ€œCPU æ ¸æ•°+1â€</strong>ï¼Œè¿™æ ·çš„è¯ï¼Œå½“çº¿ç¨‹å› ä¸ºå¶å°”çš„å†…å­˜é¡µå¤±æ•ˆæˆ–å…¶ä»–åŸå› å¯¼è‡´é˜»å¡æ—¶ï¼Œè¿™ä¸ªé¢å¤–çš„çº¿ç¨‹å¯ä»¥é¡¶ä¸Šï¼Œä»è€Œä¿è¯ CPU çš„åˆ©ç”¨ç‡ã€‚</p>
<p>å¯¹äº I&#x2F;O å¯†é›†å‹è®¡ç®—åœºæ™¯ï¼Œæœ€ä½³çš„çº¿ç¨‹æ•°æ˜¯ä¸ç¨‹åºä¸­ CPU è®¡ç®—å’Œ I&#x2F;O æ“ä½œçš„è€—æ—¶æ¯”ç›¸å…³çš„ï¼Œæˆ‘ä»¬å¯ä»¥æ€»ç»“å‡ºè¿™æ ·ä¸€ä¸ªå…¬å¼ï¼š</p>
<blockquote>
<p>æœ€ä½³çº¿ç¨‹æ•°&#x3D;1 +ï¼ˆI&#x2F;O è€—æ—¶ &#x2F; CPU è€—æ—¶ï¼‰</p>
</blockquote>
<h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><ul>
<li><a target="_blank" rel="noopener" href="https://book.douban.com/subject/10484692/">ã€ŠJava å¹¶å‘ç¼–ç¨‹å®æˆ˜ã€‹</a></li>
<li><a target="_blank" rel="noopener" href="https://book.douban.com/subject/26591326/">ã€ŠJava å¹¶å‘ç¼–ç¨‹çš„è‰ºæœ¯ã€‹</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/yaosiming2011/article/details/44280797">è¿›ç¨‹å’Œçº¿ç¨‹å…³ç³»åŠåŒºåˆ«</a></li>
<li><a target="_blank" rel="noopener" href="http://www.importnew.com/14958.html">Java çº¿ç¨‹ä¸­ yield ä¸ join æ–¹æ³•çš„åŒºåˆ«</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/xiangwanpeng/article/details/54972952">sleep()ï¼Œwait()ï¼Œyield() å’Œ join() æ–¹æ³•çš„åŒºåˆ«</a></li>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/dolphin0520/p/3920385.html">Java å¹¶å‘ç¼–ç¨‹ï¼šçº¿ç¨‹é—´åä½œçš„ä¸¤ç§æ–¹å¼ï¼šwaitã€notifyã€notifyAll å’Œ Condition</a></li>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/dolphin0520/p/3949310.html">Java å¹¶å‘ç¼–ç¨‹ï¼šCallableã€Future å’Œ FutureTask</a></li>
<li><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/27406200/visualvm-thread-states">StackOverflow VisualVM - Thread States</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/shimiso/article/details/8964414">Java ä¸­å®ˆæŠ¤çº¿ç¨‹çš„æ€»ç»“</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/CyC2018/CS-Notes/blob/master/notes/Java%20%E5%B9%B6%E5%8F%91.md">Java å¹¶å‘</a></li>
<li><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/2779484/why-must-wait-always-be-in-synchronized-block">Why must wait() always be in synchronized block</a></li>
<li><a target="_blank" rel="noopener" href="https://www.w3resource.com/java-tutorial/java-threadclass-methods-and-threadstates.php">Java Thread Methods and Thread States</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/pange1991/article/details/53860651">Java çº¿ç¨‹çš„ 5 ç§çŠ¶æ€åŠåˆ‡æ¢ï¼ˆé€å½»è®²è§£ï¼‰</a></li>
<li><a target="_blank" rel="noopener" href="https://www.zhihu.com/question/56494969/answer/154053599">Java çº¿ç¨‹è¿è¡Œæ€ä¹ˆæœ‰ç¬¬å…­ç§çŠ¶æ€ï¼Ÿ - Dawell çš„å›ç­”</a></li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://dunwu.github.io/blog/pages/84721ba0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/blog/uploads/avatar.gif">
      <meta itemprop="name" content="é’æ‚Ÿ â—¾ Dunwu">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Dunwu Blog">
      <meta itemprop="description" content="é’æ‚Ÿçš„ä¸ªäººåšå®¢">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content=" | Dunwu Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/blog/pages/84721ba0/" class="post-title-link" itemprop="url">Java å¹¶å‘ä¹‹çº¿ç¨‹æ± </a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">å‘è¡¨äº</span>

      <time title="åˆ›å»ºæ—¶é—´ï¼š2019-12-24 23:52:25" itemprop="dateCreated datePublished" datetime="2019-12-24T23:52:25+08:00">2019-12-24</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">æ›´æ–°äº</span>
      <time title="ä¿®æ”¹æ—¶é—´ï¼š2025-09-13 17:56:53" itemprop="dateModified" datetime="2025-09-13T17:56:53+08:00">2025-09-13</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">åˆ†ç±»äº</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/blog/categories/Java/" itemprop="url" rel="index"><span itemprop="name">Java</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/blog/categories/Java/JavaCore/" itemprop="url" rel="index"><span itemprop="name">JavaCore</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/blog/categories/Java/JavaCore/%E5%B9%B6%E5%8F%91/" itemprop="url" rel="index"><span itemprop="name">å¹¶å‘</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
      <span>21k</span>
    </span>
    <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
      <span>19 åˆ†é’Ÿ</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="Java-å¹¶å‘ä¹‹çº¿ç¨‹æ± "><a href="#Java-å¹¶å‘ä¹‹çº¿ç¨‹æ± " class="headerlink" title="Java å¹¶å‘ä¹‹çº¿ç¨‹æ± "></a>Java å¹¶å‘ä¹‹çº¿ç¨‹æ± </h1><h2 id="çº¿ç¨‹æ± ç®€ä»‹"><a href="#çº¿ç¨‹æ± ç®€ä»‹" class="headerlink" title="çº¿ç¨‹æ± ç®€ä»‹"></a>çº¿ç¨‹æ± ç®€ä»‹</h2><p>çº¿ç¨‹æ± å°±æ˜¯ç®¡ç†ä¸€ç³»åˆ—çº¿ç¨‹çš„èµ„æºæ± ï¼Œå…¶æä¾›äº†ä¸€ç§é™åˆ¶å’Œç®¡ç†çº¿ç¨‹èµ„æºçš„æ–¹å¼ã€‚æ¯ä¸ªçº¿ç¨‹æ± è¿˜ç»´æŠ¤ä¸€äº›åŸºæœ¬ç»Ÿè®¡ä¿¡æ¯ï¼Œä¾‹å¦‚å·²å®Œæˆä»»åŠ¡çš„æ•°é‡ã€‚</p>
<p>å¦‚æœå¹¶å‘è¯·æ±‚æ•°é‡å¾ˆå¤šï¼Œä½†æ¯ä¸ªçº¿ç¨‹æ‰§è¡Œçš„æ—¶é—´å¾ˆçŸ­ï¼Œå°±ä¼šå‡ºç°é¢‘ç¹çš„åˆ›å»ºå’Œé”€æ¯çº¿ç¨‹ã€‚å¦‚æ­¤ä¸€æ¥ï¼Œä¼šå¤§å¤§é™ä½ç³»ç»Ÿçš„æ•ˆç‡ï¼Œå¯èƒ½é¢‘ç¹åˆ›å»ºå’Œé”€æ¯çº¿ç¨‹çš„æ—¶é—´ã€èµ„æºå¼€é”€è¦å¤§äºå®é™…å·¥ä½œçš„æ‰€éœ€ã€‚</p>
<p>ä½¿ç”¨ <strong>çº¿ç¨‹æ± çš„å¥½å¤„</strong> æœ‰ä»¥ä¸‹å‡ ç‚¹ï¼š</p>
<ul>
<li><strong>é™ä½èµ„æºæ¶ˆè€—</strong> - é€šè¿‡é‡å¤åˆ©ç”¨å·²åˆ›å»ºçš„çº¿ç¨‹é™ä½çº¿ç¨‹åˆ›å»ºå’Œé”€æ¯é€ æˆçš„æ¶ˆè€—ã€‚</li>
<li><strong>æé«˜å“åº”é€Ÿåº¦</strong> - å½“ä»»åŠ¡åˆ°è¾¾æ—¶ï¼Œä»»åŠ¡å¯ä»¥ä¸éœ€è¦ç­‰åˆ°çº¿ç¨‹åˆ›å»ºå°±èƒ½ç«‹å³æ‰§è¡Œã€‚</li>
<li><strong>æé«˜çº¿ç¨‹çš„å¯ç®¡ç†æ€§</strong> - çº¿ç¨‹æ˜¯ç¨€ç¼ºèµ„æºï¼Œå¦‚æœæ— é™åˆ¶çš„åˆ›å»ºï¼Œä¸ä»…ä¼šæ¶ˆè€—ç³»ç»Ÿèµ„æºï¼Œè¿˜ä¼šé™ä½ç³»ç»Ÿçš„ç¨³å®šæ€§ï¼Œä½¿ç”¨çº¿ç¨‹æ± å¯ä»¥è¿›è¡Œç»Ÿä¸€çš„åˆ†é…ï¼Œè°ƒä¼˜å’Œç›‘æ§ã€‚</li>
</ul>
<h2 id="Executor-æ¡†æ¶"><a href="#Executor-æ¡†æ¶" class="headerlink" title="Executor æ¡†æ¶"></a>Executor æ¡†æ¶</h2><p>Executor æ¡†æ¶æ˜¯ä¸€ä¸ªæ ¹æ®ä¸€ç»„æ‰§è¡Œç­–ç•¥è°ƒç”¨ï¼Œè°ƒåº¦ï¼Œæ‰§è¡Œå’Œæ§åˆ¶çš„å¼‚æ­¥ä»»åŠ¡çš„æ¡†æ¶ï¼Œç›®çš„æ˜¯æä¾›ä¸€ç§å°†â€ä»»åŠ¡æäº¤â€ä¸â€ä»»åŠ¡å¦‚ä½•è¿è¡Œâ€åˆ†ç¦»å¼€æ¥çš„æœºåˆ¶ã€‚</p>
<p>é€šè¿‡ <code>Executor</code> æ¥å¯åŠ¨çº¿ç¨‹æ¯”ä½¿ç”¨ <code>Thread</code> çš„ <code>start</code> æ–¹æ³•æ›´å¥½ï¼Œé™¤äº†æ›´æ˜“ç®¡ç†ï¼Œæ•ˆç‡æ›´å¥½ï¼ˆç”¨çº¿ç¨‹æ± å®ç°ï¼ŒèŠ‚çº¦å¼€é”€ï¼‰å¤–ï¼Œè¿˜æœ‰å…³é”®çš„ä¸€ç‚¹ï¼šæœ‰åŠ©äºé¿å… this é€ƒé€¸é—®é¢˜ã€‚</p>
<blockquote>
<p>this é€ƒé€¸æ˜¯æŒ‡åœ¨æ„é€ å‡½æ•°è¿”å›ä¹‹å‰å…¶ä»–çº¿ç¨‹å°±æŒæœ‰è¯¥å¯¹è±¡çš„å¼•ç”¨ï¼Œè°ƒç”¨å°šæœªæ„é€ å®Œå…¨çš„å¯¹è±¡çš„æ–¹æ³•å¯èƒ½å¼•å‘ä»¤äººç–‘æƒ‘çš„é”™è¯¯ã€‚</p>
</blockquote>
<h3 id="æ ¸å¿ƒ-API-æ¦‚è¿°"><a href="#æ ¸å¿ƒ-API-æ¦‚è¿°" class="headerlink" title="æ ¸å¿ƒ API æ¦‚è¿°"></a>æ ¸å¿ƒ API æ¦‚è¿°</h3><p>Executor æ¡†æ¶æ ¸å¿ƒ API å¦‚ä¸‹ï¼š</p>
<ul>
<li><code>Executor</code> - è¿è¡Œä»»åŠ¡çš„æ¥å£ã€‚</li>
<li><code>ExecutorService</code> - æ‰©å±•äº† <code>Executor</code> æ¥å£ã€‚æ‰©å±•èƒ½åŠ›ï¼š<ul>
<li>æ”¯æŒæœ‰è¿”å›å€¼çš„çº¿ç¨‹ï¼›</li>
<li>æ”¯æŒç®¡ç†çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸã€‚</li>
</ul>
</li>
<li><code>ScheduledExecutorService</code> - æ‰©å±•äº† <code>ExecutorService</code> æ¥å£ï¼Œæ”¯æŒå®šæ—¶è°ƒåº¦ä»»åŠ¡ã€‚</li>
<li><code>AbstractExecutorService</code> - <code>ExecutorService</code> æ¥å£çš„é»˜è®¤å®ç°ã€‚</li>
<li><code>ThreadPoolExecutor</code> - Executor æ¡†æ¶æœ€æ ¸å¿ƒçš„ç±»ï¼Œå®ƒç»§æ‰¿äº† <code>AbstractExecutorService</code> ç±»ã€‚</li>
<li><code>ScheduledThreadPoolExecutor</code> - <code>ScheduledExecutorService</code> æ¥å£çš„å®ç°ï¼Œä¸€ä¸ªå¯å®šæ—¶è°ƒåº¦ä»»åŠ¡çš„çº¿ç¨‹æ± ã€‚</li>
<li><code>Executors</code> - å¯ä»¥é€šè¿‡è°ƒç”¨ <code>Executors</code> çš„é™æ€å·¥å‚æ–¹æ³•æ¥åˆ›å»ºçº¿ç¨‹æ± å¹¶è¿”å›ä¸€ä¸ª <code>ExecutorService</code> å¯¹è±¡ã€‚</li>
</ul>
<p><img src="https://raw.githubusercontent.com/dunwu/images/master/cs/java/javacore/concurrent/exexctor-uml.png" alt="img"></p>
<h3 id="Executor"><a href="#Executor" class="headerlink" title="Executor"></a>Executor</h3><p><code>Executor</code> æ¥å£ä¸­åªå®šä¹‰äº†ä¸€ä¸ª <code>execute</code> æ–¹æ³•ï¼Œç”¨äºæ¥æ”¶ä¸€ä¸ª <code>Runnable</code> å¯¹è±¡ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Executor</span> &#123;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">execute</span><span class="params">(Runnable command)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="ExecutorService"><a href="#ExecutorService" class="headerlink" title="ExecutorService"></a>ExecutorService</h3><p><code>ExecutorService</code> æ¥å£ç»§æ‰¿äº† <code>Executor</code> æ¥å£ï¼Œå®ƒè¿˜æä¾›äº† <code>invokeAll</code>ã€<code>invokeAny</code>ã€<code>shutdown</code>ã€<code>submit</code> ç­‰æ–¹æ³•ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">ExecutorService</span> <span class="keyword">extends</span> <span class="title class_">Executor</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">shutdown</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    List&lt;Runnable&gt; <span class="title function_">shutdownNow</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="type">boolean</span> <span class="title function_">isShutdown</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="type">boolean</span> <span class="title function_">isTerminated</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="type">boolean</span> <span class="title function_">awaitTermination</span><span class="params">(<span class="type">long</span> timeout, TimeUnit unit)</span></span><br><span class="line">        <span class="keyword">throws</span> InterruptedException;</span><br><span class="line"></span><br><span class="line">    &lt;T&gt; Future&lt;T&gt; <span class="title function_">submit</span><span class="params">(Callable&lt;T&gt; task)</span>;</span><br><span class="line"></span><br><span class="line">    &lt;T&gt; Future&lt;T&gt; <span class="title function_">submit</span><span class="params">(Runnable task, T result)</span>;</span><br><span class="line"></span><br><span class="line">    Future&lt;?&gt; submit(Runnable task);</span><br><span class="line"></span><br><span class="line">    &lt;T&gt; List&lt;Future&lt;T&gt;&gt; <span class="title function_">invokeAll</span><span class="params">(Collection&lt;? extends Callable&lt;T&gt;&gt; tasks)</span></span><br><span class="line">        <span class="keyword">throws</span> InterruptedException;</span><br><span class="line"></span><br><span class="line">    &lt;T&gt; List&lt;Future&lt;T&gt;&gt; <span class="title function_">invokeAll</span><span class="params">(Collection&lt;? extends Callable&lt;T&gt;&gt; tasks,</span></span><br><span class="line"><span class="params">                                  <span class="type">long</span> timeout, TimeUnit unit)</span></span><br><span class="line">        <span class="keyword">throws</span> InterruptedException;</span><br><span class="line"></span><br><span class="line">    &lt;T&gt; T <span class="title function_">invokeAny</span><span class="params">(Collection&lt;? extends Callable&lt;T&gt;&gt; tasks)</span></span><br><span class="line">        <span class="keyword">throws</span> InterruptedException, ExecutionException;</span><br><span class="line"></span><br><span class="line">    &lt;T&gt; T <span class="title function_">invokeAny</span><span class="params">(Collection&lt;? extends Callable&lt;T&gt;&gt; tasks,</span></span><br><span class="line"><span class="params">                    <span class="type">long</span> timeout, TimeUnit unit)</span></span><br><span class="line">        <span class="keyword">throws</span> InterruptedException, ExecutionException, TimeoutException;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä»å…¶æ”¯æŒçš„æ–¹æ³•å®šä¹‰ï¼Œä¸éš¾çœ‹å‡ºï¼šç›¸æ¯”äº <code>Executor</code> æ¥å£ï¼Œ<code>ExecutorService</code> æ¥å£ä¸»è¦çš„æ‰©å±•æ˜¯ï¼š</p>
<ul>
<li>æ”¯æŒæœ‰è¿”å›å€¼çš„çº¿ç¨‹ - <code>sumbit</code>ã€<code>invokeAll</code>ã€<code>invokeAny</code> æ–¹æ³•ä¸­éƒ½æ”¯æŒä¼ å…¥<code>Callable</code> å¯¹è±¡ã€‚</li>
<li>æ”¯æŒç®¡ç†çº¿ç¨‹ç”Ÿå‘½å‘¨æœŸ - <code>shutdown</code>ã€<code>shutdownNow</code>ã€<code>isShutdown</code> ç­‰æ–¹æ³•ã€‚</li>
</ul>
<h3 id="ScheduledExecutorService"><a href="#ScheduledExecutorService" class="headerlink" title="ScheduledExecutorService"></a>ScheduledExecutorService</h3><p><code>ScheduledExecutorService</code> æ¥å£æ‰©å±•äº† <code>ExecutorService</code> æ¥å£ã€‚</p>
<p>å®ƒé™¤äº†æ”¯æŒå‰é¢ä¸¤ä¸ªæ¥å£çš„æ‰€æœ‰èƒ½åŠ›ä»¥å¤–ï¼Œè¿˜æ”¯æŒå®šæ—¶è°ƒåº¦çº¿ç¨‹ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">ScheduledExecutorService</span> <span class="keyword">extends</span> <span class="title class_">ExecutorService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> ScheduledFuture&lt;?&gt; schedule(Runnable command,</span><br><span class="line">                                       <span class="type">long</span> delay, TimeUnit unit);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> &lt;V&gt; ScheduledFuture&lt;V&gt; <span class="title function_">schedule</span><span class="params">(Callable&lt;V&gt; callable,</span></span><br><span class="line"><span class="params">                                           <span class="type">long</span> delay, TimeUnit unit)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> ScheduledFuture&lt;?&gt; scheduleAtFixedRate(Runnable command,</span><br><span class="line">                                                  <span class="type">long</span> initialDelay,</span><br><span class="line">                                                  <span class="type">long</span> period,</span><br><span class="line">                                                  TimeUnit unit);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> ScheduledFuture&lt;?&gt; scheduleWithFixedDelay(Runnable command,</span><br><span class="line">                                                     <span class="type">long</span> initialDelay,</span><br><span class="line">                                                     <span class="type">long</span> delay,</span><br><span class="line">                                                     TimeUnit unit);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å…¶æ‰©å±•çš„æ¥å£æä¾›ä»¥ä¸‹èƒ½åŠ›ï¼š</p>
<ul>
<li><code>schedule</code> æ–¹æ³•å¯ä»¥åœ¨æŒ‡å®šçš„å»¶æ—¶åæ‰§è¡Œä¸€ä¸ª <code>Runnable</code> æˆ–è€… <code>Callable</code> ä»»åŠ¡ã€‚</li>
<li><code>scheduleAtFixedRate</code> æ–¹æ³•å’Œ <code>scheduleWithFixedDelay</code> æ–¹æ³•å¯ä»¥æŒ‰ç…§æŒ‡å®šæ—¶é—´é—´éš”ï¼Œå®šæœŸæ‰§è¡Œä»»åŠ¡ã€‚</li>
</ul>
<h2 id="ThreadPoolExecutor"><a href="#ThreadPoolExecutor" class="headerlink" title="ThreadPoolExecutor"></a>ThreadPoolExecutor</h2><p><code>java.uitl.concurrent.ThreadPoolExecutor</code> ç±»æ˜¯ <code>Executor</code> æ¡†æ¶ä¸­æœ€æ ¸å¿ƒçš„ç±»ã€‚</p>
<h3 id="æ„é€ æ–¹æ³•"><a href="#æ„é€ æ–¹æ³•" class="headerlink" title="æ„é€ æ–¹æ³•"></a>æ„é€ æ–¹æ³•</h3><p><code>ThreadPoolExecutor</code> æœ‰å››ä¸ªæ„é€ æ–¹æ³•ï¼Œå‰ä¸‰ä¸ªéƒ½æ˜¯åŸºäºç¬¬å››ä¸ªå®ç°ã€‚ç¬¬å››ä¸ªæ„é€ æ–¹æ³•å®šä¹‰å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="title function_">ThreadPoolExecutor</span><span class="params">(<span class="type">int</span> corePoolSize,// çº¿ç¨‹æ± çš„æ ¸å¿ƒçº¿ç¨‹æ•°é‡</span></span><br><span class="line"><span class="params">						  <span class="type">int</span> maximumPoolSize,// çº¿ç¨‹æ± çš„æœ€å¤§çº¿ç¨‹æ•°</span></span><br><span class="line"><span class="params">						  <span class="type">long</span> keepAliveTime,// å½“çº¿ç¨‹æ•°å¤§äºæ ¸å¿ƒçº¿ç¨‹æ•°æ—¶ï¼Œå¤šä½™çš„ç©ºé—²çº¿ç¨‹å­˜æ´»çš„æœ€é•¿æ—¶é—´</span></span><br><span class="line"><span class="params">						  TimeUnit unit,// æ—¶é—´å•ä½</span></span><br><span class="line"><span class="params">						  BlockingQueue&lt;Runnable&gt; workQueue,// ä»»åŠ¡é˜Ÿåˆ—ï¼Œç”¨æ¥å‚¨å­˜ç­‰å¾…æ‰§è¡Œä»»åŠ¡çš„é˜Ÿåˆ—</span></span><br><span class="line"><span class="params">						  ThreadFactory threadFactory,// çº¿ç¨‹å·¥å‚ï¼Œç”¨æ¥åˆ›å»ºçº¿ç¨‹ï¼Œä¸€èˆ¬é»˜è®¤å³å¯</span></span><br><span class="line"><span class="params">						  RejectedExecutionHandler handler// æ‹’ç»ç­–ç•¥ï¼Œå½“æäº¤çš„ä»»åŠ¡è¿‡å¤šè€Œä¸èƒ½åŠæ—¶å¤„ç†æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥å®šåˆ¶ç­–ç•¥æ¥å¤„ç†ä»»åŠ¡</span></span><br><span class="line"><span class="params">)</span> &#123;<span class="comment">// ç•¥&#125;</span></span><br></pre></td></tr></table></figure>

<p>å‚æ•°è¯´æ˜ï¼š</p>
<ul>
<li><strong><code>corePoolSize</code></strong> - <strong>è¡¨ç¤ºçº¿ç¨‹æ± ä¿æœ‰çš„æœ€å°çº¿ç¨‹æ•°</strong>ã€‚</li>
<li><strong><code>maximumPoolSize</code></strong> - <strong>è¡¨ç¤ºçº¿ç¨‹æ± å…è®¸åˆ›å»ºçš„æœ€å¤§çº¿ç¨‹æ•°</strong>ã€‚<ul>
<li>å¦‚æœé˜Ÿåˆ—æ»¡äº†ï¼Œå¹¶ä¸”å·²åˆ›å»ºçš„çº¿ç¨‹æ•°å°äºæœ€å¤§çº¿ç¨‹æ•°ï¼Œåˆ™çº¿ç¨‹æ± ä¼šå†åˆ›å»ºæ–°çš„çº¿ç¨‹æ‰§è¡Œä»»åŠ¡ã€‚</li>
<li>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼šå¦‚æœä½¿ç”¨äº†æ— ç•Œçš„ä»»åŠ¡é˜Ÿåˆ—è¿™ä¸ªå‚æ•°å°±æ²¡ä»€ä¹ˆæ•ˆæœã€‚</li>
</ul>
</li>
<li><strong><code>keepAliveTime &amp; unit</code></strong> - <strong>è¡¨ç¤ºçº¿ç¨‹ä¿æŒæ´»åŠ¨çš„æ—¶é—´</strong>ã€‚å¦‚æœä¸€ä¸ªçº¿ç¨‹ç©ºé—²äº†<code>keepAliveTime &amp; unit</code> è¿™ä¹ˆä¹…ï¼Œè€Œä¸”çº¿ç¨‹æ± çš„çº¿ç¨‹æ•°å¤§äº <code>corePoolSize</code> ï¼Œé‚£ä¹ˆè¿™ä¸ªç©ºé—²çš„çº¿ç¨‹å°±è¦è¢«å›æ”¶äº†ã€‚</li>
<li><strong><code>workQueue</code></strong> - <strong>ç­‰å¾…æ‰§è¡Œçš„ä»»åŠ¡é˜Ÿåˆ—</strong>ã€‚ç”¨äºä¿å­˜ç­‰å¾…æ‰§è¡Œçš„ä»»åŠ¡çš„é˜»å¡é˜Ÿåˆ—ã€‚ å¯ä»¥é€‰æ‹©ä»¥ä¸‹å‡ ä¸ªé˜»å¡é˜Ÿåˆ—ã€‚<ul>
<li><strong><code>ArrayBlockingQueue</code></strong> - <strong>æœ‰ç•Œé˜»å¡é˜Ÿåˆ—</strong>ã€‚</li>
<li><strong><code>LinkedBlockingQueue</code></strong> - <strong>æ— ç•Œé˜»å¡é˜Ÿåˆ—</strong>ã€‚</li>
<li><strong><code>SynchronousQueue</code></strong> - <strong>ä¸ä¼šä¿å­˜æäº¤çš„ä»»åŠ¡ï¼Œè€Œæ˜¯å°†ç›´æ¥æ–°å»ºä¸€ä¸ªçº¿ç¨‹æ¥æ‰§è¡Œæ–°æ¥çš„ä»»åŠ¡</strong>ã€‚</li>
<li><strong><code>DelayedWorkQueue</code></strong> - å»¶è¿Ÿé˜»å¡é˜Ÿåˆ—ã€‚</li>
<li><strong><code>PriorityBlockingQueue</code></strong> - <strong>å…·æœ‰ä¼˜å…ˆçº§çš„æ— ç•Œé˜»å¡é˜Ÿåˆ—</strong>ã€‚</li>
</ul>
</li>
<li><strong><code>threadFactory</code></strong> - <strong>çº¿ç¨‹å·¥å‚</strong>ã€‚çº¿ç¨‹å·¥ç¨‹ç”¨äºè‡ªå®šä¹‰å¦‚ä½•åˆ›å»ºçº¿ç¨‹ã€‚</li>
<li><strong><code>handler</code></strong> - <strong>æ‹’ç»ç­–ç•¥</strong>ã€‚å®ƒæ˜¯ <code>RejectedExecutionHandler</code> ç±»å‹çš„å˜é‡ã€‚å½“é˜Ÿåˆ—å’Œçº¿ç¨‹æ± éƒ½æ»¡äº†ï¼Œè¯´æ˜çº¿ç¨‹æ± å¤„äºé¥±å’ŒçŠ¶æ€ï¼Œé‚£ä¹ˆå¿…é¡»é‡‡å–ä¸€ç§ç­–ç•¥å¤„ç†æäº¤çš„æ–°ä»»åŠ¡ã€‚çº¿ç¨‹æ± æ”¯æŒä»¥ä¸‹ç­–ç•¥ï¼š<ul>
<li><strong><code>AbortPolicy</code></strong> - <strong>ä¸¢å¼ƒä»»åŠ¡å¹¶æŠ›å‡ºå¼‚å¸¸</strong>ã€‚è¿™ä¹Ÿæ˜¯é»˜è®¤ç­–ç•¥ï¼Œä¼šæŠ›å‡º <code>RejectedExecutionException</code>ã€‚</li>
<li><strong><code>DiscardPolicy</code></strong> - <strong>ä¸¢å¼ƒä»»åŠ¡ä½†ä¸æŠ›å‡ºå¼‚å¸¸</strong>ã€‚</li>
<li><strong><code>DiscardOldestPolicy</code></strong> - <strong>ä¸¢å¼ƒé˜Ÿåˆ—æœ€è€çš„ä»»åŠ¡</strong>ï¼Œå…¶å®å°±æ˜¯æŠŠæœ€æ—©è¿›å…¥å·¥ä½œé˜Ÿåˆ—çš„ä»»åŠ¡ä¸¢å¼ƒï¼Œç„¶åæŠŠæ–°ä»»åŠ¡åŠ å…¥åˆ°å·¥ä½œé˜Ÿåˆ—ã€‚</li>
<li><strong><code>CallerRunsPolicy</code></strong> - æäº¤ä»»åŠ¡çš„çº¿ç¨‹è‡ªå·±å»æ‰§è¡Œè¯¥ä»»åŠ¡ã€‚</li>
<li>å¦‚æœä»¥ä¸Šç­–ç•¥éƒ½ä¸èƒ½æ»¡è¶³éœ€è¦ï¼Œä¹Ÿå¯ä»¥é€šè¿‡å®ç° <code>RejectedExecutionHandler</code> æ¥å£æ¥å®šåˆ¶å¤„ç†ç­–ç•¥ã€‚å¦‚è®°å½•æ—¥å¿—æˆ–æŒä¹…åŒ–ä¸èƒ½å¤„ç†çš„ä»»åŠ¡ã€‚</li>
</ul>
</li>
</ul>
<h3 id="é‡è¦å­—æ®µ"><a href="#é‡è¦å­—æ®µ" class="headerlink" title="é‡è¦å­—æ®µ"></a>é‡è¦å­—æ®µ</h3><p><code>ThreadPoolExecutor</code> æœ‰ä»¥ä¸‹é‡è¦å­—æ®µï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> <span class="type">AtomicInteger</span> <span class="variable">ctl</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AtomicInteger</span>(ctlOf(RUNNING, <span class="number">0</span>));</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">COUNT_BITS</span> <span class="operator">=</span> Integer.SIZE - <span class="number">3</span>;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">CAPACITY</span>   <span class="operator">=</span> (<span class="number">1</span> &lt;&lt; COUNT_BITS) - <span class="number">1</span>;</span><br><span class="line"><span class="comment">// runState is stored in the high-order bits</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">RUNNING</span>    <span class="operator">=</span> -<span class="number">1</span> &lt;&lt; COUNT_BITS;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">SHUTDOWN</span>   <span class="operator">=</span>  <span class="number">0</span> &lt;&lt; COUNT_BITS;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">STOP</span>       <span class="operator">=</span>  <span class="number">1</span> &lt;&lt; COUNT_BITS;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">TIDYING</span>    <span class="operator">=</span>  <span class="number">2</span> &lt;&lt; COUNT_BITS;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">TERMINATED</span> <span class="operator">=</span>  <span class="number">3</span> &lt;&lt; COUNT_BITS;</span><br></pre></td></tr></table></figure>

<p>å‚æ•°è¯´æ˜ï¼š</p>
<ul>
<li><code>ctl</code> - <strong>ç”¨äºæ§åˆ¶çº¿ç¨‹æ± çš„è¿è¡ŒçŠ¶æ€å’Œçº¿ç¨‹æ± ä¸­çš„æœ‰æ•ˆçº¿ç¨‹æ•°é‡</strong>ã€‚å®ƒåŒ…å«ä¸¤éƒ¨åˆ†çš„ä¿¡æ¯ï¼š<ul>
<li>çº¿ç¨‹æ± çš„è¿è¡ŒçŠ¶æ€ (<code>runState</code>)</li>
<li>çº¿ç¨‹æ± å†…æœ‰æ•ˆçº¿ç¨‹çš„æ•°é‡ (<code>workerCount</code>)</li>
<li>å¯ä»¥çœ‹åˆ°ï¼Œ<code>ctl</code> ä½¿ç”¨äº† <code>Integer</code> ç±»å‹æ¥ä¿å­˜ï¼Œé«˜ 3 ä½ä¿å­˜ <code>runState</code>ï¼Œä½ 29 ä½ä¿å­˜ <code>workerCount</code>ã€‚<code>COUNT_BITS</code> å°±æ˜¯ 29ï¼Œ<code>CAPACITY</code> å°±æ˜¯ 1 å·¦ç§» 29 ä½å‡ 1ï¼ˆ29 ä¸ª 1ï¼‰ï¼Œè¿™ä¸ªå¸¸é‡è¡¨ç¤º <code>workerCount</code> çš„ä¸Šé™å€¼ï¼Œå¤§çº¦æ˜¯ 5 äº¿ã€‚</li>
</ul>
</li>
<li>è¿è¡ŒçŠ¶æ€ - çº¿ç¨‹æ± ä¸€å…±æœ‰äº”ç§è¿è¡ŒçŠ¶æ€ï¼š<ul>
<li><code>RUNNING</code> - <strong>è¿è¡ŒçŠ¶æ€</strong>ã€‚æ¥å—æ–°ä»»åŠ¡ï¼Œå¹¶ä¸”ä¹Ÿèƒ½å¤„ç†é˜»å¡é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡ã€‚</li>
<li><code>SHUTDOWN</code> - <strong>å…³é—­çŠ¶æ€</strong>ã€‚ä¸æ¥å—æ–°ä»»åŠ¡ï¼Œä½†å¯ä»¥å¤„ç†é˜»å¡é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡ã€‚<ul>
<li>åœ¨çº¿ç¨‹æ± å¤„äº <code>RUNNING</code> çŠ¶æ€æ—¶ï¼Œè°ƒç”¨ <code>shutdown</code> æ–¹æ³•ä¼šä½¿çº¿ç¨‹æ± è¿›å…¥åˆ°è¯¥çŠ¶æ€ã€‚</li>
<li><code>finalize</code> æ–¹æ³•åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ä¹Ÿä¼šè°ƒç”¨ <code>shutdown</code> æ–¹æ³•è¿›å…¥è¯¥çŠ¶æ€ã€‚</li>
</ul>
</li>
<li><code>STOP</code> - <strong>åœæ­¢çŠ¶æ€</strong>ã€‚ä¸æ¥å—æ–°ä»»åŠ¡ï¼Œä¹Ÿä¸å¤„ç†é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡ã€‚ä¼šä¸­æ–­æ­£åœ¨å¤„ç†ä»»åŠ¡çš„çº¿ç¨‹ã€‚åœ¨çº¿ç¨‹æ± å¤„äº <code>RUNNING</code> æˆ– <code>SHUTDOWN</code> çŠ¶æ€æ—¶ï¼Œè°ƒç”¨ <code>shutdownNow</code> æ–¹æ³•ä¼šä½¿çº¿ç¨‹æ± è¿›å…¥åˆ°è¯¥çŠ¶æ€ã€‚</li>
<li><code>TIDYING</code> - <strong>æ•´ç†çŠ¶æ€</strong>ã€‚å¦‚æœæ‰€æœ‰çš„ä»»åŠ¡éƒ½å·²ç»ˆæ­¢äº†ï¼Œ<code>workerCount</code> ï¼ˆæœ‰æ•ˆçº¿ç¨‹æ•°ï¼‰ ä¸º 0ï¼Œçº¿ç¨‹æ± è¿›å…¥è¯¥çŠ¶æ€åä¼šè°ƒç”¨ <code>terminated</code> æ–¹æ³•è¿›å…¥ <code>TERMINATED</code> çŠ¶æ€ã€‚</li>
<li><code>TERMINATED</code> - <strong>å·²ç»ˆæ­¢çŠ¶æ€</strong>ã€‚åœ¨ <code>terminated</code> æ–¹æ³•æ‰§è¡Œå®Œåè¿›å…¥è¯¥çŠ¶æ€ã€‚é»˜è®¤ <code>terminated</code> æ–¹æ³•ä¸­ä»€ä¹ˆä¹Ÿæ²¡æœ‰åšã€‚è¿›å…¥ <code>TERMINATED</code> çš„æ¡ä»¶å¦‚ä¸‹ï¼š<ul>
<li>çº¿ç¨‹æ± ä¸æ˜¯ <code>RUNNING</code> çŠ¶æ€ï¼›</li>
<li>çº¿ç¨‹æ± çŠ¶æ€ä¸æ˜¯ <code>TIDYING</code> çŠ¶æ€æˆ– <code>TERMINATED</code> çŠ¶æ€ï¼›</li>
<li>å¦‚æœçº¿ç¨‹æ± çŠ¶æ€æ˜¯ <code>SHUTDOWN</code> å¹¶ä¸” <code>workerQueue</code> ä¸ºç©ºï¼›</li>
<li><code>workerCount</code> ä¸º 0ï¼›</li>
<li>è®¾ç½® <code>TIDYING</code> çŠ¶æ€æˆåŠŸã€‚</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><img src="https://raw.githubusercontent.com/dunwu/images/master/snap/202409190729946.png"></p>
<h3 id="å…¶ä»–é‡è¦æ–¹æ³•"><a href="#å…¶ä»–é‡è¦æ–¹æ³•" class="headerlink" title="å…¶ä»–é‡è¦æ–¹æ³•"></a>å…¶ä»–é‡è¦æ–¹æ³•</h3><p>åœ¨ <code>ThreadPoolExecutor</code> ç±»ä¸­è¿˜æœ‰ä¸€äº›é‡è¦çš„æ–¹æ³•ï¼š</p>
<ul>
<li><code>submit</code> - ç±»ä¼¼äº <code>execute</code>ï¼Œä½†æ˜¯é’ˆå¯¹çš„æ˜¯æœ‰è¿”å›å€¼çš„çº¿ç¨‹ã€‚<code>submit</code> æ–¹æ³•æ˜¯åœ¨ <code>ExecutorService</code> ä¸­å£°æ˜çš„æ–¹æ³•ï¼Œåœ¨ <code>AbstractExecutorService</code> å°±å·²ç»æœ‰äº†å…·ä½“çš„å®ç°ã€‚<code>ThreadPoolExecutor</code> ç›´æ¥å¤ç”¨ <code>AbstractExecutorService</code> çš„ <code>submit</code> æ–¹æ³•ã€‚</li>
<li><code>shutdown</code> - ä¸ä¼šç«‹å³ç»ˆæ­¢çº¿ç¨‹æ± ï¼Œè€Œæ˜¯è¦ç­‰æ‰€æœ‰ä»»åŠ¡ç¼“å­˜é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡éƒ½æ‰§è¡Œå®Œåæ‰ç»ˆæ­¢ï¼Œä½†å†ä¹Ÿä¸ä¼šæ¥å—æ–°çš„ä»»åŠ¡ã€‚<ul>
<li>å°†çº¿ç¨‹æ± åˆ‡æ¢åˆ° <code>SHUTDOWN</code> çŠ¶æ€ï¼›</li>
<li>å¹¶è°ƒç”¨ <code>interruptIdleWorkers</code> æ–¹æ³•è¯·æ±‚ä¸­æ–­æ‰€æœ‰ç©ºé—²çš„ workerï¼›</li>
<li>æœ€åè°ƒç”¨ <code>tryTerminate</code> å°è¯•ç»“æŸçº¿ç¨‹æ± ã€‚</li>
</ul>
</li>
<li><code>shutdownNow</code> - ç«‹å³ç»ˆæ­¢çº¿ç¨‹æ± ï¼Œå¹¶å°è¯•æ‰“æ–­æ­£åœ¨æ‰§è¡Œçš„ä»»åŠ¡ï¼Œå¹¶ä¸”æ¸…ç©ºä»»åŠ¡ç¼“å­˜é˜Ÿåˆ—ï¼Œè¿”å›å°šæœªæ‰§è¡Œçš„ä»»åŠ¡ã€‚ä¸ <code>shutdown</code> æ–¹æ³•ç±»ä¼¼ï¼Œä¸åŒçš„åœ°æ–¹åœ¨äºï¼š<ul>
<li>è®¾ç½®çŠ¶æ€ä¸º <code>STOP</code>ï¼›</li>
<li>ä¸­æ–­æ‰€æœ‰å·¥ä½œçº¿ç¨‹ï¼Œæ— è®ºæ˜¯å¦æ˜¯ç©ºé—²çš„ï¼›</li>
<li>å–å‡ºé˜»å¡é˜Ÿåˆ—ä¸­æ²¡æœ‰è¢«æ‰§è¡Œçš„ä»»åŠ¡å¹¶è¿”å›ã€‚</li>
</ul>
</li>
<li><code>isShutdown</code> - è°ƒç”¨äº† <code>shutdown</code> æˆ– <code>shutdownNow</code> æ–¹æ³•åï¼Œ<code>isShutdown</code> æ–¹æ³•å°±ä¼šè¿”å› trueã€‚</li>
<li><code>isTerminaed</code> - å½“æ‰€æœ‰çš„ä»»åŠ¡éƒ½å·²å…³é—­åï¼Œæ‰è¡¨ç¤ºçº¿ç¨‹æ± å…³é—­æˆåŠŸï¼Œè¿™æ—¶è°ƒç”¨ <code>isTerminaed</code> æ–¹æ³•ä¼šè¿”å› trueã€‚</li>
<li><code>setCorePoolSize</code> - è®¾ç½®æ ¸å¿ƒçº¿ç¨‹æ•°å¤§å°ã€‚</li>
<li><code>setMaximumPoolSize</code> - è®¾ç½®æœ€å¤§çº¿ç¨‹æ•°å¤§å°ã€‚</li>
<li><code>getTaskCount</code> - çº¿ç¨‹æ± å·²ç»æ‰§è¡Œçš„å’Œæœªæ‰§è¡Œçš„ä»»åŠ¡æ€»æ•°ï¼›</li>
<li><code>getCompletedTaskCount</code> - çº¿ç¨‹æ± å·²å®Œæˆçš„ä»»åŠ¡æ•°é‡ï¼Œè¯¥å€¼å°äºç­‰äº <code>taskCount</code>ï¼›</li>
<li><code>getLargestPoolSize</code> - çº¿ç¨‹æ± æ›¾ç»åˆ›å»ºè¿‡çš„æœ€å¤§çº¿ç¨‹æ•°é‡ã€‚é€šè¿‡è¿™ä¸ªæ•°æ®å¯ä»¥çŸ¥é“çº¿ç¨‹æ± æ˜¯å¦æ»¡è¿‡ï¼Œä¹Ÿå°±æ˜¯è¾¾åˆ°äº† <code>maximumPoolSize</code>ï¼›</li>
<li><code>getPoolSize</code> - çº¿ç¨‹æ± å½“å‰çš„çº¿ç¨‹æ•°é‡ï¼›</li>
<li><code>getActiveCount</code> - å½“å‰çº¿ç¨‹æ± ä¸­æ­£åœ¨æ‰§è¡Œä»»åŠ¡çš„çº¿ç¨‹æ•°é‡ã€‚</li>
</ul>
<h3 id="ä½¿ç”¨ç¤ºä¾‹"><a href="#ä½¿ç”¨ç¤ºä¾‹" class="headerlink" title="ä½¿ç”¨ç¤ºä¾‹"></a>ä½¿ç”¨ç¤ºä¾‹</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ThreadPoolExecutorDemo</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">ThreadPoolExecutor</span> <span class="variable">threadPoolExecutor</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ThreadPoolExecutor</span>(<span class="number">5</span>, <span class="number">10</span>, <span class="number">500</span>, TimeUnit.MILLISECONDS,</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">LinkedBlockingQueue</span>&lt;Runnable&gt;(),</span><br><span class="line">            Executors.defaultThreadFactory(),</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">ThreadPoolExecutor</span>.AbortPolicy());</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">100</span>; i++) &#123;</span><br><span class="line">            threadPoolExecutor.execute(<span class="keyword">new</span> <span class="title class_">MyThread</span>());</span><br><span class="line">            <span class="type">String</span> <span class="variable">info</span> <span class="operator">=</span> String.format(<span class="string">&quot;çº¿ç¨‹æ± ä¸­çº¿ç¨‹æ•°ç›®ï¼š%sï¼Œé˜Ÿåˆ—ä¸­ç­‰å¾…æ‰§è¡Œçš„ä»»åŠ¡æ•°ç›®ï¼š%sï¼Œå·²æ‰§è¡Œç©åˆ«çš„ä»»åŠ¡æ•°ç›®ï¼š%s&quot;</span>,</span><br><span class="line">                threadPoolExecutor.getPoolSize(),</span><br><span class="line">                threadPoolExecutor.getQueue().size(),</span><br><span class="line">                threadPoolExecutor.getCompletedTaskCount());</span><br><span class="line">            System.out.println(info);</span><br><span class="line">        &#125;</span><br><span class="line">        threadPoolExecutor.shutdown();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">MyThread</span> <span class="keyword">implements</span> <span class="title class_">Runnable</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">            System.out.println(Thread.currentThread().getName() + <span class="string">&quot; æ‰§è¡Œ&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="çº¿ç¨‹æ± åŸç†"><a href="#çº¿ç¨‹æ± åŸç†" class="headerlink" title="çº¿ç¨‹æ± åŸç†"></a>çº¿ç¨‹æ± åŸç†</h2><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œåˆ›å»ºçº¿ç¨‹æ± ä¹‹åï¼Œçº¿ç¨‹æ± ä¸­æ˜¯æ²¡æœ‰çº¿ç¨‹çš„ï¼Œéœ€è¦æäº¤ä»»åŠ¡ä¹‹åæ‰ä¼šåˆ›å»ºçº¿ç¨‹ã€‚æäº¤ä»»åŠ¡å¯ä»¥ä½¿ç”¨ <code>execute</code> æ–¹æ³•ï¼Œå®ƒæ˜¯ <code>ThreadPoolExecutor</code> çš„æ ¸å¿ƒæ–¹æ³•ï¼Œé€šè¿‡è¿™ä¸ªæ–¹æ³•å¯ä»¥<strong>å‘çº¿ç¨‹æ± æäº¤ä¸€ä¸ªä»»åŠ¡ï¼Œäº¤ç”±çº¿ç¨‹æ± å»æ‰§è¡Œ</strong>ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç”¨äºæ§åˆ¶çº¿ç¨‹æ± çš„è¿è¡ŒçŠ¶æ€å’Œçº¿ç¨‹æ± ä¸­çš„æœ‰æ•ˆçº¿ç¨‹æ•°é‡</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> <span class="type">AtomicInteger</span> <span class="variable">ctl</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AtomicInteger</span>(ctlOf(RUNNING, <span class="number">0</span>));</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">execute</span><span class="params">(Runnable command)</span> &#123;</span><br><span class="line">	<span class="keyword">if</span> (command == <span class="literal">null</span>)</span><br><span class="line">		<span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">NullPointerException</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è·å– ctl ä¸­å­˜å‚¨çš„çº¿ç¨‹æ± çŠ¶æ€ä¿¡æ¯</span></span><br><span class="line">	<span class="type">int</span> <span class="variable">c</span> <span class="operator">=</span> ctl.get();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// çº¿ç¨‹æ± æ‰§è¡Œå¯ä»¥åˆ†ä¸º 3 ä¸ªæ­¥éª¤</span></span><br><span class="line">    <span class="comment">// 1. è‹¥å·¥ä½œçº¿ç¨‹æ•°å°äºæ ¸å¿ƒçº¿ç¨‹æ•°ï¼Œåˆ™å°è¯•å¯åŠ¨ä¸€ä¸ªæ–°çš„çº¿ç¨‹æ¥æ‰§è¡Œä»»åŠ¡</span></span><br><span class="line">	<span class="keyword">if</span> (workerCountOf(c) &lt; corePoolSize) &#123;</span><br><span class="line">		<span class="keyword">if</span> (addWorker(command, <span class="literal">true</span>))</span><br><span class="line">			<span class="keyword">return</span>;</span><br><span class="line">		c = ctl.get();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 2. å¦‚æœä»»åŠ¡å¯ä»¥æˆåŠŸåœ°åŠ å…¥é˜Ÿåˆ—ï¼Œè¿˜éœ€è¦å†æ¬¡ç¡®è®¤æ˜¯å¦éœ€è¦æ·»åŠ æ–°çš„çº¿ç¨‹ï¼ˆå› ä¸ºå¯èƒ½è‡ªä»ä¸Šæ¬¡æ£€æŸ¥ä»¥æ¥å·²ç»æœ‰çº¿ç¨‹æ­»äº¡ï¼‰æˆ–è€…æ£€æŸ¥çº¿ç¨‹æ± æ˜¯å¦å·²ç»å…³é—­</span></span><br><span class="line">    <span class="comment">// 	-&gt; å¦‚æœæ˜¯åè€…ï¼Œåˆ™å¯èƒ½éœ€è¦å›æ»šå…¥é˜Ÿæ“ä½œï¼›</span></span><br><span class="line">    <span class="comment">// 	-&gt; å¦‚æœæ˜¯å‰è€…ï¼Œåˆ™å¯èƒ½éœ€è¦å¯åŠ¨æ–°çš„çº¿ç¨‹</span></span><br><span class="line">	<span class="keyword">if</span> (isRunning(c) &amp;&amp; workQueue.offer(command)) &#123;</span><br><span class="line">		<span class="type">int</span> <span class="variable">recheck</span> <span class="operator">=</span> ctl.get();</span><br><span class="line">		<span class="keyword">if</span> (!isRunning(recheck) &amp;&amp; remove(command))</span><br><span class="line">			reject(command);</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span> (workerCountOf(recheck) == <span class="number">0</span>)</span><br><span class="line">			addWorker(<span class="literal">null</span>, <span class="literal">false</span>);</span><br><span class="line">	&#125;</span><br><span class="line">    <span class="comment">// å¦‚æœä»»åŠ¡æ— æ³•åŠ å…¥é˜Ÿåˆ—ï¼Œåˆ™å°è¯•æ·»åŠ ä¸€ä¸ªæ–°çš„çº¿ç¨‹</span></span><br><span class="line">    <span class="comment">// å¦‚æœæ·»åŠ æ–°çº¿ç¨‹å¤±è´¥ï¼Œè¯´æ˜çº¿ç¨‹æ± å·²ç»å…³é—­æˆ–è€…è¾¾åˆ°äº†å®¹é‡ä¸Šé™ï¼Œæ­¤æ—¶å°†æ‹’ç»è¯¥ä»»åŠ¡</span></span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span> (!addWorker(command, <span class="literal">false</span>))</span><br><span class="line">		reject(command);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>execute</code> æ–¹æ³•å·¥ä½œæµç¨‹å¦‚ä¸‹ï¼š</p>
<ol>
<li>å¦‚æœ <code>workerCount &lt; corePoolSize</code>ï¼Œåˆ™åˆ›å»ºå¹¶å¯åŠ¨ä¸€ä¸ªçº¿ç¨‹æ¥æ‰§è¡Œæ–°æäº¤çš„ä»»åŠ¡ï¼›</li>
<li>å¦‚æœ <code>workerCount &gt;= corePoolSize</code>ï¼Œä¸”çº¿ç¨‹æ± å†…çš„é˜»å¡é˜Ÿåˆ—æœªæ»¡ï¼Œåˆ™å°†ä»»åŠ¡æ·»åŠ åˆ°è¯¥é˜»å¡é˜Ÿåˆ—ä¸­ï¼›</li>
<li>å¦‚æœ <code>workerCount &gt;= corePoolSize &amp;&amp; workerCount &lt; maximumPoolSize</code>ï¼Œä¸”çº¿ç¨‹æ± å†…çš„é˜»å¡é˜Ÿåˆ—å·²æ»¡ï¼Œåˆ™åˆ›å»ºå¹¶å¯åŠ¨ä¸€ä¸ªçº¿ç¨‹æ¥æ‰§è¡Œæ–°æäº¤çš„ä»»åŠ¡ï¼›</li>
<li>å¦‚æœ<code>workerCount &gt;= maximumPoolSize</code>ï¼Œå¹¶ä¸”çº¿ç¨‹æ± å†…çš„é˜»å¡é˜Ÿåˆ—å·²æ»¡ï¼Œåˆ™æ ¹æ®æ‹’ç»ç­–ç•¥æ¥å¤„ç†è¯¥ä»»åŠ¡ï¼Œé»˜è®¤çš„å¤„ç†æ–¹å¼æ˜¯ç›´æ¥æŠ›å¼‚å¸¸ã€‚</li>
</ol>
<p><img src="https://raw.githubusercontent.com/dunwu/images/master/snap/202409190726019.png"></p>
<p>åœ¨ <code>execute</code> æ–¹æ³•ä¸­ï¼Œå¤šæ¬¡è°ƒç”¨ <code>addWorker</code> æ–¹æ³•ã€‚<code>addWorker</code> è¿™ä¸ªæ–¹æ³•ä¸»è¦ç”¨æ¥åˆ›å»ºæ–°çš„å·¥ä½œçº¿ç¨‹ï¼Œå¦‚æœè¿”å› true è¯´æ˜åˆ›å»ºå’Œå¯åŠ¨å·¥ä½œçº¿ç¨‹æˆåŠŸï¼Œå¦åˆ™çš„è¯è¿”å›çš„å°±æ˜¯ falseã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å…¨å±€é”ï¼Œå¹¶å‘æ“ä½œå¿…å¤‡</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> <span class="type">ReentrantLock</span> <span class="variable">mainLock</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ReentrantLock</span>();</span><br><span class="line"><span class="comment">// è·Ÿè¸ªçº¿ç¨‹æ± çš„æœ€å¤§å¤§å°ï¼Œåªæœ‰åœ¨æŒæœ‰å…¨å±€é” mainLock çš„å‰æä¸‹æ‰èƒ½è®¿é—®æ­¤é›†åˆ</span></span><br><span class="line"><span class="keyword">private</span> <span class="type">int</span> largestPoolSize;</span><br><span class="line"><span class="comment">// å·¥ä½œçº¿ç¨‹é›†åˆï¼Œå­˜æ”¾çº¿ç¨‹æ± ä¸­æ‰€æœ‰çš„ï¼ˆæ´»è·ƒçš„ï¼‰å·¥ä½œçº¿ç¨‹ï¼Œåªæœ‰åœ¨æŒæœ‰å…¨å±€é” mainLock çš„å‰æä¸‹æ‰èƒ½è®¿é—®æ­¤é›†åˆ</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> HashSet&lt;Worker&gt; workers = <span class="keyword">new</span> <span class="title class_">HashSet</span>&lt;&gt;();</span><br><span class="line"><span class="comment">//è·å–çº¿ç¨‹æ± çŠ¶æ€</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">runStateOf</span><span class="params">(<span class="type">int</span> c)</span>     &#123; <span class="keyword">return</span> c &amp; ~CAPACITY; &#125;</span><br><span class="line"><span class="comment">//åˆ¤æ–­çº¿ç¨‹æ± çš„çŠ¶æ€æ˜¯å¦ä¸º Running</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">isRunning</span><span class="params">(<span class="type">int</span> c)</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> c &lt; SHUTDOWN;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ·»åŠ æ–°çš„å·¥ä½œçº¿ç¨‹åˆ°çº¿ç¨‹æ± </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> firstTask è¦æ‰§è¡Œ</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> core å‚æ•°ä¸º true çš„è¯è¡¨ç¤ºä½¿ç”¨çº¿ç¨‹æ± çš„åŸºæœ¬å¤§å°ï¼Œä¸º false ä½¿ç”¨çº¿ç¨‹æ± æœ€å¤§å¤§å°</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> æ·»åŠ æˆåŠŸå°±è¿”å› true å¦åˆ™è¿”å› false</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">private</span> <span class="type">boolean</span> <span class="title function_">addWorker</span><span class="params">(Runnable firstTask, <span class="type">boolean</span> core)</span> &#123;</span><br><span class="line">	retry:</span><br><span class="line">	<span class="keyword">for</span> (;;) &#123;</span><br><span class="line">		<span class="comment">//è¿™ä¸¤å¥ç”¨æ¥è·å–çº¿ç¨‹æ± çš„çŠ¶æ€</span></span><br><span class="line">		<span class="type">int</span> <span class="variable">c</span> <span class="operator">=</span> ctl.get();</span><br><span class="line">		<span class="type">int</span> <span class="variable">rs</span> <span class="operator">=</span> runStateOf(c);</span><br><span class="line"></span><br><span class="line">		<span class="comment">// Check if queue empty only if necessary.</span></span><br><span class="line">		<span class="keyword">if</span> (rs &gt;= SHUTDOWN &amp;&amp;</span><br><span class="line">			! (rs == SHUTDOWN &amp;&amp;</span><br><span class="line">			   firstTask == <span class="literal">null</span> &amp;&amp;</span><br><span class="line">			   ! workQueue.isEmpty()))</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span> (;;) &#123;</span><br><span class="line">		   <span class="comment">//è·å–çº¿ç¨‹æ± ä¸­å·¥ä½œçš„çº¿ç¨‹çš„æ•°é‡</span></span><br><span class="line">			<span class="type">int</span> <span class="variable">wc</span> <span class="operator">=</span> workerCountOf(c);</span><br><span class="line">			<span class="comment">// core å‚æ•°ä¸º false çš„è¯è¡¨æ˜é˜Ÿåˆ—ä¹Ÿæ»¡äº†ï¼Œçº¿ç¨‹æ± å¤§å°å˜ä¸º maximumPoolSize</span></span><br><span class="line">			<span class="keyword">if</span> (wc &gt;= CAPACITY ||</span><br><span class="line">				wc &gt;= (core ? corePoolSize : maximumPoolSize))</span><br><span class="line">				<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">		   <span class="comment">//åŸå­æ“ä½œå°† workcount çš„æ•°é‡åŠ  1</span></span><br><span class="line">			<span class="keyword">if</span> (compareAndIncrementWorkerCount(c))</span><br><span class="line">				<span class="keyword">break</span> retry;</span><br><span class="line">			<span class="comment">// å¦‚æœçº¿ç¨‹çš„çŠ¶æ€æ”¹å˜äº†å°±å†æ¬¡æ‰§è¡Œä¸Šè¿°æ“ä½œ</span></span><br><span class="line">			c = ctl.get();</span><br><span class="line">			<span class="keyword">if</span> (runStateOf(c) != rs)</span><br><span class="line">				<span class="keyword">continue</span> retry;</span><br><span class="line">			<span class="comment">// else CAS failed due to workerCount change; retry inner loop</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// æ ‡è®°å·¥ä½œçº¿ç¨‹æ˜¯å¦å¯åŠ¨æˆåŠŸ</span></span><br><span class="line">	<span class="type">boolean</span> <span class="variable">workerStarted</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">	<span class="comment">// æ ‡è®°å·¥ä½œçº¿ç¨‹æ˜¯å¦åˆ›å»ºæˆåŠŸ</span></span><br><span class="line">	<span class="type">boolean</span> <span class="variable">workerAdded</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">	<span class="type">Worker</span> <span class="variable">w</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">	<span class="keyword">try</span> &#123;</span><br><span class="line"></span><br><span class="line">		w = <span class="keyword">new</span> <span class="title class_">Worker</span>(firstTask);</span><br><span class="line">		<span class="keyword">final</span> <span class="type">Thread</span> <span class="variable">t</span> <span class="operator">=</span> w.thread;</span><br><span class="line">		<span class="keyword">if</span> (t != <span class="literal">null</span>) &#123;</span><br><span class="line">		  <span class="comment">// åŠ é”</span></span><br><span class="line">			<span class="keyword">final</span> <span class="type">ReentrantLock</span> <span class="variable">mainLock</span> <span class="operator">=</span> <span class="built_in">this</span>.mainLock;</span><br><span class="line">			mainLock.lock();</span><br><span class="line">			<span class="keyword">try</span> &#123;</span><br><span class="line">			   <span class="comment">//è·å–çº¿ç¨‹æ± çŠ¶æ€</span></span><br><span class="line">				<span class="type">int</span> <span class="variable">rs</span> <span class="operator">=</span> runStateOf(ctl.get());</span><br><span class="line">			   <span class="comment">//rs &lt; SHUTDOWN å¦‚æœçº¿ç¨‹æ± çŠ¶æ€ä¾ç„¶ä¸º RUNNING, å¹¶ä¸”çº¿ç¨‹çš„çŠ¶æ€æ˜¯å­˜æ´»çš„è¯ï¼Œå°±ä¼šå°†å·¥ä½œçº¿ç¨‹æ·»åŠ åˆ°å·¥ä½œçº¿ç¨‹é›†åˆä¸­</span></span><br><span class="line">			  <span class="comment">//(rs=SHUTDOWN &amp;&amp; firstTask == null) å¦‚æœçº¿ç¨‹æ± çŠ¶æ€å°äº STOPï¼Œä¹Ÿå°±æ˜¯ RUNNING æˆ–è€… SHUTDOWN çŠ¶æ€ä¸‹ï¼ŒåŒæ—¶ä¼ å…¥çš„ä»»åŠ¡å®ä¾‹ firstTask ä¸º nullï¼Œåˆ™éœ€è¦æ·»åŠ åˆ°å·¥ä½œçº¿ç¨‹é›†åˆå’Œå¯åŠ¨æ–°çš„ Worker</span></span><br><span class="line">			   <span class="comment">// firstTask == null è¯æ˜åªæ–°å»ºçº¿ç¨‹è€Œä¸æ‰§è¡Œä»»åŠ¡</span></span><br><span class="line">				<span class="keyword">if</span> (rs &lt; SHUTDOWN ||</span><br><span class="line">					(rs == SHUTDOWN &amp;&amp; firstTask == <span class="literal">null</span>)) &#123;</span><br><span class="line">					<span class="keyword">if</span> (t.isAlive()) <span class="comment">// precheck that t is startable</span></span><br><span class="line">						<span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalThreadStateException</span>();</span><br><span class="line">					workers.add(w);</span><br><span class="line">				   <span class="comment">//æ›´æ–°å½“å‰å·¥ä½œçº¿ç¨‹çš„æœ€å¤§å®¹é‡</span></span><br><span class="line">					<span class="type">int</span> <span class="variable">s</span> <span class="operator">=</span> workers.size();</span><br><span class="line">					<span class="keyword">if</span> (s &gt; largestPoolSize)</span><br><span class="line">						largestPoolSize = s;</span><br><span class="line">				  <span class="comment">// å·¥ä½œçº¿ç¨‹æ˜¯å¦å¯åŠ¨æˆåŠŸ</span></span><br><span class="line">					workerAdded = <span class="literal">true</span>;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">				<span class="comment">// é‡Šæ”¾é”</span></span><br><span class="line">				mainLock.unlock();</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="comment">//// å¦‚æœæˆåŠŸæ·»åŠ å·¥ä½œçº¿ç¨‹ï¼Œåˆ™è°ƒç”¨ Worker å†…éƒ¨çš„çº¿ç¨‹å®ä¾‹ t çš„ Thread#start() æ–¹æ³•å¯åŠ¨çœŸå®çš„çº¿ç¨‹å®ä¾‹</span></span><br><span class="line">			<span class="keyword">if</span> (workerAdded) &#123;</span><br><span class="line">				t.start();</span><br><span class="line">			  <span class="comment">/// æ ‡è®°çº¿ç¨‹å¯åŠ¨æˆåŠŸ</span></span><br><span class="line">				workerStarted = <span class="literal">true</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">	   <span class="comment">// çº¿ç¨‹å¯åŠ¨å¤±è´¥ï¼Œéœ€è¦ä»å·¥ä½œçº¿ç¨‹ä¸­ç§»é™¤å¯¹åº”çš„ Worker</span></span><br><span class="line">		<span class="keyword">if</span> (! workerStarted)</span><br><span class="line">			addWorkerFailed(w);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> workerStarted;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Executors"><a href="#Executors" class="headerlink" title="Executors"></a>Executors</h2><p><code>Executors</code> ç±»ä¸­æä¾›äº†å‡ ç§å†…ç½®çš„ <code>ThreadPoolExecutor</code> å®ç°ï¼š</p>
<ul>
<li><code>FixedThreadPool</code>ï¼šå›ºå®šçº¿ç¨‹æ•°é‡çš„çº¿ç¨‹æ± ã€‚è¯¥çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹æ•°é‡å§‹ç»ˆä¸å˜ã€‚å½“æœ‰ä¸€ä¸ªæ–°çš„ä»»åŠ¡æäº¤æ—¶ï¼Œçº¿ç¨‹æ± ä¸­è‹¥æœ‰ç©ºé—²çº¿ç¨‹ï¼Œåˆ™ç«‹å³æ‰§è¡Œã€‚è‹¥æ²¡æœ‰ï¼Œåˆ™æ–°çš„ä»»åŠ¡ä¼šè¢«æš‚å­˜åœ¨ä¸€ä¸ªä»»åŠ¡é˜Ÿåˆ—ä¸­ï¼Œå¾…æœ‰çº¿ç¨‹ç©ºé—²æ—¶ï¼Œä¾¿å¤„ç†åœ¨ä»»åŠ¡é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡ã€‚</li>
<li><code>SingleThreadExecutor</code>ï¼š åªæœ‰ä¸€ä¸ªçº¿ç¨‹çš„çº¿ç¨‹æ± ã€‚è‹¥å¤šä½™ä¸€ä¸ªä»»åŠ¡è¢«æäº¤åˆ°è¯¥çº¿ç¨‹æ± ï¼Œä»»åŠ¡ä¼šè¢«ä¿å­˜åœ¨ä¸€ä¸ªä»»åŠ¡é˜Ÿåˆ—ä¸­ï¼Œå¾…çº¿ç¨‹ç©ºé—²ï¼ŒæŒ‰å…ˆå…¥å…ˆå‡ºçš„é¡ºåºæ‰§è¡Œé˜Ÿåˆ—ä¸­çš„ä»»åŠ¡ã€‚</li>
<li><code>CachedThreadPool</code>ï¼š å¯æ ¹æ®å®é™…æƒ…å†µè°ƒæ•´çº¿ç¨‹æ•°é‡çš„çº¿ç¨‹æ± ã€‚çº¿ç¨‹æ± çš„çº¿ç¨‹æ•°é‡ä¸ç¡®å®šï¼Œä½†è‹¥æœ‰ç©ºé—²çº¿ç¨‹å¯ä»¥å¤ç”¨ï¼Œåˆ™ä¼šä¼˜å…ˆä½¿ç”¨å¯å¤ç”¨çš„çº¿ç¨‹ã€‚è‹¥æ‰€æœ‰çº¿ç¨‹å‡åœ¨å·¥ä½œï¼Œåˆæœ‰æ–°çš„ä»»åŠ¡æäº¤ï¼Œåˆ™ä¼šåˆ›å»ºæ–°çš„çº¿ç¨‹å¤„ç†ä»»åŠ¡ã€‚æ‰€æœ‰çº¿ç¨‹åœ¨å½“å‰ä»»åŠ¡æ‰§è¡Œå®Œæ¯•åï¼Œå°†è¿”å›çº¿ç¨‹æ± è¿›è¡Œå¤ç”¨ã€‚</li>
<li><code>ScheduledThreadPool</code>ï¼šç»™å®šçš„å»¶è¿Ÿåè¿è¡Œä»»åŠ¡æˆ–è€…å®šæœŸæ‰§è¡Œä»»åŠ¡çš„çº¿ç¨‹æ± ã€‚</li>
</ul>
<blockquote>
<p>æ³¨æ„ï¼š</p>
<p>ã€Šé˜¿é‡Œå·´å·´ Java å¼€å‘æ‰‹å†Œã€‹ä¸­æ˜ç¡®è¦æ±‚ä¸è¦ä½¿ç”¨ <code>Executors</code> ä¸­çš„å†…ç½®åŒ–çº¿ç¨‹æ± ã€‚</p>
<p>ã€å¼ºåˆ¶ã€‘çº¿ç¨‹æ± ä¸å…è®¸ä½¿ç”¨ <code>Executors</code> å»åˆ›å»ºï¼Œè€Œæ˜¯é€šè¿‡ <code>ThreadPoolExecutor</code> çš„æ–¹å¼ï¼Œè¿™æ ·çš„å¤„ç†æ–¹å¼è®©å†™çš„åŒå­¦æ›´åŠ æ˜ç¡®çº¿ç¨‹æ± çš„è¿è¡Œè§„åˆ™ï¼Œè§„é¿èµ„æºè€—å°½çš„é£é™©ã€‚</p>
<p>è¯´æ˜ï¼š<code>Executors</code> è¿”å›çš„çº¿ç¨‹æ± å¯¹è±¡çš„å¼Šç«¯å¦‚ä¸‹ï¼š</p>
<ol>
<li><code>FixedThreadPool</code> å’Œ <code>SingleThreadPool</code>ï¼š å…è®¸çš„è¯·æ±‚é˜Ÿåˆ—é•¿åº¦ä¸º <code>Integer.MAX_VALUE</code>ï¼Œå¯èƒ½ä¼šå †ç§¯å¤§é‡çš„è¯·æ±‚ï¼Œä»è€Œå¯¼è‡´ OOMã€‚</li>
<li><code>CachedThreadPool</code>ï¼šå…è®¸çš„åˆ›å»ºçº¿ç¨‹æ•°é‡ä¸º <code>Integer.MAX_VALUE</code>ï¼Œå¯èƒ½ä¼šåˆ›å»ºå¤§é‡çš„çº¿ç¨‹ï¼Œä»è€Œå¯¼è‡´ OOMã€‚</li>
<li><code>ScheduledThreadPool</code>ï¼š å…è®¸çš„è¯·æ±‚é˜Ÿåˆ—é•¿åº¦ä¸º <code>Integer.MAX_VALUE</code>ï¼Œå¯èƒ½ä¼šå †ç§¯å¤§é‡çš„è¯·æ±‚ï¼Œä»è€Œå¯¼è‡´ OOMã€‚</li>
</ol>
</blockquote>
<h3 id="FixedThreadPool"><a href="#FixedThreadPool" class="headerlink" title="FixedThreadPool"></a>FixedThreadPool</h3><p><strong>FixedThreadPool æ˜¯ä¸€ä¸ªå¯é‡ç”¨çš„ã€çº¿ç¨‹æ•°å›ºå®šçš„çº¿ç¨‹æ± </strong>ã€‚<code>Executors</code> ç±»ä¸­çš„ç›¸å…³æºç ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> ExecutorService <span class="title function_">newFixedThreadPool</span><span class="params">(<span class="type">int</span> nThreads)</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ThreadPoolExecutor</span>(nThreads, nThreads,</span><br><span class="line">								  <span class="number">0L</span>, TimeUnit.MILLISECONDS,</span><br><span class="line">								  <span class="keyword">new</span> <span class="title class_">LinkedBlockingQueue</span>&lt;Runnable&gt;());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> ExecutorService <span class="title function_">newFixedThreadPool</span><span class="params">(<span class="type">int</span> nThreads, ThreadFactory threadFactory)</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ThreadPoolExecutor</span>(nThreads, nThreads,</span><br><span class="line">								  <span class="number">0L</span>, TimeUnit.MILLISECONDS,</span><br><span class="line">								  <span class="keyword">new</span> <span class="title class_">LinkedBlockingQueue</span>&lt;Runnable&gt;(),</span><br><span class="line">								  threadFactory);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>FixedThreadPool</code> çš„ <code>corePoolSize</code> å’Œ <code>maximumPoolSize</code> éƒ½è¢«è®¾ç½®ä¸º <code>nThreads</code>ï¼Œè¿™ä¸ª <code>nThreads</code> å‚æ•°æ˜¯æˆ‘ä»¬ä½¿ç”¨çš„æ—¶å€™è‡ªå·±ä¼ é€’çš„ã€‚</p>
<p>å³ä½¿ <code>maximumPoolSize</code> çš„å€¼æ¯” <code>corePoolSize</code> å¤§ï¼Œä¹Ÿè‡³å¤šåªä¼šåˆ›å»º <code>corePoolSize</code> ä¸ªçº¿ç¨‹ã€‚è¿™æ˜¯å› ä¸º<code>FixedThreadPool</code> ä½¿ç”¨çš„æ˜¯å®¹é‡ä¸º <code>Integer.MAX_VALUE</code> çš„ <code>LinkedBlockingQueue</code>ï¼ˆæ— ç•Œé˜Ÿåˆ—ï¼‰ï¼Œé˜Ÿåˆ—æ°¸è¿œä¸ä¼šè¢«æ”¾æ»¡ã€‚</p>
<p>FixedThreadPool çš„é—®é¢˜ï¼š</p>
<p><code>FixedThreadPool</code> ä½¿ç”¨æ— ç•Œé˜Ÿåˆ— <code>LinkedBlockingQueue</code>ï¼ˆé˜Ÿåˆ—çš„å®¹é‡ä¸º Integer.MAX_VALUEï¼‰ä½œä¸ºçº¿ç¨‹æ± çš„å·¥ä½œé˜Ÿåˆ—ä¼šå¯¹çº¿ç¨‹æ± å¸¦æ¥å¦‚ä¸‹å½±å“ï¼š</p>
<ol>
<li>å½“çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹æ•°è¾¾åˆ° <code>corePoolSize</code> åï¼Œæ–°ä»»åŠ¡å°†åœ¨æ— ç•Œé˜Ÿåˆ—ä¸­ç­‰å¾…ï¼Œå› æ­¤çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹æ•°ä¸ä¼šè¶…è¿‡ <code>corePoolSize</code>ï¼›</li>
<li>ç”±äºä½¿ç”¨æ— ç•Œé˜Ÿåˆ—æ—¶ <code>maximumPoolSize</code> å°†æ˜¯ä¸€ä¸ªæ— æ•ˆå‚æ•°ï¼Œå› ä¸ºä¸å¯èƒ½å­˜åœ¨ä»»åŠ¡é˜Ÿåˆ—æ»¡çš„æƒ…å†µã€‚æ‰€ä»¥ï¼Œé€šè¿‡åˆ›å»º <code>FixedThreadPool</code>çš„æºç å¯ä»¥çœ‹å‡ºåˆ›å»ºçš„ <code>FixedThreadPool</code> çš„ <code>corePoolSize</code> å’Œ <code>maximumPoolSize</code> è¢«è®¾ç½®ä¸ºåŒä¸€ä¸ªå€¼ã€‚</li>
<li>ç”±äº 1 å’Œ 2ï¼Œä½¿ç”¨æ— ç•Œé˜Ÿåˆ—æ—¶ <code>keepAliveTime</code> å°†æ˜¯ä¸€ä¸ªæ— æ•ˆå‚æ•°ï¼›</li>
<li>è¿è¡Œä¸­çš„ <code>FixedThreadPool</code>ï¼ˆæœªæ‰§è¡Œ <code>shutdown()</code>æˆ– <code>shutdownNow()</code>ï¼‰ä¸ä¼šæ‹’ç»ä»»åŠ¡ï¼Œåœ¨ä»»åŠ¡æ¯”è¾ƒå¤šçš„æ—¶å€™ä¼šå¯¼è‡´ OOMï¼ˆå†…å­˜æº¢å‡ºï¼‰ã€‚</li>
</ol>
<h3 id="SingleThreadExecutor"><a href="#SingleThreadExecutor" class="headerlink" title="SingleThreadExecutor"></a>SingleThreadExecutor</h3><p><strong><code>SingleThreadExecutor</code> æ˜¯åªæœ‰ä¸€ä¸ªçº¿ç¨‹çš„çº¿ç¨‹æ± </strong>ã€‚SingleThreadExecutor åªä¼šåˆ›å»ºå”¯ä¸€çš„å·¥ä½œçº¿ç¨‹æ¥æ‰§è¡Œä»»åŠ¡ï¼Œä¿è¯æ‰€æœ‰ä»»åŠ¡æŒ‰ç…§æŒ‡å®šé¡ºåº (FIFO, LIFO, ä¼˜å…ˆçº§ï¼‰æ‰§è¡Œã€‚ <strong>å¦‚æœè¿™ä¸ªå”¯ä¸€çš„çº¿ç¨‹å› ä¸ºå¼‚å¸¸ç»“æŸï¼Œé‚£ä¹ˆä¼šæœ‰ä¸€ä¸ªæ–°çš„çº¿ç¨‹æ¥æ›¿ä»£å®ƒ</strong> ã€‚</p>
<p><code>Executors</code> ç±»ä¸­çš„ç›¸å…³æºç ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> ExecutorService <span class="title function_">newSingleThreadExecutor</span><span class="params">()</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">FinalizableDelegatedExecutorService</span></span><br><span class="line">		(<span class="keyword">new</span> <span class="title class_">ThreadPoolExecutor</span>(<span class="number">1</span>, <span class="number">1</span>,</span><br><span class="line">								<span class="number">0L</span>, TimeUnit.MILLISECONDS,</span><br><span class="line">								<span class="keyword">new</span> <span class="title class_">LinkedBlockingQueue</span>&lt;Runnable&gt;()));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> ExecutorService <span class="title function_">newSingleThreadExecutor</span><span class="params">(ThreadFactory threadFactory)</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">FinalizableDelegatedExecutorService</span></span><br><span class="line">		(<span class="keyword">new</span> <span class="title class_">ThreadPoolExecutor</span>(<span class="number">1</span>, <span class="number">1</span>,</span><br><span class="line">								<span class="number">0L</span>, TimeUnit.MILLISECONDS,</span><br><span class="line">								<span class="keyword">new</span> <span class="title class_">LinkedBlockingQueue</span>&lt;Runnable&gt;(),</span><br><span class="line">								threadFactory));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>SingleThreadExecutor</code> çš„é—®é¢˜ï¼š</p>
<p><code>SingleThreadExecutor</code> å’Œ <code>FixedThreadPool</code> ä¸€æ ·ï¼Œä½¿ç”¨çš„éƒ½æ˜¯å®¹é‡ä¸º <code>Integer.MAX_VALUE</code> çš„ <code>LinkedBlockingQueue</code>ï¼ˆæ— ç•Œé˜Ÿåˆ—ï¼‰ä½œä¸ºçº¿ç¨‹æ± çš„å·¥ä½œé˜Ÿåˆ—ã€‚<code>SingleThreadExecutor</code> ä½¿ç”¨æ— ç•Œé˜Ÿåˆ—ä½œä¸ºçº¿ç¨‹æ± çš„å·¥ä½œé˜Ÿåˆ—ä¼šå¯¹çº¿ç¨‹æ± å¸¦æ¥çš„å½±å“ä¸ <code>FixedThreadPool</code> ç›¸åŒã€‚è¯´ç®€å•ç‚¹ï¼Œå°±æ˜¯å¯èƒ½ä¼šå¯¼è‡´ OOMã€‚</p>
<h3 id="CachedThreadPool"><a href="#CachedThreadPool" class="headerlink" title="CachedThreadPool"></a>CachedThreadPool</h3><p><code>CachedThreadPool</code> æ˜¯ä¸€ä¸ªä¼šæ ¹æ®éœ€è¦åˆ›å»ºæ–°çº¿ç¨‹çš„çº¿ç¨‹æ± ã€‚</p>
<ul>
<li>å¦‚æœçº¿ç¨‹æ± å¤§å°è¶…è¿‡å¤„ç†ä»»åŠ¡æ‰€éœ€è¦çš„çº¿ç¨‹æ•°ï¼Œå°±ä¼šå›æ”¶éƒ¨åˆ†ç©ºé—²çš„çº¿ç¨‹ï¼›</li>
<li>å¦‚æœé•¿æ—¶é—´æ²¡æœ‰å¾€çº¿ç¨‹æ± ä¸­æäº¤ä»»åŠ¡ï¼Œå³å¦‚æœå·¥ä½œçº¿ç¨‹ç©ºé—²äº†æŒ‡å®šçš„æ—¶é—´ï¼ˆé»˜è®¤ä¸º 1 åˆ†é’Ÿï¼‰ï¼Œåˆ™è¯¥å·¥ä½œçº¿ç¨‹å°†è‡ªåŠ¨ç»ˆæ­¢ã€‚ç»ˆæ­¢åï¼Œå¦‚æœä½ åˆæäº¤äº†æ–°çš„ä»»åŠ¡ï¼Œåˆ™çº¿ç¨‹æ± é‡æ–°åˆ›å»ºä¸€ä¸ªå·¥ä½œçº¿ç¨‹ã€‚</li>
<li>æ­¤çº¿ç¨‹æ± ä¸ä¼šå¯¹çº¿ç¨‹æ± å¤§å°åšé™åˆ¶ï¼Œçº¿ç¨‹æ± å¤§å°å®Œå…¨ä¾èµ–äºæ“ä½œç³»ç»Ÿï¼ˆæˆ–è€…è¯´ JVMï¼‰èƒ½å¤Ÿåˆ›å»ºçš„æœ€å¤§çº¿ç¨‹å¤§å°ã€‚ å› æ­¤ï¼Œä½¿ç”¨ <code>CachedThreadPool</code> æ—¶ï¼Œä¸€å®šè¦æ³¨æ„æ§åˆ¶ä»»åŠ¡çš„æ•°é‡ï¼Œå¦åˆ™ï¼Œç”±äºå¤§é‡çº¿ç¨‹åŒæ—¶è¿è¡Œï¼Œå¾ˆæœ‰ä¼šé€ æˆç³»ç»Ÿç˜«ç—ªã€‚</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> ExecutorService <span class="title function_">newCachedThreadPool</span><span class="params">()</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ThreadPoolExecutor</span>(<span class="number">0</span>, Integer.MAX_VALUE,</span><br><span class="line">								  <span class="number">60L</span>, TimeUnit.SECONDS,</span><br><span class="line">								  <span class="keyword">new</span> <span class="title class_">SynchronousQueue</span>&lt;Runnable&gt;());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> ExecutorService <span class="title function_">newCachedThreadPool</span><span class="params">(ThreadFactory threadFactory)</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ThreadPoolExecutor</span>(<span class="number">0</span>, Integer.MAX_VALUE,</span><br><span class="line">								  <span class="number">60L</span>, TimeUnit.SECONDS,</span><br><span class="line">								  <span class="keyword">new</span> <span class="title class_">SynchronousQueue</span>&lt;Runnable&gt;(),</span><br><span class="line">								  threadFactory);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>CachedThreadPool</code> çš„<code>corePoolSize</code> è¢«è®¾ç½®ä¸ºç©ºï¼ˆ0ï¼‰ï¼Œ<code>maximumPoolSize</code>è¢«è®¾ç½®ä¸º <code>Integer.MAX.VALUE</code>ï¼Œå³å®ƒæ˜¯æ— ç•Œçš„ï¼Œè¿™ä¹Ÿå°±æ„å‘³ç€å¦‚æœä¸»çº¿ç¨‹æäº¤ä»»åŠ¡çš„é€Ÿåº¦é«˜äº <code>maximumPool</code> ä¸­çº¿ç¨‹å¤„ç†ä»»åŠ¡çš„é€Ÿåº¦æ—¶ï¼Œ<code>CachedThreadPool</code> ä¼šä¸æ–­åˆ›å»ºæ–°çš„çº¿ç¨‹ã€‚æç«¯æƒ…å†µä¸‹ï¼Œè¿™æ ·ä¼šå¯¼è‡´è€—å°½ cpu å’Œå†…å­˜èµ„æºã€‚</p>
<p><code>CachedThreadPool</code> çš„æ‰§è¡Œæµç¨‹ï¼š</p>
<ol>
<li>é¦–å…ˆæ‰§è¡Œ <code>SynchronousQueue.offer(Runnable task)</code> æäº¤ä»»åŠ¡åˆ°ä»»åŠ¡é˜Ÿåˆ—ã€‚å¦‚æœå½“å‰ <code>maximumPool</code> ä¸­æœ‰é—²çº¿ç¨‹æ­£åœ¨æ‰§è¡Œ <code>SynchronousQueue.poll(keepAliveTime,TimeUnit.NANOSECONDS)</code>ï¼Œé‚£ä¹ˆä¸»çº¿ç¨‹æ‰§è¡Œ offer æ“ä½œä¸ç©ºé—²çº¿ç¨‹æ‰§è¡Œçš„ <code>poll</code> æ“ä½œé…å¯¹æˆåŠŸï¼Œä¸»çº¿ç¨‹æŠŠä»»åŠ¡äº¤ç»™ç©ºé—²çº¿ç¨‹æ‰§è¡Œï¼Œ<code>execute()</code>æ–¹æ³•æ‰§è¡Œå®Œæˆï¼Œå¦åˆ™æ‰§è¡Œä¸‹é¢çš„æ­¥éª¤ 2ï¼›</li>
<li>å½“åˆå§‹ <code>maximumPool</code> ä¸ºç©ºï¼Œæˆ–è€… <code>maximumPool</code> ä¸­æ²¡æœ‰ç©ºé—²çº¿ç¨‹æ—¶ï¼Œå°†æ²¡æœ‰çº¿ç¨‹æ‰§è¡Œ <code>SynchronousQueue.poll(keepAliveTime,TimeUnit.NANOSECONDS)</code>ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œæ­¥éª¤ 1 å°†å¤±è´¥ï¼Œæ­¤æ—¶ <code>CachedThreadPool</code> ä¼šåˆ›å»ºæ–°çº¿ç¨‹æ‰§è¡Œä»»åŠ¡ï¼Œexecute æ–¹æ³•æ‰§è¡Œå®Œæˆï¼›</li>
</ol>
<p><code>CachedThreadPool</code> çš„é—®é¢˜ï¼š</p>
<p><code>CachedThreadPool</code> ä½¿ç”¨çš„æ˜¯åŒæ­¥é˜Ÿåˆ— <code>SynchronousQueue</code>, å…è®¸åˆ›å»ºçš„çº¿ç¨‹æ•°é‡ä¸º <code>Integer.MAX_VALUE</code> ï¼Œå¯èƒ½ä¼šåˆ›å»ºå¤§é‡çº¿ç¨‹ï¼Œä»è€Œå¯¼è‡´ OOMã€‚</p>
<h3 id="ScheduleThreadPool"><a href="#ScheduleThreadPool" class="headerlink" title="ScheduleThreadPool"></a>ScheduleThreadPool</h3><p><code>ScheduledThreadPool</code> ç”¨æ¥åœ¨ç»™å®šçš„å»¶è¿Ÿåè¿è¡Œä»»åŠ¡æˆ–è€…å®šæœŸæ‰§è¡Œä»»åŠ¡ã€‚è¿™ä¸ªåœ¨å®é™…é¡¹ç›®ä¸­åŸºæœ¬ä¸ä¼šè¢«ç”¨åˆ°ï¼Œä¹Ÿä¸æ¨èä½¿ç”¨ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> ScheduledExecutorService <span class="title function_">newScheduledThreadPool</span><span class="params">(<span class="type">int</span> corePoolSize)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ScheduledThreadPoolExecutor</span>(corePoolSize);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="title function_">ScheduledThreadPoolExecutor</span><span class="params">(<span class="type">int</span> corePoolSize)</span> &#123;</span><br><span class="line">    <span class="built_in">super</span>(corePoolSize, Integer.MAX_VALUE, <span class="number">0</span>, NANOSECONDS,</span><br><span class="line">          <span class="keyword">new</span> <span class="title class_">DelayedWorkQueue</span>());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>ScheduledThreadPool</code> æ˜¯é€šè¿‡ <code>ScheduledThreadPoolExecutor</code> åˆ›å»ºçš„ï¼Œä½¿ç”¨çš„<code>DelayedWorkQueue</code>ï¼ˆå»¶è¿Ÿé˜»å¡é˜Ÿåˆ—ï¼‰ä½œä¸ºçº¿ç¨‹æ± çš„ä»»åŠ¡é˜Ÿåˆ—ã€‚</p>
<p><code>DelayedWorkQueue</code> çš„å†…éƒ¨å…ƒç´ å¹¶ä¸æ˜¯æŒ‰ç…§æ”¾å…¥çš„æ—¶é—´æ’åºï¼Œè€Œæ˜¯ä¼šæŒ‰ç…§å»¶è¿Ÿçš„æ—¶é—´é•¿çŸ­å¯¹ä»»åŠ¡è¿›è¡Œæ’åºï¼Œå†…éƒ¨é‡‡ç”¨çš„æ˜¯â€œå †â€çš„æ•°æ®ç»“æ„ï¼Œå¯ä»¥ä¿è¯æ¯æ¬¡å‡ºé˜Ÿçš„ä»»åŠ¡éƒ½æ˜¯å½“å‰é˜Ÿåˆ—ä¸­æ‰§è¡Œæ—¶é—´æœ€é å‰çš„ã€‚<code>DelayedWorkQueue</code> æ·»åŠ å…ƒç´ æ»¡äº†ä¹‹åä¼šè‡ªåŠ¨æ‰©å®¹åŸæ¥å®¹é‡çš„ 1&#x2F;2ï¼Œå³æ°¸è¿œä¸ä¼šé˜»å¡ï¼Œæœ€å¤§æ‰©å®¹å¯è¾¾ <code>Integer.MAX_VALUE</code>ï¼Œæ‰€ä»¥æœ€å¤šåªèƒ½åˆ›å»ºæ ¸å¿ƒçº¿ç¨‹æ•°çš„çº¿ç¨‹ã€‚</p>
<p><code>ScheduledThreadPoolExecutor</code> ç»§æ‰¿äº† <code>ThreadPoolExecutor</code>ï¼Œæ‰€ä»¥åˆ›å»º <code>ScheduledThreadExecutor</code> æœ¬è´¨ä¹Ÿæ˜¯åˆ›å»ºä¸€ä¸ª <code>ThreadPoolExecutor</code> çº¿ç¨‹æ± ï¼Œåªæ˜¯ä¼ å…¥çš„å‚æ•°ä¸ç›¸åŒã€‚</p>
<h4 id="ScheduledThreadPoolExecutor-å’Œ-Timer-å¯¹æ¯”"><a href="#ScheduledThreadPoolExecutor-å’Œ-Timer-å¯¹æ¯”" class="headerlink" title="ScheduledThreadPoolExecutor å’Œ Timer å¯¹æ¯”"></a>ScheduledThreadPoolExecutor å’Œ Timer å¯¹æ¯”</h4><ul>
<li><code>Timer</code> å¯¹ç³»ç»Ÿæ—¶é’Ÿçš„å˜åŒ–æ•æ„Ÿï¼Œ<code>ScheduledThreadPoolExecutor</code>ä¸æ˜¯ï¼›</li>
<li><code>Timer</code> åªæœ‰ä¸€ä¸ªæ‰§è¡Œçº¿ç¨‹ï¼Œå› æ­¤é•¿æ—¶é—´è¿è¡Œçš„ä»»åŠ¡å¯ä»¥å»¶è¿Ÿå…¶ä»–ä»»åŠ¡ã€‚ <code>ScheduledThreadPoolExecutor</code> å¯ä»¥é…ç½®ä»»æ„æ•°é‡çš„çº¿ç¨‹ã€‚ æ­¤å¤–ï¼Œå¦‚æœä½ æƒ³ï¼ˆé€šè¿‡æä¾› <code>ThreadFactory</code>ï¼‰ï¼Œä½ å¯ä»¥å®Œå…¨æ§åˆ¶åˆ›å»ºçš„çº¿ç¨‹ï¼›</li>
<li>åœ¨<code>TimerTask</code> ä¸­æŠ›å‡ºçš„è¿è¡Œæ—¶å¼‚å¸¸ä¼šæ€æ­»ä¸€ä¸ªçº¿ç¨‹ï¼Œä»è€Œå¯¼è‡´ <code>Timer</code> æ­»æœºå³è®¡åˆ’ä»»åŠ¡å°†ä¸å†è¿è¡Œã€‚<code>ScheduledThreadExecutor</code> ä¸ä»…æ•è·è¿è¡Œæ—¶å¼‚å¸¸ï¼Œè¿˜å…è®¸æ‚¨åœ¨éœ€è¦æ—¶å¤„ç†å®ƒä»¬ï¼ˆé€šè¿‡é‡å†™ <code>afterExecute</code> æ–¹æ³•<code>ThreadPoolExecutor</code>ï¼‰ã€‚æŠ›å‡ºå¼‚å¸¸çš„ä»»åŠ¡å°†è¢«å–æ¶ˆï¼Œä½†å…¶ä»–ä»»åŠ¡å°†ç»§ç»­è¿è¡Œã€‚</li>
</ul>
<h3 id="WorkStealingPool"><a href="#WorkStealingPool" class="headerlink" title="WorkStealingPool"></a>WorkStealingPool</h3><blockquote>
<p>WorkStealingPool æ˜¯ JDK8 æ‰å¼•å…¥çš„ã€‚</p>
</blockquote>
<p>å…¶å†…éƒ¨ä¼šæ„å»º <code>ForkJoinPool</code>ï¼Œåˆ©ç”¨ <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Work_stealing">Work-Stealing</a> ç®—æ³•ï¼Œå¹¶è¡Œåœ°å¤„ç†ä»»åŠ¡ï¼Œä¸ä¿è¯å¤„ç†é¡ºåºã€‚</p>
<h2 id="çº¿ç¨‹æ± æœ€ä½³å®è·µ"><a href="#çº¿ç¨‹æ± æœ€ä½³å®è·µ" class="headerlink" title="çº¿ç¨‹æ± æœ€ä½³å®è·µ"></a>çº¿ç¨‹æ± æœ€ä½³å®è·µ</h2><h3 id="è®¡ç®—çº¿ç¨‹æ•°é‡"><a href="#è®¡ç®—çº¿ç¨‹æ•°é‡" class="headerlink" title="è®¡ç®—çº¿ç¨‹æ•°é‡"></a>è®¡ç®—çº¿ç¨‹æ•°é‡</h3><p>ä¸€èˆ¬å¤šçº¿ç¨‹æ‰§è¡Œçš„ä»»åŠ¡ç±»å‹å¯ä»¥åˆ†ä¸º CPU å¯†é›†å‹å’Œ I&#x2F;O å¯†é›†å‹ï¼Œæ ¹æ®ä¸åŒçš„ä»»åŠ¡ç±»å‹ï¼Œæˆ‘ä»¬è®¡ç®—çº¿ç¨‹æ•°çš„æ–¹æ³•ä¹Ÿä¸ä¸€æ ·ã€‚</p>
<p><strong>CPU å¯†é›†å‹ä»»åŠ¡ï¼š</strong>è¿™ç§ä»»åŠ¡æ¶ˆè€—çš„ä¸»è¦æ˜¯ CPU èµ„æºï¼Œå¯ä»¥å°†çº¿ç¨‹æ•°è®¾ç½®ä¸º Nï¼ˆCPU æ ¸å¿ƒæ•°ï¼‰+1ï¼Œæ¯” CPU æ ¸å¿ƒæ•°å¤šå‡ºæ¥çš„ä¸€ä¸ªçº¿ç¨‹æ˜¯ä¸ºäº†é˜²æ­¢çº¿ç¨‹å¶å‘çš„ç¼ºé¡µä¸­æ–­ï¼Œæˆ–è€…å…¶å®ƒåŸå› å¯¼è‡´çš„ä»»åŠ¡æš‚åœè€Œå¸¦æ¥çš„å½±å“ã€‚ä¸€æ—¦ä»»åŠ¡æš‚åœï¼ŒCPU å°±ä¼šå¤„äºç©ºé—²çŠ¶æ€ï¼Œè€Œåœ¨è¿™ç§æƒ…å†µä¸‹å¤šå‡ºæ¥çš„ä¸€ä¸ªçº¿ç¨‹å°±å¯ä»¥å……åˆ†åˆ©ç”¨ CPU çš„ç©ºé—²æ—¶é—´ã€‚</p>
<p><strong>I&#x2F;O å¯†é›†å‹ä»»åŠ¡ï¼š</strong>è¿™ç§ä»»åŠ¡åº”ç”¨èµ·æ¥ï¼Œç³»ç»Ÿä¼šç”¨å¤§éƒ¨åˆ†çš„æ—¶é—´æ¥å¤„ç† I&#x2F;O äº¤äº’ï¼Œè€Œçº¿ç¨‹åœ¨å¤„ç† I&#x2F;O çš„æ—¶é—´æ®µå†…ä¸ä¼šå ç”¨ CPU æ¥å¤„ç†ï¼Œè¿™æ—¶å°±å¯ä»¥å°† CPU äº¤å‡ºç»™å…¶å®ƒçº¿ç¨‹ä½¿ç”¨ã€‚å› æ­¤åœ¨ I&#x2F;O å¯†é›†å‹ä»»åŠ¡çš„åº”ç”¨ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å¤šé…ç½®ä¸€äº›çº¿ç¨‹ï¼Œå…·ä½“çš„è®¡ç®—æ–¹æ³•æ˜¯ 2Nã€‚</p>
<h3 id="å»ºè®®ä½¿ç”¨æœ‰ç•Œé˜»å¡é˜Ÿåˆ—"><a href="#å»ºè®®ä½¿ç”¨æœ‰ç•Œé˜»å¡é˜Ÿåˆ—" class="headerlink" title="å»ºè®®ä½¿ç”¨æœ‰ç•Œé˜»å¡é˜Ÿåˆ—"></a>å»ºè®®ä½¿ç”¨æœ‰ç•Œé˜»å¡é˜Ÿåˆ—</h3><p>ä¸å»ºè®®ä½¿ç”¨ <code>Executors</code> çš„æœ€é‡è¦çš„åŸå› æ˜¯ï¼š<code>Executors</code> æä¾›çš„å¾ˆå¤šæ–¹æ³•é»˜è®¤ä½¿ç”¨çš„éƒ½æ˜¯æ— ç•Œçš„ <code>LinkedBlockingQueue</code>ï¼Œé«˜è´Ÿè½½æƒ…å¢ƒä¸‹ï¼Œæ— ç•Œé˜Ÿåˆ—å¾ˆå®¹æ˜“å¯¼è‡´ OOMï¼Œè€Œ OOM ä¼šå¯¼è‡´æ‰€æœ‰è¯·æ±‚éƒ½æ— æ³•å¤„ç†ï¼Œè¿™æ˜¯è‡´å‘½é—®é¢˜ã€‚æ‰€ä»¥<strong>å¼ºçƒˆå»ºè®®ä½¿ç”¨æœ‰ç•Œé˜Ÿåˆ—</strong>ã€‚</p>
<p>ã€Šé˜¿é‡Œå·´å·´ Java å¼€å‘æ‰‹å†Œã€‹ä¸­æåˆ°ï¼Œç¦æ­¢ä½¿ç”¨è¿™äº›æ–¹æ³•æ¥åˆ›å»ºçº¿ç¨‹æ± ï¼Œè€Œåº”è¯¥æ‰‹åŠ¨ <code>new ThreadPoolExecutor</code> æ¥åˆ›å»ºçº¿ç¨‹æ± ã€‚åˆ¶è®¢è¿™æ¡è§„åˆ™æ˜¯å› ä¸ºå®¹æ˜“å¯¼è‡´ç”Ÿäº§äº‹æ•…ï¼Œæœ€å…¸å‹çš„å°±æ˜¯ <code>newFixedThreadPool</code> å’Œ <code>newCachedThreadPool</code>ï¼Œå¯èƒ½å› ä¸ºèµ„æºè€—å°½å¯¼è‡´ OOM é—®é¢˜ã€‚</p>
<p>ã€ç¤ºä¾‹ã€‘<code>newFixedThreadPool</code> OOM</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ThreadPoolExecutor</span> <span class="variable">threadPool</span> <span class="operator">=</span> (ThreadPoolExecutor) Executors.newFixedThreadPool(<span class="number">1</span>);</span><br><span class="line">printStats(threadPool);</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">100000000</span>; i++) &#123;</span><br><span class="line">	threadPool.execute(() -&gt; &#123;</span><br><span class="line">		<span class="type">String</span> <span class="variable">payload</span> <span class="operator">=</span> IntStream.rangeClosed(<span class="number">1</span>, <span class="number">1000000</span>)</span><br><span class="line">			.mapToObj(__ -&gt; <span class="string">&quot;a&quot;</span>)</span><br><span class="line">			.collect(Collectors.joining(<span class="string">&quot;&quot;</span>)) + UUID.randomUUID().toString();</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			TimeUnit.HOURS.sleep(<span class="number">1</span>);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">		&#125;</span><br><span class="line">		log.info(payload);</span><br><span class="line">	&#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">threadPool.shutdown();</span><br><span class="line">threadPool.awaitTermination(<span class="number">1</span>, TimeUnit.HOURS);</span><br></pre></td></tr></table></figure>

<p><code>newFixedThreadPool</code> ä½¿ç”¨çš„å·¥ä½œé˜Ÿåˆ—æ˜¯ <code>LinkedBlockingQueue</code> ï¼Œè€Œé»˜è®¤æ„é€ æ–¹æ³•çš„ <code>LinkedBlockingQueue</code> æ˜¯ä¸€ä¸ª <code>Integer.MAX_VALUE</code> é•¿åº¦çš„é˜Ÿåˆ—ï¼Œå¯ä»¥è®¤ä¸ºæ˜¯æ— ç•Œçš„ã€‚å¦‚æœä»»åŠ¡è¾ƒå¤šå¹¶ä¸”æ‰§è¡Œè¾ƒæ…¢çš„è¯ï¼Œé˜Ÿåˆ—å¯èƒ½ä¼šå¿«é€Ÿç§¯å‹ï¼Œæ’‘çˆ†å†…å­˜å¯¼è‡´ OOMã€‚</p>
<p>ã€ç¤ºä¾‹ã€‘<code>newCachedThreadPool</code> OOM</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ThreadPoolExecutor</span> <span class="variable">threadPool</span> <span class="operator">=</span> (ThreadPoolExecutor) Executors.newCachedThreadPool();</span><br><span class="line">printStats(threadPool);</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">100000000</span>; i++) &#123;</span><br><span class="line">	threadPool.execute(() -&gt; &#123;</span><br><span class="line">		<span class="type">String</span> <span class="variable">payload</span> <span class="operator">=</span> UUID.randomUUID().toString();</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			TimeUnit.HOURS.sleep(<span class="number">1</span>);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">		&#125;</span><br><span class="line">		log.info(payload);</span><br><span class="line">	&#125;);</span><br><span class="line">&#125;</span><br><span class="line">threadPool.shutdown();</span><br><span class="line">threadPool.awaitTermination(<span class="number">1</span>, TimeUnit.HOURS);</span><br></pre></td></tr></table></figure>

<p><code>newCachedThreadPool</code> çš„æœ€å¤§çº¿ç¨‹æ•°æ˜¯ <code>Integer.MAX_VALUE</code>ï¼Œå¯ä»¥è®¤ä¸ºæ˜¯æ²¡æœ‰ä¸Šé™çš„ï¼Œè€Œå…¶å·¥ä½œé˜Ÿåˆ— <code>SynchronousQueue</code> æ˜¯ä¸€ä¸ªæ²¡æœ‰å­˜å‚¨ç©ºé—´çš„é˜»å¡é˜Ÿåˆ—ã€‚è¿™æ„å‘³ç€ï¼Œåªè¦æœ‰è¯·æ±‚åˆ°æ¥ï¼Œå°±å¿…é¡»æ‰¾åˆ°ä¸€æ¡å·¥ä½œçº¿ç¨‹æ¥å¤„ç†ï¼Œå¦‚æœå½“å‰æ²¡æœ‰ç©ºé—²çš„çº¿ç¨‹å°±å†åˆ›å»ºä¸€æ¡æ–°çš„ã€‚</p>
<p>å¦‚æœå¤§é‡çš„ä»»åŠ¡è¿›æ¥åä¼šåˆ›å»ºå¤§é‡çš„çº¿ç¨‹ã€‚æˆ‘ä»¬çŸ¥é“çº¿ç¨‹æ˜¯éœ€è¦åˆ†é…ä¸€å®šçš„å†…å­˜ç©ºé—´ä½œä¸ºçº¿ç¨‹æ ˆçš„ï¼Œæ¯”å¦‚ 1MBï¼Œå› æ­¤æ— é™åˆ¶åˆ›å»ºçº¿ç¨‹å¿…ç„¶ä¼šå¯¼è‡´ OOMã€‚</p>
<h3 id="ç›‘æµ‹çº¿ç¨‹æ± è¿è¡ŒçŠ¶æ€"><a href="#ç›‘æµ‹çº¿ç¨‹æ± è¿è¡ŒçŠ¶æ€" class="headerlink" title="ç›‘æµ‹çº¿ç¨‹æ± è¿è¡ŒçŠ¶æ€"></a>ç›‘æµ‹çº¿ç¨‹æ± è¿è¡ŒçŠ¶æ€</h3><p>å¯ä»¥é€šè¿‡ä¸€äº›æ‰‹æ®µæ¥æ£€æµ‹çº¿ç¨‹æ± çš„è¿è¡ŒçŠ¶æ€æ¯”å¦‚ SpringBoot ä¸­çš„ Actuator ç»„ä»¶ã€‚</p>
<p>é™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥åˆ©ç”¨ <code>ThreadPoolExecutor</code> çš„ç›¸å…³ API åšä¸€ä¸ªç®€é™‹çš„ç›‘æ§ã€‚ä»ä¸‹å›¾å¯ä»¥çœ‹å‡ºï¼Œ <code>ThreadPoolExecutor</code>æä¾›äº†è·å–çº¿ç¨‹æ± å½“å‰çš„çº¿ç¨‹æ•°å’Œæ´»è·ƒçº¿ç¨‹æ•°ã€å·²ç»æ‰§è¡Œå®Œæˆçš„ä»»åŠ¡æ•°ã€æ­£åœ¨æ’é˜Ÿä¸­çš„ä»»åŠ¡æ•°ç­‰ç­‰ã€‚</p>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ Demoã€‚<code>printThreadPoolStatus()</code>ä¼šæ¯éš”ä¸€ç§’æ‰“å°å‡ºçº¿ç¨‹æ± çš„çº¿ç¨‹æ•°ã€æ´»è·ƒçº¿ç¨‹æ•°ã€å®Œæˆçš„ä»»åŠ¡æ•°ã€ä»¥åŠé˜Ÿåˆ—ä¸­çš„ä»»åŠ¡æ•°ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">printThreadPoolStatus</span><span class="params">(ThreadPoolExecutor threadPool)</span> &#123;</span><br><span class="line">    <span class="type">ScheduledExecutorService</span> <span class="variable">scheduledExecutorService</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ScheduledThreadPoolExecutor</span>(<span class="number">1</span>, createThreadFactory(<span class="string">&quot;print-images/thread-pool-status&quot;</span>, <span class="literal">false</span>));</span><br><span class="line">    scheduledExecutorService.scheduleAtFixedRate(() -&gt; &#123;</span><br><span class="line">        log.info(<span class="string">&quot;=========================&quot;</span>);</span><br><span class="line">        log.info(<span class="string">&quot;ThreadPool Size: [&#123;&#125;]&quot;</span>, threadPool.getPoolSize());</span><br><span class="line">        log.info(<span class="string">&quot;Active Threads: &#123;&#125;&quot;</span>, threadPool.getActiveCount());</span><br><span class="line">        log.info(<span class="string">&quot;Number of Tasks : &#123;&#125;&quot;</span>, threadPool.getCompletedTaskCount());</span><br><span class="line">        log.info(<span class="string">&quot;Number of Tasks in Queue: &#123;&#125;&quot;</span>, threadPool.getQueue().size());</span><br><span class="line">        log.info(<span class="string">&quot;=========================&quot;</span>);</span><br><span class="line">    &#125;, <span class="number">0</span>, <span class="number">1</span>, TimeUnit.SECONDS);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="çº¿ç¨‹æ± å’Œ-ThreadLocal"><a href="#çº¿ç¨‹æ± å’Œ-ThreadLocal" class="headerlink" title="çº¿ç¨‹æ± å’Œ ThreadLocal"></a>çº¿ç¨‹æ± å’Œ ThreadLocal</h3><p>çº¿ç¨‹æ± å’Œ <code>ThreadLocal</code>å…±ç”¨ï¼Œå¯èƒ½ä¼šå¯¼è‡´çº¿ç¨‹ä»<code>ThreadLocal</code>è·å–åˆ°çš„æ˜¯æ—§å€¼&#x2F;è„æ•°æ®ã€‚è¿™æ˜¯å› ä¸ºçº¿ç¨‹æ± ä¼šå¤ç”¨çº¿ç¨‹å¯¹è±¡ï¼Œä¸çº¿ç¨‹å¯¹è±¡ç»‘å®šçš„ç±»çš„é™æ€å±æ€§ <code>ThreadLocal</code> å˜é‡ä¹Ÿä¼šè¢«é‡ç”¨ï¼Œè¿™å°±å¯¼è‡´ä¸€ä¸ªçº¿ç¨‹å¯èƒ½è·å–åˆ°å…¶ä»–çº¿ç¨‹çš„<code>ThreadLocal</code> å€¼ã€‚</p>
<p>ä¸è¦ä»¥ä¸ºä»£ç ä¸­æ²¡æœ‰æ˜¾ç¤ºä½¿ç”¨çº¿ç¨‹æ± å°±ä¸å­˜åœ¨çº¿ç¨‹æ± äº†ï¼Œåƒå¸¸ç”¨çš„ Web æœåŠ¡å™¨ Tomcat å¤„ç†ä»»åŠ¡ä¸ºäº†æé«˜å¹¶å‘é‡ï¼Œå°±ä½¿ç”¨åˆ°äº†çº¿ç¨‹æ± ï¼Œå¹¶ä¸”ä½¿ç”¨çš„æ˜¯åŸºäºåŸç”Ÿ Java çº¿ç¨‹æ± æ”¹è¿›å®Œå–„å¾—åˆ°çš„è‡ªå®šä¹‰çº¿ç¨‹æ± ã€‚</p>
<p>å½“ç„¶äº†ï¼Œä½ å¯ä»¥å°† Tomcat è®¾ç½®ä¸ºå•çº¿ç¨‹å¤„ç†ä»»åŠ¡ã€‚ä¸è¿‡ï¼Œè¿™å¹¶ä¸åˆé€‚ï¼Œä¼šä¸¥é‡å½±å“å…¶å¤„ç†ä»»åŠ¡çš„é€Ÿåº¦ã€‚</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server.tomcat.max-threads</span>=<span class="string">1</span></span><br></pre></td></tr></table></figure>

<p>è§£å†³ä¸Šè¿°é—®é¢˜æ¯”è¾ƒå»ºè®®çš„åŠæ³•æ˜¯ä½¿ç”¨é˜¿é‡Œå·´å·´å¼€æºçš„ <code>TransmittableThreadLocal</code>(<code>TTL</code>)ã€‚<code>TransmittableThreadLocal</code>ç±»ç»§æ‰¿å¹¶åŠ å¼ºäº† JDK å†…ç½®çš„<code>InheritableThreadLocal</code>ç±»ï¼Œåœ¨ä½¿ç”¨çº¿ç¨‹æ± ç­‰ä¼šæ± åŒ–å¤ç”¨çº¿ç¨‹çš„æ‰§è¡Œç»„ä»¶æƒ…å†µä¸‹ï¼Œæä¾›<code>ThreadLocal</code>å€¼çš„ä¼ é€’åŠŸèƒ½ï¼Œè§£å†³å¼‚æ­¥æ‰§è¡Œæ—¶ä¸Šä¸‹æ–‡ä¼ é€’çš„é—®é¢˜ã€‚</p>
<p><code>TransmittableThreadLocal</code> é¡¹ç›®åœ°å€ï¼š<a target="_blank" rel="noopener" href="https://github.com/alibaba/transmittable-thread-local">https://github.com/alibaba/transmittable-thread-localopen in new window</a> ã€‚</p>
<h3 id="é‡è¦ä»»åŠ¡åº”è¯¥è‡ªå®šä¹‰æ‹’ç»ç­–ç•¥"><a href="#é‡è¦ä»»åŠ¡åº”è¯¥è‡ªå®šä¹‰æ‹’ç»ç­–ç•¥" class="headerlink" title="é‡è¦ä»»åŠ¡åº”è¯¥è‡ªå®šä¹‰æ‹’ç»ç­–ç•¥"></a>é‡è¦ä»»åŠ¡åº”è¯¥è‡ªå®šä¹‰æ‹’ç»ç­–ç•¥</h3><p>ä½¿ç”¨æœ‰ç•Œé˜Ÿåˆ—ï¼Œå½“ä»»åŠ¡è¿‡å¤šæ—¶ï¼Œçº¿ç¨‹æ± ä¼šè§¦å‘æ‰§è¡Œæ‹’ç»ç­–ç•¥ï¼Œçº¿ç¨‹æ± é»˜è®¤çš„æ‹’ç»ç­–ç•¥ä¼š throw <code>RejectedExecutionException</code> è¿™æ˜¯ä¸ªè¿è¡Œæ—¶å¼‚å¸¸ï¼Œå¯¹äºè¿è¡Œæ—¶å¼‚å¸¸ç¼–è¯‘å™¨å¹¶ä¸å¼ºåˆ¶ <code>catch</code> å®ƒï¼Œæ‰€ä»¥å¼€å‘äººå‘˜å¾ˆå®¹æ˜“å¿½ç•¥ã€‚å› æ­¤<strong>é»˜è®¤æ‹’ç»ç­–ç•¥è¦æ…é‡ä½¿ç”¨</strong>ã€‚å¦‚æœçº¿ç¨‹æ± å¤„ç†çš„ä»»åŠ¡éå¸¸é‡è¦ï¼Œå»ºè®®è‡ªå®šä¹‰è‡ªå·±çš„æ‹’ç»ç­–ç•¥ï¼›å¹¶ä¸”åœ¨å®é™…å·¥ä½œä¸­ï¼Œè‡ªå®šä¹‰çš„æ‹’ç»ç­–ç•¥å¾€å¾€å’Œé™çº§ç­–ç•¥é…åˆä½¿ç”¨ã€‚</p>
<h3 id="åŠ¨æ€çº¿ç¨‹æ± "><a href="#åŠ¨æ€çº¿ç¨‹æ± " class="headerlink" title="åŠ¨æ€çº¿ç¨‹æ± "></a>åŠ¨æ€çº¿ç¨‹æ± </h3><p>ç¾å›¢æŠ€æœ¯å›¢é˜Ÿåœ¨ <a target="_blank" rel="noopener" href="https://tech.meituan.com/2020/04/02/java-pooling-pratice-in-meituan.html">ã€ŠJava çº¿ç¨‹æ± å®ç°åŸç†åŠå…¶åœ¨ç¾å›¢ä¸šåŠ¡ä¸­çš„å®è·µã€‹</a> è¿™ç¯‡æ–‡ç« ä¸­ä»‹ç»åˆ°å¯¹çº¿ç¨‹æ± å‚æ•°å®ç°å¯è‡ªå®šä¹‰é…ç½®çš„æ€è·¯å’Œæ–¹æ³•ã€‚</p>
<p>ç¾å›¢æŠ€æœ¯å›¢é˜Ÿçš„æ€è·¯æ˜¯ä¸»è¦å¯¹çº¿ç¨‹æ± çš„æ ¸å¿ƒå‚æ•°å®ç°è‡ªå®šä¹‰å¯é…ç½®ã€‚è¿™ä¸‰ä¸ªæ ¸å¿ƒå‚æ•°æ˜¯ï¼š</p>
<ul>
<li><strong><code>corePoolSize</code></strong> - æ ¸å¿ƒçº¿ç¨‹æ•°çº¿ç¨‹æ•°å®šä¹‰äº†æœ€å°å¯ä»¥åŒæ—¶è¿è¡Œçš„çº¿ç¨‹æ•°é‡ã€‚</li>
<li><strong><code>maximumPoolSize</code></strong> - å½“é˜Ÿåˆ—ä¸­å­˜æ”¾çš„ä»»åŠ¡è¾¾åˆ°é˜Ÿåˆ—å®¹é‡çš„æ—¶å€™ï¼Œå½“å‰å¯ä»¥åŒæ—¶è¿è¡Œçš„çº¿ç¨‹æ•°é‡å˜ä¸ºæœ€å¤§çº¿ç¨‹æ•°ã€‚</li>
<li><strong><code>workQueue</code></strong> - å½“æ–°ä»»åŠ¡æ¥çš„æ—¶å€™ä¼šå…ˆåˆ¤æ–­å½“å‰è¿è¡Œçš„çº¿ç¨‹æ•°é‡æ˜¯å¦è¾¾åˆ°æ ¸å¿ƒçº¿ç¨‹æ•°ï¼Œå¦‚æœè¾¾åˆ°çš„è¯ï¼Œæ–°ä»»åŠ¡å°±ä¼šè¢«å­˜æ”¾åœ¨é˜Ÿåˆ—ä¸­ã€‚</li>
</ul>
<p>JDK åŸç”Ÿçº¿ç¨‹æ±  <code>ThreadPoolExecutor</code> æä¾›äº†å¦‚ä¸‹å‡ ä¸ª public çš„ setter æ–¹æ³•ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://p1.meituan.net/travelcube/efd32f1211e9cf0a3ca9d35b0dc5de8588353.png" alt="å›¾ 19 JDK çº¿ç¨‹æ± å‚æ•°è®¾ç½®æ¥å£"></p>
<p>JDK å…è®¸çº¿ç¨‹æ± ä½¿ç”¨æ–¹é€šè¿‡ <code>ThreadPoolExecutor</code> çš„å®ä¾‹æ¥åŠ¨æ€è®¾ç½®çº¿ç¨‹æ± çš„æ ¸å¿ƒç­–ç•¥ã€‚</p>
<p>é‡ç‚¹æ˜¯åŸºäºè¿™å‡ ä¸ª <code>public</code> æ–¹æ³•ï¼Œæˆ‘ä»¬åªéœ€è¦ç»´æŠ¤ <code>ThreadPoolExecutor</code> çš„å®ä¾‹ï¼Œå¹¶ä¸”åœ¨éœ€è¦ä¿®æ”¹çš„æ—¶å€™æ‹¿åˆ°å®ä¾‹ä¿®æ”¹å…¶å‚æ•°å³å¯ã€‚åŸºäºä»¥ä¸Šçš„æ€è·¯ï¼Œç¾å›¢å®ç°äº†çº¿ç¨‹æ± å‚æ•°çš„åŠ¨æ€åŒ–ã€çº¿ç¨‹æ± å‚æ•°åœ¨ç®¡ç†å¹³å°å¯é…ç½®å¯ä¿®æ”¹ï¼Œå…¶æ•ˆæœå›¾å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://p0.meituan.net/travelcube/414ba7f3abd11e5f805c58635ae10988166121.png" alt="å›¾ 21 å¯åŠ¨æ€ä¿®æ”¹çº¿ç¨‹æ± å‚æ•°"></p>
<p>å¦‚æœæˆ‘ä»¬çš„é¡¹ç›®ä¹Ÿæƒ³è¦å®ç°è¿™ç§æ•ˆæœçš„è¯ï¼Œå¯ä»¥å€ŸåŠ©ç°æˆçš„å¼€æºé¡¹ç›®ï¼š</p>
<ul>
<li><strong><a target="_blank" rel="noopener" href="https://github.com/opengoofy/hippo4j">Hippo4jopen</a></strong> - å¼‚æ­¥çº¿ç¨‹æ± æ¡†æ¶ï¼Œæ”¯æŒçº¿ç¨‹æ± åŠ¨æ€å˜æ›´&amp;ç›‘æ§&amp;æŠ¥è­¦ï¼Œæ— éœ€ä¿®æ”¹ä»£ç è½»æ¾å¼•å…¥ã€‚æ”¯æŒå¤šç§ä½¿ç”¨æ¨¡å¼ï¼Œè½»æ¾å¼•å…¥ï¼Œè‡´åŠ›äºæé«˜ç³»ç»Ÿè¿è¡Œä¿éšœèƒ½åŠ›ã€‚</li>
<li><strong><a target="_blank" rel="noopener" href="https://github.com/dromara/dynamic-tp">Dynamic TPopen</a></strong> - è½»é‡çº§åŠ¨æ€çº¿ç¨‹æ± ï¼Œå†…ç½®ç›‘æ§å‘Šè­¦åŠŸèƒ½ï¼Œé›†æˆä¸‰æ–¹ä¸­é—´ä»¶çº¿ç¨‹æ± ç®¡ç†ï¼ŒåŸºäºä¸»æµé…ç½®ä¸­å¿ƒï¼ˆå·²æ”¯æŒ Nacosã€Apolloï¼ŒZookeeperã€Consulã€Etcdï¼Œå¯é€šè¿‡ SPI è‡ªå®šä¹‰å®ç°ï¼‰ã€‚</li>
</ul>
<h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><ul>
<li><a target="_blank" rel="noopener" href="https://book.douban.com/subject/10484692/">ã€ŠJava å¹¶å‘ç¼–ç¨‹å®æˆ˜ã€‹</a></li>
<li><a target="_blank" rel="noopener" href="https://book.douban.com/subject/26591326/">ã€ŠJava å¹¶å‘ç¼–ç¨‹çš„è‰ºæœ¯ã€‹</a></li>
<li><a target="_blank" rel="noopener" href="https://time.geekbang.org/column/intro/100023901">æå®¢æ—¶é—´æ•™ç¨‹ - Java å¹¶å‘ç¼–ç¨‹å®æˆ˜</a></li>
<li><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/d2729853c4da">æ·±å…¥ç†è§£ Java çº¿ç¨‹æ± ï¼šThreadPoolExecutor</a></li>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/MOBIN/p/5436482.html">java å¹¶å‘ç¼–ç¨‹â€“Executor æ¡†æ¶</a></li>
<li><a target="_blank" rel="noopener" href="https://tech.meituan.com/2020/04/02/java-pooling-pratice-in-meituan.html">Java çº¿ç¨‹æ± å®ç°åŸç†åŠå…¶åœ¨ç¾å›¢ä¸šåŠ¡ä¸­çš„å®è·µ</a></li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://dunwu.github.io/blog/pages/3f571b78/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/blog/uploads/avatar.gif">
      <meta itemprop="name" content="é’æ‚Ÿ â—¾ Dunwu">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Dunwu Blog">
      <meta itemprop="description" content="é’æ‚Ÿçš„ä¸ªäººåšå®¢">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content=" | Dunwu Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/blog/pages/3f571b78/" class="post-title-link" itemprop="url">Maven æ’ä»¶ä¹‹ä»£ç æ£€æŸ¥</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">å‘è¡¨äº</span>

      <time title="åˆ›å»ºæ—¶é—´ï¼š2019-12-16 17:09:26" itemprop="dateCreated datePublished" datetime="2019-12-16T17:09:26+08:00">2019-12-16</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">æ›´æ–°äº</span>
      <time title="ä¿®æ”¹æ—¶é—´ï¼š2025-09-13 17:56:53" itemprop="dateModified" datetime="2025-09-13T17:56:53+08:00">2025-09-13</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">åˆ†ç±»äº</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/blog/categories/Java/" itemprop="url" rel="index"><span itemprop="name">Java</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/blog/categories/Java/%E8%BD%AF%E4%BB%B6/" itemprop="url" rel="index"><span itemprop="name">è½¯ä»¶</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/blog/categories/Java/%E8%BD%AF%E4%BB%B6/%E6%9E%84%E5%BB%BA/" itemprop="url" rel="index"><span itemprop="name">æ„å»º</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/blog/categories/Java/%E8%BD%AF%E4%BB%B6/%E6%9E%84%E5%BB%BA/Maven/" itemprop="url" rel="index"><span itemprop="name">Maven</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
      <span>16k</span>
    </span>
    <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
      <span>15 åˆ†é’Ÿ</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="Maven-æ’ä»¶ä¹‹ä»£ç æ£€æŸ¥"><a href="#Maven-æ’ä»¶ä¹‹ä»£ç æ£€æŸ¥" class="headerlink" title="Maven æ’ä»¶ä¹‹ä»£ç æ£€æŸ¥"></a>Maven æ’ä»¶ä¹‹ä»£ç æ£€æŸ¥</h1><h2 id="maven-checkstyle-plugin"><a href="#maven-checkstyle-plugin" class="headerlink" title="maven-checkstyle-plugin"></a>maven-checkstyle-plugin</h2><blockquote>
<p><strong>maven-checkstyle-pluginï¼Œç”¨äºæ£€æµ‹ä»£ç ä¸­ä¸ç¬¦åˆè§„èŒƒçš„åœ°æ–¹ã€‚</strong></p>
</blockquote>
<h3 id="å®šä¹‰-checkstyle-xml"><a href="#å®šä¹‰-checkstyle-xml" class="headerlink" title="å®šä¹‰ checkstyle.xml"></a>å®šä¹‰ checkstyle.xml</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">module</span> <span class="keyword">PUBLIC</span></span></span><br><span class="line"><span class="meta">  <span class="string">&quot;-//Checkstyle//DTD Checkstyle Configuration 1.3//EN&quot;</span></span></span><br><span class="line"><span class="meta">  <span class="string">&quot;https://checkstyle.org/dtds/configuration_1_3.dtd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- Generated by RHY @will_awoke --&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">module</span> <span class="attr">name</span>=<span class="string">&quot;Checker&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;charset&quot;</span> <span class="attr">value</span>=<span class="string">&quot;UTF-8&quot;</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;severity&quot;</span> <span class="attr">value</span>=<span class="string">&quot;warning&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- Checks for Size Violations.  --&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- æ£€æŸ¥æ–‡ä»¶çš„é•¿åº¦ï¼ˆè¡Œï¼‰ default max=2000 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">module</span> <span class="attr">name</span>=<span class="string">&quot;FileLength&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;max&quot;</span> <span class="attr">value</span>=<span class="string">&quot;2500&quot;</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">module</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- Checks that property files contain the same keys. --&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- æ£€æŸ¥**.propertiesé…ç½®æ–‡ä»¶ æ˜¯å¦æœ‰ç›¸åŒçš„key</span></span><br><span class="line"><span class="comment">  &lt;module name=&quot;Translation&quot;&gt;</span></span><br><span class="line"><span class="comment">  &lt;/module&gt;</span></span><br><span class="line"><span class="comment">  --&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">module</span> <span class="attr">name</span>=<span class="string">&quot;TreeWalker&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- Checks for imports    --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- å¿…é¡»å¯¼å…¥ç±»çš„å®Œæ•´è·¯å¾„ï¼Œå³ä¸èƒ½ä½¿ç”¨*å¯¼å…¥æ‰€éœ€çš„ç±» --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">module</span> <span class="attr">name</span>=<span class="string">&quot;AvoidStarImport&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- æ£€æŸ¥æ˜¯å¦ä»éæ³•çš„åŒ…ä¸­å¯¼å…¥äº†ç±» illegalPkgs: å®šä¹‰éæ³•çš„åŒ…åç§°--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">module</span> <span class="attr">name</span>=<span class="string">&quot;IllegalImport&quot;</span>/&gt;</span> <span class="comment">&lt;!-- defaults to sun.* packages --&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- æ£€æŸ¥æ˜¯å¦å¯¼å…¥äº†ä¸å¿…æ˜¾ç¤ºå¯¼å…¥çš„ç±»--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">module</span> <span class="attr">name</span>=<span class="string">&quot;RedundantImport&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- æ£€æŸ¥æ˜¯å¦å¯¼å…¥çš„åŒ…æ²¡æœ‰ä½¿ç”¨--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">module</span> <span class="attr">name</span>=<span class="string">&quot;UnusedImports&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- Checks for whitespace</span></span><br><span class="line"><span class="comment">    &lt;module name=&quot;EmptyForIteratorPad&quot;/&gt;</span></span><br><span class="line"><span class="comment">    &lt;module name=&quot;MethodParamPad&quot;/&gt;</span></span><br><span class="line"><span class="comment">    &lt;module name=&quot;NoWhitespaceAfter&quot;/&gt;</span></span><br><span class="line"><span class="comment">    &lt;module name=&quot;NoWhitespaceBefore&quot;/&gt;</span></span><br><span class="line"><span class="comment">    &lt;module name=&quot;OperatorWrap&quot;/&gt;</span></span><br><span class="line"><span class="comment">    &lt;module name=&quot;ParenPad&quot;/&gt;</span></span><br><span class="line"><span class="comment">    &lt;module name=&quot;TypecastParenPad&quot;/&gt;</span></span><br><span class="line"><span class="comment">    &lt;module name=&quot;WhitespaceAfter&quot;/&gt;</span></span><br><span class="line"><span class="comment">    &lt;module name=&quot;WhitespaceAround&quot;/&gt;</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- æ£€æŸ¥ç±»å’Œæ¥å£çš„javadoc é»˜è®¤ä¸æ£€æŸ¥author å’Œversion tags</span></span><br><span class="line"><span class="comment">      authorFormat: æ£€æŸ¥authoræ ‡ç­¾çš„æ ¼å¼</span></span><br><span class="line"><span class="comment">            versionFormat: æ£€æŸ¥versionæ ‡ç­¾çš„æ ¼å¼</span></span><br><span class="line"><span class="comment">            scope: å¯ä»¥æ£€æŸ¥çš„ç±»çš„èŒƒå›´ï¼Œä¾‹å¦‚ï¼špublicåªèƒ½æ£€æŸ¥publicä¿®é¥°çš„ç±»ï¼Œprivateå¯ä»¥æ£€æŸ¥æ‰€æœ‰çš„ç±»</span></span><br><span class="line"><span class="comment">            excludeScope: ä¸èƒ½æ£€æŸ¥çš„ç±»çš„èŒƒå›´ï¼Œä¾‹å¦‚ï¼špublicï¼Œpublicçš„ç±»å°†ä¸è¢«æ£€æŸ¥ï¼Œä½†è®¿é—®æƒé™å°äºpublicçš„ç±»ä»ç„¶ä¼šæ£€æŸ¥ï¼Œå…¶ä»–çš„æƒé™ä»¥æ­¤ç±»æ¨</span></span><br><span class="line"><span class="comment">            tokens: è¯¥å±æ€§é€‚ç”¨çš„ç±»å‹ï¼Œä¾‹å¦‚ï¼šCLASS_DEF,INTERFACE_DEF --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">module</span> <span class="attr">name</span>=<span class="string">&quot;JavadocType&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;authorFormat&quot;</span> <span class="attr">value</span>=<span class="string">&quot;\S&quot;</span>/&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;scope&quot;</span> <span class="attr">value</span>=<span class="string">&quot;protected&quot;</span>/&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;tokens&quot;</span> <span class="attr">value</span>=<span class="string">&quot;CLASS_DEF,INTERFACE_DEF&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">module</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- æ£€æŸ¥æ–¹æ³•çš„javadocçš„æ³¨é‡Š</span></span><br><span class="line"><span class="comment">            scope: å¯ä»¥æ£€æŸ¥çš„æ–¹æ³•çš„èŒƒå›´ï¼Œä¾‹å¦‚ï¼špublicåªèƒ½æ£€æŸ¥publicä¿®é¥°çš„æ–¹æ³•ï¼Œprivateå¯ä»¥æ£€æŸ¥æ‰€æœ‰çš„æ–¹æ³•</span></span><br><span class="line"><span class="comment">            allowMissingParamTags: æ˜¯å¦å¿½ç•¥å¯¹å‚æ•°æ³¨é‡Šçš„æ£€æŸ¥</span></span><br><span class="line"><span class="comment">            allowMissingThrowsTags: æ˜¯å¦å¿½ç•¥å¯¹throwsæ³¨é‡Šçš„æ£€æŸ¥</span></span><br><span class="line"><span class="comment">            allowMissingReturntags: æ˜¯å¦å¿½ç•¥å¯¹returnæ³¨é‡Šçš„æ£€æŸ¥ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">module</span> <span class="attr">name</span>=<span class="string">&quot;JavadocMethod&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;scope&quot;</span> <span class="attr">value</span>=<span class="string">&quot;private&quot;</span>/&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;allowMissingParamTags&quot;</span> <span class="attr">value</span>=<span class="string">&quot;false&quot;</span>/&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;allowMissingThrowsTags&quot;</span> <span class="attr">value</span>=<span class="string">&quot;false&quot;</span>/&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;allowMissingReturnTag&quot;</span> <span class="attr">value</span>=<span class="string">&quot;false&quot;</span>/&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;tokens&quot;</span> <span class="attr">value</span>=<span class="string">&quot;METHOD_DEF&quot;</span>/&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;allowUndeclaredRTE&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;allowThrowsTagsForSubclasses&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br><span class="line">      <span class="comment">&lt;!--å…è®¸get set æ–¹æ³•æ²¡æœ‰æ³¨é‡Š--&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;allowMissingPropertyJavadoc&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">module</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- æ£€æŸ¥ç±»å˜é‡çš„æ³¨é‡Š</span></span><br><span class="line"><span class="comment">            scope: æ£€æŸ¥å˜é‡çš„èŒƒå›´ï¼Œä¾‹å¦‚ï¼špublicåªèƒ½æ£€æŸ¥publicä¿®é¥°çš„å˜é‡ï¼Œprivateå¯ä»¥æ£€æŸ¥æ‰€æœ‰çš„å˜é‡ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">module</span> <span class="attr">name</span>=<span class="string">&quot;JavadocVariable&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;scope&quot;</span> <span class="attr">value</span>=<span class="string">&quot;private&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">module</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--option: å®šä¹‰å·¦å¤§æ‹¬å·&#x27;&#123;&#x27;æ˜¾ç¤ºä½ç½®ï¼Œeolåœ¨åŒä¸€è¡Œæ˜¾ç¤ºï¼Œnlåœ¨ä¸‹ä¸€è¡Œæ˜¾ç¤º</span></span><br><span class="line"><span class="comment">      maxLineLength: å¤§æ‹¬å·&#x27;&#123;&#x27;æ‰€åœ¨è¡Œè¡Œæœ€å¤šå®¹çº³çš„å­—ç¬¦æ•°</span></span><br><span class="line"><span class="comment">      tokens: è¯¥å±æ€§é€‚ç”¨çš„ç±»å‹ï¼Œä¾‹ï¼šCLASS_DEF,INTERFACE_DEF,METHOD_DEF,CTOR_DEF --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">module</span> <span class="attr">name</span>=<span class="string">&quot;LeftCurly&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;option&quot;</span> <span class="attr">value</span>=<span class="string">&quot;nl&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">module</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- NeedBraces æ£€æŸ¥æ˜¯å¦åº”è¯¥ä½¿ç”¨æ‹¬å·çš„åœ°æ–¹æ²¡æœ‰åŠ æ‹¬å·</span></span><br><span class="line"><span class="comment">      tokens: å®šä¹‰æ£€æŸ¥çš„ç±»å‹ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">module</span> <span class="attr">name</span>=<span class="string">&quot;NeedBraces&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- Checks the placement of right curly braces (&#x27;&#125;&#x27;) for  else, try, and catch tokens. The policy to verify is specified using property  option.</span></span><br><span class="line"><span class="comment">      option: å³å¤§æ‹¬å·æ˜¯å¦å•ç‹¬ä¸€è¡Œæ˜¾ç¤º</span></span><br><span class="line"><span class="comment">      tokens: å®šä¹‰æ£€æŸ¥çš„ç±»å‹  --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">module</span> <span class="attr">name</span>=<span class="string">&quot;RightCurly&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;option&quot;</span> <span class="attr">value</span>=<span class="string">&quot;alone&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">module</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- æ£€æŸ¥åœ¨é‡å†™äº†equalsæ–¹æ³•åæ˜¯å¦é‡å†™äº†hashCodeæ–¹æ³• --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">module</span> <span class="attr">name</span>=<span class="string">&quot;EqualsHashCode&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--  Checks for illegal instantiations where a factory method is preferred.</span></span><br><span class="line"><span class="comment">      Rationale: Depending on the project, for some classes it might be preferable to create instances through factory methods rather than calling the constructor.</span></span><br><span class="line"><span class="comment">      A simple example is the java.lang.Boolean class. In order to save memory and CPU cycles, it is preferable to use the predefined constants TRUE and FALSE. Constructor invocations should be replaced by calls to Boolean.valueOf().</span></span><br><span class="line"><span class="comment">      Some extremely performance sensitive projects may require the use of factory methods for other classes as well, to enforce the usage of number caches or object pools. --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">module</span> <span class="attr">name</span>=<span class="string">&quot;IllegalInstantiation&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;classes&quot;</span> <span class="attr">value</span>=<span class="string">&quot;java.lang.Boolean&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">module</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- Checks for Naming Conventions.   å‘½åè§„èŒƒ   --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- local, final variables, including catch parameters --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">module</span> <span class="attr">name</span>=<span class="string">&quot;LocalFinalVariableName&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- local, non-final variables, including catch parameters--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">module</span> <span class="attr">name</span>=<span class="string">&quot;LocalVariableName&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- static, non-final fields --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">module</span> <span class="attr">name</span>=<span class="string">&quot;StaticVariableName&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;format&quot;</span> <span class="attr">value</span>=<span class="string">&quot;(^[A-Z0-9_]&#123;0,19&#125;$)&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">module</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- packages --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">module</span> <span class="attr">name</span>=<span class="string">&quot;PackageName&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;format&quot;</span> <span class="attr">value</span>=<span class="string">&quot;^[a-z]+(\.[a-z][a-z0-9]*)*$&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">module</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- classes and interfaces --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">module</span> <span class="attr">name</span>=<span class="string">&quot;TypeName&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;format&quot;</span> <span class="attr">value</span>=<span class="string">&quot;(^[A-Z][a-zA-Z0-9]&#123;0,19&#125;$)&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">module</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- methods --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">module</span> <span class="attr">name</span>=<span class="string">&quot;MethodName&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;format&quot;</span> <span class="attr">value</span>=<span class="string">&quot;(^[a-z][a-zA-Z0-9]&#123;0,19&#125;$)&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">module</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- non-static fields --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">module</span> <span class="attr">name</span>=<span class="string">&quot;MemberName&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;format&quot;</span> <span class="attr">value</span>=<span class="string">&quot;(^[a-z][a-z0-9][a-zA-Z0-9]&#123;0,19&#125;$)&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">module</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- parameters --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">module</span> <span class="attr">name</span>=<span class="string">&quot;ParameterName&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;format&quot;</span> <span class="attr">value</span>=<span class="string">&quot;(^[a-z][a-zA-Z0-9_]&#123;0,19&#125;$)&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">module</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- constants (static,  final fields) --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">module</span> <span class="attr">name</span>=<span class="string">&quot;ConstantName&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;format&quot;</span> <span class="attr">value</span>=<span class="string">&quot;(^[A-Z0-9_]&#123;0,19&#125;$)&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">module</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- ä»£ç ç¼©è¿›   --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">module</span> <span class="attr">name</span>=<span class="string">&quot;Indentation&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">module</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- Checks for redundant exceptions declared in throws clause such as duplicates, unchecked exceptions or subclasses of another declared exception.</span></span><br><span class="line"><span class="comment">      æ£€æŸ¥æ˜¯å¦æŠ›å‡ºäº†å¤šä½™çš„å¼‚å¸¸</span></span><br><span class="line"><span class="comment">    &lt;module name=&quot;RedundantThrows&quot;&gt;</span></span><br><span class="line"><span class="comment">        &lt;property name=&quot;logLoadErrors&quot; value=&quot;true&quot;/&gt;</span></span><br><span class="line"><span class="comment">        &lt;property name=&quot;suppressLoadErrors&quot; value=&quot;true&quot;/&gt;</span></span><br><span class="line"><span class="comment">    &lt;/module&gt;</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--  Checks for overly complicated boolean expressions. Currently finds code like  if (b == true), b || true, !false, etc.</span></span><br><span class="line"><span class="comment">      æ£€æŸ¥booleanå€¼æ˜¯å¦å†—ä½™çš„åœ°æ–¹</span></span><br><span class="line"><span class="comment">      Rationale: Complex boolean logic makes code hard to understand and maintain. --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">module</span> <span class="attr">name</span>=<span class="string">&quot;SimplifyBooleanExpression&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--  Checks for overly complicated boolean return statements. For example the following code</span></span><br><span class="line"><span class="comment">       æ£€æŸ¥æ˜¯å¦å­˜åœ¨è¿‡åº¦å¤æ‚çš„booleanè¿”å›å€¼</span></span><br><span class="line"><span class="comment">       if (valid())</span></span><br><span class="line"><span class="comment">          return false;</span></span><br><span class="line"><span class="comment">       else</span></span><br><span class="line"><span class="comment">          return true;</span></span><br><span class="line"><span class="comment">       could be written as</span></span><br><span class="line"><span class="comment">          return !valid();</span></span><br><span class="line"><span class="comment">       The Idea for this Check has been shamelessly stolen from the equivalent PMD rule. --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">module</span> <span class="attr">name</span>=<span class="string">&quot;SimplifyBooleanReturn&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- Checks that a class which has only private constructors is declared as final.åªæœ‰ç§æœ‰æ„é€ å™¨çš„ç±»å¿…é¡»å£°æ˜ä¸ºfinal--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">module</span> <span class="attr">name</span>=<span class="string">&quot;FinalClass&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--  Make sure that utility classes (classes that contain only static methods or fields in their API) do not have a public constructor.</span></span><br><span class="line"><span class="comment">      ç¡®ä¿Utilsç±»ï¼ˆåªæä¾›staticæ–¹æ³•å’Œå±æ€§çš„ç±»ï¼‰æ²¡æœ‰publicæ„é€ å™¨ã€‚</span></span><br><span class="line"><span class="comment">      Rationale: Instantiating utility classes does not make sense. Hence the constructors should either be private or (if you want to allow subclassing) protected. A common mistake is forgetting to hide the default constructor.</span></span><br><span class="line"><span class="comment">      If you make the constructor protected you may want to consider the following constructor implementation technique to disallow instantiating subclasses:</span></span><br><span class="line"><span class="comment">      public class StringUtils // not final to allow subclassing</span></span><br><span class="line"><span class="comment">      &#123;</span></span><br><span class="line"><span class="comment">          protected StringUtils() &#123;</span></span><br><span class="line"><span class="comment">              throw new UnsupportedOperationException(); // prevents calls from subclass</span></span><br><span class="line"><span class="comment">          &#125;</span></span><br><span class="line"><span class="comment">          public static int count(char c, String s) &#123;</span></span><br><span class="line"><span class="comment">              // ...</span></span><br><span class="line"><span class="comment">          &#125;</span></span><br><span class="line"><span class="comment">      &#125;</span></span><br><span class="line"><span class="comment">   &lt;module name=&quot;HideUtilityClassConstructor&quot;/&gt;</span></span><br><span class="line"><span class="comment">   --&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--  Checks visibility of class members. Only static final members may be public; other class members must be private unless property protectedAllowed or packageAllowed is set.</span></span><br><span class="line"><span class="comment">      æ£€æŸ¥classæˆå‘˜å±æ€§å¯è§æ€§ã€‚åªæœ‰static final ä¿®é¥°çš„æˆå‘˜æ˜¯å¯ä»¥publicçš„ã€‚å…¶ä»–çš„æˆå‘˜å±æ€§å¿…éœ€æ˜¯privateçš„ï¼Œé™¤éå±æ€§protectedAllowedæˆ–è€…packageAllowedè®¾ç½®äº†true.</span></span><br><span class="line"><span class="comment">       Public members are not flagged if the name matches the public member regular expression (contains &quot;^serialVersionUID$&quot; by default). <span class="doctag">Note:</span> Checkstyle 2 used to include &quot;^f[A-Z][a-zA-Z0-9]*$&quot; in the default pattern to allow CMP for EJB 1.1 with the default settings. With EJB 2.0 it is not longer necessary to have public access for persistent fields, hence the default has been changed.</span></span><br><span class="line"><span class="comment">       Rationale: Enforce encapsulation. å¼ºåˆ¶å°è£… --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">module</span> <span class="attr">name</span>=<span class="string">&quot;VisibilityModifier&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- æ¯ä¸€è¡Œåªèƒ½å®šä¹‰ä¸€ä¸ªå˜é‡ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">module</span> <span class="attr">name</span>=<span class="string">&quot;MultipleVariableDeclarations&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">module</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- Checks the style of array type definitions. Some like Java-style: public static void main(String[] args) and some like C-style: public static void main(String args[])</span></span><br><span class="line"><span class="comment">      æ£€æŸ¥å†å®šä¹‰æ•°ç»„æ—¶ï¼Œé‡‡ç”¨javaé£æ ¼è¿˜æ˜¯cé£æ ¼ï¼Œä¾‹å¦‚ï¼šint[] numæ˜¯javaé£æ ¼ï¼Œint num[]æ˜¯cé£æ ¼ã€‚é»˜è®¤æ˜¯javaé£æ ¼--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">module</span> <span class="attr">name</span>=<span class="string">&quot;ArrayTypeStyle&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">module</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- Checks that there are no &quot;magic numbers&quot;, where a magic number is a numeric literal that is not defined as a constant. By default, -1, 0, 1, and 2 are not considered to be magic numbers.</span></span><br><span class="line"><span class="comment">    &lt;module name=&quot;MagicNumber&quot;&gt;</span></span><br><span class="line"><span class="comment">    &lt;/module&gt;</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- A check for <span class="doctag">TODO:</span> comments. Actually it is a generic regular expression matcher on Java comments. To check for other patterns in Java comments, set property format.</span></span><br><span class="line"><span class="comment">       æ£€æŸ¥æ˜¯å¦å­˜åœ¨TODOï¼ˆå¾…å¤„ç†ï¼‰ TODOæ˜¯javaIDEè‡ªåŠ¨ç”Ÿæˆçš„ã€‚ä¸€èˆ¬ä»£ç å†™å®Œåè¦å»æ‰ã€‚</span></span><br><span class="line"><span class="comment">     --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">module</span> <span class="attr">name</span>=<span class="string">&quot;TodoComment&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--  Checks that long constants are defined with an upper ell. That is &#x27; L&#x27; and not &#x27;l&#x27;. This is in accordance to the Java Language Specification,  Section 3.10.1.</span></span><br><span class="line"><span class="comment">      æ£€æŸ¥æ˜¯å¦åœ¨longç±»å‹æ˜¯å¦å®šä¹‰äº†å¤§å†™çš„L.å­—æ¯å°å†™lå’Œæ•°å­—1ï¼ˆä¸€ï¼‰å¾ˆç›¸ä¼¼ã€‚</span></span><br><span class="line"><span class="comment">      looks a lot like 1. --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">module</span> <span class="attr">name</span>=<span class="string">&quot;UpperEll&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--  Checks that switch statement has &quot;default&quot; clause. æ£€æŸ¥switchè¯­å¥æ˜¯å¦æœ‰â€˜defaultâ€™ä»å¥</span></span><br><span class="line"><span class="comment">       Rationale: It&#x27;s usually a good idea to introduce a default case in every switch statement.</span></span><br><span class="line"><span class="comment">       Even if the developer is sure that all currently possible cases are covered, this should be expressed in the default branch,</span></span><br><span class="line"><span class="comment">        e.g. by using an assertion. This way the code is protected aginst later changes, e.g. introduction of new types in an enumeration type. --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">module</span> <span class="attr">name</span>=<span class="string">&quot;MissingSwitchDefault&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--æ£€æŸ¥switchä¸­caseåæ˜¯å¦åŠ å…¥äº†è·³å‡ºè¯­å¥ï¼Œä¾‹å¦‚ï¼šreturnã€breakã€throwã€continue --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">module</span> <span class="attr">name</span>=<span class="string">&quot;FallThrough&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- Checks the number of parameters of a method or constructor. max default 7ä¸ª. --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">module</span> <span class="attr">name</span>=<span class="string">&quot;ParameterNumber&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;max&quot;</span> <span class="attr">value</span>=<span class="string">&quot;5&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">module</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- æ¯è¡Œå­—ç¬¦æ•° --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">module</span> <span class="attr">name</span>=<span class="string">&quot;LineLength&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;max&quot;</span> <span class="attr">value</span>=<span class="string">&quot;200&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">module</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- Checks for long methods and constructors. max default 150è¡Œ. max=300 è®¾ç½®é•¿åº¦300 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">module</span> <span class="attr">name</span>=<span class="string">&quot;MethodLength&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;max&quot;</span> <span class="attr">value</span>=<span class="string">&quot;300&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">module</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- ModifierOrder æ£€æŸ¥ä¿®é¥°ç¬¦çš„é¡ºåºï¼Œé»˜è®¤æ˜¯ public,protected,private,abstract,static,final,transient,volatile,synchronized,native --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">module</span> <span class="attr">name</span>=<span class="string">&quot;ModifierOrder&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">module</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- æ£€æŸ¥æ˜¯å¦æœ‰å¤šä½™çš„ä¿®é¥°ç¬¦ï¼Œä¾‹å¦‚ï¼šæ¥å£ä¸­çš„æ–¹æ³•ä¸å¿…ä½¿ç”¨publicã€abstractä¿®é¥°  --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">module</span> <span class="attr">name</span>=<span class="string">&quot;RedundantModifier&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">module</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--- å­—ç¬¦ä¸²æ¯”è¾ƒå¿…é¡»ä½¿ç”¨ equals() --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">module</span> <span class="attr">name</span>=<span class="string">&quot;StringLiteralEquality&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">module</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- if-elseåµŒå¥—è¯­å¥ä¸ªæ•° æœ€å¤š4å±‚ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">module</span> <span class="attr">name</span>=<span class="string">&quot;NestedIfDepth&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;max&quot;</span> <span class="attr">value</span>=<span class="string">&quot;3&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">module</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- try-catch åµŒå¥—è¯­å¥ä¸ªæ•° æœ€å¤š2å±‚ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">module</span> <span class="attr">name</span>=<span class="string">&quot;NestedTryDepth&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;max&quot;</span> <span class="attr">value</span>=<span class="string">&quot;2&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">module</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- è¿”å›ä¸ªæ•° --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">module</span> <span class="attr">name</span>=<span class="string">&quot;ReturnCount&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;max&quot;</span> <span class="attr">value</span>=<span class="string">&quot;5&quot;</span>/&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;format&quot;</span> <span class="attr">value</span>=<span class="string">&quot;^$&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">module</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;/<span class="name">module</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">module</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>é…ç½® <code>pom.xml</code>ï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span>&gt;</span></span><br><span class="line">    ...</span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">checkstyle.config.location</span>&gt;</span>config/maven_checks.xml<span class="tag">&lt;/<span class="name">checkstyle.config.location</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line">    ...</span><br><span class="line">    <span class="tag">&lt;<span class="name">reporting</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-checkstyle-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">executions</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">execution</span>&gt;</span></span><br><span class="line">                        <span class="comment">&lt;!-- ç»‘å®špmd:pmdåˆ°validateç”Ÿå‘½å‘¨æœŸï¼Œåœ¨validateæ—¶ä¼šè‡ªåŠ¨è¿›è¡Œä»£ç è§„èŒƒæ£€æŸ¥ --&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">id</span>&gt;</span>validate<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">phase</span>&gt;</span>validate<span class="tag">&lt;/<span class="name">phase</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">                            <span class="comment">&lt;!-- é…ç½®æ–‡ä»¶çš„è·¯å¾„ï¼Œåœ¨styleæ–‡ä»¶å¤¹ä¸‹ --&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">configLocation</span>&gt;</span>style/checkstyle.xml<span class="tag">&lt;/<span class="name">configLocation</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">encoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">encoding</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">consoleOutput</span>&gt;</span>true<span class="tag">&lt;/<span class="name">consoleOutput</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">failsOnError</span>&gt;</span>true<span class="tag">&lt;/<span class="name">failsOnError</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">includeTestSourceDirectory</span>&gt;</span>false<span class="tag">&lt;/<span class="name">includeTestSourceDirectory</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">goals</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">goal</span>&gt;</span>check<span class="tag">&lt;/<span class="name">goal</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">goals</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">execution</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">executions</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-jxr-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">reporting</span>&gt;</span></span><br><span class="line">    ...</span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>å…¶ä¸­å¯ä»¥ä¿®æ”¹ä½¿ç”¨çš„æ£€æŸ¥è§„åˆ™æ–‡ä»¶è·¯å¾„ï¼Œæ’ä»¶é»˜è®¤æä¾›äº†å››ä¸ªè§„åˆ™æ–‡ä»¶å¯ä»¥ç›´æ¥ä½¿ç”¨ï¼Œæ— éœ€æ‰‹åŠ¨ä¸‹è½½ï¼š</p>
<ul>
<li>config&#x2F;sun_checks.xml - Sun Microsystems Definition (default).</li>
<li>config&#x2F;maven_checks.xml - Maven Development Definitions.</li>
<li>config&#x2F;turbine_checks.xml - Turbine Development Definitions.</li>
<li>config&#x2F;avalon_checks.xml - Avalon Development Definitions.</li>
</ul>
<p>é…ç½®å¥½åï¼Œå¯ä»¥æ‰§è¡Œ <code>mvn clean checkstyle:check</code> æ£€æŸ¥ä»£ç ã€‚</p>
<h2 id="maven-pmd-plugin"><a href="#maven-pmd-plugin" class="headerlink" title="maven-pmd-plugin"></a>maven-pmd-plugin</h2><blockquote>
<p>maven-pmd-plugin æ˜¯é˜¿é‡Œç¼–ç¨‹è§„èŒƒæ£€æŸ¥æ’ä»¶ã€‚</p>
</blockquote>
<p>é…ç½® <code>pom.xml</code>ï¼š</p>
<p>å‚è€ƒ <a target="_blank" rel="noopener" href="https://github.com/alibaba/p3c/blob/master/p3c-pmd/pom.xml">https://github.com/alibaba/p3c/blob/master/p3c-pmd/pom.xml</a> é…ç½®</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">  <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-pmd-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.11.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">sourceEncoding</span>&gt;</span>$&#123;project.build.sourceEncoding&#125;<span class="tag">&lt;/<span class="name">sourceEncoding</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">targetJdk</span>&gt;</span>$&#123;maven.compiler.target&#125;<span class="tag">&lt;/<span class="name">targetJdk</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">printFailingErrors</span>&gt;</span>true<span class="tag">&lt;/<span class="name">printFailingErrors</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">rulesets</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">ruleset</span>&gt;</span>rulesets/java/ali-comment.xml<span class="tag">&lt;/<span class="name">ruleset</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">ruleset</span>&gt;</span>rulesets/java/ali-concurrent.xml<span class="tag">&lt;/<span class="name">ruleset</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">ruleset</span>&gt;</span>rulesets/java/ali-constant.xml<span class="tag">&lt;/<span class="name">ruleset</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">ruleset</span>&gt;</span>rulesets/java/ali-exception.xml<span class="tag">&lt;/<span class="name">ruleset</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">ruleset</span>&gt;</span>rulesets/java/ali-flowcontrol.xml<span class="tag">&lt;/<span class="name">ruleset</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">ruleset</span>&gt;</span>rulesets/java/ali-naming.xml<span class="tag">&lt;/<span class="name">ruleset</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">ruleset</span>&gt;</span>rulesets/java/ali-oop.xml<span class="tag">&lt;/<span class="name">ruleset</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">ruleset</span>&gt;</span>rulesets/java/ali-orm.xml<span class="tag">&lt;/<span class="name">ruleset</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">ruleset</span>&gt;</span>rulesets/java/ali-other.xml<span class="tag">&lt;/<span class="name">ruleset</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">ruleset</span>&gt;</span>rulesets/java/ali-set.xml<span class="tag">&lt;/<span class="name">ruleset</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">rulesets</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">printFailingErrors</span>&gt;</span>true<span class="tag">&lt;/<span class="name">printFailingErrors</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">executions</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">execution</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">phase</span>&gt;</span>verify<span class="tag">&lt;/<span class="name">phase</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">goals</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">goal</span>&gt;</span>check<span class="tag">&lt;/<span class="name">goal</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">goals</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">execution</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">executions</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba.p3c<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>p3c-pmd<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.0.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>é…ç½®å¥½åï¼Œå¯ä»¥æ‰§è¡Œ <code>mvn clean pmd:check</code> æ£€æŸ¥ä»£ç ã€‚</p>
<h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><ul>
<li><a target="_blank" rel="noopener" href="https://maven.apache.org/plugins/maven-checkstyle-plugin/">https://maven.apache.org/plugins/maven-checkstyle-plugin/</a></li>
<li><a target="_blank" rel="noopener" href="https://maven.apache.org/jxr/maven-jxr-plugin/">https://maven.apache.org/jxr/maven-jxr-plugin/</a></li>
<li><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/557b975ae40d">https://www.jianshu.com/p/557b975ae40d</a></li>
<li>é˜¿é‡Œå·´å·´ç¼–ç¨‹è§„èŒƒ<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/alibaba/p3c">https://github.com/alibaba/p3c</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/alibaba/p3c/blob/master/p3c-pmd/pom.xml">https://github.com/alibaba/p3c/blob/master/p3c-pmd/pom.xml</a></li>
</ul>
</li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://dunwu.github.io/blog/pages/a32bd53e/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/blog/uploads/avatar.gif">
      <meta itemprop="name" content="é’æ‚Ÿ â—¾ Dunwu">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Dunwu Blog">
      <meta itemprop="description" content="é’æ‚Ÿçš„ä¸ªäººåšå®¢">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content=" | Dunwu Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/blog/pages/a32bd53e/" class="post-title-link" itemprop="url">ç³»ç»Ÿæµ‹è¯•æ¶æ„</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">å‘è¡¨äº</span>

      <time title="åˆ›å»ºæ—¶é—´ï¼š2019-12-10 17:00:00" itemprop="dateCreated datePublished" datetime="2019-12-10T17:00:00+08:00">2019-12-10</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">æ›´æ–°äº</span>
      <time title="ä¿®æ”¹æ—¶é—´ï¼š2025-09-13 17:56:53" itemprop="dateModified" datetime="2025-09-13T17:56:53+08:00">2025-09-13</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">åˆ†ç±»äº</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/blog/categories/%E8%AE%BE%E8%AE%A1/" itemprop="url" rel="index"><span itemprop="name">è®¾è®¡</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/blog/categories/%E8%AE%BE%E8%AE%A1/%E6%9E%B6%E6%9E%84/" itemprop="url" rel="index"><span itemprop="name">æ¶æ„</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/blog/categories/%E8%AE%BE%E8%AE%A1/%E6%9E%B6%E6%9E%84/%E7%BB%BC%E5%90%88/" itemprop="url" rel="index"><span itemprop="name">ç»¼åˆ</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
      <span>1.2k</span>
    </span>
    <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
      <span>1 åˆ†é’Ÿ</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="ç³»ç»Ÿæµ‹è¯•æ¶æ„"><a href="#ç³»ç»Ÿæµ‹è¯•æ¶æ„" class="headerlink" title="ç³»ç»Ÿæµ‹è¯•æ¶æ„"></a>ç³»ç»Ÿæµ‹è¯•æ¶æ„</h1><blockquote>
<p>è½¯ä»¶æµ‹è¯•æè¿°ä¸€ç§ç”¨æ¥ä¿ƒè¿›é‰´å®šè½¯ä»¶çš„æ­£ç¡®æ€§ã€å®Œæ•´æ€§ã€å®‰å…¨æ€§å’Œè´¨é‡çš„è¿‡ç¨‹ã€‚è½¯ä»¶æµ‹è¯•çš„ç»å…¸å®šä¹‰æ˜¯ï¼šåœ¨è§„å®šçš„æ¡ä»¶ä¸‹å¯¹ç¨‹åºè¿›è¡Œæ“ä½œï¼Œä»¥å‘ç°ç¨‹åºé”™è¯¯ï¼Œè¡¡é‡è½¯ä»¶è´¨é‡ï¼Œå¹¶å¯¹å…¶æ˜¯å¦èƒ½æ»¡è¶³è®¾è®¡è¦æ±‚è¿›è¡Œè¯„ä¼°çš„è¿‡ç¨‹ã€‚</p>
<p>ç°ä»£è½¯ä»¶å¼€å‘é¡¹ç›®ä¸­ï¼Œåˆ†å·¥æ˜ç¡®ï¼ŒåŸºæœ¬ä¸Šéƒ½ä¼šæœ‰ç ”å‘ã€æµ‹è¯•ã€QA ç­‰è§’è‰²ã€‚ä¸åŒè§’è‰²ç”±äºå…³æ³¨çš„è§†è§’ä¸åŒï¼Œæµ‹è¯•ç›®æ ‡å’Œæµ‹è¯•æ–¹æ³•ä¹Ÿä¸å®Œå…¨ç›¸åŒã€‚æœ¬æ–‡ä¸»è¦ä»ç ”å‘ã€æµ‹è¯•çš„è§†è§’å»è€ƒé‡è½¯ä»¶æµ‹è¯•æŠ€æœ¯ã€‚</p>
<p>æ³¨æ„ï¼š</p>
<ul>
<li>ä¸ºäº†æ–¹ä¾¿ï¼Œåªæœ‰æµ‹è¯•äººå‘˜éœ€è¦å…³æ³¨çš„æµ‹è¯•ç‚¹ç”¨ã€æµ‹è¯•ã€‘æ ‡æ³¨ï¼›</li>
<li>è€Œåªæœ‰ç ”å‘äººå‘˜éœ€è¦å…³æ³¨çš„æµ‹è¯•ç‚¹ç”¨ã€ç ”å‘ã€‘æ ‡æ³¨ï¼›</li>
<li>éƒ½éœ€è¦å…³æ³¨çš„æµ‹è¯•ç‚¹åˆ™ä¸ä½œæ ‡æ³¨ã€‚</li>
</ul>
</blockquote>
<h2 id="æµ‹è¯•æ–¹æ³•åˆ†ç±»"><a href="#æµ‹è¯•æ–¹æ³•åˆ†ç±»" class="headerlink" title="æµ‹è¯•æ–¹æ³•åˆ†ç±»"></a>æµ‹è¯•æ–¹æ³•åˆ†ç±»</h2><h3 id="ä»æµ‹è¯•è®¾è®¡æ–¹æ³•åˆ†ç±»"><a href="#ä»æµ‹è¯•è®¾è®¡æ–¹æ³•åˆ†ç±»" class="headerlink" title="ä»æµ‹è¯•è®¾è®¡æ–¹æ³•åˆ†ç±»"></a>ä»æµ‹è¯•è®¾è®¡æ–¹æ³•åˆ†ç±»</h3><ul>
<li><strong>é»‘ç›’æµ‹è¯•ã€æµ‹è¯•ã€‘</strong> - æŠŠè½¯ä»¶ç³»ç»Ÿå½“ä½œä¸€ä¸ªâ€œé»‘ç®±â€ï¼Œæ— æ³•äº†è§£æˆ–ä½¿ç”¨ç³»ç»Ÿçš„å†…éƒ¨ç»“æ„åŠçŸ¥è¯†ã€‚ä»è½¯ä»¶çš„è¡Œä¸ºï¼Œè€Œä¸æ˜¯å†…éƒ¨ç»“æ„å‡ºå‘æ¥è®¾è®¡æµ‹è¯•ã€‚</li>
<li><strong>ç™½ç›’æµ‹è¯•ã€ç ”å‘ã€‘</strong> - è®¾è®¡è€…å¯ä»¥çœ‹åˆ°è½¯ä»¶ç³»ç»Ÿçš„å†…éƒ¨ç»“æ„ï¼Œå¹¶ä¸”ä½¿ç”¨è½¯ä»¶çš„å†…éƒ¨çŸ¥è¯†æ¥æŒ‡å¯¼æµ‹è¯•æ•°æ®åŠæ–¹æ³•çš„é€‰æ‹©ã€‚</li>
<li><strong>ç°ç›’æµ‹è¯•</strong> - ä»‹äºé»‘ç›’å’Œç™½ç›’ä¹‹é—´ã€‚</li>
</ul>
<blockquote>
<p>å°ç»“ï¼š</p>
<ul>
<li>é»‘æ²³æµ‹è¯•é€šå¸¸é’ˆå¯¹çš„æ˜¯è½¯ä»¶çš„è¡Œä¸ºæˆ–åŠŸèƒ½ï¼Œä¸€èˆ¬æ˜¯æµ‹è¯•äººå‘˜ä¸»è¦å…³æ³¨çš„ã€‚</li>
<li>ç™½ç›’æµ‹è¯•é€šå¸¸åˆ™éœ€è¦å¯¹è½¯ä»¶æœ‰ä¸€å®šç¨‹åº¦çš„äº†è§£ï¼Œä¸€èˆ¬æ˜¯å¼€å‘äººå‘˜æ‰€å…³æ³¨çš„ã€‚</li>
<li>ç°ç›’æµ‹è¯•é€šå¸¸æ˜¯ä¸ºäº†æµ‹è¯•è½¯ä»¶åœ¨ç‰¹å®šçš„åœºæ™¯ä¸‹çš„è¡¨ç°ï¼Œè€Œéä¸»åœºæ™¯ã€‚</li>
</ul>
</blockquote>
<h3 id="ä»æµ‹è¯•çš„ç›®çš„åˆ†ç±»"><a href="#ä»æµ‹è¯•çš„ç›®çš„åˆ†ç±»" class="headerlink" title="ä»æµ‹è¯•çš„ç›®çš„åˆ†ç±»"></a>ä»æµ‹è¯•çš„ç›®çš„åˆ†ç±»</h3><h4 id="åŠŸèƒ½æµ‹è¯•"><a href="#åŠŸèƒ½æµ‹è¯•" class="headerlink" title="åŠŸèƒ½æµ‹è¯•"></a>åŠŸèƒ½æµ‹è¯•</h4><ul>
<li><strong>å•å…ƒæµ‹è¯•ï¼ˆUnit Testï¼‰</strong> - åœ¨æœ€ä½ç²’åº¦çš„åŠŸèƒ½&#x2F;å‚æ•°ä¸ŠéªŒè¯ç¨‹åºçš„å‡†ç¡®æ€§ï¼Œæ¯”å¦‚æµ‹è¯•ä¸€ä¸ªå‡½æ•°çš„æ­£ç¡®æ€§ã€‚ã€ç ”å‘ã€‘<ul>
<li>å¸¸ç”¨æŠ€æœ¯ï¼š<a target="_blank" rel="noopener" href="https://github.com/junit-team/junit4"><strong>junit4</strong></a>ã€<a target="_blank" rel="noopener" href="https://github.com/junit-team/junit5"><strong>junit5</strong></a>ã€<a target="_blank" rel="noopener" href="https://github.com/mockito/mockito"><strong>mockito</strong></a>ã€<a target="_blank" rel="noopener" href="https://github.com/joel-costigliola/assertj-core"><strong>assertj-core</strong></a></li>
</ul>
</li>
<li><strong>åŠŸèƒ½æµ‹è¯•ï¼ˆFunctional Testï¼‰</strong> - éªŒè¯æ¨¡å—çš„åŠŸèƒ½ã€‚ã€æµ‹è¯•ã€‘</li>
<li><strong>é›†æˆæµ‹è¯•ï¼ˆIntegration Testï¼‰</strong> - éªŒè¯å‡ ä¸ªäº’ç›¸æœ‰ä¾èµ–å…³ç³»çš„æ¨¡å—çš„åŠŸèƒ½ã€‚ã€æµ‹è¯•ã€‘</li>
<li><strong>åœºæ™¯æµ‹è¯•ï¼ˆScenario Testï¼‰</strong>- éªŒè¯å‡ ä¸ªæ¨¡å—æ˜¯å¦èƒ½å®Œæˆä¸€ä¸ªç”¨æˆ·åœºæ™¯ã€‚ã€æµ‹è¯•ã€‘</li>
<li><strong>ç³»ç»Ÿæµ‹è¯•ï¼ˆSystem Testï¼‰</strong> - å¯¹äºæ•´ä¸ªç³»ç»ŸåŠŸèƒ½çš„æµ‹è¯•ã€‚ã€æµ‹è¯•ã€‘</li>
<li><strong>Alpha æµ‹è¯•</strong> - è½¯ä»¶æµ‹è¯•äººå‘˜åœ¨çœŸå®ç”¨æˆ·ç¯å¢ƒä¸­å¯¹è½¯ä»¶è¿›è¡Œå…¨é¢çš„æµ‹è¯•ã€‚ã€æµ‹è¯•ã€‘</li>
<li><strong>Beta æµ‹è¯•</strong> - ä¹Ÿå«å…¬æµ‹ï¼Œæ˜¯çœŸå®çš„ç”¨æˆ·åœ¨çœŸå®çš„ç¯å¢ƒä¸­è¿›è¡Œçš„æµ‹è¯•ã€‚</li>
</ul>
<h4 id="éåŠŸèƒ½æµ‹è¯•"><a href="#éåŠŸèƒ½æµ‹è¯•" class="headerlink" title="éåŠŸèƒ½æµ‹è¯•"></a>éåŠŸèƒ½æµ‹è¯•</h4><ul>
<li><strong>å‹åŠ›æµ‹è¯•ï¼ˆStress testï¼‰</strong> - éªŒè¯è½¯ä»¶åœ¨è¶…è¿‡è´Ÿè½½è®¾è®¡çš„æƒ…å†µä¸‹ä»èƒ½è¿”å›æ­£ç¡®çš„ç»“æœï¼Œæ²¡æœ‰å´©æºƒ</li>
<li><strong>è´Ÿè½½æµ‹è¯•ï¼ˆLoad testï¼‰</strong> - æµ‹è¯•è½¯ä»¶åœ¨è´Ÿè½½æƒ…å†µä¸‹èƒ½å¦æ­£å¸¸å·¥ä½œ</li>
<li><strong>æ€§èƒ½æµ‹è¯•ï¼ˆPerformance testï¼‰</strong> - æµ‹è¯•è½¯ä»¶çš„æ•ˆèƒ½ï¼Œæ˜¯å¦æä¾›æ»¡æ„çš„æœåŠ¡è´¨é‡ã€‚<ul>
<li>å¸¸ç”¨æŠ€æœ¯ï¼š<a target="_blank" rel="noopener" href="https://jmeter.apache.org/"><strong>JMeter</strong></a>ã€JMHã€‚</li>
</ul>
</li>
<li><strong>è½¯ä»¶è¾…åŠ©åŠŸèƒ½æµ‹è¯•ï¼ˆAccessibility test</strong>ï¼‰ - æµ‹è¯•è½¯ä»¶æ˜¯å¦å‘æ®‹ç–¾ç”¨æˆ·æä¾›è¶³å¤Ÿçš„è¾…åŠ©åŠŸèƒ½</li>
<li><strong>æœ¬åœ°åŒ–&#x2F;å…¨çƒåŒ–æµ‹è¯•ï¼ˆLocalization&#x2F;Globalization</strong>ï¼‰</li>
<li><strong>å…¼å®¹æ€§æµ‹è¯•ï¼ˆCompatibility Testï¼‰</strong></li>
<li><strong>é…ç½®æµ‹è¯•ï¼ˆConfiguration Testï¼‰</strong> - æµ‹è¯•è½¯ä»¶åœ¨å„ç§é…ç½®ä¸‹èƒ½å¦æ­£å¸¸å·¥ä½œ</li>
<li><strong>å¯ç”¨æ€§æµ‹è¯•ï¼ˆUsability Testï¼‰</strong> â€“ æµ‹è¯•è½¯ä»¶æ˜¯å¦å¥½ç”¨</li>
<li><strong>å®‰å…¨æ€§æµ‹è¯•ï¼ˆSecurity Testï¼‰</strong></li>
</ul>
<h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><ul>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/TankXiao/archive/2012/02/20/2347016.html">è½¯ä»¶æµ‹è¯• (ä¸€) è½¯ä»¶æµ‹è¯•æ–¹æ³•å¤§æ±‡æ€»</a></li>
<li><a target="_blank" rel="noopener" href="https://www.xncoding.com/2018/01/07/java/jmh.html">Java å¾®åŸºå‡†æµ‹è¯•æ¡†æ¶ JMH</a></li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://dunwu.github.io/blog/pages/b9996d17/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/blog/uploads/avatar.gif">
      <meta itemprop="name" content="é’æ‚Ÿ â—¾ Dunwu">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Dunwu Blog">
      <meta itemprop="description" content="é’æ‚Ÿçš„ä¸ªäººåšå®¢">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content=" | Dunwu Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/blog/pages/b9996d17/" class="post-title-link" itemprop="url">Intellij IDEA å¿«é€Ÿå…¥é—¨</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">å‘è¡¨äº</span>

      <time title="åˆ›å»ºæ—¶é—´ï¼š2019-11-29 18:10:14" itemprop="dateCreated datePublished" datetime="2019-11-29T18:10:14+08:00">2019-11-29</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">æ›´æ–°äº</span>
      <time title="ä¿®æ”¹æ—¶é—´ï¼š2025-09-13 17:56:53" itemprop="dateModified" datetime="2025-09-13T17:56:53+08:00">2025-09-13</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">åˆ†ç±»äº</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/blog/categories/Java/" itemprop="url" rel="index"><span itemprop="name">Java</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/blog/categories/Java/%E8%BD%AF%E4%BB%B6/" itemprop="url" rel="index"><span itemprop="name">è½¯ä»¶</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/blog/categories/Java/%E8%BD%AF%E4%BB%B6/IDE/" itemprop="url" rel="index"><span itemprop="name">IDE</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
      <span>5.4k</span>
    </span>
    <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
      <span>5 åˆ†é’Ÿ</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="Intellij-IDEA-å¿«é€Ÿå…¥é—¨"><a href="#Intellij-IDEA-å¿«é€Ÿå…¥é—¨" class="headerlink" title="Intellij IDEA å¿«é€Ÿå…¥é—¨"></a>Intellij IDEA å¿«é€Ÿå…¥é—¨</h1><h2 id="å¿«æ·é”®"><a href="#å¿«æ·é”®" class="headerlink" title="å¿«æ·é”®"></a>å¿«æ·é”®</h2><h3 id="æ ¸å¿ƒå¿«æ·é”®"><a href="#æ ¸å¿ƒå¿«æ·é”®" class="headerlink" title="æ ¸å¿ƒå¿«æ·é”®"></a>æ ¸å¿ƒå¿«æ·é”®</h3><p>IntelliJ IDEA ä½œä¸ºä¸€ä¸ªä»¥å¿«æ·é”®ä¸ºä¸­å¿ƒçš„ IDEï¼Œä¸ºå¤§å¤šæ•°æ“ä½œå»ºè®®äº†é”®ç›˜å¿«æ·é”®ã€‚åœ¨è¿™ä¸ªä¸»é¢˜ä¸­ï¼Œæ‚¨å¯ä»¥æ‰¾åˆ°æœ€ä¸å¯ç¼ºå°‘çš„åˆ—è¡¨ï¼Œä½¿ IntelliJ IDEA è½»æ¾å®ç°ç¬¬ä¸€æ­¥ã€‚</p>
<p>æ ¸å¿ƒå¿«æ·é”®è¡¨ï¼š</p>
<table>
<thead>
<tr>
<th>æ“ä½œ</th>
<th>å¿«æ·é”®</th>
</tr>
</thead>
<tbody><tr>
<td><a target="_blank" rel="noopener" href="https://www.jetbrains.com/help/idea/navigating-to-action.html">æ ¹æ®åç§°æŸ¥æ‰¾æ“ä½œ</a></td>
<td><code>Ctrl+Shift+A</code></td>
</tr>
<tr>
<td>æ˜¾ç¤ºå¯ç”¨ <a target="_blank" rel="noopener" href="https://www.jetbrains.com/help/idea/intention-actions.html">æ„å›¾æ“ä½œ</a> åˆ—è¡¨</td>
<td><code>Alt+Enter</code></td>
</tr>
<tr>
<td>åˆ‡æ¢è§†å›¾ (<a target="_blank" rel="noopener" href="https://www.jetbrains.com/help/idea/project-tool-window.html">Project</a>,<a target="_blank" rel="noopener" href="https://www.jetbrains.com/help/idea/structure-tool-window-file-structure-popup.html">Structure</a>, etc.).</td>
<td><code>Alt+F1</code></td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://www.jetbrains.com/help/idea/navigating-between-files-and-tool-windows.html">åˆ‡æ¢</a>å·¥å…·çª—å£å’Œåœ¨ç¼–è¾‘å™¨ä¸­æ‰“å¼€çš„æ–‡ä»¶</td>
<td><code>Ctrl+Tab</code></td>
</tr>
<tr>
<td>æ˜¾ç¤º <a target="_blank" rel="noopener" href="https://www.jetbrains.com/help/idea/navigation-bar.html">å¯¼èˆªæ </a>.</td>
<td><code>Alt+Home</code></td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://www.jetbrains.com/help/idea/generating-code.html">æ’å…¥ä»£ç æ¨¡æ¿</a>.</td>
<td><code>Ctrl+J</code></td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://www.jetbrains.com/help/idea/creating-code-constructs-using-surround-templates.html">åœ¨å‘¨å›´æ’å…¥ä»£ç æ¨¡æ¿</a>.</td>
<td><code>Ctrl+Alt+J</code></td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://www.jetbrains.com/help/idea/opening-and-reopening-files-in-the-editor.html">Edit an item from the Project or another tree view</a>.</td>
<td><code>F4</code></td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://www.jetbrains.com/help/idea/commenting-and-uncommenting-blocks-of-code.html">æ³¨é‡Š</a></td>
<td><code>Ctrl+/</code> <code>Ctrl+Shift+/</code></td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://www.jetbrains.com/help/idea/navigating-to-class-file-or-symbol-by-name.html">æ ¹æ®åç§°æŸ¥æ‰¾ç±»æˆ–æ–‡ä»¶</a>.</td>
<td><code>Ctrl+N</code> <code>Ctrl+Shift+N</code></td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://www.jetbrains.com/help/idea/adding-deleting-and-moving-code-elements.html#duplicate">æ‹·è´å½“å‰è¡Œæˆ–æŒ‡å®šçš„è¡Œ</a>.</td>
<td><code>Ctrl+D</code></td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://www.jetbrains.com/help/idea/selecting-text-in-the-editor.html">å¢åŠ æˆ–å‡å°‘é€‰ä¸­çš„è¡¨è¾¾å¼</a>.</td>
<td><code>Ctrl+W</code> and <code>Ctrl+Shift+W</code></td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://www.jetbrains.com/help/idea/finding-and-replacing-text-in-file.html">åœ¨å½“å‰æ–‡ä»¶æŸ¥æ‰¾æˆ–æ›¿æ¢</a>.</td>
<td><code>Ctrl+F</code> <code>Ctrl+R</code></td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://www.jetbrains.com/help/idea/finding-and-replacing-text-in-project.html">åœ¨é¡¹ç›®ä¸­æˆ–æŒ‡å®šçš„ç›®å½•ä¸­æŸ¥æ‰¾æˆ–æ›¿æ¢</a></td>
<td><code>Ctrl+Shift+F</code> <code>Ctrl+Shift+R</code></td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://www.jetbrains.com/help/idea/searching-everywhere.htmls">å…¨å±€æœç´¢</a></td>
<td>åŒå‡» <code>Shift</code></td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://www.jetbrains.com/help/idea/highlighting-usages.html">å¿«é€ŸæŸ¥çœ‹é€‰ä¸­å¯¹è±¡çš„å¼•ç”¨</a>.</td>
<td><code>Ctrl+Shift+F7</code></td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://www.jetbrains.com/help/idea/code-folding.html">å±•å¼€æˆ–æŠ˜å ç¼–è¾‘å™¨ä¸­çš„ä»£ç å—</a>.</td>
<td><code>Ctrl+NumPad Plus</code> <code>Ctrl+NumPad -</code></td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://www.jetbrains.com/help/idea/auto-completing-code.html#basic_completion">è°ƒç”¨ä»£ç å®Œæˆ</a>.</td>
<td><code>Ctrl+Space</code></td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://www.jetbrains.com/help/idea/auto-completing-code.html#statements_completion">æ™ºèƒ½å£°æ˜å®Œæˆ</a>.</td>
<td><code>Ctrl+Shift+Enter</code></td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://www.jetbrains.com/help/idea/auto-completing-code.html#smart_completion">æ™ºèƒ½è¡¥å…¨ä»£ç </a></td>
<td><code>Ctrl+Shift+Space</code></td>
</tr>
<tr>
<td>æ˜¾ç¤ºå¯ç”¨çš„<a target="_blank" rel="noopener" href="https://www.jetbrains.com/help/idea/refactoring-source-code.html">é‡æ„</a>æ–¹æ³•åˆ—è¡¨</td>
<td><code>Ctrl+Shift+Alt+T</code></td>
</tr>
</tbody></table>
<h3 id="å¿«æ·é”®åˆ†ç±»"><a href="#å¿«æ·é”®åˆ†ç±»" class="headerlink" title="å¿«æ·é”®åˆ†ç±»"></a>å¿«æ·é”®åˆ†ç±»</h3><h4 id="Tradition"><a href="#Tradition" class="headerlink" title="Tradition"></a>Tradition</h4><table>
<thead>
<tr>
<th>å¿«æ·é”®</th>
<th>ä»‹ç»</th>
</tr>
</thead>
<tbody><tr>
<td>Ctrl + Z</td>
<td>æ’¤é”€</td>
</tr>
<tr>
<td>Ctrl + Shift + Z</td>
<td>å–æ¶ˆæ’¤é”€</td>
</tr>
<tr>
<td>Ctrl + X</td>
<td>å‰ªåˆ‡</td>
</tr>
<tr>
<td>Ctrl + C</td>
<td>å¤åˆ¶</td>
</tr>
<tr>
<td>Ctrl + S</td>
<td>ä¿å­˜</td>
</tr>
<tr>
<td>Tab</td>
<td>ç¼©è¿›</td>
</tr>
<tr>
<td>Shift + Tab</td>
<td>å–æ¶ˆç¼©è¿›</td>
</tr>
<tr>
<td>Shift + Home&#x2F;End</td>
<td>é€‰ä¸­å…‰æ ‡åˆ°å½“å‰è¡Œå¤´ä½ç½®&#x2F;è¡Œå°¾ä½ç½®</td>
</tr>
<tr>
<td>Ctrl + Home&#x2F;End</td>
<td>è·³åˆ°æ–‡ä»¶å¤´&#x2F;æ–‡ä»¶å°¾</td>
</tr>
</tbody></table>
<h4 id="Editing"><a href="#Editing" class="headerlink" title="Editing"></a>Editing</h4><table>
<thead>
<tr>
<th>å¿«æ·é”®</th>
<th>ä»‹ç»</th>
</tr>
</thead>
<tbody><tr>
<td>Ctrl + Space</td>
<td>åŸºç¡€ä»£ç è¡¥å…¨ï¼Œé»˜è®¤åœ¨ Windows ç³»ç»Ÿä¸Šè¢«è¾“å…¥æ³•å ç”¨ï¼Œéœ€è¦è¿›è¡Œä¿®æ”¹ï¼Œå»ºè®®ä¿®æ”¹ä¸º Ctrl + é€—å·<code>ï¼ˆå¿…å¤‡ï¼‰</code></td>
</tr>
<tr>
<td>Ctrl + Alt + Space</td>
<td>ç±»åè‡ªåŠ¨å®Œæˆ</td>
</tr>
<tr>
<td>Ctrl + Shift + Enter</td>
<td>è‡ªåŠ¨ç»“æŸä»£ç ï¼Œè¡Œæœ«è‡ªåŠ¨æ·»åŠ åˆ†å·<code>ï¼ˆå¿…å¤‡ï¼‰</code></td>
</tr>
<tr>
<td>Ctrl + P</td>
<td>æ–¹æ³•å‚æ•°æç¤ºæ˜¾ç¤º</td>
</tr>
<tr>
<td>Ctrl + Q</td>
<td>å…‰æ ‡æ‰€åœ¨çš„å˜é‡&#x2F;ç±»å&#x2F;æ–¹æ³•åç­‰ä¸Šé¢ï¼ˆä¹Ÿå¯ä»¥åœ¨æç¤ºè¡¥å……çš„æ—¶å€™æŒ‰ï¼‰ï¼Œæ˜¾ç¤ºæ–‡æ¡£å†…å®¹</td>
</tr>
<tr>
<td>Shift + F1</td>
<td>å¦‚æœæœ‰å¤–éƒ¨æ–‡æ¡£å¯ä»¥è¿æ¥å¤–éƒ¨æ–‡æ¡£</td>
</tr>
<tr>
<td>Ctrl + F1</td>
<td>åœ¨å…‰æ ‡æ‰€åœ¨çš„é”™è¯¯ä»£ç å¤„æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯<code>ï¼ˆå¿…å¤‡ï¼‰</code></td>
</tr>
<tr>
<td>Alt + Insert</td>
<td>ä»£ç è‡ªåŠ¨ç”Ÿæˆï¼Œå¦‚ç”Ÿæˆå¯¹è±¡çš„ set&#x2F;get æ–¹æ³•ï¼Œæ„é€ å‡½æ•°ï¼ŒtoString() ç­‰<code>ï¼ˆå¿…å¤‡ï¼‰</code></td>
</tr>
<tr>
<td>Ctrl + O</td>
<td>é€‰æ‹©å¯é‡å†™çš„æ–¹æ³•</td>
</tr>
<tr>
<td>Ctrl + I</td>
<td>é€‰æ‹©å¯ç»§æ‰¿çš„æ–¹æ³•</td>
</tr>
<tr>
<td>Ctrl + Alt + T</td>
<td>å¯¹é€‰ä¸­çš„ä»£ç å¼¹å‡ºç¯ç»•é€‰é¡¹å¼¹å‡ºå±‚<code>ï¼ˆå¿…å¤‡ï¼‰</code></td>
</tr>
<tr>
<td>Ctrl + &#x2F;</td>
<td>æ³¨é‡Šå…‰æ ‡æ‰€åœ¨è¡Œä»£ç ï¼Œä¼šæ ¹æ®å½“å‰ä¸åŒæ–‡ä»¶ç±»å‹ä½¿ç”¨ä¸åŒçš„æ³¨é‡Šç¬¦å·<code>ï¼ˆå¿…å¤‡ï¼‰</code></td>
</tr>
<tr>
<td>Ctrl + Shift + &#x2F;</td>
<td>ä»£ç å—æ³¨é‡Š<code>ï¼ˆå¿…å¤‡ï¼‰</code></td>
</tr>
<tr>
<td>Ctrl + W</td>
<td>é€’è¿›å¼é€‰æ‹©ä»£ç å—ã€‚å¯é€‰ä¸­å…‰æ ‡æ‰€åœ¨çš„å•è¯æˆ–æ®µè½ï¼Œè¿ç»­æŒ‰ä¼šåœ¨åŸæœ‰é€‰ä¸­çš„åŸºç¡€ä¸Šå†æ‰©å±•é€‰ä¸­èŒƒå›´<code>ï¼ˆå¿…å¤‡ï¼‰</code></td>
</tr>
<tr>
<td>Ctrl + Shift + W</td>
<td>é€’è¿›å¼å–æ¶ˆé€‰æ‹©ä»£ç å—ã€‚å¯é€‰ä¸­å…‰æ ‡æ‰€åœ¨çš„å•è¯æˆ–æ®µè½ï¼Œè¿ç»­æŒ‰ä¼šåœ¨åŸæœ‰é€‰ä¸­çš„åŸºç¡€ä¸Šå†æ‰©å±•å–æ¶ˆé€‰ä¸­èŒƒå›´<code>ï¼ˆå¿…å¤‡ï¼‰</code></td>
</tr>
<tr>
<td>Alt + Q</td>
<td>å¼¹å‡ºä¸€ä¸ªæç¤ºï¼Œæ˜¾ç¤ºå½“å‰ç±»çš„å£°æ˜&#x2F;ä¸Šä¸‹æ–‡ä¿¡æ¯</td>
</tr>
<tr>
<td>Alt + Enter</td>
<td>IntelliJ IDEA æ ¹æ®å…‰æ ‡æ‰€åœ¨é—®é¢˜ï¼Œæä¾›å¿«é€Ÿä¿®å¤é€‰æ‹©ï¼Œå…‰æ ‡æ”¾åœ¨çš„ä½ç½®ä¸åŒæç¤ºçš„ç»“æœä¹Ÿä¸åŒ<code>ï¼ˆå¿…å¤‡ï¼‰</code></td>
</tr>
<tr>
<td>Ctrl + Alt + L</td>
<td>æ ¼å¼åŒ–ä»£ç ï¼Œå¯ä»¥å¯¹å½“å‰æ–‡ä»¶å’Œæ•´ä¸ªåŒ…ç›®å½•ä½¿ç”¨<code>ï¼ˆå¿…å¤‡ï¼‰</code></td>
</tr>
<tr>
<td>Ctrl + Alt + O</td>
<td>ä¼˜åŒ–å¯¼å…¥çš„ç±»ï¼Œå¯ä»¥å¯¹å½“å‰æ–‡ä»¶å’Œæ•´ä¸ªåŒ…ç›®å½•ä½¿ç”¨<code>ï¼ˆå¿…å¤‡ï¼‰</code></td>
</tr>
<tr>
<td>Ctrl + Alt + I</td>
<td>å…‰æ ‡æ‰€åœ¨è¡Œ æˆ– é€‰ä¸­éƒ¨åˆ†è¿›è¡Œè‡ªåŠ¨ä»£ç ç¼©è¿›ï¼Œæœ‰ç‚¹ç±»ä¼¼æ ¼å¼åŒ–</td>
</tr>
<tr>
<td>Ctrl + Shift + C</td>
<td>å¤åˆ¶å½“å‰æ–‡ä»¶ç£ç›˜è·¯å¾„åˆ°å‰ªè´´æ¿<code>ï¼ˆå¿…å¤‡ï¼‰</code></td>
</tr>
<tr>
<td>Ctrl + Shift + V</td>
<td>å¼¹å‡ºç¼“å­˜çš„æœ€è¿‘æ‹·è´çš„å†…å®¹ç®¡ç†å™¨å¼¹å‡ºå±‚</td>
</tr>
<tr>
<td>Ctrl + Alt + Shift + C</td>
<td>å¤åˆ¶å‚è€ƒä¿¡æ¯</td>
</tr>
<tr>
<td>Ctrl + Alt + Shift + V</td>
<td>æ— æ ¼å¼é»è´´<code>ï¼ˆå¿…å¤‡ï¼‰</code></td>
</tr>
<tr>
<td>Ctrl + D</td>
<td>å¤åˆ¶å…‰æ ‡æ‰€åœ¨è¡Œ æˆ– å¤åˆ¶é€‰æ‹©å†…å®¹ï¼Œå¹¶æŠŠå¤åˆ¶å†…å®¹æ’å…¥å…‰æ ‡ä½ç½®ä¸‹é¢<code>ï¼ˆå¿…å¤‡ï¼‰</code></td>
</tr>
<tr>
<td>Ctrl + Y</td>
<td>åˆ é™¤å…‰æ ‡æ‰€åœ¨è¡Œ æˆ– åˆ é™¤é€‰ä¸­çš„è¡Œ<code>ï¼ˆå¿…å¤‡ï¼‰</code></td>
</tr>
<tr>
<td>Ctrl + Shift + J</td>
<td>è‡ªåŠ¨å°†ä¸‹ä¸€è¡Œåˆå¹¶åˆ°å½“å‰è¡Œæœ«å°¾<code>ï¼ˆå¿…å¤‡ï¼‰</code></td>
</tr>
<tr>
<td>Shift + Enter</td>
<td>å¼€å§‹æ–°ä¸€è¡Œã€‚å…‰æ ‡æ‰€åœ¨è¡Œä¸‹ç©ºå‡ºä¸€è¡Œï¼Œå…‰æ ‡å®šä½åˆ°æ–°è¡Œä½ç½®<code>ï¼ˆå¿…å¤‡ï¼‰</code></td>
</tr>
<tr>
<td>Ctrl + Shift + U</td>
<td>å¯¹é€‰ä¸­çš„ä»£ç è¿›è¡Œå¤§&#x2F;å°å†™è½®æµè½¬æ¢<code>ï¼ˆå¿…å¤‡ï¼‰</code></td>
</tr>
<tr>
<td>Ctrl + Shift + ]&#x2F;[</td>
<td>é€‰ä¸­ä»å…‰æ ‡æ‰€åœ¨ä½ç½®åˆ°å®ƒçš„åº•éƒ¨&#x2F;é¡¶éƒ¨çš„ä¸­æ‹¬å·ä½ç½®<code>ï¼ˆå¿…å¤‡ï¼‰</code></td>
</tr>
<tr>
<td>Ctrl + Delete</td>
<td>åˆ é™¤å…‰æ ‡åé¢çš„å•è¯æˆ–æ˜¯ä¸­æ–‡å¥<code>ï¼ˆå¿…å¤‡ï¼‰</code></td>
</tr>
<tr>
<td>Ctrl + BackSpace</td>
<td>åˆ é™¤å…‰æ ‡å‰é¢çš„å•è¯æˆ–æ˜¯ä¸­æ–‡å¥<code>ï¼ˆå¿…å¤‡ï¼‰</code></td>
</tr>
<tr>
<td>Ctrl + +&#x2F;-</td>
<td>å±•å¼€&#x2F;æŠ˜å ä»£ç å—</td>
</tr>
<tr>
<td>Ctrl + Shift + +&#x2F;-</td>
<td>å±•å¼€&#x2F;æŠ˜å æ‰€æœ‰ä»£ç <code>ï¼ˆå¿…å¤‡ï¼‰</code></td>
</tr>
<tr>
<td>Ctrl + F4</td>
<td>å…³é—­å½“å‰ç¼–è¾‘æ–‡ä»¶</td>
</tr>
<tr>
<td>Ctrl + Shift + Up&#x2F;Down</td>
<td>å…‰æ ‡æ”¾åœ¨æ–¹æ³•åä¸Šï¼Œå°†æ–¹æ³•ç§»åŠ¨åˆ°ä¸Šä¸€ä¸ª&#x2F;ä¸‹ä¸€ä¸ªæ–¹æ³•å‰é¢ï¼Œè°ƒæ•´æ–¹æ³•æ’åº<code>ï¼ˆå¿…å¤‡ï¼‰</code></td>
</tr>
<tr>
<td>Alt + Shift + Up&#x2F;Down</td>
<td>ç§»åŠ¨å…‰æ ‡æ‰€åœ¨è¡Œå‘ä¸Šç§»åŠ¨&#x2F;å‘ä¸‹ç§»åŠ¨<code>ï¼ˆå¿…å¤‡ï¼‰</code></td>
</tr>
<tr>
<td>Ctrl + Shift + å·¦é”®å•å‡»</td>
<td>æŠŠå…‰æ ‡æ”¾åœ¨æŸä¸ªç±»å˜é‡ä¸Šï¼ŒæŒ‰æ­¤å¿«æ·é”®å¯ä»¥ç›´æ¥å®šä½åˆ°è¯¥ç±»ä¸­<code>ï¼ˆå¿…å¤‡ï¼‰</code></td>
</tr>
<tr>
<td>Alt + Shift + å·¦é”®åŒå‡»</td>
<td>é€‰æ‹©è¢«åŒå‡»çš„å•è¯&#x2F;ä¸­æ–‡å¥ï¼ŒæŒ‰ä½ä¸æ”¾ï¼Œå¯ä»¥åŒæ—¶é€‰æ‹©å…¶ä»–å•è¯&#x2F;ä¸­æ–‡å¥<code>ï¼ˆå¿…å¤‡ï¼‰</code></td>
</tr>
<tr>
<td>Ctrl + Shift + T</td>
<td>å¯¹å½“å‰ç±»ç”Ÿæˆå•å…ƒæµ‹è¯•ç±»ï¼Œå¦‚æœå·²ç»å­˜åœ¨çš„å•å…ƒæµ‹è¯•ç±»åˆ™å¯ä»¥è¿›è¡Œé€‰æ‹©<code>ï¼ˆå¿…å¤‡ï¼‰</code></td>
</tr>
</tbody></table>
<h4 id="Search-Replace"><a href="#Search-Replace" class="headerlink" title="Search&#x2F;Replace"></a>Search&#x2F;Replace</h4><table>
<thead>
<tr>
<th>å¿«æ·é”®</th>
<th>ä»‹ç»</th>
</tr>
</thead>
<tbody><tr>
<td>Double Shift</td>
<td>å¼¹å‡º Search Everywhere å¼¹å‡ºå±‚</td>
</tr>
<tr>
<td>F3</td>
<td>åœ¨æŸ¥æ‰¾æ¨¡å¼ä¸‹ï¼Œå®šä½åˆ°ä¸‹ä¸€ä¸ªåŒ¹é…å¤„</td>
</tr>
<tr>
<td>Shift + F3</td>
<td>åœ¨æŸ¥æ‰¾æ¨¡å¼ä¸‹ï¼ŒæŸ¥æ‰¾åŒ¹é…ä¸Šä¸€ä¸ª</td>
</tr>
<tr>
<td>Ctrl + F</td>
<td>åœ¨å½“å‰æ–‡ä»¶è¿›è¡Œæ–‡æœ¬æŸ¥æ‰¾<code>ï¼ˆå¿…å¤‡ï¼‰</code></td>
</tr>
<tr>
<td>Ctrl + R</td>
<td>åœ¨å½“å‰æ–‡ä»¶è¿›è¡Œæ–‡æœ¬æ›¿æ¢<code>ï¼ˆå¿…å¤‡ï¼‰</code></td>
</tr>
<tr>
<td>Ctrl + Shift + F</td>
<td>æ ¹æ®è¾“å…¥å†…å®¹æŸ¥æ‰¾æ•´ä¸ªé¡¹ç›® æˆ– æŒ‡å®šç›®å½•å†…æ–‡ä»¶<code>ï¼ˆå¿…å¤‡ï¼‰</code></td>
</tr>
<tr>
<td>Ctrl + Shift + R</td>
<td>æ ¹æ®è¾“å…¥å†…å®¹æ›¿æ¢å¯¹åº”å†…å®¹ï¼ŒèŒƒå›´ä¸ºæ•´ä¸ªé¡¹ç›® æˆ– æŒ‡å®šç›®å½•å†…æ–‡ä»¶<code>ï¼ˆå¿…å¤‡ï¼‰</code></td>
</tr>
</tbody></table>
<h4 id="Usage-Search"><a href="#Usage-Search" class="headerlink" title="Usage Search"></a>Usage Search</h4><table>
<thead>
<tr>
<th>å¿«æ·é”®</th>
<th>ä»‹ç»</th>
</tr>
</thead>
<tbody><tr>
<td>Alt + F7</td>
<td>æŸ¥æ‰¾å…‰æ ‡æ‰€åœ¨çš„æ–¹æ³•&#x2F;å˜é‡&#x2F;ç±»è¢«è°ƒç”¨çš„åœ°æ–¹</td>
</tr>
<tr>
<td>Ctrl + Alt + F7</td>
<td>æ˜¾ç¤ºä½¿ç”¨çš„åœ°æ–¹ã€‚å¯»æ‰¾è¢«è¯¥ç±»æˆ–æ˜¯å˜é‡è¢«è°ƒç”¨çš„åœ°æ–¹ï¼Œç”¨å¼¹å‡ºæ¡†çš„æ–¹å¼æ‰¾å‡ºæ¥</td>
</tr>
<tr>
<td>Ctrl + Shift + F7</td>
<td>é«˜äº®æ˜¾ç¤ºæ‰€æœ‰è¯¥é€‰ä¸­æ–‡æœ¬ï¼ŒæŒ‰ Esc é«˜äº®æ¶ˆå¤±<code>ï¼ˆå¿…å¤‡ï¼‰</code></td>
</tr>
</tbody></table>
<h4 id="Compile-and-Run"><a href="#Compile-and-Run" class="headerlink" title="Compile and Run"></a>Compile and Run</h4><table>
<thead>
<tr>
<th>å¿«æ·é”®</th>
<th>ä»‹ç»</th>
</tr>
</thead>
<tbody><tr>
<td>Ctrl + F9</td>
<td>æ‰§è¡Œ Make Project æ“ä½œ</td>
</tr>
<tr>
<td>Ctrl + Shift + F9</td>
<td>ç¼–è¯‘é€‰ä¸­çš„æ–‡ä»¶&#x2F;åŒ…&#x2F;Module</td>
</tr>
<tr>
<td>Shift + F9</td>
<td>Debug</td>
</tr>
<tr>
<td>Shift + F10</td>
<td>Run</td>
</tr>
<tr>
<td>Alt + Shift + F9</td>
<td>å¼¹å‡º Debug çš„å¯é€‰æ‹©èœå•</td>
</tr>
<tr>
<td>Alt + Shift + F10</td>
<td>å¼¹å‡º Run çš„å¯é€‰æ‹©èœå•</td>
</tr>
</tbody></table>
<h4 id="Debugging"><a href="#Debugging" class="headerlink" title="Debugging"></a>Debugging</h4><table>
<thead>
<tr>
<th>å¿«æ·é”®</th>
<th>ä»‹ç»</th>
</tr>
</thead>
<tbody><tr>
<td>F7</td>
<td>åœ¨ Debug æ¨¡å¼ä¸‹ï¼Œè¿›å…¥ä¸‹ä¸€æ­¥ï¼Œå¦‚æœå½“å‰è¡Œæ–­ç‚¹æ˜¯ä¸€ä¸ªæ–¹æ³•ï¼Œåˆ™è¿›å…¥å½“å‰æ–¹æ³•ä½“å†…ï¼Œå¦‚æœè¯¥æ–¹æ³•ä½“è¿˜æœ‰æ–¹æ³•ï¼Œåˆ™ä¸ä¼šè¿›å…¥è¯¥å†…åµŒçš„æ–¹æ³•ä¸­</td>
</tr>
<tr>
<td>F8</td>
<td>åœ¨ Debug æ¨¡å¼ä¸‹ï¼Œè¿›å…¥ä¸‹ä¸€æ­¥ï¼Œå¦‚æœå½“å‰è¡Œæ–­ç‚¹æ˜¯ä¸€ä¸ªæ–¹æ³•ï¼Œåˆ™ä¸è¿›å…¥å½“å‰æ–¹æ³•ä½“å†…</td>
</tr>
<tr>
<td>Shift + F7</td>
<td>åœ¨ Debug æ¨¡å¼ä¸‹ï¼Œæ™ºèƒ½æ­¥å…¥ã€‚æ–­ç‚¹æ‰€åœ¨è¡Œä¸Šæœ‰å¤šä¸ªæ–¹æ³•è°ƒç”¨ï¼Œä¼šå¼¹å‡ºè¿›å…¥å“ªä¸ªæ–¹æ³•</td>
</tr>
<tr>
<td>Shift + F8</td>
<td>åœ¨ Debug æ¨¡å¼ä¸‹ï¼Œè·³å‡ºï¼Œè¡¨ç°å‡ºæ¥çš„æ•ˆæœè·Ÿ F9 ä¸€æ ·</td>
</tr>
<tr>
<td>Alt + F8</td>
<td>åœ¨ Debug æ¨¡å¼ä¸‹ï¼Œé€‰ä¸­å¯¹è±¡ï¼Œå¼¹å‡ºå¯è¾“å…¥è®¡ç®—è¡¨è¾¾å¼è°ƒè¯•æ¡†ï¼ŒæŸ¥çœ‹è¯¥è¾“å…¥å†…å®¹çš„è°ƒè¯•ç»“æœ</td>
</tr>
<tr>
<td>Alt + F9</td>
<td>åœ¨ Debug æ¨¡å¼ä¸‹ï¼Œæ‰§è¡Œåˆ°å…‰æ ‡å¤„</td>
</tr>
<tr>
<td>F9</td>
<td>åœ¨ Debug æ¨¡å¼ä¸‹ï¼Œæ¢å¤ç¨‹åºè¿è¡Œï¼Œä½†æ˜¯å¦‚æœè¯¥æ–­ç‚¹ä¸‹é¢ä»£ç è¿˜æœ‰æ–­ç‚¹åˆ™åœåœ¨ä¸‹ä¸€ä¸ªæ–­ç‚¹ä¸Š</td>
</tr>
<tr>
<td>Ctrl + F8</td>
<td>åœ¨ Debug æ¨¡å¼ä¸‹ï¼Œè®¾ç½®å…‰æ ‡å½“å‰è¡Œä¸ºæ–­ç‚¹ï¼Œå¦‚æœå½“å‰å·²ç»æ˜¯æ–­ç‚¹åˆ™å»æ‰æ–­ç‚¹</td>
</tr>
<tr>
<td>Ctrl + Shift + F8</td>
<td>åœ¨ Debug æ¨¡å¼ä¸‹ï¼ŒæŒ‡å®šæ–­ç‚¹è¿›å…¥æ¡ä»¶</td>
</tr>
</tbody></table>
<h4 id="Navigation"><a href="#Navigation" class="headerlink" title="Navigation"></a>Navigation</h4><table>
<thead>
<tr>
<th>å¿«æ·é”®</th>
<th>ä»‹ç»</th>
</tr>
</thead>
<tbody><tr>
<td>Ctrl + N</td>
<td>è·³è½¬åˆ°ç±»<code>ï¼ˆå¿…å¤‡ï¼‰</code></td>
</tr>
<tr>
<td>Ctrl + Shift + N</td>
<td>è·³è½¬åˆ°æ–‡ä»¶<code>ï¼ˆå¿…å¤‡ï¼‰</code></td>
</tr>
<tr>
<td>Ctrl + Alt + Shift + N</td>
<td>è·³è½¬åˆ°ç¬¦å·<code>ï¼ˆå¿…å¤‡ï¼‰</code></td>
</tr>
<tr>
<td>Alt + Left&#x2F;Right</td>
<td>åˆ‡æ¢å½“å‰å·²æ‰“å¼€çš„çª—å£ä¸­çš„å­è§†å›¾ï¼Œæ¯”å¦‚ Debug çª—å£ä¸­æœ‰ Outputã€Debugger ç­‰å­è§†å›¾ï¼Œç”¨æ­¤å¿«æ·é”®å°±å¯ä»¥åœ¨å­è§†å›¾ä¸­åˆ‡æ¢<code>ï¼ˆå¿…å¤‡ï¼‰</code></td>
</tr>
<tr>
<td>F12</td>
<td>å›åˆ°å‰ä¸€ä¸ªå·¥å…·çª—å£<code>ï¼ˆå¿…å¤‡ï¼‰</code></td>
</tr>
<tr>
<td>ESC</td>
<td>ä»å·¥å…·çª—å£è¿›å…¥ä»£ç æ–‡ä»¶çª—å£<code>ï¼ˆå¿…å¤‡ï¼‰</code></td>
</tr>
<tr>
<td>Shift + ESC</td>
<td>éšè—å½“å‰ æˆ– æœ€åä¸€ä¸ªæ¿€æ´»çš„å·¥å…·çª—å£</td>
</tr>
<tr>
<td>Ctrl + G</td>
<td>è·³è½¬åˆ°å½“å‰æ–‡ä»¶çš„æŒ‡å®šè¡Œå¤„</td>
</tr>
<tr>
<td>Ctrl + E</td>
<td>æ˜¾ç¤ºæœ€è¿‘æ‰“å¼€çš„æ–‡ä»¶è®°å½•åˆ—è¡¨<code>ï¼ˆå¿…å¤‡ï¼‰</code></td>
</tr>
<tr>
<td>Ctrl + Shift + E</td>
<td>æ˜¾ç¤ºæœ€è¿‘ç¼–è¾‘çš„æ–‡ä»¶è®°å½•åˆ—è¡¨<code>ï¼ˆå¿…å¤‡ï¼‰</code></td>
</tr>
<tr>
<td>Ctrl + Alt + Left&#x2F;Right</td>
<td>è·³è½¬åˆ°ä¸Šä¸€ä¸ª&#x2F;ä¸‹ä¸€ä¸ªæ“ä½œçš„åœ°æ–¹<code>ï¼ˆå¿…å¤‡ï¼‰</code></td>
</tr>
<tr>
<td>Ctrl + Shift + Backspace</td>
<td>é€€å›åˆ°ä¸Šæ¬¡ä¿®æ”¹çš„åœ°æ–¹<code>ï¼ˆå¿…å¤‡ï¼‰</code></td>
</tr>
<tr>
<td>Alt + F1</td>
<td>æ˜¾ç¤ºå½“å‰æ–‡ä»¶é€‰æ‹©ç›®æ ‡å¼¹å‡ºå±‚ï¼Œå¼¹å‡ºå±‚ä¸­æœ‰å¾ˆå¤šç›®æ ‡å¯ä»¥è¿›è¡Œé€‰æ‹©<code>ï¼ˆå¿…å¤‡ï¼‰</code></td>
</tr>
<tr>
<td>Ctrl + B&#x2F;Ctrl + å·¦é”®å•å‡»</td>
<td>è·³è½¬åˆ°å£°æ˜å¤„</td>
</tr>
<tr>
<td>Ctrl + Alt + B</td>
<td>åœ¨æŸä¸ªè°ƒç”¨çš„æ–¹æ³•åä¸Šä½¿ç”¨ä¼šè·³åˆ°å…·ä½“çš„å®ç°å¤„ï¼Œå¯ä»¥è·³è¿‡æ¥å£</td>
</tr>
<tr>
<td>Ctrl + Shift + B</td>
<td>è·³è½¬åˆ°ç±»å‹å£°æ˜å¤„<code>ï¼ˆå¿…å¤‡ï¼‰</code></td>
</tr>
<tr>
<td>Ctrl + Shift + I</td>
<td>å¿«é€ŸæŸ¥çœ‹å…‰æ ‡æ‰€åœ¨çš„æ–¹æ³• æˆ– ç±»çš„å®šä¹‰</td>
</tr>
<tr>
<td>Ctrl + U</td>
<td>å‰å¾€å½“å‰å…‰æ ‡æ‰€åœ¨çš„æ–¹æ³•çš„çˆ¶ç±»çš„æ–¹æ³•&#x2F;æ¥å£å®šä¹‰<code>ï¼ˆå¿…å¤‡ï¼‰</code></td>
</tr>
<tr>
<td>Alt + Up&#x2F;Down</td>
<td>è·³è½¬åˆ°å½“å‰æ–‡ä»¶çš„å‰ä¸€ä¸ª&#x2F;åä¸€ä¸ªæ–¹æ³•<code>ï¼ˆå¿…å¤‡ï¼‰</code></td>
</tr>
<tr>
<td>Ctrl + ]&#x2F;[</td>
<td>è·³è½¬åˆ°å½“å‰æ‰€åœ¨ä»£ç çš„èŠ±æ‹¬å·ç»“æŸä½ç½®&#x2F;å¼€å§‹ä½ç½®</td>
</tr>
<tr>
<td>Ctrl + F12</td>
<td>å¼¹å‡ºå½“å‰æ–‡ä»¶ç»“æ„å±‚ï¼Œå¯ä»¥åœ¨å¼¹å‡ºçš„å±‚ä¸Šç›´æ¥è¾“å…¥ï¼Œè¿›è¡Œç­›é€‰</td>
</tr>
<tr>
<td>Ctrl + H</td>
<td>æ˜¾ç¤ºå½“å‰ç±»çš„å±‚æ¬¡ç»“æ„</td>
</tr>
<tr>
<td>Ctrl + Shift + H</td>
<td>æ˜¾ç¤ºæ–¹æ³•å±‚æ¬¡ç»“æ„</td>
</tr>
<tr>
<td>Ctrl + Alt + H</td>
<td>è°ƒç”¨å±‚æ¬¡</td>
</tr>
<tr>
<td>F2&#x2F;Shift + F2</td>
<td>è·³è½¬åˆ°ä¸‹ä¸€ä¸ª&#x2F;ä¸Šä¸€ä¸ªé«˜äº®é”™è¯¯ æˆ– è­¦å‘Šä½ç½®<code>ï¼ˆå¿…å¤‡ï¼‰</code></td>
</tr>
<tr>
<td>F4</td>
<td>ç¼–è¾‘æº<code>ï¼ˆå¿…å¤‡ï¼‰</code></td>
</tr>
<tr>
<td>Alt + Home</td>
<td>å®šä½&#x2F;æ˜¾ç¤ºåˆ°å½“å‰æ–‡ä»¶çš„ Navigation Bar</td>
</tr>
<tr>
<td>F11</td>
<td>æ·»åŠ ä¹¦ç­¾<code>ï¼ˆå¿…å¤‡ï¼‰</code></td>
</tr>
<tr>
<td>Ctrl + F11</td>
<td>é€‰ä¸­æ–‡ä»¶&#x2F;æ–‡ä»¶å¤¹ï¼Œä½¿ç”¨åŠ©è®°ç¬¦è®¾å®š&#x2F;å–æ¶ˆä¹¦ç­¾<code>ï¼ˆå¿…å¤‡ï¼‰</code></td>
</tr>
<tr>
<td>Shift + F11</td>
<td>å¼¹å‡ºä¹¦ç­¾æ˜¾ç¤ºå±‚<code>ï¼ˆå¿…å¤‡ï¼‰</code></td>
</tr>
<tr>
<td>Alt + 1,2,3â€¦9</td>
<td>æ˜¾ç¤ºå¯¹åº”æ•°å€¼çš„é€‰é¡¹å¡ï¼Œå…¶ä¸­ 1 æ˜¯ Project ç”¨å¾—æœ€å¤š<code>ï¼ˆå¿…å¤‡ï¼‰</code></td>
</tr>
<tr>
<td>Ctrl + 1,2,3â€¦9</td>
<td>å®šä½åˆ°å¯¹åº”æ•°å€¼çš„ä¹¦ç­¾ä½ç½®<code>ï¼ˆå¿…å¤‡ï¼‰</code></td>
</tr>
</tbody></table>
<h4 id="Refactoring"><a href="#Refactoring" class="headerlink" title="Refactoring"></a>Refactoring</h4><table>
<thead>
<tr>
<th>å¿«æ·é”®</th>
<th>ä»‹ç»</th>
</tr>
</thead>
<tbody><tr>
<td>Shift + F6</td>
<td>å¯¹æ–‡ä»¶&#x2F;æ–‡ä»¶å¤¹ é‡å‘½å<code>ï¼ˆå¿…å¤‡ï¼‰</code></td>
</tr>
<tr>
<td>Ctrl + Alt + Shift + T</td>
<td>æ‰“å¼€é‡æ„èœå•<code>ï¼ˆå¿…å¤‡ï¼‰</code></td>
</tr>
</tbody></table>
<h4 id="VCS-Local-History"><a href="#VCS-Local-History" class="headerlink" title="VCS&#x2F;Local History"></a>VCS&#x2F;Local History</h4><table>
<thead>
<tr>
<th>å¿«æ·é”®</th>
<th>ä»‹ç»</th>
</tr>
</thead>
<tbody><tr>
<td>Ctrl + K</td>
<td>ç‰ˆæœ¬æ§åˆ¶æäº¤é¡¹ç›®ï¼Œéœ€è¦æ­¤é¡¹ç›®æœ‰åŠ å…¥åˆ°ç‰ˆæœ¬æ§åˆ¶æ‰å¯ç”¨</td>
</tr>
<tr>
<td>Ctrl + T</td>
<td>ç‰ˆæœ¬æ§åˆ¶æ›´æ–°é¡¹ç›®ï¼Œéœ€è¦æ­¤é¡¹ç›®æœ‰åŠ å…¥åˆ°ç‰ˆæœ¬æ§åˆ¶æ‰å¯ç”¨</td>
</tr>
<tr>
<td>&#96;Alt +</td>
<td>&#96;</td>
</tr>
<tr>
<td>Alt + Shift + C</td>
<td>æŸ¥çœ‹æœ€è¿‘æ“ä½œé¡¹ç›®çš„å˜åŒ–æƒ…å†µåˆ—è¡¨</td>
</tr>
<tr>
<td>Alt + Shift + N</td>
<td>é€‰æ‹©&#x2F;æ·»åŠ  task<code>ï¼ˆå¿…å¤‡ï¼‰</code></td>
</tr>
</tbody></table>
<h4 id="Live-Templates"><a href="#Live-Templates" class="headerlink" title="Live Templates"></a>Live Templates</h4><table>
<thead>
<tr>
<th>å¿«æ·é”®</th>
<th>ä»‹ç»</th>
</tr>
</thead>
<tbody><tr>
<td>Ctrl + J</td>
<td>æ’å…¥è‡ªå®šä¹‰åŠ¨æ€ä»£ç æ¨¡æ¿<code>ï¼ˆå¿…å¤‡ï¼‰</code></td>
</tr>
<tr>
<td>Ctrl + Alt + J</td>
<td>å¼¹å‡ºæ¨¡æ¿é€‰æ‹©çª—å£ï¼Œå°†é€‰å®šçš„ä»£ç åŠ å…¥åŠ¨æ€æ¨¡æ¿ä¸­</td>
</tr>
</tbody></table>
<h4 id="General"><a href="#General" class="headerlink" title="General"></a>General</h4><table>
<thead>
<tr>
<th>å¿«æ·é”®</th>
<th>ä»‹ç»</th>
</tr>
</thead>
<tbody><tr>
<td>Ctrl + Tab</td>
<td>ç¼–è¾‘çª—å£åˆ‡æ¢ï¼Œå¦‚æœåœ¨åˆ‡æ¢çš„è¿‡ç¨‹åˆåŠ æŒ‰ä¸Š deleteï¼Œåˆ™æ˜¯å…³é—­å¯¹åº”é€‰ä¸­çš„çª—å£</td>
</tr>
<tr>
<td>Ctrl + Alt + Y</td>
<td>åŒæ­¥ã€åˆ·æ–°</td>
</tr>
<tr>
<td>Ctrl + Alt + S</td>
<td>æ‰“å¼€ IntelliJ IDEA ç³»ç»Ÿè®¾ç½®<code>ï¼ˆå¿…å¤‡ï¼‰</code></td>
</tr>
<tr>
<td>Ctrl + Alt + Shift + S</td>
<td>æ‰“å¼€å½“å‰é¡¹ç›®è®¾ç½®<code>ï¼ˆå¿…å¤‡ï¼‰</code></td>
</tr>
<tr>
<td>Ctrl + Shift + A</td>
<td>æŸ¥æ‰¾åŠ¨ä½œ&#x2F;è®¾ç½®<code>ï¼ˆå¿…å¤‡ï¼‰</code></td>
</tr>
<tr>
<td>Ctrl + Shift + F12</td>
<td>ç¼–è¾‘å™¨æœ€å¤§åŒ–<code>ï¼ˆå¿…å¤‡ï¼‰</code></td>
</tr>
<tr>
<td>Alt + Shift + F</td>
<td>æ˜¾ç¤ºæ·»åŠ åˆ°æ”¶è—å¤¹å¼¹å‡ºå±‚&#x2F;æ·»åŠ åˆ°æ”¶è—å¤¹</td>
</tr>
<tr>
<td>Alt + Shift + I</td>
<td>æŸ¥çœ‹é¡¹ç›®å½“å‰æ–‡ä»¶</td>
</tr>
</tbody></table>
<h3 id="Intellij-IDEA-å®˜æ–¹å¿«æ·é”®è¡¨"><a href="#Intellij-IDEA-å®˜æ–¹å¿«æ·é”®è¡¨" class="headerlink" title="Intellij IDEA å®˜æ–¹å¿«æ·é”®è¡¨"></a>Intellij IDEA å®˜æ–¹å¿«æ·é”®è¡¨</h3><p><img src="http://upload-images.jianshu.io/upload_images/3101171-6a44121ae280a10e.png" alt="img"></p>
<h2 id="æ’ä»¶"><a href="#æ’ä»¶" class="headerlink" title="æ’ä»¶"></a>æ’ä»¶</h2><p>æ¨èå‡ ä¸ªæ¯”è¾ƒå¥½ç”¨çš„æ’ä»¶</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://plugins.jetbrains.com/plugin/4455?pr=idea">Key promoter</a> <a target="_blank" rel="noopener" href="https://plugins.jetbrains.com/plugin/4455?pr=idea">å¿«æ·é”®æç¤º</a></li>
<li><a target="_blank" rel="noopener" href="https://plugins.jetbrains.com/plugin/7160?pr=idea">CamelCase</a> é©¼å³°å¼å‘½åå’Œä¸‹åˆ’çº¿å‘½åäº¤æ›¿å˜åŒ–</li>
<li><a target="_blank" rel="noopener" href="https://plugins.jetbrains.com/plugin/1065?pr=idea">CheckStyle-IDEA</a> ä»£ç è§„èŒƒæ£€æŸ¥</li>
<li><a target="_blank" rel="noopener" href="https://plugins.jetbrains.com/plugin/3847?pr=idea">FindBugs-IDEA</a>æ½œåœ¨ Bug æ£€æŸ¥</li>
<li><a target="_blank" rel="noopener" href="https://plugins.jetbrains.com/plugin/93?pr=idea">MetricsReloaded</a> ä»£ç å¤æ‚åº¦æ£€æŸ¥</li>
<li><a target="_blank" rel="noopener" href="https://plugins.jetbrains.com/plugin/4509?pr=idea">Statistic</a> ä»£ç ç»Ÿè®¡</li>
<li><a target="_blank" rel="noopener" href="https://plugins.jetbrains.com/plugin/?id=4441">JRebel Plugin</a> çƒ­éƒ¨ç½²</li>
<li><a target="_blank" rel="noopener" href="https://plugins.jetbrains.com/plugin/7654?pr=idea">GsonFormat</a> æŠŠ JSON å­—ç¬¦ä¸²ç›´æ¥å®ä¾‹åŒ–æˆç±»</li>
<li><a target="_blank" rel="noopener" href="https://plugins.jetbrains.com/plugin/6546-eclipse-code-formatter">Eclipse Code Formatter</a> å¦‚æœä½ ä»¥å‰ç”¨çš„æ˜¯ IDEï¼Œå¹¶æœ‰è‡ªå·±çš„ä¸€å¥—ä»£ç é£æ ¼é…ç½®ï¼Œå¯ä»¥é€šè¿‡æ­¤æ’ä»¶å¯¼å…¥åˆ° IDEA</li>
<li><a target="_blank" rel="noopener" href="https://plugins.jetbrains.com/plugin/10046-alibaba-java-coding-guidelines">Alibaba Java Coding Guidelines</a> é˜¿é‡Œ Java å¼€å‘è§„èŒƒçš„é™æ€æ£€æŸ¥å·¥å…·</li>
<li><a target="_blank" rel="noopener" href="https://plugins.jetbrains.com/plugin/8554-ide-features-trainer">IDE Features Trainer</a> å®˜æ–¹çš„æ–°æ‰‹è®­ç»ƒæ’ä»¶</li>
<li><a target="_blank" rel="noopener" href="https://plugins.jetbrains.com/plugin/7896-markdown-navigator">Markdown Navigator</a> Markdown æ’ä»¶ï¼Œé€‚ç”¨äºå–œæ¬¢ç”¨ markdown å†™æ–‡æ¡£çš„äºº</li>
</ul>
<h2 id="ä¸ªæ€§åŒ–"><a href="#ä¸ªæ€§åŒ–" class="headerlink" title="ä¸ªæ€§åŒ–"></a>ä¸ªæ€§åŒ–</h2><h3 id="é¢œè‰²ä¸»é¢˜"><a href="#é¢œè‰²ä¸»é¢˜" class="headerlink" title="é¢œè‰²ä¸»é¢˜"></a>é¢œè‰²ä¸»é¢˜</h3><p><a target="_blank" rel="noopener" href="https://github.com/jkaving/intellij-colors-solarized">intellij-colors-solarized</a> ä¸ªäººè§‰å¾—è¿™ç§è‰²å½©æ­é…ååˆ†ä¼˜é›…</p>
<p><a target="_blank" rel="noopener" href="https://github.com/altercation/solarized">ä¸‹è½½åœ°å€</a></p>
<h2 id="FAQ"><a href="#FAQ" class="headerlink" title="FAQ"></a>FAQ</h2><p>ï¼ˆ1ï¼‰è¿è¡Œæ—¶æŠ¥é”™</p>
<blockquote>
<p>Error running XXX. Command line is too long. Shorten the command line via JAR manifest or via a classpath file and rerun</p>
</blockquote>
<p>è§£å†³æ–¹æ¡ˆï¼š</p>
<p>æ‰¾åˆ° <code>.idea/libraies/workspace.xml</code> ä¸­çš„ <code>&lt;component name=&quot;PropertiesComponent&quot;&gt;</code></p>
<p>æ·»åŠ ä¸€è¡Œé…ç½®ï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;dynamic.classpath&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><ul>
<li><a target="_blank" rel="noopener" href="https://github.com/judasn/IntelliJ-IDEA-Tutorial">IntelliJ-IDEA-Tutorial</a></li>
<li><a target="_blank" rel="noopener" href="http://wiki.jikexueyuan.com/project/intellij-idea-tutorial/">æå®¢å­¦é™¢ - Intellij IDEA ä½¿ç”¨æ•™ç¨‹</a></li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://dunwu.github.io/blog/pages/02efbd5a/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/blog/uploads/avatar.gif">
      <meta itemprop="name" content="é’æ‚Ÿ â—¾ Dunwu">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Dunwu Blog">
      <meta itemprop="description" content="é’æ‚Ÿçš„ä¸ªäººåšå®¢">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content=" | Dunwu Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/blog/pages/02efbd5a/" class="post-title-link" itemprop="url">MySQL è¿ç»´</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">å‘è¡¨äº</span>

      <time title="åˆ›å»ºæ—¶é—´ï¼š2019-11-26 21:37:17" itemprop="dateCreated datePublished" datetime="2019-11-26T21:37:17+08:00">2019-11-26</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">æ›´æ–°äº</span>
      <time title="ä¿®æ”¹æ—¶é—´ï¼š2025-09-13 17:56:53" itemprop="dateModified" datetime="2025-09-13T17:56:53+08:00">2025-09-13</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">åˆ†ç±»äº</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/blog/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/" itemprop="url" rel="index"><span itemprop="name">æ•°æ®åº“</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/blog/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/%E5%85%B3%E7%B3%BB%E5%9E%8B%E6%95%B0%E6%8D%AE%E5%BA%93/" itemprop="url" rel="index"><span itemprop="name">å…³ç³»å‹æ•°æ®åº“</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/blog/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/%E5%85%B3%E7%B3%BB%E5%9E%8B%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/" itemprop="url" rel="index"><span itemprop="name">mysql</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
      <span>29k</span>
    </span>
    <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
      <span>27 åˆ†é’Ÿ</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="MySQL-è¿ç»´"><a href="#MySQL-è¿ç»´" class="headerlink" title="MySQL è¿ç»´"></a>MySQL è¿ç»´</h1><p>::: info æ¦‚è¿°</p>
<p>å¦‚æœä½ çš„å…¬å¸æœ‰ DBAï¼Œé‚£ä¹ˆæˆ‘æ­å–œä½ ï¼Œä½ å¯ä»¥æ— è§† MySQL è¿ç»´ã€‚å¦‚æœä½ çš„å…¬å¸æ²¡æœ‰ DBAï¼Œé‚£ä½ å°±å¥½å¥½å­¦ä¸¤æ‰‹ MySQL åŸºæœ¬è¿ç»´æ“ä½œï¼Œè¡Œèµ°æ±Ÿæ¹–ï¼Œé˜²èº«å¿…å¤‡ã€‚</p>
<p>:::</p>
<h2 id="MySQL-å®‰è£…"><a href="#MySQL-å®‰è£…" class="headerlink" title="MySQL å®‰è£…"></a>MySQL å®‰è£…</h2><h3 id="Windows-å®‰è£…"><a href="#Windows-å®‰è£…" class="headerlink" title="Windows å®‰è£…"></a>Windows å®‰è£…</h3><p>ï¼ˆ1ï¼‰ä¸‹è½½ MySQL 5.7 å…å®‰è£…ç‰ˆ</p>
<p>ä¸‹è½½åœ°å€ï¼š<a target="_blank" rel="noopener" href="https://dev.mysql.com/downloads/mysql/5.7.html#downloads">https://dev.mysql.com/downloads/mysql/5.7.html#downloads</a></p>
<p>ï¼ˆ2ï¼‰è§£å‹å¹¶åˆ›å»º my.ini åœ¨æ ¹ç›®å½•</p>
<p>my.ini æ–‡ä»¶ç¤ºä¾‹ï¼š</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[mysqld]</span></span><br><span class="line"><span class="comment">#è®¾ç½® 3306 ç«¯å£</span></span><br><span class="line"><span class="attr">port</span> = <span class="number">3306</span></span><br><span class="line"><span class="comment"># è®¾ç½® mysql çš„å®‰è£…ç›®å½• è¿™å—æ¢æˆè‡ªå·±è§£å‹çš„è·¯å¾„</span></span><br><span class="line"><span class="attr">basedir</span>=D:\\Tools\\DB\\mysql\\mysql-<span class="number">5.7</span>.<span class="number">31</span></span><br><span class="line"><span class="comment"># å…è®¸æœ€å¤§è¿æ¥æ•°</span></span><br><span class="line"><span class="attr">max_connections</span>=<span class="number">200</span></span><br><span class="line"><span class="comment"># æœåŠ¡ç«¯ä½¿ç”¨çš„å­—ç¬¦é›†é»˜è®¤ä¸º 8 æ¯”ç‰¹ç¼–ç çš„ latin1 å­—ç¬¦é›†</span></span><br><span class="line"><span class="attr">character-set-server</span>=utf8</span><br><span class="line"><span class="comment"># åˆ›å»ºæ–°è¡¨æ—¶å°†ä½¿ç”¨çš„é»˜è®¤å­˜å‚¨å¼•æ“</span></span><br><span class="line"><span class="attr">default-storage-engine</span>=INNODB</span><br><span class="line"></span><br><span class="line"><span class="section">[client]</span></span><br><span class="line"><span class="comment"># è®¾ç½® mysql å®¢æˆ·ç«¯é»˜è®¤å­—ç¬¦é›†</span></span><br><span class="line"><span class="attr">default-character-set</span>=utf8</span><br></pre></td></tr></table></figure>

<p>ï¼ˆ3ï¼‰æ‰§è¡Œå®‰è£…å‘½ä»¤</p>
<p>åœ¨æ§åˆ¶å° CMD ä¸­ä¾æ¬¡æ‰§è¡Œä»¥ä¸‹å®‰è£…å‘½ä»¤</p>
<figure class="highlight taggerscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd D:<span class="symbol">\\</span>Tools<span class="symbol">\\</span>DB<span class="symbol">\\</span>mysql<span class="symbol">\\</span>mysql-5.7.31</span><br><span class="line">mysqld --initialize</span><br><span class="line">mysqld -install</span><br></pre></td></tr></table></figure>

<p>è¯´æ˜ï¼š</p>
<ul>
<li><code>mysqld --initialize</code> ä¼šè‡ªåŠ¨åˆå§‹åŒ–åˆ›å»º data æ–‡ä»¶å¤¹å¹¶åˆå§‹åŒ– mysqlã€‚</li>
<li><code>mysqld -install</code> ä¼šå®‰è£… mysql æœåŠ¡ã€‚</li>
</ul>
<p>ï¼ˆ4ï¼‰å¯åŠ¨æœåŠ¡</p>
<p>åœ¨æ§åˆ¶å°æ‰§è¡Œ <code>net start mysql</code> å¯åŠ¨æœåŠ¡ã€‚</p>
<h3 id="CentOS-å®‰è£…"><a href="#CentOS-å®‰è£…" class="headerlink" title="CentOS å®‰è£…"></a>CentOS å®‰è£…</h3><blockquote>
<p>æœ¬æ–‡ä»…ä»‹ç» rpm å®‰è£…æ–¹å¼</p>
</blockquote>
<h4 id="å®‰è£…-mysql-yum-æº"><a href="#å®‰è£…-mysql-yum-æº" class="headerlink" title="å®‰è£… mysql yum æº"></a>å®‰è£… mysql yum æº</h4><p>å®˜æ–¹ä¸‹è½½åœ°å€ï¼š<a target="_blank" rel="noopener" href="https://dev.mysql.com/downloads/repo/yum/">https://dev.mysql.com/downloads/repo/yum/</a></p>
<p>ï¼ˆ1ï¼‰ä¸‹è½½ yum æº</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget https://dev.mysql.com/get/mysql80-community-release-el7-1.noarch.rpm</span><br></pre></td></tr></table></figure>

<p>ï¼ˆ2ï¼‰å®‰è£… yum repo æ–‡ä»¶å¹¶æ›´æ–° yum ç¼“å­˜</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rpm -ivh mysql80-community-release-el7-1.noarch.rpm</span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œç»“æœï¼š</p>
<p>ä¼šåœ¨ &#x2F;etc&#x2F;yum.repos.d&#x2F; ç›®å½•ä¸‹ç”Ÿæˆä¸¤ä¸ª repo æ–‡ä»¶</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">ls</span> | grep mysql</span></span><br><span class="line">mysql-community.repo</span><br><span class="line">mysql-community-source.repo</span><br></pre></td></tr></table></figure>

<p>æ›´æ–° yumï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yum clean all</span><br><span class="line">yum makecache</span><br></pre></td></tr></table></figure>

<p>ï¼ˆ3ï¼‰æŸ¥çœ‹ rpm å®‰è£…çŠ¶æ€</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">yum search mysql | grep server</span></span><br><span class="line">mysql-community-common.i686 : MySQL database common files for server and client</span><br><span class="line">mysql-community-common.x86_64 : MySQL database common files for server and</span><br><span class="line">mysql-community-test.x86_64 : Test suite for the MySQL database server</span><br><span class="line">                       : administering MySQL servers</span><br><span class="line">mysql-community-server.x86_64 : A very fast and reliable SQL database server</span><br></pre></td></tr></table></figure>

<p>é€šè¿‡ yum å®‰è£… mysql æœ‰å‡ ä¸ªé‡è¦ç›®å½•ï¼š</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## é…ç½®æ–‡ä»¶</span></span><br><span class="line"><span class="regexp">/etc/my</span>.cnf</span><br><span class="line"><span class="comment">## æ•°æ®åº“ç›®å½•</span></span><br><span class="line"><span class="regexp">/var/</span>lib<span class="regexp">/mysql/</span></span><br><span class="line"><span class="comment">## é…ç½®æ–‡ä»¶</span></span><br><span class="line"><span class="regexp">/usr/</span>share/mysqlï¼ˆmysql.server å‘½ä»¤åŠé…ç½®æ–‡ä»¶ï¼‰</span><br><span class="line"><span class="comment">## ç›¸å…³å‘½ä»¤</span></span><br><span class="line"><span class="regexp">/usr/</span>binï¼ˆmysqladmin mysqldump ç­‰å‘½ä»¤ï¼‰</span><br><span class="line"><span class="comment">## å¯åŠ¨è„šæœ¬</span></span><br><span class="line"><span class="regexp">/usr/</span>lib<span class="regexp">/systemd/</span>system/mysqld.service ï¼ˆæ³¨å†Œä¸º systemd æœåŠ¡ï¼‰</span><br></pre></td></tr></table></figure>

<p>ï¼ˆ4ï¼‰å®‰è£… mysql æœåŠ¡å™¨</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install mysql-community-server</span><br></pre></td></tr></table></figure>

<h4 id="mysql-æœåŠ¡ç®¡ç†"><a href="#mysql-æœåŠ¡ç®¡ç†" class="headerlink" title="mysql æœåŠ¡ç®¡ç†"></a>mysql æœåŠ¡ç®¡ç†</h4><p>é€šè¿‡ yum æ–¹å¼å®‰è£… mysql åï¼Œæœ¬åœ°ä¼šæœ‰ä¸€ä¸ªåä¸º <code>mysqld</code> çš„ systemd æœåŠ¡ã€‚</p>
<p>å…¶æœåŠ¡ç®¡ç†ååˆ†ç®€ä¾¿ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment"># æŸ¥çœ‹çŠ¶æ€</span></span></span><br><span class="line">systemctl status mysqld</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment"># å¯ç”¨æœåŠ¡</span></span></span><br><span class="line">systemctl enable mysqld</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment"># ç¦ç”¨æœåŠ¡</span></span></span><br><span class="line">systemctl disable mysqld</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment"># å¯åŠ¨æœåŠ¡</span></span></span><br><span class="line">systemctl start mysqld</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment"># é‡å¯æœåŠ¡</span></span></span><br><span class="line">systemctl restart mysqld</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment"># åœæ­¢æœåŠ¡</span></span></span><br><span class="line">systemctl stop mysqld</span><br></pre></td></tr></table></figure>

<h3 id="åˆå§‹åŒ–æ•°æ®åº“å¯†ç "><a href="#åˆå§‹åŒ–æ•°æ®åº“å¯†ç " class="headerlink" title="åˆå§‹åŒ–æ•°æ®åº“å¯†ç "></a>åˆå§‹åŒ–æ•°æ®åº“å¯†ç </h3><p>æŸ¥çœ‹ä¸€ä¸‹åˆå§‹å¯†ç </p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">grep <span class="string">&quot;password&quot;</span> /var/log/mysqld.log</span></span><br><span class="line">2018-09-30T03:13:41.727736Z 5 [Note] [MY-010454] [Server] A temporary password is generated for root@localhost: %:lt+srWu4k1</span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œå‘½ä»¤ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -uroot -p&lt;ä¸´æ—¶å¯†ç &gt;</span><br></pre></td></tr></table></figure>

<p>è¾“å…¥ä¸´æ—¶å¯†ç ï¼Œè¿›å…¥ mysqlï¼Œå¦‚æœè¦ä¿®æ”¹å¯†ç ï¼Œæ‰§è¡Œä»¥ä¸‹æŒ‡ä»¤ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ALTER user &#x27;root&#x27;@&#x27;localhost&#x27; IDENTIFIED BY &#x27;ä½ çš„å¯†ç &#x27;;</span><br></pre></td></tr></table></figure>

<p>æ³¨ï¼šå¯†ç å¼ºåº¦é»˜è®¤ä¸ºä¸­ç­‰ï¼Œå¤§å°å†™å­—æ¯ã€æ•°å­—ã€ç‰¹æ®Šç¬¦å·ï¼Œåªæœ‰ä¿®æ”¹æˆåŠŸåæ‰èƒ½ä¿®æ”¹é…ç½®å†è®¾ç½®æ›´ç®€å•çš„å¯†ç </p>
<h3 id="é…ç½®è¿œç¨‹è®¿é—®"><a href="#é…ç½®è¿œç¨‹è®¿é—®" class="headerlink" title="é…ç½®è¿œç¨‹è®¿é—®"></a>é…ç½®è¿œç¨‹è®¿é—®</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">USER</span> <span class="string">&#x27;root&#x27;</span>@<span class="string">&#x27;%&#x27;</span> IDENTIFIED <span class="keyword">BY</span> <span class="string">&#x27;ä½ çš„å¯†ç &#x27;</span>;</span><br><span class="line"><span class="keyword">GRANT</span> <span class="keyword">ALL</span> <span class="keyword">ON</span> <span class="operator">*</span>.<span class="operator">*</span> <span class="keyword">TO</span> <span class="string">&#x27;root&#x27;</span>@<span class="string">&#x27;%&#x27;</span>;</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">USER</span> <span class="string">&#x27;root&#x27;</span>@<span class="string">&#x27;%&#x27;</span> IDENTIFIED <span class="keyword">WITH</span> mysql_native_password <span class="keyword">BY</span> <span class="string">&#x27;ä½ çš„å¯†ç &#x27;</span>;</span><br><span class="line">FLUSH PRIVILEGES;</span><br></pre></td></tr></table></figure>

<h3 id="è·³è¿‡ç™»å½•è®¤è¯"><a href="#è·³è¿‡ç™»å½•è®¤è¯" class="headerlink" title="è·³è¿‡ç™»å½•è®¤è¯"></a>è·³è¿‡ç™»å½•è®¤è¯</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/my.cnf</span><br></pre></td></tr></table></figure>

<p>åœ¨ [mysqld] ä¸‹é¢åŠ ä¸Š skip-grant-tables</p>
<p>ä½œç”¨æ˜¯ç™»å½•æ—¶è·³è¿‡ç™»å½•è®¤è¯ï¼Œæ¢å¥è¯è¯´å°±æ˜¯ root ä»€ä¹ˆå¯†ç éƒ½å¯ä»¥ç™»å½•è¿›å»ã€‚</p>
<p>æ‰§è¡Œ <code>systemctl restart mysqld</code>ï¼Œé‡å¯ mysql</p>
<h2 id="MySQL-ç®¡ç†"><a href="#MySQL-ç®¡ç†" class="headerlink" title="MySQL ç®¡ç†"></a>MySQL ç®¡ç†</h2><h3 id="å®¢æˆ·ç«¯è¿æ¥"><a href="#å®¢æˆ·ç«¯è¿æ¥" class="headerlink" title="å®¢æˆ·ç«¯è¿æ¥"></a>å®¢æˆ·ç«¯è¿æ¥</h3><p>è¯­æ³•ï¼š<code>mysql -h&lt;ä¸»æœº&gt; -P&lt;ç«¯å£&gt; -u&lt;ç”¨æˆ·å&gt; -p&lt;å¯†ç &gt;</code></p>
<p>å¦‚æœæ²¡æœ‰æ˜¾å¼æŒ‡å®šå¯†ç ï¼Œä¼šè¦æ±‚è¾“å…¥å¯†ç æ‰èƒ½è®¿é—®ã€‚</p>
<p>ã€ç¤ºä¾‹ã€‘è¿æ¥æœ¬åœ° MySQL</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">mysql -h 127.0.0.1 -P 3306 -u root -p</span></span><br><span class="line">Enter password:</span><br><span class="line">Welcome to the MySQL monitor.  Commands end with ; or \g.</span><br><span class="line">Your MySQL connection id is 13501</span><br><span class="line">Server version: 8.0.19 MySQL Community Server - GPL</span><br><span class="line"></span><br><span class="line">Copyright (c) 2000, 2020, Oracle and/or its affiliates. All rights reserved.</span><br><span class="line"></span><br><span class="line">Oracle is a registered trademark of Oracle Corporation and/or its</span><br><span class="line">affiliates. Other names may be trademarks of their respective</span><br><span class="line">owners.</span><br><span class="line"></span><br><span class="line">Type &#x27;help;&#x27; or &#x27;\h&#x27; for help. Type &#x27;\c&#x27; to clear the current input statement.</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">mysql&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="æŸ¥çœ‹è¿æ¥"><a href="#æŸ¥çœ‹è¿æ¥" class="headerlink" title="æŸ¥çœ‹è¿æ¥"></a>æŸ¥çœ‹è¿æ¥</h3><p>è¿æ¥å®Œæˆåï¼Œå¦‚æœä½ æ²¡æœ‰åç»­çš„åŠ¨ä½œï¼Œè¿™ä¸ªè¿æ¥å°±å¤„äºç©ºé—²çŠ¶æ€ï¼Œä½ å¯ä»¥åœ¨ <code>show processlist</code> å‘½ä»¤ä¸­çœ‹åˆ°å®ƒã€‚å®¢æˆ·ç«¯å¦‚æœå¤ªé•¿æ—¶é—´æ²¡åŠ¨é™ï¼Œè¿æ¥å™¨å°±ä¼šè‡ªåŠ¨å°†å®ƒæ–­å¼€ã€‚è¿™ä¸ªæ—¶é—´æ˜¯ç”±å‚æ•° <code>wait_timeout</code> æ§åˆ¶çš„ï¼Œé»˜è®¤å€¼æ˜¯ 8 å°æ—¶ã€‚</p>
<p><img src="https://raw.githubusercontent.com/dunwu/images/master/snap/20200714115031.png" alt="img"></p>
<h3 id="åˆ›å»ºç”¨æˆ·"><a href="#åˆ›å»ºç”¨æˆ·" class="headerlink" title="åˆ›å»ºç”¨æˆ·"></a>åˆ›å»ºç”¨æˆ·</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">USER</span> <span class="string">&#x27;username&#x27;</span>@<span class="string">&#x27;host&#x27;</span> IDENTIFIED <span class="keyword">BY</span> <span class="string">&#x27;password&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>è¯´æ˜ï¼š</p>
<ul>
<li>usernameï¼šä½ å°†åˆ›å»ºçš„ç”¨æˆ·å</li>
<li>hostï¼šæŒ‡å®šè¯¥ç”¨æˆ·åœ¨å“ªä¸ªä¸»æœºä¸Šå¯ä»¥ç™»é™†ï¼Œå¦‚æœæ˜¯æœ¬åœ°ç”¨æˆ·å¯ç”¨ localhostï¼Œå¦‚æœæƒ³è®©è¯¥ç”¨æˆ·å¯ä»¥<strong>ä»ä»»æ„è¿œç¨‹ä¸»æœºç™»é™†</strong>ï¼Œå¯ä»¥ä½¿ç”¨é€šé…ç¬¦<code>%</code></li>
<li>passwordï¼šè¯¥ç”¨æˆ·çš„ç™»é™†å¯†ç ï¼Œå¯†ç å¯ä»¥ä¸ºç©ºï¼Œå¦‚æœä¸ºç©ºåˆ™è¯¥ç”¨æˆ·å¯ä»¥ä¸éœ€è¦å¯†ç ç™»é™†æœåŠ¡å™¨</li>
</ul>
<p>ç¤ºä¾‹ï¼š</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">USER</span> <span class="string">&#x27;dog&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span> IDENTIFIED <span class="keyword">BY</span> <span class="string">&#x27;123456&#x27;</span>;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">USER</span> <span class="string">&#x27;pig&#x27;</span>@<span class="string">&#x27;192.168.1.101_&#x27;</span> IDENDIFIED <span class="keyword">BY</span> <span class="string">&#x27;123456&#x27;</span>;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">USER</span> <span class="string">&#x27;pig&#x27;</span>@<span class="string">&#x27;%&#x27;</span> IDENTIFIED <span class="keyword">BY</span> <span class="string">&#x27;123456&#x27;</span>;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">USER</span> <span class="string">&#x27;pig&#x27;</span>@<span class="string">&#x27;%&#x27;</span> IDENTIFIED <span class="keyword">BY</span> <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">USER</span> <span class="string">&#x27;pig&#x27;</span>@<span class="string">&#x27;%&#x27;</span>;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ³¨æ„ï¼šåœ¨ MySQL 8 ä¸­ï¼Œé»˜è®¤å¯†ç éªŒè¯ä¸å†æ˜¯ <code>password</code>ã€‚æ‰€ä»¥åœ¨åˆ›å»ºç”¨æˆ·æ—¶ï¼Œ<code>create user &#39;username&#39;@&#39;%&#39; identified by &#39;password&#39;;</code> å®¢æˆ·ç«¯æ˜¯æ— æ³•è¿æ¥æœåŠ¡çš„ã€‚</p>
<p>æ‰€ä»¥ï¼Œéœ€è¦åŠ ä¸Š <code>IDENTIFIED WITH mysql_native_password</code>ï¼Œä¾‹å¦‚ï¼š<code>CREATE USER &#39;slave&#39;@&#39;%&#39; IDENTIFIED WITH mysql_native_password BY &#39;123456&#39;;</code></p>
</blockquote>
<h3 id="æŸ¥çœ‹ç”¨æˆ·"><a href="#æŸ¥çœ‹ç”¨æˆ·" class="headerlink" title="æŸ¥çœ‹ç”¨æˆ·"></a>æŸ¥çœ‹ç”¨æˆ·</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- æŸ¥çœ‹æ‰€æœ‰ç”¨æˆ·</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> CONCAT(<span class="string">&#x27;User: &#x27;&#x27;&#x27;</span>, <span class="keyword">user</span>, <span class="string">&#x27;&#x27;&#x27;@&#x27;&#x27;&#x27;</span>, host, <span class="string">&#x27;&#x27;&#x27;;&#x27;</span>) <span class="keyword">AS</span> query</span><br><span class="line"><span class="keyword">FROM</span> mysql.user;</span><br></pre></td></tr></table></figure>

<h3 id="æˆæƒ"><a href="#æˆæƒ" class="headerlink" title="æˆæƒ"></a>æˆæƒ</h3><p>å‘½ä»¤ï¼š</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GRANT</span> privileges <span class="keyword">ON</span> databasename.tablename <span class="keyword">TO</span> <span class="string">&#x27;username&#x27;</span>@<span class="string">&#x27;host&#x27;</span></span><br></pre></td></tr></table></figure>

<p>è¯´æ˜ï¼š</p>
<ul>
<li>privilegesï¼šç”¨æˆ·çš„æ“ä½œæƒé™ï¼Œå¦‚<code>SELECT</code>ï¼Œ<code>INSERT</code>ï¼Œ<code>UPDATE</code>ç­‰ï¼Œå¦‚æœè¦æˆäºˆæ‰€çš„æƒé™åˆ™ä½¿ç”¨<code>ALL</code></li>
<li>databasenameï¼šæ•°æ®åº“å</li>
<li>tablenameï¼šè¡¨åï¼Œå¦‚æœè¦æˆäºˆè¯¥ç”¨æˆ·å¯¹æ‰€æœ‰æ•°æ®åº“å’Œè¡¨çš„ç›¸åº”æ“ä½œæƒé™åˆ™å¯ç”¨<code>*</code>è¡¨ç¤ºï¼Œå¦‚<code>*.*</code></li>
</ul>
<p>ç¤ºä¾‹ï¼š</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GRANT</span> <span class="keyword">SELECT</span>, <span class="keyword">INSERT</span> <span class="keyword">ON</span> test.user <span class="keyword">TO</span> <span class="string">&#x27;pig&#x27;</span>@<span class="string">&#x27;%&#x27;</span>;</span><br><span class="line"><span class="keyword">GRANT</span> <span class="keyword">ALL</span> <span class="keyword">ON</span> <span class="operator">*</span>.<span class="operator">*</span> <span class="keyword">TO</span> <span class="string">&#x27;pig&#x27;</span>@<span class="string">&#x27;%&#x27;</span>;</span><br><span class="line"><span class="keyword">GRANT</span> <span class="keyword">ALL</span> <span class="keyword">ON</span> maindataplus.<span class="operator">*</span> <span class="keyword">TO</span> <span class="string">&#x27;pig&#x27;</span>@<span class="string">&#x27;%&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>æ³¨æ„ï¼š</p>
<p>ç”¨ä»¥ä¸Šå‘½ä»¤æˆæƒçš„ç”¨æˆ·ä¸èƒ½ç»™å…¶å®ƒç”¨æˆ·æˆæƒï¼Œå¦‚æœæƒ³è®©è¯¥ç”¨æˆ·å¯ä»¥æˆæƒï¼Œç”¨ä»¥ä¸‹å‘½ä»¤ï¼š</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- ä¸ºæŒ‡å®šç”¨æˆ·é…ç½®æŒ‡å®šæƒé™</span></span><br><span class="line"><span class="keyword">GRANT</span> privileges <span class="keyword">ON</span> databasename.tablename <span class="keyword">TO</span> <span class="string">&#x27;username&#x27;</span>@<span class="string">&#x27;host&#x27;</span> <span class="keyword">WITH</span> <span class="keyword">GRANT</span> OPTION;</span><br><span class="line"><span class="comment">-- ä¸º root ç”¨æˆ·åˆ†é…æ‰€æœ‰æƒé™</span></span><br><span class="line"><span class="keyword">GRANT</span> <span class="keyword">ALL</span> <span class="keyword">ON</span> <span class="operator">*</span>.<span class="operator">*</span> <span class="keyword">TO</span> <span class="string">&#x27;root&#x27;</span>@<span class="string">&#x27;%&#x27;</span> IDENTIFIED <span class="keyword">BY</span> <span class="string">&#x27;å¯†ç &#x27;</span> <span class="keyword">WITH</span> <span class="keyword">GRANT</span> OPTION;</span><br></pre></td></tr></table></figure>

<h3 id="æ’¤é”€æˆæƒ"><a href="#æ’¤é”€æˆæƒ" class="headerlink" title="æ’¤é”€æˆæƒ"></a>æ’¤é”€æˆæƒ</h3><p>å‘½ä»¤ï¼š</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">REVOKE</span> privilege <span class="keyword">ON</span> databasename.tablename <span class="keyword">FROM</span> <span class="string">&#x27;username&#x27;</span>@<span class="string">&#x27;host&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>è¯´æ˜ï¼š</p>
<p>privilege, databasename, tablenameï¼šåŒæˆæƒéƒ¨åˆ†</p>
<p>ä¾‹å­ï¼š</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">REVOKE</span> <span class="keyword">SELECT</span> <span class="keyword">ON</span> <span class="operator">*</span>.<span class="operator">*</span> <span class="keyword">FROM</span> <span class="string">&#x27;pig&#x27;</span>@<span class="string">&#x27;%&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>æ³¨æ„ï¼š</p>
<p>å‡å¦‚ä½ åœ¨ç»™ç”¨æˆ·<code>&#39;pig&#39;@&#39;%&#39;</code>æˆæƒçš„æ—¶å€™æ˜¯è¿™æ ·çš„ï¼ˆæˆ–ç±»ä¼¼çš„ï¼‰ï¼š<code>GRANT SELECT ON test.user TO &#39;pig&#39;@&#39;%&#39;</code>ï¼Œåˆ™åœ¨ä½¿ç”¨<code>REVOKE SELECT ON *.* FROM &#39;pig&#39;@&#39;%&#39;;</code>å‘½ä»¤å¹¶ä¸èƒ½æ’¤é”€è¯¥ç”¨æˆ·å¯¹ test æ•°æ®åº“ä¸­ user è¡¨çš„<code>SELECT</code> æ“ä½œã€‚ç›¸åï¼Œå¦‚æœæˆæƒä½¿ç”¨çš„æ˜¯<code>GRANT SELECT ON *.* TO &#39;pig&#39;@&#39;%&#39;;</code>åˆ™<code>REVOKE SELECT ON test.user FROM &#39;pig&#39;@&#39;%&#39;;</code>å‘½ä»¤ä¹Ÿä¸èƒ½æ’¤é”€è¯¥ç”¨æˆ·å¯¹ test æ•°æ®åº“ä¸­ user è¡¨çš„<code>Select</code>æƒé™ã€‚</p>
<p>å…·ä½“ä¿¡æ¯å¯ä»¥ç”¨å‘½ä»¤<code>SHOW GRANTS FOR &#39;pig&#39;@&#39;%&#39;;</code> æŸ¥çœ‹ã€‚</p>
<h3 id="æŸ¥çœ‹æˆæƒ"><a href="#æŸ¥çœ‹æˆæƒ" class="headerlink" title="æŸ¥çœ‹æˆæƒ"></a>æŸ¥çœ‹æˆæƒ</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- æŸ¥çœ‹ç”¨æˆ·æƒé™</span></span><br><span class="line"><span class="keyword">SHOW</span> GRANTS <span class="keyword">FOR</span> <span class="string">&#x27;root&#x27;</span>@<span class="string">&#x27;%&#x27;</span>;</span><br></pre></td></tr></table></figure>

<h3 id="æ›´æ”¹ç”¨æˆ·å¯†ç "><a href="#æ›´æ”¹ç”¨æˆ·å¯†ç " class="headerlink" title="æ›´æ”¹ç”¨æˆ·å¯†ç "></a>æ›´æ”¹ç”¨æˆ·å¯†ç </h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SET</span> PASSWORD <span class="keyword">FOR</span> <span class="string">&#x27;username&#x27;</span>@<span class="string">&#x27;host&#x27;</span> <span class="operator">=</span> PASSWORD(<span class="string">&#x27;newpassword&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>å¦‚æœæ˜¯å½“å‰ç™»é™†ç”¨æˆ·ç”¨ï¼š</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SET</span> PASSWORD <span class="operator">=</span> PASSWORD(&quot;newpassword&quot;);</span><br></pre></td></tr></table></figure>

<p>ç¤ºä¾‹ï¼š</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SET</span> PASSWORD <span class="keyword">FOR</span> <span class="string">&#x27;pig&#x27;</span>@<span class="string">&#x27;%&#x27;</span> <span class="operator">=</span> PASSWORD(&quot;123456&quot;);</span><br></pre></td></tr></table></figure>

<h3 id="å¤‡ä»½ä¸æ¢å¤"><a href="#å¤‡ä»½ä¸æ¢å¤" class="headerlink" title="å¤‡ä»½ä¸æ¢å¤"></a>å¤‡ä»½ä¸æ¢å¤</h3><p>MySQL å¤‡ä»½æ•°æ®ä½¿ç”¨ mysqldump å‘½ä»¤ã€‚</p>
<p>mysqldump å°†æ•°æ®åº“ä¸­çš„æ•°æ®å¤‡ä»½æˆä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼Œè¡¨çš„ç»“æ„å’Œè¡¨ä¸­çš„æ•°æ®å°†å­˜å‚¨åœ¨ç”Ÿæˆçš„æ–‡æœ¬æ–‡ä»¶ä¸­ã€‚</p>
<p>å¤‡ä»½ï¼š</p>
<h4 id="å¤‡ä»½ä¸€ä¸ªæ•°æ®åº“"><a href="#å¤‡ä»½ä¸€ä¸ªæ•°æ®åº“" class="headerlink" title="å¤‡ä»½ä¸€ä¸ªæ•°æ®åº“"></a>å¤‡ä»½ä¸€ä¸ªæ•°æ®åº“</h4><p>è¯­æ³•ï¼š</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysqldump <span class="operator">-</span>h <span class="operator">&lt;</span>host<span class="operator">&gt;</span> <span class="operator">-</span>P<span class="operator">&lt;</span>port<span class="operator">&gt;</span> <span class="operator">-</span>u<span class="operator">&lt;</span>username<span class="operator">&gt;</span> <span class="operator">-</span>p<span class="operator">&lt;</span>database<span class="operator">&gt;</span> [<span class="operator">&lt;</span>table1<span class="operator">&gt;</span> <span class="operator">&lt;</span>table2<span class="operator">&gt;</span> ...] <span class="operator">&gt;</span> backup.sql</span><br></pre></td></tr></table></figure>

<ul>
<li><strong><code>host</code></strong> - MySQL Server çš„ host</li>
<li><strong><code>port</code></strong> - MySQL Server çš„ç«¯å£</li>
<li><strong><code>username</code></strong> - æ•°æ®åº“ç”¨æˆ·</li>
<li><strong><code>dbname</code></strong> - æ•°æ®åº“åç§°</li>
<li>table1 å’Œ table2 å‚æ•°è¡¨ç¤ºéœ€è¦å¤‡ä»½çš„è¡¨çš„åç§°ï¼Œä¸ºç©ºåˆ™æ•´ä¸ªæ•°æ®åº“å¤‡ä»½ï¼›</li>
<li>BackupName.sql å‚æ•°è¡¨è®¾è®¡å¤‡ä»½æ–‡ä»¶çš„åç§°ï¼Œæ–‡ä»¶åå‰é¢å¯ä»¥åŠ ä¸Šä¸€ä¸ªç»å¯¹è·¯å¾„ã€‚é€šå¸¸å°†æ•°æ®åº“è¢«åˆ†æˆä¸€ä¸ªåç¼€åä¸º sql çš„æ–‡ä»¶</li>
</ul>
<h4 id="å¤‡ä»½å¤šä¸ªæ•°æ®åº“"><a href="#å¤‡ä»½å¤šä¸ªæ•°æ®åº“" class="headerlink" title="å¤‡ä»½å¤šä¸ªæ•°æ®åº“"></a>å¤‡ä»½å¤šä¸ªæ•°æ®åº“</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysqldump <span class="operator">-</span>u <span class="operator">&lt;</span>username<span class="operator">&gt;</span> <span class="operator">-</span>p <span class="comment">--databases &lt;database1&gt; &lt;database2&gt; ... &gt; backup.sql</span></span><br></pre></td></tr></table></figure>

<h4 id="å¤‡ä»½æ‰€æœ‰æ•°æ®åº“"><a href="#å¤‡ä»½æ‰€æœ‰æ•°æ®åº“" class="headerlink" title="å¤‡ä»½æ‰€æœ‰æ•°æ®åº“"></a>å¤‡ä»½æ‰€æœ‰æ•°æ®åº“</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysqldump <span class="operator">-</span>u <span class="operator">&lt;</span>username<span class="operator">&gt;</span> <span class="operator">-</span>p <span class="comment">--all-databases &gt; backup.sql</span></span><br></pre></td></tr></table></figure>

<h4 id="æ¢å¤ä¸€ä¸ªæ•°æ®åº“"><a href="#æ¢å¤ä¸€ä¸ªæ•°æ®åº“" class="headerlink" title="æ¢å¤ä¸€ä¸ªæ•°æ®åº“"></a>æ¢å¤ä¸€ä¸ªæ•°æ®åº“</h4><p>MySQL æ¢å¤æ•°æ®ä½¿ç”¨ mysql å‘½ä»¤ã€‚</p>
<p>è¯­æ³•ï¼š</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql <span class="operator">-</span>h <span class="operator">&lt;</span>host<span class="operator">&gt;</span> <span class="operator">-</span>P<span class="operator">&lt;</span>port<span class="operator">&gt;</span> <span class="operator">-</span>u<span class="operator">&lt;</span>username<span class="operator">&gt;</span> <span class="operator">-</span>p<span class="operator">&lt;</span>database<span class="operator">&gt;</span> <span class="operator">&lt;</span> backup.sql</span><br></pre></td></tr></table></figure>

<h4 id="æ¢å¤æ‰€æœ‰æ•°æ®åº“"><a href="#æ¢å¤æ‰€æœ‰æ•°æ®åº“" class="headerlink" title="æ¢å¤æ‰€æœ‰æ•°æ®åº“"></a>æ¢å¤æ‰€æœ‰æ•°æ®åº“</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql <span class="operator">-</span>u<span class="operator">&lt;</span>username<span class="operator">&gt;</span> <span class="operator">-</span>p <span class="comment">--all-databases &lt; backup.sql</span></span><br></pre></td></tr></table></figure>

<h3 id="å¸è½½"><a href="#å¸è½½" class="headerlink" title="å¸è½½"></a>å¸è½½</h3><p>ï¼ˆ1ï¼‰æŸ¥çœ‹å·²å®‰è£…çš„ mysql</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">rpm -qa | grep -i mysql</span></span><br><span class="line">perl-DBD-MySQL-4.023-6.el7.x86_64</span><br><span class="line">mysql80-community-release-el7-1.noarch</span><br><span class="line">mysql-community-common-8.0.12-1.el7.x86_64</span><br><span class="line">mysql-community-client-8.0.12-1.el7.x86_64</span><br><span class="line">mysql-community-libs-compat-8.0.12-1.el7.x86_64</span><br><span class="line">mysql-community-libs-8.0.12-1.el7.x86_64</span><br></pre></td></tr></table></figure>

<p>ï¼ˆ2ï¼‰å¸è½½ mysql</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum remove mysql-community-server.x86_64</span><br></pre></td></tr></table></figure>

<h3 id="ä¸»ä»èŠ‚ç‚¹éƒ¨ç½²"><a href="#ä¸»ä»èŠ‚ç‚¹éƒ¨ç½²" class="headerlink" title="ä¸»ä»èŠ‚ç‚¹éƒ¨ç½²"></a>ä¸»ä»èŠ‚ç‚¹éƒ¨ç½²</h3><p>å‡è®¾éœ€è¦é…ç½®ä¸€ä¸ªä¸»ä» MySQL æœåŠ¡å™¨ç¯å¢ƒ</p>
<ul>
<li>master èŠ‚ç‚¹ï¼š192.168.8.10</li>
<li>slave èŠ‚ç‚¹ï¼š192.168.8.11</li>
</ul>
<h4 id="ä¸»èŠ‚ç‚¹ä¸Šçš„æ“ä½œ"><a href="#ä¸»èŠ‚ç‚¹ä¸Šçš„æ“ä½œ" class="headerlink" title="ä¸»èŠ‚ç‚¹ä¸Šçš„æ“ä½œ"></a>ä¸»èŠ‚ç‚¹ä¸Šçš„æ“ä½œ</h4><p>ï¼ˆ1ï¼‰ä¿®æ”¹é…ç½®å¹¶é‡å¯</p>
<p>æ‰§è¡Œ <code>vi /etc/my.cnf</code> ï¼Œæ·»åŠ å¦‚ä¸‹é…ç½®ï¼š</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[mysqld]</span></span><br><span class="line"><span class="attr">server-id</span>=<span class="number">1</span></span><br><span class="line"><span class="attr">log_bin</span>=/var/lib/mysql/binlog</span><br></pre></td></tr></table></figure>

<ul>
<li><code>server-id</code> - æœåŠ¡å™¨ ID å·ã€‚åœ¨ä¸»ä»æ¶æ„ä¸­ï¼Œæ¯å°æœºå™¨çš„ ID å¿…é¡»å”¯ä¸€ã€‚</li>
<li><code>log_bin</code> - åŒæ­¥çš„æ—¥å¿—è·¯å¾„åŠæ–‡ä»¶åï¼Œä¸€å®šæ³¨æ„è¿™ä¸ªç›®å½•è¦æ˜¯ mysql æœ‰æƒé™å†™å…¥çš„ï¼›</li>
</ul>
<p>ä¿®æ”¹åï¼Œé‡å¯ mysql ä½¿é…ç½®ç”Ÿæ•ˆï¼š</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl restart mysql</span><br></pre></td></tr></table></figure>

<p>ï¼ˆ2ï¼‰åˆ›å»ºç”¨äºåŒæ­¥çš„ç”¨æˆ·</p>
<p>è¿›å…¥ mysql å‘½ä»¤æ§åˆ¶å°ï¼š</p>
<figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ mysql -u root -p</span><br><span class="line"><span class="symbol">Password:</span></span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œä»¥ä¸‹ SQLï¼š</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- a. åˆ›å»º slave ç”¨æˆ·</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">USER</span> <span class="string">&#x27;slave&#x27;</span>@<span class="string">&#x27;%&#x27;</span> IDENTIFIED <span class="keyword">WITH</span> mysql_native_password <span class="keyword">BY</span> <span class="string">&#x27;å¯†ç &#x27;</span>;</span><br><span class="line"><span class="comment">-- ä¸º slave èµ‹äºˆ REPLICATION SLAVE æƒé™</span></span><br><span class="line"><span class="keyword">GRANT</span> REPLICATION SLAVE <span class="keyword">ON</span> <span class="operator">*</span>.<span class="operator">*</span> <span class="keyword">TO</span> <span class="string">&#x27;slave&#x27;</span>@<span class="string">&#x27;%&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- b. æˆ–è€…ï¼Œåˆ›å»º slave ç”¨æˆ·ï¼Œå¹¶æŒ‡å®šè¯¥ç”¨æˆ·èƒ½åœ¨ä»»æ„ä¸»æœºä¸Šç™»å½•</span></span><br><span class="line"><span class="comment">-- å¦‚æœæœ‰å¤šä¸ªä»èŠ‚ç‚¹ï¼Œåˆæƒ³è®©æ‰€æœ‰ä»èŠ‚ç‚¹éƒ½ä½¿ç”¨ç»Ÿä¸€çš„ç”¨æˆ·åã€å¯†ç è®¤è¯ï¼Œå¯ä»¥è€ƒè™‘è¿™ç§æ–¹å¼</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">USER</span> <span class="string">&#x27;slave&#x27;</span>@<span class="string">&#x27;%&#x27;</span> IDENTIFIED <span class="keyword">WITH</span> mysql_native_password <span class="keyword">BY</span> <span class="string">&#x27;å¯†ç &#x27;</span>;</span><br><span class="line"><span class="keyword">GRANT</span> REPLICATION SLAVE <span class="keyword">ON</span> <span class="operator">*</span>.<span class="operator">*</span> <span class="keyword">TO</span> <span class="string">&#x27;slave&#x27;</span>@<span class="string">&#x27;%&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- åˆ·æ–°æˆæƒè¡¨ä¿¡æ¯</span></span><br><span class="line">FLUSH PRIVILEGES;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ³¨æ„ï¼šåœ¨ MySQL 8 ä¸­ï¼Œé»˜è®¤å¯†ç éªŒè¯ä¸å†æ˜¯ <code>password</code>ã€‚æ‰€ä»¥åœ¨åˆ›å»ºç”¨æˆ·æ—¶ï¼Œ<code>create user &#39;username&#39;@&#39;%&#39; identified by &#39;password&#39;;</code> å®¢æˆ·ç«¯æ˜¯æ— æ³•è¿æ¥æœåŠ¡çš„ã€‚æ‰€ä»¥ï¼Œéœ€è¦åŠ ä¸Š <code>IDENTIFIED WITH mysql_native_password BY &#39;password&#39;</code></p>
</blockquote>
<p>è¡¥å……ç”¨æˆ·ç®¡ç† SQL:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- æŸ¥çœ‹æ‰€æœ‰ç”¨æˆ·</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> CONCAT(<span class="string">&#x27;User: &#x27;&#x27;&#x27;</span>, <span class="keyword">user</span>, <span class="string">&#x27;&#x27;&#x27;@&#x27;&#x27;&#x27;</span>, host, <span class="string">&#x27;&#x27;&#x27;;&#x27;</span>) <span class="keyword">AS</span> query</span><br><span class="line"><span class="keyword">FROM</span> mysql.user;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- æŸ¥çœ‹ç”¨æˆ·æƒé™</span></span><br><span class="line"><span class="keyword">SHOW</span> GRANTS <span class="keyword">FOR</span> <span class="string">&#x27;root&#x27;</span>@<span class="string">&#x27;%&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- åˆ›å»ºç”¨æˆ·</span></span><br><span class="line"><span class="comment">-- a. åˆ›å»º slave ç”¨æˆ·ï¼Œå¹¶æŒ‡å®šè¯¥ç”¨æˆ·åªèƒ½åœ¨ä¸»æœº 192.168.8.11 ä¸Šç™»å½•</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">USER</span> <span class="string">&#x27;slave&#x27;</span>@<span class="string">&#x27;192.168.8.11&#x27;</span> IDENTIFIED <span class="keyword">WITH</span> mysql_native_password <span class="keyword">BY</span> <span class="string">&#x27;å¯†ç &#x27;</span>;</span><br><span class="line"><span class="comment">-- ä¸º slave èµ‹äºˆ REPLICATION SLAVE æƒé™</span></span><br><span class="line"><span class="keyword">GRANT</span> REPLICATION SLAVE <span class="keyword">ON</span> <span class="operator">*</span>.<span class="operator">*</span> <span class="keyword">TO</span> <span class="string">&#x27;slave&#x27;</span>@<span class="string">&#x27;192.168.8.11&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- åˆ é™¤ç”¨æˆ·</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">USER</span> <span class="string">&#x27;slave&#x27;</span>@<span class="string">&#x27;192.168.8.11&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>ï¼ˆ3ï¼‰åŠ è¯»é”</p>
<p>ä¸ºäº†ä¸»åº“ä¸ä»åº“çš„æ•°æ®ä¿æŒä¸€è‡´ï¼Œæˆ‘ä»¬å…ˆä¸º mysql åŠ å…¥è¯»é”ï¼Œä½¿å…¶å˜ä¸ºåªè¯»ã€‚</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> FLUSH TABLES <span class="keyword">WITH</span> READ LOCK;</span><br></pre></td></tr></table></figure>

<p>ï¼ˆ4ï¼‰æŸ¥çœ‹ä¸»èŠ‚ç‚¹çŠ¶æ€</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">show</span> master status;</span><br><span class="line"><span class="operator">+</span><span class="comment">------------------+----------+--------------+---------------------------------------------+-------------------+</span></span><br><span class="line"><span class="operator">|</span> File             <span class="operator">|</span> Position <span class="operator">|</span> Binlog_Do_DB <span class="operator">|</span> Binlog_Ignore_DB                            <span class="operator">|</span> Executed_Gtid_Set <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------------+----------+--------------+---------------------------------------------+-------------------+</span></span><br><span class="line"><span class="operator">|</span> mysql<span class="operator">-</span>bin<span class="number">.000001</span> <span class="operator">|</span>     <span class="number">4202</span> <span class="operator">|</span>              <span class="operator">|</span> mysql,information_schema,performance_schema <span class="operator">|</span>                   <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------------+----------+--------------+---------------------------------------------+-------------------+</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ³¨æ„ï¼šéœ€è¦è®°å½•ä¸‹ <code>File</code> å’Œ <code>Position</code>ï¼Œåé¢ä¼šç”¨åˆ°ã€‚</p>
</blockquote>
<p>ï¼ˆ5ï¼‰å¯¼å‡º sql</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysqldump -u root -p --all-databases --master-data &gt; dbdump.sql</span><br></pre></td></tr></table></figure>

<p>ï¼ˆ6ï¼‰è§£é™¤è¯»é”</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> UNLOCK TABLES;</span><br></pre></td></tr></table></figure>

<p>ï¼ˆ7ï¼‰å°† sql è¿œç¨‹ä¼ é€åˆ°ä»èŠ‚ç‚¹ä¸Š</p>
<figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scp dbdump.sql root<span class="variable">@192</span>.<span class="number">168.8</span>.<span class="number">11</span><span class="symbol">:/home</span></span><br></pre></td></tr></table></figure>

<h4 id="ä»èŠ‚ç‚¹ä¸Šçš„æ“ä½œ"><a href="#ä»èŠ‚ç‚¹ä¸Šçš„æ“ä½œ" class="headerlink" title="ä»èŠ‚ç‚¹ä¸Šçš„æ“ä½œ"></a>ä»èŠ‚ç‚¹ä¸Šçš„æ“ä½œ</h4><p>ï¼ˆ1ï¼‰ä¿®æ”¹é…ç½®å¹¶é‡å¯</p>
<p>æ‰§è¡Œ <code>vi /etc/my.cnf</code> ï¼Œæ·»åŠ å¦‚ä¸‹é…ç½®ï¼š</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[mysqld]</span></span><br><span class="line"><span class="attr">server-id</span>=<span class="number">2</span></span><br><span class="line"><span class="attr">log_bin</span>=/var/lib/mysql/binlog</span><br></pre></td></tr></table></figure>

<ul>
<li><code>server-id</code> - æœåŠ¡å™¨ ID å·ã€‚åœ¨ä¸»ä»æ¶æ„ä¸­ï¼Œæ¯å°æœºå™¨çš„ ID å¿…é¡»å”¯ä¸€ã€‚</li>
<li><code>log_bin</code> - åŒæ­¥çš„æ—¥å¿—è·¯å¾„åŠæ–‡ä»¶åï¼Œä¸€å®šæ³¨æ„è¿™ä¸ªç›®å½•è¦æ˜¯ mysql æœ‰æƒé™å†™å…¥çš„ï¼›</li>
</ul>
<p>ä¿®æ”¹åï¼Œé‡å¯ mysql ä½¿é…ç½®ç”Ÿæ•ˆï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl restart mysql</span><br></pre></td></tr></table></figure>

<p>ï¼ˆ2ï¼‰å¯¼å…¥ sql</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -u root -p &lt; /home/dbdump.sql</span><br></pre></td></tr></table></figure>

<p>ï¼ˆ3ï¼‰åœ¨ä»èŠ‚ç‚¹ä¸Šå»ºç«‹ä¸ä¸»èŠ‚ç‚¹çš„è¿æ¥</p>
<p>è¿›å…¥ mysql å‘½ä»¤æ§åˆ¶å°ï¼š</p>
<figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ mysql -u root -p</span><br><span class="line"><span class="symbol">Password:</span></span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œä»¥ä¸‹ SQLï¼š</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- åœæ­¢ä»èŠ‚ç‚¹æœåŠ¡</span></span><br><span class="line">STOP SLAVE;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- æ³¨æ„ï¼šMASTER_USER å’Œ</span></span><br><span class="line">CHANGE MASTER <span class="keyword">TO</span></span><br><span class="line">MASTER_HOST<span class="operator">=</span><span class="string">&#x27;192.168.8.10&#x27;</span>,</span><br><span class="line">MASTER_USER<span class="operator">=</span><span class="string">&#x27;slave&#x27;</span>,</span><br><span class="line">MASTER_PASSWORD<span class="operator">=</span><span class="string">&#x27;å¯†ç &#x27;</span>,</span><br><span class="line">MASTER_LOG_FILE<span class="operator">=</span><span class="string">&#x27;binlog.000001&#x27;</span>,</span><br><span class="line">MASTER_LOG_POS<span class="operator">=</span><span class="number">4202</span>;</span><br></pre></td></tr></table></figure>

<ul>
<li><code>MASTER_LOG_FILE</code> å’Œ <code>MASTER_LOG_POS</code> å‚æ•°è¦åˆ†åˆ«ä¸ <code>show master status</code> æŒ‡ä»¤è·å¾—çš„ <code>File</code> å’Œ <code>Position</code> å±æ€§å€¼å¯¹åº”ã€‚</li>
<li><code>MASTER_HOST</code> æ˜¯ä¸»èŠ‚ç‚¹çš„ HOSTã€‚</li>
<li><code>MASTER_USER</code> å’Œ <code>MASTER_PASSWORD</code> æ˜¯åœ¨ä¸»èŠ‚ç‚¹ä¸Šæ³¨å†Œçš„ç”¨æˆ·åŠå¯†ç ã€‚</li>
</ul>
<p>ï¼ˆ4ï¼‰å¯åŠ¨ slave è¿›ç¨‹</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">start</span> slave;</span><br></pre></td></tr></table></figure>

<p>ï¼ˆ5ï¼‰æŸ¥çœ‹ä¸»ä»åŒæ­¥çŠ¶æ€</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">show</span> slave status\G;</span><br></pre></td></tr></table></figure>

<p>è¯´æ˜ï¼šå¦‚æœä»¥ä¸‹ä¸¤é¡¹å‚æ•°å‡ä¸º YESï¼Œè¯´æ˜é…ç½®æ­£ç¡®ã€‚</p>
<ul>
<li><code>Slave_IO_Running</code></li>
<li><code>Slave_SQL_Running</code></li>
</ul>
<p>ï¼ˆ6ï¼‰å°†ä»èŠ‚ç‚¹è®¾ä¸ºåªè¯»</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">set</span> <span class="keyword">global</span> read_only<span class="operator">=</span><span class="number">1</span>;</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">set</span> <span class="keyword">global</span> super_read_only<span class="operator">=</span><span class="number">1</span>;</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">show</span> <span class="keyword">global</span> variables <span class="keyword">like</span> &quot;%read_only%&quot;;</span><br><span class="line"><span class="operator">+</span><span class="comment">-----------------------+-------+</span></span><br><span class="line"><span class="operator">|</span> Variable_name         <span class="operator">|</span> <span class="keyword">Value</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------------------+-------+</span></span><br><span class="line"><span class="operator">|</span> innodb_read_only      <span class="operator">|</span> OFF   <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> read_only             <span class="operator">|</span> <span class="keyword">ON</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> super_read_only       <span class="operator">|</span> <span class="keyword">ON</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> transaction_read_only <span class="operator">|</span> OFF   <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------------------+-------+</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ³¨ï¼šè®¾ç½® slave æœåŠ¡å™¨ä¸ºåªè¯»ï¼Œå¹¶ä¸å½±å“ä¸»ä»åŒæ­¥ã€‚</p>
</blockquote>
<h3 id="æ…¢æŸ¥è¯¢"><a href="#æ…¢æŸ¥è¯¢" class="headerlink" title="æ…¢æŸ¥è¯¢"></a>æ…¢æŸ¥è¯¢</h3><p>æŸ¥çœ‹æ…¢æŸ¥è¯¢æ˜¯å¦å¼€å¯</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> variables <span class="keyword">like</span> <span class="string">&#x27;%slow_query_log&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥é€šè¿‡ <code>set global slow_query_log</code> å‘½ä»¤è®¾ç½®æ…¢æŸ¥è¯¢æ˜¯å¦å¼€å¯ï¼šON è¡¨ç¤ºå¼€å¯ï¼›OFF è¡¨ç¤ºå…³é—­ã€‚</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span> <span class="keyword">global</span> slow_query_log<span class="operator">=</span><span class="string">&#x27;ON&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>æŸ¥çœ‹æ…¢æŸ¥è¯¢æ—¶é—´é˜ˆå€¼</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> variables <span class="keyword">like</span> <span class="string">&#x27;%long_query_time%&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>è®¾ç½®æ…¢æŸ¥è¯¢é˜ˆå€¼</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span> <span class="keyword">global</span> long_query_time <span class="operator">=</span> <span class="number">3</span>;</span><br></pre></td></tr></table></figure>

<h3 id="éš”ç¦»çº§åˆ«"><a href="#éš”ç¦»çº§åˆ«" class="headerlink" title="éš”ç¦»çº§åˆ«"></a>éš”ç¦»çº§åˆ«</h3><p>æŸ¥çœ‹éš”ç¦»çº§åˆ«ï¼š</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">show</span> variables <span class="keyword">like</span> <span class="string">&#x27;transaction_isolation&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------------------+----------------+</span></span><br><span class="line"></span><br><span class="line"><span class="operator">|</span> Variable_name <span class="operator">|</span> <span class="keyword">Value</span> <span class="operator">|</span></span><br><span class="line"></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------------------+----------------+</span></span><br><span class="line"></span><br><span class="line"><span class="operator">|</span> transaction_isolation <span class="operator">|</span> READ<span class="operator">-</span>COMMITTED <span class="operator">|</span></span><br><span class="line"></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------------------+----------------+</span></span><br></pre></td></tr></table></figure>

<h2 id="MySQL-é…ç½®"><a href="#MySQL-é…ç½®" class="headerlink" title="MySQL é…ç½®"></a>MySQL é…ç½®</h2><blockquote>
<p><strong><em>å¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œé»˜è®¤çš„åŸºæœ¬é…ç½®å·²ç»è¶³å¤Ÿåº”ä»˜å¤§å¤šæ•°åœºæ™¯ï¼Œä¸è¦è½»æ˜“ä¿®æ”¹ MySQL æœåŠ¡å™¨é…ç½®ï¼Œé™¤éä½ æ˜ç¡®çŸ¥é“ä¿®æ”¹é¡¹æ˜¯æœ‰ç›Šçš„ã€‚</em></strong></p>
<p>å°½é‡ä¸è¦ä½¿ç”¨ MySQL çš„ç¼“å­˜åŠŸèƒ½ï¼Œå› ä¸ºå…¶è¦æ±‚æ¯æ¬¡è¯·æ±‚å‚æ•°å®Œå…¨ç›¸åŒï¼Œæ‰èƒ½å‘½ä¸­ç¼“å­˜ã€‚è¿™ç§æ–¹å¼å®é™…ä¸Šå¹¶ä¸é«˜æ•ˆï¼Œè¿˜ä¼šå¢åŠ é¢å¤–å¼€é”€ï¼Œå®é™…ä¸šåŠ¡åœºæ™¯ä¸­ä¸€èˆ¬ä½¿ç”¨ Redis ç­‰ key-value å­˜å‚¨æ¥è§£å†³ç¼“å­˜é—®é¢˜ï¼Œæ€§èƒ½è¿œé«˜äº MySQL çš„æŸ¥è¯¢ç¼“å­˜ã€‚</p>
</blockquote>
<h3 id="é…ç½®æ–‡ä»¶è·¯å¾„"><a href="#é…ç½®æ–‡ä»¶è·¯å¾„" class="headerlink" title="é…ç½®æ–‡ä»¶è·¯å¾„"></a>é…ç½®æ–‡ä»¶è·¯å¾„</h3><p>é…ç½® MySQL é¦–å…ˆè¦ç¡®å®šé…ç½®æ–‡ä»¶åœ¨å“ªå„¿ã€‚</p>
<p>ä¸åŒ Linux æ“ä½œç³»ç»Ÿä¸Šï¼ŒMySQL é…ç½®æ–‡ä»¶è·¯å¾„å¯èƒ½ä¸åŒã€‚é€šå¸¸çš„è·¯å¾„ä¸º &#x2F;etc&#x2F;my.cnf æˆ– &#x2F;etc&#x2F;mysql&#x2F;my.cnf ã€‚</p>
<p>å¦‚æœä¸çŸ¥é“é…ç½®æ–‡ä»¶è·¯å¾„ï¼Œå¯ä»¥å°è¯•ä»¥ä¸‹æ“ä½œï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">which</span> mysqld</span></span><br><span class="line">/usr/sbin/mysqld</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">/usr/sbin/mysqld --verbose --<span class="built_in">help</span> | grep -A 1 <span class="string">&#x27;Default options&#x27;</span></span></span><br><span class="line">Default options are read from the following files in the given order:</span><br><span class="line">/etc/my.cnf /etc/mysql/my.cnf /usr/etc/my.cnf ~/.my.cnf</span><br></pre></td></tr></table></figure>

<h3 id="é…ç½®é¡¹è¯­æ³•"><a href="#é…ç½®é¡¹è¯­æ³•" class="headerlink" title="é…ç½®é¡¹è¯­æ³•"></a>é…ç½®é¡¹è¯­æ³•</h3><p><strong>MySQL é…ç½®é¡¹è®¾ç½®éƒ½ä½¿ç”¨å°å†™ï¼Œå•è¯ä¹‹é—´ç”¨ä¸‹åˆ’çº¿æˆ–æ¨ªçº¿éš”å¼€ï¼ˆäºŒè€…æ˜¯ç­‰ä»·çš„ï¼‰ã€‚</strong></p>
<p>å»ºè®®ä½¿ç”¨å›ºå®šçš„é£æ ¼ï¼Œè¿™æ ·æ£€ç´¢é…ç½®é¡¹æ—¶è¾ƒä¸ºæ–¹ä¾¿ã€‚</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">è¿™ä¸¤ç§æ ¼å¼ç­‰ä»·</span></span><br><span class="line">/usr/sbin/mysqld --auto-increment-offset=5</span><br><span class="line">/usr/sbin/mysqld --auto_increment_offset=5</span><br></pre></td></tr></table></figure>

<h3 id="åŸºæœ¬é…ç½®æ¨¡æ¿"><a href="#åŸºæœ¬é…ç½®æ¨¡æ¿" class="headerlink" title="åŸºæœ¬é…ç½®æ¨¡æ¿"></a>åŸºæœ¬é…ç½®æ¨¡æ¿</h3><p>ä¸€ä¸ªåŸºæœ¬çš„ MySQL é…ç½®æ¨¡æ¿å¤§æ¦‚å¦‚ä¸‹ï¼š</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[mysqld]</span></span><br><span class="line"><span class="comment"># GENERAL</span></span><br><span class="line"><span class="comment"># -------------------------------------------------------------------------------</span></span><br><span class="line"><span class="attr">datadir</span> = /var/lib/mysql</span><br><span class="line"><span class="attr">socket</span>  = /var/lib/mysql/mysql.sock</span><br><span class="line"><span class="attr">pid_file</span> = /var/lib/mysql/mysql.pid</span><br><span class="line"><span class="attr">user</span> = mysql</span><br><span class="line"><span class="attr">port</span> = <span class="number">3306</span></span><br><span class="line"><span class="attr">default_storage_engine</span> = InnoDB</span><br><span class="line"><span class="attr">default_time_zone</span> = <span class="string">&#x27;+8ï¼š00&#x27;</span></span><br><span class="line"><span class="attr">character_set_server</span> = utf8mb4</span><br><span class="line"><span class="attr">collation_server</span> = utf8mb<span class="number">4_0900_</span>ai_ci</span><br><span class="line"></span><br><span class="line"><span class="comment"># LOG</span></span><br><span class="line"><span class="comment"># -------------------------------------------------------------------------------</span></span><br><span class="line"><span class="attr">log_error</span> = /var/log/mysql/mysql-error.log</span><br><span class="line"><span class="attr">slow_query_log</span> = <span class="number">1</span></span><br><span class="line"><span class="attr">slow_query_log_file</span> = /var/log/mysql/mysql-slow.log</span><br><span class="line"></span><br><span class="line"><span class="comment"># InnoDB</span></span><br><span class="line"><span class="comment"># -------------------------------------------------------------------------------</span></span><br><span class="line"><span class="attr">innodb_buffer_pool_size</span> = &lt;value&gt;</span><br><span class="line"><span class="attr">innodb_log_file_size</span> = &lt;value&gt;</span><br><span class="line"><span class="attr">innodb_file_per_table</span> = <span class="number">1</span></span><br><span class="line"><span class="attr">innodb_flush_method</span> = O_DIRECT</span><br><span class="line"></span><br><span class="line"><span class="comment"># MyIsam</span></span><br><span class="line"><span class="comment"># -------------------------------------------------------------------------------</span></span><br><span class="line"><span class="attr">key_buffer_size</span> = &lt;value&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># OTHER</span></span><br><span class="line"><span class="comment"># -------------------------------------------------------------------------------</span></span><br><span class="line"><span class="attr">tmp_table_size</span> = <span class="number">32</span>M</span><br><span class="line"><span class="attr">max_heap_table_size</span> = <span class="number">32</span>M</span><br><span class="line"><span class="attr">max_connections</span> = &lt;value&gt;</span><br><span class="line"><span class="attr">open_files_limit</span> = <span class="number">65535</span></span><br><span class="line"></span><br><span class="line"><span class="section">[client]</span></span><br><span class="line"><span class="attr">socket</span>  = /var/lib/mysql/mysql.sock</span><br><span class="line"><span class="attr">port</span> = <span class="number">3306</span></span><br></pre></td></tr></table></figure>

<h3 id="é…ç½®é¡¹è¯´æ˜"><a href="#é…ç½®é¡¹è¯´æ˜" class="headerlink" title="é…ç½®é¡¹è¯´æ˜"></a>é…ç½®é¡¹è¯´æ˜</h3><p>ä¸‹é¢æ˜¯ä¸€ä¸ªè¾ƒä¸ºè¯¦å°½çš„ MySQL é…ç½®æ–‡ä»¶ï¼Œå„é…ç½®é¡¹æœ‰æ³¨é‡Šè¯´æ˜ï¼š</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[mysqld]</span></span><br><span class="line"><span class="comment"># GENERAL</span></span><br><span class="line"><span class="comment"># -------------------------------------------------------------------------------</span></span><br><span class="line"><span class="attr">datadir</span> = /var/lib/mysql</span><br><span class="line"><span class="comment"># socket æ–‡ä»¶</span></span><br><span class="line"><span class="attr">socket</span>  = /var/lib/mysql/mysql.sock</span><br><span class="line"><span class="comment"># PID æ–‡ä»¶</span></span><br><span class="line"><span class="attr">pid_file</span> = /var/lib/mysql/mysql.pid</span><br><span class="line"><span class="comment"># å¯åŠ¨ mysql æœåŠ¡è¿›ç¨‹çš„ç”¨æˆ·</span></span><br><span class="line"><span class="attr">user</span> = mysql</span><br><span class="line"><span class="comment"># æœåŠ¡ç«¯å£å·ï¼Œé»˜è®¤ 3306</span></span><br><span class="line"><span class="attr">port</span> = <span class="number">3306</span></span><br><span class="line"><span class="attr">default_storage_engine</span> = InnoDB</span><br><span class="line"><span class="comment"># é»˜è®¤æ—¶åŒº</span></span><br><span class="line"><span class="attr">default_time_zone</span> = <span class="string">&#x27;+8:00&#x27;</span></span><br><span class="line"><span class="attr">character_set_server</span> = utf8mb4</span><br><span class="line"><span class="attr">collation_server</span> = utf8mb<span class="number">4_0900_</span>ai_ci</span><br><span class="line"></span><br><span class="line"><span class="comment"># MySQL æœåŠ¡ IDï¼Œå•ç‚¹æœåŠ¡æ—¶æ²¡å¿…è¦è®¾ç½®</span></span><br><span class="line"><span class="attr">server-id</span> = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># äº‹åŠ¡éš”ç¦»çº§åˆ«ï¼Œé»˜è®¤ä¸ºå¯é‡å¤è¯»ï¼ˆREPEATABLE-READï¼‰ã€‚ï¼ˆæ­¤çº§åˆ«ä¸‹å¯èƒ½å‚æ•°å¾ˆå¤šé—´éš™é”ï¼Œå½±å“æ€§èƒ½ï¼Œä½†æ˜¯ä¿®æ”¹åˆå½±å“ä¸»ä»å¤åˆ¶åŠç¾éš¾æ¢å¤ï¼Œå»ºè®®è¿˜æ˜¯ä¿®æ”¹ä»£ç é€»è¾‘å§ï¼‰</span></span><br><span class="line"><span class="comment"># éš”ç¦»çº§åˆ«å¯é€‰é¡¹ç›®ï¼šREAD-UNCOMMITTED READ-COMMITTED REPEATABLE-READ SERIALIZABLE</span></span><br><span class="line"><span class="attr">transaction_isolation</span> = REPEATABLE-READ</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç›®å½•é…ç½®</span></span><br><span class="line"><span class="comment"># -------------------------------------------------------------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># mysql å®‰è£…æ ¹ç›®å½•</span></span><br><span class="line"><span class="attr">basedir</span> = /usr/local/mysql-<span class="number">5.7</span>.<span class="number">21</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># mysql æ•°æ®æ–‡ä»¶æ‰€åœ¨ç›®å½•</span></span><br><span class="line"><span class="attr">datadir</span> = /var/lib/mysql</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¸´æ—¶ç›®å½• æ¯”å¦‚ load data infile ä¼šç”¨åˆ°ï¼Œä¸€èˆ¬éƒ½æ˜¯ä½¿ç”¨/tmp</span></span><br><span class="line"><span class="attr">tmpdir</span> = /tmp</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ•°æ®åº“å¼•æ“é…ç½®</span></span><br><span class="line"><span class="comment"># -------------------------------------------------------------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># mysql 5.1 ä¹‹åï¼Œé»˜è®¤å¼•æ“æ˜¯ InnoDB</span></span><br><span class="line"><span class="attr">default_storage_engine</span> = InnoDB</span><br><span class="line"></span><br><span class="line"><span class="comment"># å†…å­˜ä¸´æ—¶è¡¨é»˜è®¤å¼•æ“ï¼Œé»˜è®¤ InnoDB</span></span><br><span class="line"><span class="attr">default_tmp_storage_engine</span> = InnoDB</span><br><span class="line"></span><br><span class="line"><span class="comment"># mysql 5.7 æ–°å¢ç‰¹æ€§ï¼Œç£ç›˜ä¸´æ—¶è¡¨é»˜è®¤å¼•æ“ï¼Œé»˜è®¤ InnoDB</span></span><br><span class="line"><span class="attr">internal_tmp_disk_storage_engine</span> = InnoDB</span><br><span class="line"></span><br><span class="line"><span class="comment"># å­—ç¬¦é›†é…ç½®</span></span><br><span class="line"><span class="comment"># -------------------------------------------------------------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ•°æ®åº“é»˜è®¤å­—ç¬¦é›†ï¼Œä¸»æµå­—ç¬¦é›†æ”¯æŒä¸€äº›ç‰¹æ®Šè¡¨æƒ…ç¬¦å·ï¼ˆç‰¹æ®Šè¡¨æƒ…ç¬¦å ç”¨ 4 ä¸ªå­—èŠ‚ï¼‰</span></span><br><span class="line"><span class="attr">character_set_server</span> = utf8mb4</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ•°æ®åº“å­—ç¬¦é›†å¯¹åº”ä¸€äº›æ’åºç­‰è§„åˆ™ï¼Œæ³¨æ„è¦å’Œ character_set_server å¯¹åº”</span></span><br><span class="line"><span class="attr">collation-server</span> = utf8mb<span class="number">4_0900_</span>ai_ci</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¾ç½® client è¿æ¥ mysql æ—¶çš„å­—ç¬¦é›†ï¼Œé˜²æ­¢ä¹±ç </span></span><br><span class="line"><span class="comment"># init_connect=&#x27;SET NAMES utf8&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ˜¯å¦å¯¹ sql è¯­å¥å¤§å°å†™æ•æ„Ÿï¼Œé»˜è®¤å€¼ä¸º 0ï¼Œ1 è¡¨ç¤ºä¸æ•æ„Ÿ</span></span><br><span class="line"><span class="attr">lower_case_table_names</span> = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ•°æ®åº“è¿æ¥é…ç½®</span></span><br><span class="line"><span class="comment"># -------------------------------------------------------------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æœ€å¤§è¿æ¥æ•°ï¼Œå¯è®¾æœ€å¤§å€¼ 16384ï¼Œä¸€èˆ¬è€ƒè™‘æ ¹æ®åŒæ—¶åœ¨çº¿äººæ•°è®¾ç½®ä¸€ä¸ªæ¯”è¾ƒç»¼åˆçš„æ•°å­—ï¼Œé‰´äºè¯¥æ•°å€¼å¢å¤§å¹¶ä¸å¤ªæ¶ˆè€—ç³»ç»Ÿèµ„æºï¼Œå»ºè®®ç›´æ¥è®¾ 10000</span></span><br><span class="line"><span class="comment"># å¦‚æœåœ¨è®¿é—®æ—¶ç»å¸¸å‡ºç° Too Many Connections çš„é”™è¯¯æç¤ºï¼Œåˆ™éœ€è¦å¢å¤§è¯¥å‚æ•°å€¼</span></span><br><span class="line"><span class="attr">max_connections</span> = <span class="number">10000</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># é»˜è®¤å€¼ 100ï¼Œæœ€å¤§é”™è¯¯è¿æ¥æ•°ï¼Œå¦‚æœæœ‰è¶…å‡ºè¯¥å‚æ•°å€¼ä¸ªæ•°çš„ä¸­æ–­é”™è¯¯è¿æ¥ï¼Œåˆ™è¯¥ä¸»æœºå°†è¢«ç¦æ­¢è¿æ¥ã€‚å¦‚éœ€å¯¹è¯¥ä¸»æœºè¿›è¡Œè§£ç¦ï¼Œæ‰§è¡Œï¼šFLUSH HOST</span></span><br><span class="line"><span class="comment"># è€ƒè™‘é«˜å¹¶å‘åœºæ™¯ä¸‹çš„å®¹é”™ï¼Œå»ºè®®åŠ å¤§ã€‚</span></span><br><span class="line"><span class="attr">max_connect_errors</span> = <span class="number">10000</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># MySQL æ‰“å¼€çš„æ–‡ä»¶æè¿°ç¬¦é™åˆ¶ï¼Œé»˜è®¤æœ€å° 1024;</span></span><br><span class="line"><span class="comment"># å½“ open_files_limit æ²¡æœ‰è¢«é…ç½®çš„æ—¶å€™ï¼Œæ¯”è¾ƒ max_connections\*5 å’Œ ulimit -n çš„å€¼ï¼Œå“ªä¸ªå¤§ç”¨å“ªä¸ªï¼Œ</span></span><br><span class="line"><span class="comment"># å½“ open_file_limit è¢«é…ç½®çš„æ—¶å€™ï¼Œæ¯”è¾ƒ open_files_limit å’Œ max_connections\*5 çš„å€¼ï¼Œå“ªä¸ªå¤§ç”¨å“ªä¸ªã€‚</span></span><br><span class="line"><span class="comment"># æ³¨æ„ï¼šä»ç„¶å¯èƒ½å‡ºç°æŠ¥é”™ä¿¡æ¯ Can&#x27;t create a new threadï¼›æ­¤æ—¶è§‚å¯Ÿç³»ç»Ÿ cat /proc/mysql è¿›ç¨‹å·/limitsï¼Œè§‚å¯Ÿè¿›ç¨‹ ulimit é™åˆ¶æƒ…å†µ</span></span><br><span class="line"><span class="comment"># è¿‡å°çš„è¯ï¼Œè€ƒè™‘ä¿®æ”¹ç³»ç»Ÿé…ç½®è¡¨ï¼Œ/etc/security/limits.conf å’Œ /etc/security/limits.d/90-nproc.conf</span></span><br><span class="line"><span class="attr">open_files_limit</span> = <span class="number">65535</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è¶…æ—¶é…ç½®</span></span><br><span class="line"><span class="comment"># -------------------------------------------------------------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># MySQL é»˜è®¤çš„ wait_timeout å€¼ä¸º 8 ä¸ªå°æ—¶ï¼Œinteractive_timeout å‚æ•°éœ€è¦åŒæ—¶é…ç½®æ‰èƒ½ç”Ÿæ•ˆ</span></span><br><span class="line"><span class="comment"># MySQL è¿æ¥é—²ç½®è¶…è¿‡ä¸€å®šæ—¶é—´åï¼ˆå•ä½ï¼šç§’ï¼Œæ­¤å¤„ä¸º 1800 ç§’ï¼‰å°†ä¼šè¢«å¼ºè¡Œå…³é—­</span></span><br><span class="line"><span class="attr">interactive_timeout</span> = <span class="number">1800</span></span><br><span class="line"><span class="attr">wait_timeout</span> = <span class="number">1800</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åœ¨ MySQL æš‚æ—¶åœæ­¢å“åº”æ–°è¯·æ±‚ä¹‹å‰çš„çŸ­æ—¶é—´å†…å¤šå°‘ä¸ªè¯·æ±‚å¯ä»¥è¢«å­˜åœ¨å †æ ˆä¸­</span></span><br><span class="line"><span class="comment"># å®˜æ–¹å»ºè®® back_log = 50 + (max_connections / 5)ï¼Œå°é¡¶æ•°ä¸º 900</span></span><br><span class="line"><span class="attr">back_log</span> = <span class="number">900</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ•°æ®åº“æ•°æ®äº¤æ¢é…ç½®</span></span><br><span class="line"><span class="comment"># -------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment"># è¯¥å‚æ•°é™åˆ¶æœåŠ¡å™¨ç«¯ï¼Œæ¥å—çš„æ•°æ®åŒ…å¤§å°ï¼Œå¦‚æœæœ‰ BLOB å­æ®µï¼Œå»ºè®®å¢å¤§æ­¤å€¼ï¼Œé¿å…å†™å…¥æˆ–è€…æ›´æ–°å‡ºé”™ã€‚æœ‰ BLOB å­æ®µï¼Œå»ºè®®æ”¹ä¸º 1024M</span></span><br><span class="line"><span class="attr">max_allowed_packet</span> = <span class="number">128</span>M</span><br><span class="line"></span><br><span class="line"><span class="comment"># å†…å­˜ã€cache ä¸ buffer è®¾ç½®</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å†…å­˜ä¸´æ—¶è¡¨çš„æœ€å¤§å€¼ï¼Œé»˜è®¤ 16Mï¼Œæ­¤å¤„è®¾ç½®æˆ 64M</span></span><br><span class="line"><span class="attr">tmp_table_size</span> = <span class="number">64</span>M</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç”¨æˆ·åˆ›å»ºçš„å†…å­˜è¡¨çš„å¤§å°ï¼Œé»˜è®¤ 16Mï¼Œå¾€å¾€å’Œ tmp_table_size ä¸€èµ·è®¾ç½®ï¼Œé™åˆ¶ç”¨æˆ·ä¸´æ—¶è¡¨å¤§å°ã€‚</span></span><br><span class="line"><span class="comment"># è¶…é™çš„è¯ï¼ŒMySQL å°±ä¼šè‡ªåŠ¨åœ°æŠŠå®ƒè½¬åŒ–ä¸ºåŸºäºç£ç›˜çš„ MyISAM è¡¨ï¼Œå­˜å‚¨åœ¨æŒ‡å®šçš„ tmpdir ç›®å½•ä¸‹ï¼Œå¢å¤§ IO å‹åŠ›ï¼Œå»ºè®®å†…å­˜å¤§ï¼Œå¢å¤§è¯¥æ•°å€¼ã€‚</span></span><br><span class="line"><span class="attr">max_heap_table_size</span> = <span class="number">64</span>M</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¡¨ç¤ºè¿™ä¸ª mysql ç‰ˆæœ¬æ˜¯å¦æ”¯æŒæŸ¥è¯¢ç¼“å­˜ã€‚psï¼šSHOW STATUS LIKE &#x27;qcache%&#x27;ï¼Œä¸ç¼“å­˜ç›¸å…³çš„çŠ¶æ€å˜é‡ã€‚</span></span><br><span class="line"><span class="comment"># have_query_cache</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿™ä¸ªç³»ç»Ÿå˜é‡æ§åˆ¶ç€æŸ¥è¯¢ç¼“å­˜åŠŸèƒ½çš„å¼€å¯å’Œå…³é—­ï¼Œ0 è¡¨ç¤ºå…³é—­ï¼Œ1 è¡¨ç¤ºæ‰“å¼€ï¼Œ2 è¡¨ç¤ºåªè¦ select ä¸­æ˜ç¡®æŒ‡å®š SQL_CACHE æ‰ç¼“å­˜ã€‚</span></span><br><span class="line"><span class="comment"># çœ‹ä¸šåŠ¡åœºæ™¯å†³å®šæ˜¯å¦ä½¿ç”¨ç¼“å­˜ï¼Œä¸ä½¿ç”¨ï¼Œä¸‹é¢å°±ä¸ç”¨é…ç½®äº†ã€‚</span></span><br><span class="line"><span class="comment"># MySQL8 ä¸æ”¯æŒ</span></span><br><span class="line"><span class="attr">query_cache_type</span> = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># é»˜è®¤å€¼ 1Mï¼Œä¼˜ç‚¹æ˜¯æŸ¥è¯¢ç¼“å­˜å¯ä»¥æå¤§çš„æé«˜æœåŠ¡å™¨é€Ÿåº¦ï¼Œå¦‚æœä½ æœ‰å¤§é‡çš„ç›¸åŒçš„æŸ¥è¯¢å¹¶ä¸”å¾ˆå°‘ä¿®æ”¹è¡¨ã€‚</span></span><br><span class="line"><span class="comment"># ç¼ºç‚¹ï¼šåœ¨ä½ è¡¨ç»å¸¸å˜åŒ–çš„æƒ…å†µä¸‹æˆ–è€…å¦‚æœä½ çš„æŸ¥è¯¢åŸæ–‡æ¯æ¬¡éƒ½ä¸åŒï¼ŒæŸ¥è¯¢ç¼“å­˜ä¹Ÿè®¸å¼•èµ·æ€§èƒ½ä¸‹é™è€Œä¸æ˜¯æ€§èƒ½æå‡ã€‚</span></span><br><span class="line"><span class="comment"># MySQL8 ä¸æ”¯æŒ</span></span><br><span class="line"><span class="attr">query_cache_size</span> = <span class="number">64</span>M</span><br><span class="line"></span><br><span class="line"><span class="comment"># åªæœ‰å°äºæ­¤è®¾å®šå€¼çš„ç»“æœæ‰ä¼šè¢«ç¼“å†²ï¼Œä¿æŠ¤æŸ¥è¯¢ç¼“å†²ï¼Œé˜²æ­¢ä¸€ä¸ªæå¤§çš„ç»“æœé›†å°†å…¶ä»–æ‰€æœ‰çš„æŸ¥è¯¢ç»“æœéƒ½è¦†ç›–ã€‚</span></span><br><span class="line"><span class="attr">query_cache_limit</span> = <span class="number">2</span>M</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¯ä¸ªè¢«ç¼“å­˜çš„ç»“æœé›†è¦å ç”¨çš„æœ€å°å†…å­˜ï¼Œé»˜è®¤å€¼ 4kbï¼Œä¸€èˆ¬ä¸æ€ä¹ˆè°ƒæ•´ã€‚</span></span><br><span class="line"><span class="comment"># å¦‚æœ Qcache_free_blocks å€¼è¿‡å¤§ï¼Œå¯èƒ½æ˜¯ query_cache_min_res_unit å€¼è¿‡å¤§ï¼Œåº”è¯¥è°ƒå°äº›</span></span><br><span class="line"><span class="comment"># query_cache_min_res_unit çš„ä¼°è®¡å€¼ï¼š(query_cache_size - Qcache_free_memory) / Qcache_queries_in_cache</span></span><br><span class="line"><span class="attr">query_cache_min_res_unit</span> = <span class="number">4</span>kb</span><br><span class="line"></span><br><span class="line"><span class="comment"># åœ¨ä¸€ä¸ªäº‹åŠ¡ä¸­ binlog ä¸ºäº†è®°å½• SQL çŠ¶æ€æ‰€æŒæœ‰çš„ cache å¤§å°</span></span><br><span class="line"><span class="comment"># å¦‚æœä½ ç»å¸¸ä½¿ç”¨å¤§çš„ã€å¤šå£°æ˜çš„äº‹åŠ¡ï¼Œä½ å¯ä»¥å¢åŠ æ­¤å€¼æ¥è·å–æ›´å¤§çš„æ€§èƒ½ã€‚</span></span><br><span class="line"><span class="comment"># æ‰€æœ‰ä»äº‹åŠ¡æ¥çš„çŠ¶æ€éƒ½å°†è¢«ç¼“å†²åœ¨ binlog ç¼“å†²ä¸­ç„¶ååœ¨æäº¤åä¸€æ¬¡æ€§å†™å…¥åˆ° binlog ä¸­</span></span><br><span class="line"><span class="comment"># å¦‚æœäº‹åŠ¡æ¯”æ­¤å€¼å¤§ï¼Œä¼šä½¿ç”¨ç£ç›˜ä¸Šçš„ä¸´æ—¶æ–‡ä»¶æ¥æ›¿ä»£ã€‚</span></span><br><span class="line"><span class="comment"># æ­¤ç¼“å†²åœ¨æ¯ä¸ªè¿æ¥çš„äº‹åŠ¡ç¬¬ä¸€æ¬¡æ›´æ–°çŠ¶æ€æ—¶è¢«åˆ›å»º</span></span><br><span class="line"><span class="attr">binlog_cache_size</span> = <span class="number">1</span>M</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ—¥å¿—é…ç½®</span></span><br><span class="line"><span class="comment"># -------------------------------------------------------------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ—¥å¿—æ–‡ä»¶ç›¸å…³è®¾ç½®ï¼Œä¸€èˆ¬åªå¼€å¯ä¸‰ç§æ—¥å¿—ï¼Œé”™è¯¯æ—¥å¿—ï¼Œæ…¢æŸ¥è¯¢æ—¥å¿—ï¼ŒäºŒè¿›åˆ¶æ—¥å¿—ã€‚æ™®é€šæŸ¥è¯¢æ—¥å¿—ä¸å¼€å¯ã€‚</span></span><br><span class="line"><span class="comment"># æ™®é€šæŸ¥è¯¢æ—¥å¿—ï¼Œé»˜è®¤å€¼ offï¼Œä¸å¼€å¯</span></span><br><span class="line"><span class="attr">general_log</span> = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ™®é€šæŸ¥è¯¢æ—¥å¿—å­˜æ”¾åœ°å€</span></span><br><span class="line"><span class="attr">general_log_file</span> = /usr/local/mysql-<span class="number">5.7</span>.<span class="number">21</span>/log/mysql-general.log</span><br><span class="line"></span><br><span class="line"><span class="comment"># å…¨å±€åŠ¨æ€å˜é‡ï¼Œé»˜è®¤ 3ï¼ŒèŒƒå›´ï¼š1 ï½ 3</span></span><br><span class="line"><span class="comment"># è¡¨ç¤ºé”™è¯¯æ—¥å¿—è®°å½•çš„ä¿¡æ¯ï¼Œ1ï¼šåªè®°å½• error ä¿¡æ¯ï¼›2ï¼šè®°å½• error å’Œ warnings ä¿¡æ¯ï¼›3ï¼šè®°å½• errorã€warnings å’Œæ™®é€šçš„ notes ä¿¡æ¯ã€‚</span></span><br><span class="line"><span class="attr">log_error_verbosity</span> = <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># é”™è¯¯æ—¥å¿—æ–‡ä»¶åœ°å€</span></span><br><span class="line"><span class="attr">log_error</span> = /usr/local/mysql-<span class="number">5.7</span>.<span class="number">21</span>/log/mysql-error.log</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¼€å¯æ…¢æŸ¥è¯¢</span></span><br><span class="line"><span class="attr">slow_query_log</span> = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¼€å¯æ…¢æŸ¥è¯¢æ—¶é—´ï¼Œæ­¤å¤„ä¸º 1 ç§’ï¼Œè¾¾åˆ°æ­¤å€¼æ‰è®°å½•æ•°æ®</span></span><br><span class="line"><span class="attr">long_query_time</span> = <span class="number">3</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ£€ç´¢è¡Œæ•°è¾¾åˆ°æ­¤æ•°å€¼ï¼Œæ‰è®°å½•æ…¢æŸ¥è¯¢æ—¥å¿—ä¸­</span></span><br><span class="line"><span class="attr">min_examined_row_limit</span> = <span class="number">100</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># mysql 5.6.5 æ–°å¢ï¼Œç”¨æ¥è¡¨ç¤ºæ¯åˆ†é’Ÿå…è®¸è®°å½•åˆ° slow log çš„ä¸”æœªä½¿ç”¨ç´¢å¼•çš„ SQL è¯­å¥æ¬¡æ•°ï¼Œé»˜è®¤å€¼ä¸º 0ï¼Œä¸é™åˆ¶ã€‚</span></span><br><span class="line"><span class="attr">log_throttle_queries_not_using_indexes</span> = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ…¢æŸ¥è¯¢æ—¥å¿—æ–‡ä»¶åœ°å€</span></span><br><span class="line"><span class="attr">slow_query_log_file</span> = /var/log/mysql/mysql-slow.log</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¼€å¯è®°å½•æ²¡æœ‰ä½¿ç”¨ç´¢å¼•æŸ¥è¯¢è¯­å¥</span></span><br><span class="line"><span class="attr">log-queries-not-using-indexes</span> = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¼€å¯äºŒè¿›åˆ¶æ—¥å¿—</span></span><br><span class="line"><span class="attr">log_bin</span> = /usr/local/mysql-<span class="number">5.7</span>.<span class="number">21</span>/log/mysql-bin.log</span><br><span class="line"></span><br><span class="line"><span class="comment"># mysql æ¸…é™¤è¿‡æœŸæ—¥å¿—çš„æ—¶é—´ï¼Œé»˜è®¤å€¼ 0ï¼Œä¸è‡ªåŠ¨æ¸…ç†ï¼Œè€Œæ˜¯ä½¿ç”¨æ»šåŠ¨å¾ªç¯çš„æ–¹å¼ã€‚</span></span><br><span class="line"><span class="attr">expire_logs_days</span> = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¦‚æœäºŒè¿›åˆ¶æ—¥å¿—å†™å…¥çš„å†…å®¹è¶…å‡ºç»™å®šå€¼ï¼Œæ—¥å¿—å°±ä¼šå‘ç”Ÿæ»šåŠ¨ã€‚ä½ ä¸èƒ½å°†è¯¥å˜é‡è®¾ç½®ä¸ºå¤§äº 1GB æˆ–å°äº 4096 å­—èŠ‚ã€‚ é»˜è®¤å€¼æ˜¯ 1GBã€‚</span></span><br><span class="line"><span class="attr">max_binlog_size</span> = <span class="number">1000</span>M</span><br><span class="line"></span><br><span class="line"><span class="comment"># binlog çš„æ ¼å¼ä¹Ÿæœ‰ä¸‰ç§ï¼šSTATEMENTï¼ŒROWï¼ŒMIXEDã€‚mysql 5.7.7 åï¼Œé»˜è®¤å€¼ä» MIXED æ”¹ä¸º ROW</span></span><br><span class="line"><span class="comment"># å…³äº binlog æ—¥å¿—æ ¼å¼é—®é¢˜ï¼Œè¯·æŸ¥é˜…ç½‘ç»œèµ„æ–™</span></span><br><span class="line"><span class="attr">binlog_format</span> = row</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¡¨ç¤ºæ¯ N æ¬¡å†™å…¥ binlog åï¼ŒæŒä¹…åŒ–åˆ°ç£ç›˜ï¼Œé»˜è®¤å€¼ N=1</span></span><br><span class="line"><span class="comment"># å»ºè®®è®¾ç½®æˆ 1ï¼Œè¿™æ ·å¯ä»¥ä¿è¯ MySQL å¼‚å¸¸é‡å¯ä¹‹å binlog ä¸ä¸¢å¤±ã€‚</span></span><br><span class="line"><span class="comment"># sync_binlog = 1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># InnoDB å¼•æ“é…ç½®</span></span><br><span class="line"><span class="comment"># -------------------------------------------------------------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è¯´æ˜ï¼šè¯¥å‚æ•°å¯ä»¥æå‡æ‰©å±•æ€§å’Œåˆ·è„é¡µæ€§èƒ½ã€‚</span></span><br><span class="line"><span class="comment"># é»˜è®¤å€¼ 1ï¼Œå»ºè®®å€¼ï¼š4-8ï¼›å¹¶ä¸”å¿…é¡»å°äº innodb_buffer_pool_instances</span></span><br><span class="line"><span class="attr">innodb_page_cleaners</span> = <span class="number">4</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è¯´æ˜ï¼šä¸€èˆ¬ 8k å’Œ 16k ä¸­é€‰æ‹©ï¼Œ8k çš„è¯ï¼Œcpu æ¶ˆè€—å°äº›ï¼Œselcet æ•ˆç‡é«˜ä¸€ç‚¹ï¼Œä¸€èˆ¬ä¸ç”¨æ”¹</span></span><br><span class="line"><span class="comment"># é»˜è®¤å€¼ï¼š16kï¼›å»ºè®®å€¼ï¼šä¸æ”¹ï¼Œ</span></span><br><span class="line"><span class="attr">innodb_page_size</span> = <span class="number">16384</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è¯´æ˜ï¼šInnoDB ä½¿ç”¨ä¸€ä¸ªç¼“å†²æ± æ¥ä¿å­˜ç´¢å¼•å’ŒåŸå§‹æ•°æ®ï¼Œä¸åƒ MyISAMã€‚è¿™é‡Œä½ è®¾ç½®è¶Šå¤§ï¼Œä½ åœ¨å­˜å–è¡¨é‡Œé¢æ•°æ®æ—¶æ‰€éœ€è¦çš„ç£ç›˜ I/O è¶Šå°‘ã€‚</span></span><br><span class="line"><span class="comment"># åœ¨ä¸€ä¸ªç‹¬ç«‹ä½¿ç”¨çš„æ•°æ®åº“æœåŠ¡å™¨ä¸Šï¼Œä½ å¯ä»¥è®¾ç½®è¿™ä¸ªå˜é‡åˆ°æœåŠ¡å™¨ç‰©ç†å†…å­˜å¤§å°çš„ 60%-80%</span></span><br><span class="line"><span class="comment"># æ³¨æ„åˆ«è®¾ç½®çš„è¿‡å¤§ï¼Œä¼šå¯¼è‡´ system çš„ swap ç©ºé—´è¢«å ç”¨ï¼Œå¯¼è‡´æ“ä½œç³»ç»Ÿå˜æ…¢ï¼Œä»è€Œå‡ä½ sql æŸ¥è¯¢çš„æ•ˆç‡</span></span><br><span class="line"><span class="comment"># é»˜è®¤å€¼ï¼š128Mï¼Œå»ºè®®å€¼ï¼šç‰©ç†å†…å­˜çš„ 60%-80%</span></span><br><span class="line"><span class="attr">innodb_buffer_pool_size</span> = <span class="number">512</span>M</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¯´æ˜ï¼šåªæœ‰å½“è®¾ç½® innodb_buffer_pool_size å€¼å¤§äº 1G æ—¶æ‰æœ‰æ„ä¹‰ï¼Œå°äº 1Gï¼Œinstances é»˜è®¤ä¸º 1ï¼Œå¤§äº 1Gï¼Œinstances é»˜è®¤ä¸º 8</span></span><br><span class="line"><span class="comment"># ä½†æ˜¯ç½‘ç»œä¸Šæœ‰è¯„ä»·ï¼Œæœ€ä½³æ€§èƒ½ï¼Œæ¯ä¸ªå®ä¾‹è‡³å°‘ 1G å¤§å°ã€‚</span></span><br><span class="line"><span class="comment"># é»˜è®¤å€¼ï¼š1 æˆ– 8ï¼Œå»ºè®®å€¼ï¼šinnodb_buffer_pool_size/innodb_buffer_pool_instances &gt;= 1G</span></span><br><span class="line"><span class="attr">innodb_buffer_pool_instances</span> = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è¯´æ˜ï¼šmysql 5.7 æ–°ç‰¹æ€§ï¼Œdefines the chunk size for online InnoDB buffer pool resizing operationsã€‚</span></span><br><span class="line"><span class="comment"># å®é™…ç¼“å†²åŒºå¤§å°å¿…é¡»ä¸º innodb_buffer_pool_chunk_size*innodb_buffer_pool_instances *å€æ•°ï¼Œå–ç•¥å¤§äº innodb_buffer_pool_size</span></span><br><span class="line"><span class="comment"># é»˜è®¤å€¼ 128Mï¼Œå»ºè®®å€¼ï¼šé»˜è®¤å€¼å°±å¥½ï¼Œä¹±æ”¹åè€Œå®¹æ˜“å‡ºé—®é¢˜ï¼Œå®ƒä¼šå½±å“å®é™… buffer pool å¤§å°ã€‚</span></span><br><span class="line"><span class="attr">innodb_buffer_pool_chunk_size</span> = <span class="number">128</span>M</span><br><span class="line"></span><br><span class="line"><span class="comment"># åœ¨å¯åŠ¨æ—¶æŠŠçƒ­æ•°æ®åŠ è½½åˆ°å†…å­˜ã€‚é»˜è®¤å€¼ä¸º onï¼Œä¸ä¿®æ”¹</span></span><br><span class="line"><span class="attr">innodb_buffer_pool_load_at_startup</span> = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åœ¨å…³é—­æ—¶æŠŠçƒ­æ•°æ® dump åˆ°æœ¬åœ°ç£ç›˜ã€‚é»˜è®¤å€¼ä¸º onï¼Œä¸ä¿®æ”¹</span></span><br><span class="line"><span class="attr">innodb_buffer_pool_dump_at_shutdown</span> = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è¯´æ˜ï¼šå½±å“ Innodb ç¼“å†²åŒºçš„åˆ·æ–°ç®—æ³•ï¼Œå»ºè®®ä»å°åˆ°å¤§é…ç½®ï¼Œç›´åˆ° zero free pagesï¼›innodb_lru_scan_depth \* innodb_buffer_pool_instances defines the amount of work performed by the page cleaner thread each secondã€‚</span></span><br><span class="line"><span class="comment"># é»˜è®¤å€¼ 1024ï¼Œå»ºè®®å€¼ï¼š æœªçŸ¥</span></span><br><span class="line"><span class="attr">innodb_lru_scan_depth</span> = <span class="number">1024</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è¯´æ˜ï¼šäº‹åŠ¡ç­‰å¾…è·å–èµ„æºç­‰å¾…çš„æœ€é•¿æ—¶é—´ï¼Œå•ä½ä¸ºç§’ï¼Œçœ‹å…·ä½“ä¸šåŠ¡æƒ…å†µï¼Œä¸€èˆ¬é»˜è®¤å€¼å°±å¥½</span></span><br><span class="line"><span class="comment"># é»˜è®¤å€¼ï¼š50ï¼Œå»ºè®®å€¼ï¼šçœ‹ä¸šåŠ¡ã€‚</span></span><br><span class="line"><span class="attr">innodb_lock_wait_timeout</span> = <span class="number">60</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è¯´æ˜ï¼šè®¾ç½®äº† MySQL åå°ä»»åŠ¡ï¼ˆä¾‹å¦‚é¡µåˆ·æ–°å’Œ merge dadta from buffer poolï¼‰æ¯ç§’ io æ“ä½œçš„ä¸Šé™ã€‚</span></span><br><span class="line"><span class="comment"># é»˜è®¤å€¼ï¼š200ï¼Œå»ºè®®å€¼ï¼šæ–¹æ³•ä¸€ï¼Œå•ç›˜ sata è®¾ 100ï¼Œsas10ï¼Œraid10 è®¾ 200ï¼Œssd è®¾ 2000ï¼Œfushion-io è®¾ 50000ï¼›æ–¹æ³•äºŒï¼Œé€šè¿‡æµ‹è¯•å·¥å…·è·å¾—ç£ç›˜ io æ€§èƒ½åï¼Œè®¾ç½® IOPS æ•°å€¼/2ã€‚</span></span><br><span class="line"><span class="attr">innodb_io_capacity</span> = <span class="number">2000</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è¯´æ˜ï¼šè¯¥å‚æ•°æ˜¯æ‰€æœ‰ç¼“å†²åŒºçº¿ç¨‹ io æ“ä½œçš„æ€»ä¸Šé™ã€‚</span></span><br><span class="line"><span class="comment"># é»˜è®¤å€¼ï¼šinnodb_io_capacity çš„ä¸¤å€ã€‚å»ºè®®å€¼ï¼šä¾‹å¦‚ç”¨ iometer æµ‹è¯•åçš„ iops æ•°å€¼å°±å¥½</span></span><br><span class="line"><span class="attr">innodb_io_capacity_max</span> = <span class="number">4000</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è¯´æ˜ï¼šæ§åˆ¶ç€ innodb æ•°æ®æ–‡ä»¶åŠ redo log çš„æ‰“å¼€ã€åˆ·å†™æ¨¡å¼ï¼Œä¸‰ç§æ¨¡å¼ï¼šfdatasyncï¼ˆé»˜è®¤ï¼‰ï¼ŒO_DSYNCï¼ŒO_DIRECT</span></span><br><span class="line"><span class="comment"># fdatasyncï¼šæ•°æ®æ–‡ä»¶ï¼Œbuffer pool-&gt;os buffer-&gt;ç£ç›˜ï¼›æ—¥å¿—æ–‡ä»¶ï¼Œbuffer pool-&gt;os buffer-&gt;ç£ç›˜ï¼›</span></span><br><span class="line"><span class="comment"># O_DSYNCï¼š æ•°æ®æ–‡ä»¶ï¼Œbuffer pool-&gt;os buffer-&gt;ç£ç›˜ï¼›æ—¥å¿—æ–‡ä»¶ï¼Œbuffer pool-&gt;ç£ç›˜ï¼›</span></span><br><span class="line"><span class="comment"># O_DIRECTï¼š æ•°æ®æ–‡ä»¶ï¼Œbuffer pool-&gt;ç£ç›˜ï¼› æ—¥å¿—æ–‡ä»¶ï¼Œbuffer pool-&gt;os buffer-&gt;ç£ç›˜ï¼›</span></span><br><span class="line"><span class="comment"># é»˜è®¤å€¼ä¸ºç©ºï¼Œå»ºè®®å€¼ï¼šä½¿ç”¨ SAN æˆ–è€… raidï¼Œå»ºè®®ç”¨ O_DIRECTï¼Œä¸æ‡‚æµ‹è¯•çš„è¯ï¼Œé»˜è®¤ç”Ÿäº§ä¸Šä½¿ç”¨ O_DIRECT</span></span><br><span class="line"><span class="attr">innodb_flush_method</span> = O_DIRECT</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¯´æ˜ï¼šmysql5.7 ä¹‹åé»˜è®¤å¼€å¯ï¼Œæ„æ€æ˜¯ï¼Œæ¯å¼ è¡¨ä¸€ä¸ªç‹¬ç«‹è¡¨ç©ºé—´ã€‚</span></span><br><span class="line"><span class="comment"># é»˜è®¤å€¼ 1ï¼Œå¼€å¯</span></span><br><span class="line"><span class="attr">innodb_file_per_table</span> = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è¯´æ˜ï¼šThe path where InnoDB creates undo tablespacesã€‚é€šå¸¸ç­‰äº undo log æ–‡ä»¶çš„å­˜æ”¾ç›®å½•ã€‚</span></span><br><span class="line"><span class="comment"># é»˜è®¤å€¼ ./; è‡ªè¡Œè®¾ç½®</span></span><br><span class="line"><span class="attr">innodb_undo_directory</span> = /usr/local/mysql-<span class="number">5.7</span>.<span class="number">21</span>/log</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¯´æ˜ï¼šThe number of undo tablespaces used by InnoDB ç­‰äº undo log æ–‡ä»¶æ•°é‡ã€‚5.7.21 åå¼€å§‹å¼ƒç”¨</span></span><br><span class="line"><span class="comment"># é»˜è®¤å€¼ä¸º 0ï¼Œå»ºè®®é»˜è®¤å€¼å°±å¥½ï¼Œä¸ç”¨è°ƒæ•´äº†ã€‚</span></span><br><span class="line"><span class="attr">innodb_undo_tablespaces</span> = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è¯´æ˜ï¼šå®šä¹‰ undo ä½¿ç”¨çš„å›æ»šæ®µæ•°é‡ã€‚5.7.19 åå¼ƒç”¨</span></span><br><span class="line"><span class="comment"># é»˜è®¤å€¼ 128ï¼Œå»ºè®®ä¸åŠ¨ï¼Œä»¥åå¼ƒç”¨äº†ã€‚</span></span><br><span class="line"><span class="attr">innodb_undo_logs</span> = <span class="number">128</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è¯´æ˜ï¼š5.7.5 åå¼€å§‹ä½¿ç”¨ï¼Œåœ¨çº¿æ”¶ç¼© undo log ä½¿ç”¨çš„ç©ºé—´ã€‚</span></span><br><span class="line"><span class="comment"># é»˜è®¤å€¼ï¼šå…³é—­ï¼Œå»ºè®®å€¼ï¼šå¼€å¯</span></span><br><span class="line"><span class="attr">innodb_undo_log_truncate</span> = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è¯´æ˜ï¼šç»“åˆ innodb_undo_log_truncateï¼Œå®ç° undo ç©ºé—´æ”¶ç¼©åŠŸèƒ½</span></span><br><span class="line"><span class="comment"># é»˜è®¤å€¼ï¼š1Gï¼Œå»ºè®®å€¼ï¼Œä¸æ”¹ã€‚</span></span><br><span class="line"><span class="attr">innodb_max_undo_log_size</span> = <span class="number">1</span>G</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¯´æ˜ï¼šé‡ä½œæ—¥å¿—æ–‡ä»¶çš„å­˜æ”¾ç›®å½•</span></span><br><span class="line"><span class="attr">innodb_log_group_home_dir</span> = /usr/local/mysql-<span class="number">5.7</span>.<span class="number">21</span>/log</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¯´æ˜ï¼šæ—¥å¿—æ–‡ä»¶çš„å¤§å°</span></span><br><span class="line"><span class="comment"># é»˜è®¤å€¼ï¼š48Mï¼Œå»ºè®®å€¼ï¼šæ ¹æ®ä½ ç³»ç»Ÿçš„ç£ç›˜ç©ºé—´å’Œæ—¥å¿—å¢é•¿æƒ…å†µè°ƒæ•´å¤§å°</span></span><br><span class="line"><span class="attr">innodb_log_file_size</span> = <span class="number">128</span>M</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¯´æ˜ï¼šæ—¥å¿—ç»„ä¸­çš„æ–‡ä»¶æ•°é‡ï¼Œmysql ä»¥å¾ªç¯æ–¹å¼å†™å…¥æ—¥å¿—</span></span><br><span class="line"><span class="comment"># é»˜è®¤å€¼ 2ï¼Œå»ºè®®å€¼ï¼šæ ¹æ®ä½ ç³»ç»Ÿçš„ç£ç›˜ç©ºé—´å’Œæ—¥å¿—å¢é•¿æƒ…å†µè°ƒæ•´å¤§å°</span></span><br><span class="line"><span class="attr">innodb_log_files_in_group</span> = <span class="number">3</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ­¤å‚æ•°ç¡®å®šäº›æ—¥å¿—æ–‡ä»¶æ‰€ç”¨çš„å†…å­˜å¤§å°ï¼Œä»¥ M ä¸ºå•ä½ã€‚ç¼“å†²åŒºæ›´å¤§èƒ½æé«˜æ€§èƒ½ï¼Œä½†æ„å¤–çš„æ•…éšœå°†ä¼šä¸¢å¤±æ•°æ®ã€‚MySQL å¼€å‘äººå‘˜å»ºè®®è®¾ç½®ä¸º 1ï¼8M ä¹‹é—´</span></span><br><span class="line"><span class="attr">innodb_log_buffer_size</span> = <span class="number">16</span>M</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¯´æ˜ï¼šå¯ä»¥æ§åˆ¶ log ä»ç³»ç»Ÿ buffer åˆ·å…¥ç£ç›˜æ–‡ä»¶çš„åˆ·æ–°é¢‘ç‡ï¼Œå¢å¤§å¯å‡è½»ç³»ç»Ÿè´Ÿè·</span></span><br><span class="line"><span class="comment"># é»˜è®¤å€¼æ˜¯ 1ï¼›å»ºè®®å€¼ä¸æ”¹ã€‚ç³»ç»Ÿæ€§èƒ½ä¸€èˆ¬å¤Ÿç”¨ã€‚</span></span><br><span class="line"><span class="attr">innodb_flush_log_at_timeout</span> = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è¯´æ˜ï¼šå‚æ•°å¯è®¾ä¸º 0ï¼Œ1ï¼Œ2ï¼›</span></span><br><span class="line"><span class="comment"># å‚æ•° 0ï¼šè¡¨ç¤ºæ¯ç§’å°† log buffer å†…å®¹åˆ·æ–°åˆ°ç³»ç»Ÿ buffer ä¸­ï¼Œå†è°ƒç”¨ç³»ç»Ÿ flush æ“ä½œå†™å…¥ç£ç›˜æ–‡ä»¶ã€‚</span></span><br><span class="line"><span class="comment"># å‚æ•° 1ï¼šè¡¨ç¤ºæ¯æ¬¡äº‹åŠ¡æäº¤ï¼Œredo log éƒ½ç›´æ¥æŒä¹…åŒ–åˆ°ç£ç›˜ã€‚</span></span><br><span class="line"><span class="comment"># å‚æ•° 2ï¼šè¡¨ç¤ºæ¯æ¬¡äº‹åŠ¡æäº¤ï¼Œéš” 1 ç§’åå†å°† redo log æŒä¹…åŒ–åˆ°ç£ç›˜ã€‚</span></span><br><span class="line"><span class="comment"># å»ºè®®è®¾ç½®æˆ 1ï¼Œè¿™æ ·å¯ä»¥ä¿è¯ MySQL å¼‚å¸¸é‡å¯ä¹‹åæ•°æ®ä¸ä¸¢å¤±ã€‚</span></span><br><span class="line"><span class="attr">innodb_flush_log_at_trx_commit</span> = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è¯´æ˜ï¼šé™åˆ¶ Innodb èƒ½æ‰“å¼€çš„è¡¨çš„æ•°æ®ï¼Œå¦‚æœåº“é‡Œçš„è¡¨ç‰¹åˆ«å¤šçš„æƒ…å†µï¼Œè¯·å¢åŠ è¿™ä¸ªã€‚</span></span><br><span class="line"><span class="comment"># å€¼é»˜è®¤æ˜¯ 2000ï¼Œå»ºè®®å€¼ï¼šå‚è€ƒæ•°æ®åº“è¡¨æ€»æ•°å†è¿›è¡Œè°ƒæ•´ï¼Œä¸€èˆ¬å¤Ÿç”¨ä¸ç”¨è°ƒæ•´ã€‚</span></span><br><span class="line"><span class="attr">innodb_open_files</span> = <span class="number">8192</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># innodb å¤„ç† io è¯»å†™çš„åå°å¹¶å‘çº¿ç¨‹æ•°é‡ï¼Œæ ¹æ® cpu æ ¸æ¥ç¡®è®¤ï¼Œå–å€¼èŒƒå›´ï¼š1-64</span></span><br><span class="line"><span class="comment"># é»˜è®¤å€¼ï¼š4ï¼Œå»ºè®®å€¼ï¼šä¸é€»è¾‘ cpu æ•°é‡çš„ä¸€åŠä¿æŒä¸€è‡´ã€‚</span></span><br><span class="line"><span class="attr">innodb_read_io_threads</span> = <span class="number">4</span></span><br><span class="line"><span class="attr">innodb_write_io_threads</span> = <span class="number">4</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># é»˜è®¤è®¾ç½®ä¸º 0ï¼Œè¡¨ç¤ºä¸é™åˆ¶å¹¶å‘æ•°ï¼Œè¿™é‡Œæ¨èè®¾ç½®ä¸º 0ï¼Œæ›´å¥½å»å‘æŒ¥ CPU å¤šæ ¸å¤„ç†èƒ½åŠ›ï¼Œæé«˜å¹¶å‘é‡</span></span><br><span class="line"><span class="attr">innodb_thread_concurrency</span> = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># é»˜è®¤å€¼ä¸º 4ï¼Œå»ºè®®ä¸å˜ã€‚InnoDB ä¸­çš„æ¸…é™¤æ“ä½œæ˜¯ä¸€ç±»å®šæœŸå›æ”¶æ— ç”¨æ•°æ®çš„æ“ä½œã€‚mysql 5.5 ä¹‹åï¼Œæ”¯æŒå¤šçº¿ç¨‹æ¸…é™¤æ“ä½œã€‚</span></span><br><span class="line"><span class="attr">innodb_purge_threads</span> = <span class="number">4</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è¯´æ˜ï¼šmysql ç¼“å†²åŒºåˆ†ä¸º new blocks å’Œ old blocksï¼›æ­¤å‚æ•°è¡¨ç¤º old blocks å æ¯”ï¼›</span></span><br><span class="line"><span class="comment"># é»˜è®¤å€¼ï¼š37ï¼Œå»ºè®®å€¼ï¼Œä¸€èˆ¬ä¸åŠ¨</span></span><br><span class="line"><span class="attr">innodb_old_blocks_pct</span> = <span class="number">37</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è¯´æ˜ï¼šæ–°æ•°æ®è¢«è½½å…¥ç¼“å†²æ± ï¼Œè¿›å…¥ old pages é“¾åŒºï¼Œå½“ 1 ç§’åå†æ¬¡è®¿é—®ï¼Œåˆ™æå‡è¿›å…¥ new pages é“¾åŒºã€‚</span></span><br><span class="line"><span class="comment"># é»˜è®¤å€¼ï¼š1000</span></span><br><span class="line"><span class="attr">innodb_old_blocks_time</span>=<span class="number">1000</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è¯´æ˜ï¼šå¼€å¯å¼‚æ­¥ ioï¼Œå¯ä»¥æé«˜å¹¶å‘æ€§ï¼Œé»˜è®¤å¼€å¯ã€‚</span></span><br><span class="line"><span class="comment"># é»˜è®¤å€¼ä¸º 1ï¼Œå»ºè®®ä¸åŠ¨</span></span><br><span class="line"><span class="attr">innodb_use_native_aio</span> = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è¯´æ˜ï¼šé»˜è®¤ä¸ºç©ºï¼Œä½¿ç”¨ data ç›®å½•ï¼Œä¸€èˆ¬ä¸æ”¹ã€‚</span></span><br><span class="line"><span class="attr">innodb_data_home_dir</span>=/usr/local/mysql-<span class="number">5.7</span>.<span class="number">21</span>/data</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¯´æ˜ï¼šDefines the nameï¼Œsizeï¼Œand attributes of InnoDB system tablespace data filesã€‚</span></span><br><span class="line"><span class="comment"># é»˜è®¤å€¼ï¼Œä¸æŒ‡å®šï¼Œé»˜è®¤ä¸º ibdata1ï¼š12Mï¼šautoextend</span></span><br><span class="line"><span class="attr">innodb_data_file_path</span> = ibdata1ï¼š<span class="number">12</span>Mï¼šautoextend</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¯´æ˜ï¼šè®¾ç½®äº† InnoDB å­˜å‚¨å¼•æ“ç”¨æ¥å­˜æ”¾æ•°æ®å­—å…¸ä¿¡æ¯ä»¥åŠä¸€äº›å†…éƒ¨æ•°æ®ç»“æ„çš„å†…å­˜ç©ºé—´å¤§å°ï¼Œé™¤éä½ çš„æ•°æ®å¯¹è±¡åŠå…¶å¤šï¼Œå¦åˆ™ä¸€èˆ¬é»˜è®¤ä¸æ”¹ã€‚</span></span><br><span class="line"><span class="comment"># innodb_additional_mem_pool_size = 16M</span></span><br><span class="line"><span class="comment"># è¯´æ˜ï¼šThe crash recovery modeã€‚åªæœ‰ç´§æ€¥æƒ…å†µéœ€è¦æ¢å¤æ•°æ®çš„æ—¶å€™ï¼Œæ‰æ”¹ä¸ºå¤§äº 1-6 ä¹‹é—´æ•°å€¼ï¼Œå«ä¹‰æŸ¥ä¸‹å®˜ç½‘ã€‚</span></span><br><span class="line"><span class="comment"># é»˜è®¤å€¼ä¸º 0ï¼›</span></span><br><span class="line"><span class="comment">#innodb_force_recovery = 0</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># MyISAM å¼•æ“é…ç½®</span></span><br><span class="line"><span class="comment"># -------------------------------------------------------------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æŒ‡å®šç´¢å¼•ç¼“å†²åŒºçš„å¤§å°ï¼Œä¸º MYISAM æ•°æ®è¡¨å¼€å¯ä¾›çº¿ç¨‹å…±äº«çš„ç´¢å¼•ç¼“å­˜ï¼Œå¯¹ INNODB å¼•æ“æ— æ•ˆã€‚ç›¸å½“å½±å“ MyISAM çš„æ€§èƒ½ã€‚</span></span><br><span class="line"><span class="comment"># ä¸è¦å°†å…¶è®¾ç½®å¤§äºä½ å¯ç”¨å†…å­˜çš„ 30%ï¼Œå› ä¸ºä¸€éƒ¨åˆ†å†…å­˜åŒæ ·è¢« OS ç”¨æ¥ç¼“å†²è¡Œæ•°æ®</span></span><br><span class="line"><span class="comment"># ç”šè‡³åœ¨ä½ å¹¶ä¸ä½¿ç”¨ MyISAM è¡¨çš„æƒ…å†µä¸‹ï¼Œä½ ä¹Ÿéœ€è¦ä»æ—§è®¾ç½®èµ· 8-64M å†…å­˜ç”±äºå®ƒåŒæ ·ä¼šè¢«å†…éƒ¨ä¸´æ—¶ç£ç›˜è¡¨ä½¿ç”¨ã€‚</span></span><br><span class="line"><span class="comment"># é»˜è®¤å€¼ 8Mï¼Œå»ºè®®å€¼ï¼šå¯¹äºå†…å­˜åœ¨ 4GB å·¦å³çš„æœåŠ¡å™¨è¯¥å‚æ•°å¯è®¾ç½®ä¸º 256M æˆ– 384Mã€‚æ³¨æ„ï¼šè¯¥å‚æ•°å€¼è®¾ç½®çš„è¿‡å¤§åè€Œä¼šæ˜¯æœåŠ¡å™¨æ•´ä½“æ•ˆç‡é™ä½ï¼</span></span><br><span class="line"><span class="attr">key_buffer_size</span> = <span class="number">64</span>M</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¸ºæ¯ä¸ªæ‰«æ MyISAM çš„çº¿ç¨‹åˆ†é…å‚æ•°è®¾ç½®çš„å†…å­˜å¤§å°ç¼“å†²åŒºã€‚</span></span><br><span class="line"><span class="comment"># é»˜è®¤å€¼ 128kbï¼Œå»ºè®®å€¼ï¼š16G å†…å­˜å»ºè®® 1Mï¼Œ4Gï¼š128kb æˆ–è€… 256kb å§</span></span><br><span class="line"><span class="comment"># æ³¨æ„ï¼Œè¯¥ç¼“å†²åŒºæ˜¯æ¯ä¸ªè¿æ¥ç‹¬å çš„ï¼Œæ‰€ä»¥æ€»ç¼“å†²åŒºå¤§å°ä¸º 128kb *è¿æ¥æ•°ï¼›æç«¯æƒ…å†µ 128kb*maxconnectiosnsï¼Œä¼šè¶…çº§å¤§ï¼Œæ‰€ä»¥è¦è€ƒè™‘æ—¥å¸¸å¹³å‡è¿æ¥æ•°ã€‚</span></span><br><span class="line"><span class="comment"># ä¸€èˆ¬ä¸éœ€è¦å¤ªå…³å¿ƒè¯¥æ•°å€¼ï¼Œç¨å¾®å¢å¤§å°±å¯ä»¥äº†ï¼Œ</span></span><br><span class="line"><span class="attr">read_buffer_size</span> = <span class="number">262144</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ”¯æŒä»»ä½•å­˜å‚¨å¼•æ“</span></span><br><span class="line"><span class="comment"># MySQL çš„éšæœºè¯»ç¼“å†²åŒºå¤§å°ï¼Œé€‚å½“å¢å¤§ï¼Œå¯ä»¥æé«˜æ€§èƒ½ã€‚</span></span><br><span class="line"><span class="comment"># é»˜è®¤å€¼ 256kbï¼›å»ºè®®å€¼ï¼šå¾—å‚è€ƒè¿æ¥æ•°ï¼Œ16G å†…å­˜ï¼Œæœ‰äººæ¨è 8M</span></span><br><span class="line"><span class="comment"># æ³¨æ„ï¼Œè¯¥ç¼“å†²åŒºæ˜¯æ¯ä¸ªè¿æ¥ç‹¬å çš„ï¼Œæ‰€ä»¥æ€»ç¼“å†²åŒºå¤§å°ä¸º 128kb *è¿æ¥æ•°ï¼›æç«¯æƒ…å†µ 128kb*maxconnectiosnsï¼Œä¼šè¶…çº§å¤§ï¼Œæ‰€ä»¥è¦è€ƒè™‘æ—¥å¸¸å¹³å‡è¿æ¥æ•°ã€‚</span></span><br><span class="line"><span class="attr">read_rnd_buffer_size</span> = <span class="number">1</span>M</span><br><span class="line"></span><br><span class="line"><span class="comment"># order by æˆ– group by æ—¶ç”¨åˆ°</span></span><br><span class="line"><span class="comment"># æ”¯æŒæ‰€æœ‰å¼•æ“ï¼Œinnodb å’Œ myisam æœ‰è‡ªå·±çš„ innodb_sort_buffer_size å’Œ myisam_sort_buffer_size è®¾ç½®</span></span><br><span class="line"><span class="comment"># é»˜è®¤å€¼ 256kbï¼›å»ºè®®å€¼ï¼šå¾—å‚è€ƒè¿æ¥æ•°ï¼Œ16G å†…å­˜ï¼Œæœ‰äººæ¨è 8Mã€‚</span></span><br><span class="line"><span class="comment"># æ³¨æ„ï¼Œè¯¥ç¼“å†²åŒºæ˜¯æ¯ä¸ªè¿æ¥ç‹¬å çš„ï¼Œæ‰€ä»¥æ€»ç¼“å†²åŒºå¤§å°ä¸º 1M *è¿æ¥æ•°ï¼›æç«¯æƒ…å†µ 1M*maxconnectiosnsï¼Œä¼šè¶…çº§å¤§ã€‚æ‰€ä»¥è¦è€ƒè™‘æ—¥å¸¸å¹³å‡è¿æ¥æ•°ã€‚</span></span><br><span class="line"><span class="attr">sort_buffer_size</span> = <span class="number">1</span>M</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ­¤ç¼“å†²è¢«ä½¿ç”¨æ¥ä¼˜åŒ–å…¨è”åˆ (full JOINs ä¸å¸¦ç´¢å¼•çš„è”åˆï¼‰</span></span><br><span class="line"><span class="comment"># ç±»ä¼¼çš„è”åˆåœ¨æå¤§å¤šæ•°æƒ…å†µä¸‹æœ‰éå¸¸ç³Ÿç³•çš„æ€§èƒ½è¡¨ç°ï¼Œä½†æ˜¯å°†æ­¤å€¼è®¾å¤§èƒ½å¤Ÿå‡è½»æ€§èƒ½å½±å“ã€‚</span></span><br><span class="line"><span class="comment"># é€šè¿‡ â€œSelect_full_joinâ€ çŠ¶æ€å˜é‡æŸ¥çœ‹å…¨è”åˆçš„æ•°é‡</span></span><br><span class="line"><span class="comment"># æ³¨æ„ï¼Œè¯¥ç¼“å†²åŒºæ˜¯æ¯ä¸ªè¿æ¥ç‹¬å çš„ï¼Œæ‰€ä»¥æ€»ç¼“å†²åŒºå¤§å°ä¸º 1M *è¿æ¥æ•°ï¼›æç«¯æƒ…å†µ 1M*maxconnectiosnsï¼Œä¼šè¶…çº§å¤§ã€‚æ‰€ä»¥è¦è€ƒè™‘æ—¥å¸¸å¹³å‡è¿æ¥æ•°ã€‚</span></span><br><span class="line"><span class="comment"># é»˜è®¤å€¼ 256kb; å»ºè®®å€¼ï¼š16G å†…å­˜ï¼Œè®¾ç½® 8Mã€‚</span></span><br><span class="line"><span class="attr">join_buffer_size</span> = <span class="number">1</span>M</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç¼“å­˜ linux æ–‡ä»¶æè¿°ç¬¦ä¿¡æ¯ï¼ŒåŠ å¿«æ•°æ®æ–‡ä»¶æ‰“å¼€é€Ÿåº¦</span></span><br><span class="line"><span class="comment"># å®ƒå½±å“ myisam è¡¨çš„æ‰“å¼€å…³é—­ï¼Œä½†æ˜¯ä¸å½±å“ innodb è¡¨çš„æ‰“å¼€å…³é—­ã€‚</span></span><br><span class="line"><span class="comment"># é»˜è®¤å€¼ 2000ï¼Œå»ºè®®å€¼ï¼šæ ¹æ®çŠ¶æ€å˜é‡ Opened_tables å»è®¾å®š</span></span><br><span class="line"><span class="attr">table_open_cache</span> = <span class="number">2000</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ç¼“å­˜è¡¨å®šä¹‰çš„ç›¸å…³ä¿¡æ¯ï¼ŒåŠ å¿«è¯»å–è¡¨ä¿¡æ¯é€Ÿåº¦</span></span><br><span class="line"><span class="comment"># é»˜è®¤å€¼ 1400ï¼Œæœ€å¤§å€¼ 2000ï¼Œå»ºè®®å€¼ï¼šåŸºæœ¬ä¸æ”¹ã€‚</span></span><br><span class="line"><span class="attr">table_definition_cache</span> = <span class="number">1400</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è¯¥å‚æ•°æ˜¯ myssql 5.6 åå¼•å…¥çš„ï¼Œç›®çš„æ˜¯æé«˜å¹¶å‘ã€‚</span></span><br><span class="line"><span class="comment"># é»˜è®¤å€¼ 1ï¼Œå»ºè®®å€¼ï¼šcpu æ ¸æ•°ï¼Œå¹¶ä¸”&lt;=16</span></span><br><span class="line"><span class="attr">table_open_cache_instances</span> = <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å½“å®¢æˆ·ç«¯æ–­å¼€ä¹‹åï¼ŒæœåŠ¡å™¨å¤„ç†æ­¤å®¢æˆ·çš„çº¿ç¨‹å°†ä¼šç¼“å­˜èµ·æ¥ä»¥å“åº”ä¸‹ä¸€ä¸ªå®¢æˆ·è€Œä¸æ˜¯é”€æ¯ã€‚å¯é‡ç”¨ï¼Œå‡å°äº†ç³»ç»Ÿå¼€é”€ã€‚</span></span><br><span class="line"><span class="comment"># é»˜è®¤å€¼ä¸º 9ï¼Œå»ºè®®å€¼ï¼šä¸¤ç§å–å€¼æ–¹å¼ï¼Œæ–¹å¼ä¸€ï¼Œæ ¹æ®ç‰©ç†å†…å­˜ï¼Œ1G â€”&gt; 8ï¼›2G â€”&gt; 16ï¼› 3G â€”&gt; 32ï¼› &gt;3G â€”&gt; 64ï¼›</span></span><br><span class="line"><span class="comment"># æ–¹å¼äºŒï¼Œæ ¹æ® show status like &#x27;threads%&#x27;ï¼ŒæŸ¥çœ‹ Threads_connected å€¼ã€‚</span></span><br><span class="line"><span class="attr">thread_cache_size</span> = <span class="number">16</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># é»˜è®¤å€¼ 256kï¼Œå»ºè®®å€¼ï¼š16/32G å†…å­˜ï¼Œ512kbï¼Œå…¶ä»–ä¸€èˆ¬ä¸æ”¹å˜ï¼Œå¦‚æœæŠ¥é”™ï¼šThread stack overrunï¼Œå°±å¢å¤§çœ‹çœ‹ï¼Œ</span></span><br><span class="line"><span class="comment"># æ³¨æ„ï¼Œæ¯ä¸ªçº¿ç¨‹åˆ†é…å†…å­˜ç©ºé—´ï¼Œæ‰€ä»¥æ€»å†…å­˜ç©ºé—´ã€‚ä½ æ‡‚å¾—ã€‚</span></span><br><span class="line"><span class="attr">thread_stack</span> = <span class="number">512</span>k</span><br><span class="line"></span><br><span class="line"><span class="section">[client]</span></span><br><span class="line"><span class="attr">socket</span>  = /var/lib/mysql/mysql.sock</span><br><span class="line"><span class="attr">port</span> = <span class="number">3306</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p>GENERAL</p>
<ul>
<li><code>datadir</code> - mysql æ•°æ®æ–‡ä»¶æ‰€åœ¨ç›®å½•</li>
<li><code>socket</code> - scoket æ–‡ä»¶</li>
<li><code>pid_file</code> - PID æ–‡ä»¶</li>
<li><code>user</code> - å¯åŠ¨ mysql æœåŠ¡è¿›ç¨‹çš„ç”¨æˆ·</li>
<li><code>port</code> - æœåŠ¡ç«¯å£å·ï¼Œé»˜è®¤ <code>3306</code></li>
<li><code>default_storage_engine</code> - mysql 5.1 ä¹‹åï¼Œé»˜è®¤å¼•æ“æ˜¯ InnoDB</li>
<li><code>default_time_zone</code> - é»˜è®¤æ—¶åŒºã€‚ä¸­å›½å¤§éƒ¨åˆ†åœ°åŒºåœ¨ä¸œå…«åŒºï¼Œå³ <code>+8:00</code></li>
<li><code>character_set_server</code> - æ•°æ®åº“é»˜è®¤å­—ç¬¦é›†</li>
<li><code>collation_server</code> - æ•°æ®åº“å­—ç¬¦é›†å¯¹åº”ä¸€äº›æ’åºç­‰è§„åˆ™ï¼Œæ³¨æ„è¦å’Œ <code>character_set_server</code> å¯¹åº”</li>
</ul>
</li>
<li><p>LOG</p>
<ul>
<li><code>log_error</code> - é”™è¯¯æ—¥å¿—æ–‡ä»¶åœ°å€</li>
<li><code>slow_query_log</code> - é”™è¯¯æ—¥å¿—æ–‡ä»¶åœ°å€</li>
</ul>
</li>
<li><p>InnoDB</p>
<ul>
<li><code>innodb_buffer_pool_size</code> - InnoDB ä½¿ç”¨ä¸€ä¸ªç¼“å†²æ± æ¥ä¿å­˜ç´¢å¼•å’ŒåŸå§‹æ•°æ®ï¼Œä¸åƒ MyISAMã€‚è¿™é‡Œä½ è®¾ç½®è¶Šå¤§ï¼Œä½ åœ¨å­˜å–è¡¨é‡Œé¢æ•°æ®æ—¶æ‰€éœ€è¦çš„ç£ç›˜ I&#x2F;O è¶Šå°‘ã€‚<ul>
<li>åœ¨ä¸€ä¸ªç‹¬ç«‹ä½¿ç”¨çš„æ•°æ®åº“æœåŠ¡å™¨ä¸Šï¼Œä½ å¯ä»¥è®¾ç½®è¿™ä¸ªå˜é‡åˆ°æœåŠ¡å™¨ç‰©ç†å†…å­˜å¤§å°çš„ 60%-80%</li>
<li>æ³¨æ„åˆ«è®¾ç½®çš„è¿‡å¤§ï¼Œä¼šå¯¼è‡´ system çš„ swap ç©ºé—´è¢«å ç”¨ï¼Œå¯¼è‡´æ“ä½œç³»ç»Ÿå˜æ…¢ï¼Œä»è€Œå‡ä½ sql æŸ¥è¯¢çš„æ•ˆç‡</li>
<li>é»˜è®¤å€¼ï¼š128Mï¼Œå»ºè®®å€¼ï¼šç‰©ç†å†…å­˜çš„ 60%-80%</li>
</ul>
</li>
<li><code>innodb_log_file_size</code> - æ—¥å¿—æ–‡ä»¶çš„å¤§å°ã€‚é»˜è®¤å€¼ï¼š48Mï¼Œå»ºè®®å€¼ï¼šæ ¹æ®ä½ ç³»ç»Ÿçš„ç£ç›˜ç©ºé—´å’Œæ—¥å¿—å¢é•¿æƒ…å†µè°ƒæ•´å¤§å°</li>
<li><code>innodb_file_per_table</code> - è¯´æ˜ï¼šmysql5.7 ä¹‹åé»˜è®¤å¼€å¯ï¼Œæ„æ€æ˜¯ï¼Œæ¯å¼ è¡¨ä¸€ä¸ªç‹¬ç«‹è¡¨ç©ºé—´ã€‚é»˜è®¤å€¼ 1ï¼Œå¼€å¯ã€‚</li>
<li><code>innodb_flush_method</code> - è¯´æ˜ï¼šæ§åˆ¶ç€ innodb æ•°æ®æ–‡ä»¶åŠ redo log çš„æ‰“å¼€ã€åˆ·å†™æ¨¡å¼ï¼Œä¸‰ç§æ¨¡å¼ï¼šfdatasyncï¼ˆé»˜è®¤ï¼‰ï¼ŒO_DSYNCï¼ŒO_DIRECTã€‚é»˜è®¤å€¼ä¸ºç©ºï¼Œå»ºè®®å€¼ï¼šä½¿ç”¨ SAN æˆ–è€… raidï¼Œå»ºè®®ç”¨ O_DIRECTï¼Œä¸æ‡‚æµ‹è¯•çš„è¯ï¼Œé»˜è®¤ç”Ÿäº§ä¸Šä½¿ç”¨ O_DIRECT<ul>
<li><code>fdatasync</code>ï¼šæ•°æ®æ–‡ä»¶ï¼Œbuffer pool-&gt;os buffer-&gt;ç£ç›˜ï¼›æ—¥å¿—æ–‡ä»¶ï¼Œbuffer pool-&gt;os buffer-&gt;ç£ç›˜ï¼›</li>
<li><code>O_DSYNC</code>ï¼š æ•°æ®æ–‡ä»¶ï¼Œbuffer pool-&gt;os buffer-&gt;ç£ç›˜ï¼›æ—¥å¿—æ–‡ä»¶ï¼Œbuffer pool-&gt;ç£ç›˜ï¼›</li>
<li><code>O_DIRECT</code>ï¼š æ•°æ®æ–‡ä»¶ï¼Œbuffer pool-&gt;ç£ç›˜ï¼› æ—¥å¿—æ–‡ä»¶ï¼Œbuffer pool-&gt;os buffer-&gt;ç£ç›˜ï¼›</li>
</ul>
</li>
</ul>
</li>
<li><p>MyIsam</p>
<ul>
<li><code>key_buffer_size</code> - æŒ‡å®šç´¢å¼•ç¼“å†²åŒºçš„å¤§å°ï¼Œä¸º MYISAM æ•°æ®è¡¨å¼€å¯ä¾›çº¿ç¨‹å…±äº«çš„ç´¢å¼•ç¼“å­˜ï¼Œå¯¹ INNODB å¼•æ“æ— æ•ˆã€‚ç›¸å½“å½±å“ MyISAM çš„æ€§èƒ½ã€‚<ul>
<li>ä¸è¦å°†å…¶è®¾ç½®å¤§äºä½ å¯ç”¨å†…å­˜çš„ 30%ï¼Œå› ä¸ºä¸€éƒ¨åˆ†å†…å­˜åŒæ ·è¢« OS ç”¨æ¥ç¼“å†²è¡Œæ•°æ®</li>
<li>ç”šè‡³åœ¨ä½ å¹¶ä¸ä½¿ç”¨ MyISAM è¡¨çš„æƒ…å†µä¸‹ï¼Œä½ ä¹Ÿéœ€è¦ä»æ—§è®¾ç½®èµ· 8-64M å†…å­˜ç”±äºå®ƒåŒæ ·ä¼šè¢«å†…éƒ¨ä¸´æ—¶ç£ç›˜è¡¨ä½¿ç”¨ã€‚</li>
<li>é»˜è®¤å€¼ 8Mï¼Œå»ºè®®å€¼ï¼šå¯¹äºå†…å­˜åœ¨ 4GB å·¦å³çš„æœåŠ¡å™¨è¯¥å‚æ•°å¯è®¾ç½®ä¸º 256M æˆ– 384Mã€‚</li>
<li>æ³¨æ„ï¼šè¯¥å‚æ•°å€¼è®¾ç½®çš„è¿‡å¤§åè€Œä¼šæ˜¯æœåŠ¡å™¨æ•´ä½“æ•ˆç‡é™ä½ï¼</li>
</ul>
</li>
</ul>
</li>
<li><p>OTHER</p>
<ul>
<li><code>tmp_table_size</code> - å†…å­˜ä¸´æ—¶è¡¨çš„æœ€å¤§å€¼ï¼Œé»˜è®¤ 16Mï¼Œæ­¤å¤„è®¾ç½®æˆ 128M</li>
<li><code>max_heap_table_size</code> - ç”¨æˆ·åˆ›å»ºçš„å†…å­˜è¡¨çš„å¤§å°ï¼Œé»˜è®¤ 16Mï¼Œå¾€å¾€å’Œ <code>tmp_table_size</code> ä¸€èµ·è®¾ç½®ï¼Œé™åˆ¶ç”¨æˆ·ä¸´æ—¶è¡¨å¤§å°ã€‚è¶…é™çš„è¯ï¼ŒMySQL å°±ä¼šè‡ªåŠ¨åœ°æŠŠå®ƒè½¬åŒ–ä¸ºåŸºäºç£ç›˜çš„ MyISAM è¡¨ï¼Œå­˜å‚¨åœ¨æŒ‡å®šçš„ tmpdir ç›®å½•ä¸‹ï¼Œå¢å¤§ IO å‹åŠ›ï¼Œå»ºè®®å†…å­˜å¤§ï¼Œå¢å¤§è¯¥æ•°å€¼ã€‚</li>
<li><code>query_cache_type</code> - è¿™ä¸ªç³»ç»Ÿå˜é‡æ§åˆ¶ç€æŸ¥è¯¢ç¼“å­˜åŠŸèƒ½çš„å¼€å¯å’Œå…³é—­ï¼Œ0 è¡¨ç¤ºå…³é—­ï¼Œ1 è¡¨ç¤ºæ‰“å¼€ï¼Œ2 è¡¨ç¤ºåªè¦ <code>select</code> ä¸­æ˜ç¡®æŒ‡å®š <code>SQL_CACHE</code> æ‰ç¼“å­˜ã€‚</li>
<li><code>query_cache_size</code> - é»˜è®¤å€¼ 1Mï¼Œä¼˜ç‚¹æ˜¯æŸ¥è¯¢ç¼“å­˜å¯ä»¥æå¤§çš„æé«˜æœåŠ¡å™¨é€Ÿåº¦ï¼Œå¦‚æœä½ æœ‰å¤§é‡çš„ç›¸åŒçš„æŸ¥è¯¢å¹¶ä¸”å¾ˆå°‘ä¿®æ”¹è¡¨ã€‚ç¼ºç‚¹ï¼šåœ¨ä½ è¡¨ç»å¸¸å˜åŒ–çš„æƒ…å†µä¸‹æˆ–è€…å¦‚æœä½ çš„æŸ¥è¯¢åŸæ–‡æ¯æ¬¡éƒ½ä¸åŒï¼ŒæŸ¥è¯¢ç¼“å­˜ä¹Ÿè®¸å¼•èµ·æ€§èƒ½ä¸‹é™è€Œä¸æ˜¯æ€§èƒ½æå‡ã€‚</li>
<li><code>max_connections</code> - æœ€å¤§è¿æ¥æ•°ï¼Œå¯è®¾æœ€å¤§å€¼ 16384ï¼Œä¸€èˆ¬è€ƒè™‘æ ¹æ®åŒæ—¶åœ¨çº¿äººæ•°è®¾ç½®ä¸€ä¸ªæ¯”è¾ƒç»¼åˆçš„æ•°å­—ï¼Œé‰´äºè¯¥æ•°å€¼å¢å¤§å¹¶ä¸å¤ªæ¶ˆè€—ç³»ç»Ÿèµ„æºï¼Œå»ºè®®ç›´æ¥è®¾ 10000ã€‚å¦‚æœåœ¨è®¿é—®æ—¶ç»å¸¸å‡ºç° Too Many Connections çš„é”™è¯¯æç¤ºï¼Œåˆ™éœ€è¦å¢å¤§è¯¥å‚æ•°å€¼</li>
<li><code>thread_cache</code> - å½“å®¢æˆ·ç«¯æ–­å¼€ä¹‹åï¼ŒæœåŠ¡å™¨å¤„ç†æ­¤å®¢æˆ·çš„çº¿ç¨‹å°†ä¼šç¼“å­˜èµ·æ¥ä»¥å“åº”ä¸‹ä¸€ä¸ªå®¢æˆ·è€Œä¸æ˜¯é”€æ¯ã€‚å¯é‡ç”¨ï¼Œå‡å°äº†ç³»ç»Ÿå¼€é”€ã€‚é»˜è®¤å€¼ä¸º 9ï¼Œå»ºè®®å€¼ï¼šä¸¤ç§å–å€¼æ–¹å¼ï¼Œ<ul>
<li>æ–¹å¼ä¸€ï¼Œæ ¹æ®ç‰©ç†å†…å­˜ï¼Œ1G â€”&gt; 8ï¼›2G â€”&gt; 16ï¼› 3G â€”&gt; 32ï¼› &gt;3G â€”&gt; 64ï¼›</li>
<li>æ–¹å¼äºŒï¼Œæ ¹æ® show status like â€˜threads%â€™ï¼ŒæŸ¥çœ‹ Threads_connected å€¼ã€‚</li>
</ul>
</li>
<li><code>open_files_limit</code> - MySQL æ‰“å¼€çš„æ–‡ä»¶æè¿°ç¬¦é™åˆ¶ï¼Œé»˜è®¤æœ€å° 1024;<ul>
<li>å½“ open_files_limit æ²¡æœ‰è¢«é…ç½®çš„æ—¶å€™ï¼Œæ¯”è¾ƒ max_connections*5 å’Œ ulimit -n çš„å€¼ï¼Œå“ªä¸ªå¤§ç”¨å“ªä¸ªï¼Œ</li>
<li>å½“ open_file_limit è¢«é…ç½®çš„æ—¶å€™ï¼Œæ¯”è¾ƒ open_files_limit å’Œ max_connections*5 çš„å€¼ï¼Œå“ªä¸ªå¤§ç”¨å“ªä¸ª</li>
<li>æ³¨æ„ï¼šä»ç„¶å¯èƒ½å‡ºç°æŠ¥é”™ä¿¡æ¯ Canâ€™t create a new threadï¼›æ­¤æ—¶è§‚å¯Ÿç³»ç»Ÿ <code>cat /proc/mysql</code> è¿›ç¨‹å·&#x2F;limitsï¼Œè§‚å¯Ÿè¿›ç¨‹ ulimit é™åˆ¶æƒ…å†µ</li>
<li>è¿‡å°çš„è¯ï¼Œè€ƒè™‘ä¿®æ”¹ç³»ç»Ÿé…ç½®è¡¨ï¼Œ<code>/etc/security/limits.conf</code> å’Œ <code>/etc/security/limits.d/90-nproc.conf</code></li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="MySQL-FAQ"><a href="#MySQL-FAQ" class="headerlink" title="MySQL FAQ"></a>MySQL FAQ</h2><h3 id="Too-many-connections"><a href="#Too-many-connections" class="headerlink" title="Too many connections"></a>Too many connections</h3><p><strong>ç°è±¡</strong></p>
<p>å°è¯•è¿æ¥ MySQL æ—¶ï¼Œé‡åˆ° <code>Too many connections</code> é”™è¯¯ã€‚</p>
<p><strong>åŸå› </strong></p>
<p>æ•°æ®åº“è¿æ¥çº¿ç¨‹æ•°è¶…è¿‡æœ€å¤§å€¼ï¼Œè®¿é—®è¢«æ‹’ç»ã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong></p>
<p>å¦‚æœå®é™…è¿æ¥çº¿ç¨‹æ•°è¿‡å¤§ï¼Œå¯ä»¥è€ƒè™‘å¢åŠ æœåŠ¡å™¨èŠ‚ç‚¹æ¥åˆ†æµï¼›å¦‚æœå®é™…çº¿ç¨‹æ•°å¹¶ä¸ç®—è¿‡å¤§ï¼Œé‚£ä¹ˆå¯ä»¥é…ç½® <code>max_connections</code> æ¥å¢åŠ å…è®¸çš„æœ€å¤§è¿æ¥æ•°ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿æ¥æ•°ä¸å®œè¿‡å¤§ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œå•åº“æ¯ç§’æœ‰ 2000 ä¸ªå¹¶å‘è¿æ¥æ—¶ï¼Œå°±å¯ä»¥è€ƒè™‘æ‰©å®¹äº†ï¼Œå¥åº·çš„çŠ¶æ€åº”è¯¥ç»´æŒåœ¨æ¯ç§’ 1000 ä¸ªå¹¶å‘è¿æ¥å·¦å³ã€‚</p>
<p>ï¼ˆ1ï¼‰æŸ¥çœ‹æœ€å¤§è¿æ¥æ•°</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">show</span> variables <span class="keyword">like</span> <span class="string">&#x27;%max_connections%&#x27;</span>;</span><br><span class="line"><span class="operator">+</span><span class="comment">------------------------+-------+</span></span><br><span class="line"><span class="operator">|</span> Variable_name          <span class="operator">|</span> <span class="keyword">Value</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------------------+-------+</span></span><br><span class="line"><span class="operator">|</span> max_connections        <span class="operator">|</span> <span class="number">151</span>   <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> mysqlx_max_connections <span class="operator">|</span> <span class="number">100</span>   <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------------------+-------+</span></span><br></pre></td></tr></table></figure>

<p>ï¼ˆ2ï¼‰æŸ¥çœ‹æœåŠ¡å™¨å“åº”çš„æœ€å¤§è¿æ¥æ•°</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">show</span> <span class="keyword">global</span> status <span class="keyword">like</span> <span class="string">&#x27;Max_used_connections&#x27;</span>;</span><br><span class="line"><span class="operator">+</span><span class="comment">----------------------+-------+</span></span><br><span class="line"><span class="operator">|</span> Variable_name        <span class="operator">|</span> <span class="keyword">Value</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------------------+-------+</span></span><br><span class="line"><span class="operator">|</span> Max_used_connections <span class="operator">|</span> <span class="number">142</span>   <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------------------+-------+</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure>

<p>ï¼ˆ3ï¼‰ä¸´æ—¶è®¾ç½®æœ€å¤§è¿æ¥æ•°</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span> <span class="keyword">GLOBAL</span> max_connections<span class="operator">=</span><span class="number">256</span>;</span><br></pre></td></tr></table></figure>

<p>æ³¨æ„ï¼šå½“æœåŠ¡å™¨é‡å¯æ—¶ï¼Œæœ€å¤§è¿æ¥æ•°ä¼šè¢«é‡ç½®ã€‚</p>
<p>ï¼ˆ4ï¼‰æ°¸ä¹…è®¾ç½®æœ€å¤§è¿æ¥æ•°</p>
<p>ä¿®æ”¹ <code>/etc/my.cnf</code> é…ç½®æ–‡ä»¶ï¼Œåœ¨ <code>[mysqld]</code> æ·»åŠ ä»¥ä¸‹é…ç½®ï¼š</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">max_connections<span class="operator">=</span><span class="number">256</span></span><br></pre></td></tr></table></figure>

<p>é‡å¯ mysql ä»¥ç”Ÿæ•ˆ</p>
<p>ï¼ˆ5ï¼‰ä¿®æ”¹ Linux æœ€å¤§æ–‡ä»¶æ•°é™åˆ¶</p>
<p>è®¾ç½®äº†æœ€å¤§è¿æ¥æ•°ï¼Œå¦‚æœè¿˜æ˜¯æ²¡æœ‰ç”Ÿæ•ˆï¼Œè€ƒè™‘æ£€æŸ¥ä¸€ä¸‹ Linux æœ€å¤§æ–‡ä»¶æ•°</p>
<p>MySQL æœ€å¤§è¿æ¥æ•°ä¼šå—åˆ°æœ€å¤§æ–‡ä»¶æ•°é™åˆ¶ï¼Œ<code>vim /etc/security/limits.conf</code>ï¼Œæ·»åŠ  mysql ç”¨æˆ·é…ç½®</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">mysql</span> hard nofile <span class="number">65535</span></span><br><span class="line"><span class="attribute">mysql</span> soft nofile <span class="number">65535</span></span><br></pre></td></tr></table></figure>

<p>ï¼ˆ6ï¼‰æ£€æŸ¥ LimitNOFILE</p>
<p>å¦‚æœæ˜¯ä½¿ç”¨ rpm æ–¹å¼å®‰è£… mysqlï¼Œæ£€æŸ¥ <strong>mysqld.service</strong> æ–‡ä»¶ä¸­çš„ <code>LimitNOFILE</code> æ˜¯å¦é…ç½®çš„å¤ªå°ã€‚</p>
<h3 id="æ—¶åŒºï¼ˆtime-zoneï¼‰åå·®"><a href="#æ—¶åŒºï¼ˆtime-zoneï¼‰åå·®" class="headerlink" title="æ—¶åŒºï¼ˆtime_zoneï¼‰åå·®"></a>æ—¶åŒºï¼ˆtime_zoneï¼‰åå·®</h3><p><strong>ç°è±¡</strong></p>
<p>æ•°æ®åº“ä¸­å­˜å‚¨çš„ Timestamp å­—æ®µå€¼æ¯”çœŸå®å€¼å°‘äº† 13 ä¸ªå°æ—¶ã€‚</p>
<p><strong>åŸå› </strong></p>
<ul>
<li>å½“ JDBC ä¸ MySQL å¼€å§‹å»ºç«‹è¿æ¥æ—¶ï¼Œä¼šè·å–æœåŠ¡å™¨å‚æ•°ã€‚</li>
<li>å½“ MySQL çš„ <code>time_zone</code> å€¼ä¸º <code>SYSTEM</code> æ—¶ï¼Œä¼šå– <code>system_time_zone</code> å€¼ä½œä¸ºåè°ƒæ—¶åŒºï¼Œè‹¥å¾—åˆ°çš„æ˜¯ <code>CST</code> é‚£ä¹ˆ Java ä¼šè¯¯ä»¥ä¸ºè¿™æ˜¯ <code>CST -0500</code> ï¼Œå› æ­¤ä¼šç»™å‡ºé”™è¯¯çš„æ—¶åŒºä¿¡æ¯ï¼ˆå›½å†…ä¸€èˆ¬æ˜¯<code>CST +0800</code>ï¼Œå³ä¸œå…«åŒºï¼‰ã€‚</li>
</ul>
<p>æŸ¥çœ‹æ—¶åŒºæ–¹æ³•ï¼š</p>
<p>é€šè¿‡ <code>show variables like &#39;%time_zone%&#39;;</code> å‘½ä»¤æŸ¥çœ‹ MySQL æ—¶åŒºé…ç½®ï¼š</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">show</span> variables <span class="keyword">like</span> <span class="string">&#x27;%time_zone%&#x27;</span>;</span><br><span class="line"><span class="operator">+</span><span class="comment">------------------+--------+</span></span><br><span class="line"><span class="operator">|</span> Variable_name    <span class="operator">|</span> <span class="keyword">Value</span>  <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------------+--------+</span></span><br><span class="line"><span class="operator">|</span> system_time_zone <span class="operator">|</span> CST    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> time_zone        <span class="operator">|</span> <span class="keyword">SYSTEM</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------------+--------+</span></span><br></pre></td></tr></table></figure>

<p><strong>è§£å†³æ–¹æ¡ˆ</strong></p>
<p>æ–¹æ¡ˆä¸€</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">set</span> <span class="keyword">global</span> time_zone <span class="operator">=</span> <span class="string">&#x27;+08:00&#x27;</span>;</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">set</span> time_zone <span class="operator">=</span> <span class="string">&#x27;+08:00&#x27;</span>;</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure>

<p>æ–¹æ¡ˆäºŒ</p>
<p>ä¿®æ”¹ <code>my.cnf</code> æ–‡ä»¶ï¼Œåœ¨ <code>[mysqld]</code> èŠ‚ä¸‹å¢åŠ  <code>default-time-zone=&#39;+08:00&#39;</code> ï¼Œç„¶åé‡å¯ã€‚</p>
<h3 id="æ•°æ®è¡¨æŸåå¦‚ä½•ä¿®å¤"><a href="#æ•°æ®è¡¨æŸåå¦‚ä½•ä¿®å¤" class="headerlink" title="æ•°æ®è¡¨æŸåå¦‚ä½•ä¿®å¤"></a>æ•°æ®è¡¨æŸåå¦‚ä½•ä¿®å¤</h3><p>ä½¿ç”¨ myisamchk æ¥ä¿®å¤ï¼Œå…·ä½“æ­¥éª¤ï¼š</p>
<ol>
<li>ä¿®å¤å‰å°† mysql æœåŠ¡åœæ­¢ã€‚</li>
<li>æ‰“å¼€å‘½ä»¤è¡Œæ–¹å¼ï¼Œç„¶åè¿›å…¥åˆ° mysql çš„ <code>bin</code> ç›®å½•ã€‚</li>
<li>æ‰§è¡Œ myisamchk â€“recover æ•°æ®åº“æ‰€åœ¨è·¯ &#x2F;*.MYI</li>
</ol>
<p>ä½¿ç”¨ repair table æˆ–è€… OPTIMIZE table å‘½ä»¤æ¥ä¿®å¤ï¼ŒREPAIR TABLE table_name ä¿®å¤è¡¨ OPTIMIZE TABLE table_name ä¼˜åŒ–è¡¨ REPAIR TABLE ç”¨äºä¿®å¤è¢«ç ´åçš„è¡¨ã€‚ OPTIMIZE TABLE ç”¨äºå›æ”¶é—²ç½®çš„æ•°æ®åº“ç©ºé—´ï¼Œå½“è¡¨ä¸Šçš„æ•°æ®è¡Œè¢«åˆ é™¤æ—¶ï¼Œæ‰€å æ®çš„ç£ç›˜ç©ºé—´å¹¶æ²¡æœ‰ç«‹å³è¢«å›æ”¶ï¼Œä½¿ç”¨äº† OPTIMIZE TABLE å‘½ä»¤åè¿™äº›ç©ºé—´å°†è¢«å›æ”¶ï¼Œå¹¶ä¸”å¯¹ç£ç›˜ä¸Šçš„æ•°æ®è¡Œè¿›è¡Œé‡æ’ï¼ˆæ³¨æ„ï¼šæ˜¯ç£ç›˜ä¸Šï¼Œè€Œéæ•°æ®åº“ï¼‰</p>
<h3 id="æ•°æ®ç»“æ„"><a href="#æ•°æ®ç»“æ„" class="headerlink" title="æ•°æ®ç»“æ„"></a>æ•°æ®ç»“æ„</h3><blockquote>
<p>é—®é¢˜ç°è±¡ï¼šERROR 1071: Specified key was too long; max key length is 767 bytes</p>
</blockquote>
<p>é—®é¢˜åŸå› ï¼šMySQL é»˜è®¤æƒ…å†µä¸‹å•ä¸ªåˆ—çš„ç´¢å¼•ä¸èƒ½è¶…è¿‡ 767 ä½ï¼ˆä¸åŒç‰ˆæœ¬å¯èƒ½å­˜åœ¨å·®å¼‚ï¼‰ ã€‚</p>
<p>è§£å†³æ–¹æ³•ï¼šä¼˜åŒ–ç´¢å¼•ç»“æ„ï¼Œç´¢å¼•å­—æ®µä¸å®œè¿‡é•¿ã€‚</p>
<h2 id="MySQL-è¿ç»´è„šæœ¬"><a href="#MySQL-è¿ç»´è„šæœ¬" class="headerlink" title="MySQL è¿ç»´è„šæœ¬"></a>MySQL è¿ç»´è„šæœ¬</h2><p>è¿™é‡Œæ¨èæˆ‘å†™çš„å‡ ä¸ªä¸€é”®è¿ç»´è„šæœ¬ï¼Œéå¸¸æ–¹ä¾¿ï¼Œæ¬¢è¿ä½¿ç”¨ï¼š</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/dunwu/linux-tutorial/tree/master/codes/linux/soft/mysql-install.sh">MySQL å®‰è£…è„šæœ¬</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/dunwu/linux-tutorial/tree/master/codes/linux/soft/mysql-backup.sh">MySQL å¤‡ä»½è„šæœ¬</a></li>
</ul>
<h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><ul>
<li><a target="_blank" rel="noopener" href="https://book.douban.com/subject/23008813/">ã€Šé«˜æ€§èƒ½ MySQLã€‹</a></li>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/xiaopotian/p/8196464.html">https://www.cnblogs.com/xiaopotian/p/8196464.html</a></li>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/bigbrotherer/p/7241845.html">https://www.cnblogs.com/bigbrotherer/p/7241845.html</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/managementandjava/article/details/80039650">https://blog.csdn.net/managementandjava/article/details/80039650</a></li>
<li><a target="_blank" rel="noopener" href="http://www.manongjc.com/article/6996.html">http://www.manongjc.com/article/6996.html</a></li>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/xyabk/p/8967990.html">https://www.cnblogs.com/xyabk/p/8967990.html</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/zyhlwzy/article/details/80569422">MySQL 8.0 ä¸»ä»ï¼ˆMaster-Slaveï¼‰é…ç½®</a></li>
<li><a target="_blank" rel="noopener" href="https://juejin.im/post/58eb5d162f301e00624f014a">MySQL ä¸»ä»åŒæ­¥å®æˆ˜</a></li>
<li><a target="_blank" rel="noopener" href="https://juejin.im/entry/5a0aa2026fb9a045132a369f">MySQL å¤‡ä»½å’Œæ¢å¤æœºåˆ¶</a></li>
<li><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/5f39c486561b">MySQL é…ç½®æ–‡ä»¶&#x2F;etc&#x2F;my.cnf è§£æ</a></li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://dunwu.github.io/blog/pages/a2bb9482/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/blog/uploads/avatar.gif">
      <meta itemprop="name" content="é’æ‚Ÿ â—¾ Dunwu">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Dunwu Blog">
      <meta itemprop="description" content="é’æ‚Ÿçš„ä¸ªäººåšå®¢">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content=" | Dunwu Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/blog/pages/a2bb9482/" class="post-title-link" itemprop="url">iptables</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">å‘è¡¨äº</span>

      <time title="åˆ›å»ºæ—¶é—´ï¼š2019-11-25 17:25:00" itemprop="dateCreated datePublished" datetime="2019-11-25T17:25:00+08:00">2019-11-25</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">æ›´æ–°äº</span>
      <time title="ä¿®æ”¹æ—¶é—´ï¼š2025-09-13 17:56:53" itemprop="dateModified" datetime="2025-09-13T17:56:53+08:00">2025-09-13</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">åˆ†ç±»äº</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/blog/categories/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/" itemprop="url" rel="index"><span itemprop="name">æ“ä½œç³»ç»Ÿ</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/blog/categories/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/Linux/" itemprop="url" rel="index"><span itemprop="name">Linux</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/blog/categories/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/Linux/%E5%B7%A5%E5%85%B7/" itemprop="url" rel="index"><span itemprop="name">å·¥å…·</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
      <span>5k</span>
    </span>
    <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
      <span>5 åˆ†é’Ÿ</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="Iptables-åº”ç”¨"><a href="#Iptables-åº”ç”¨" class="headerlink" title="Iptables åº”ç”¨"></a>Iptables åº”ç”¨</h1><blockquote>
<p><em>iptables</em> æ˜¯ä¸€ä¸ªé…ç½® Linux å†…æ ¸ <a target="_blank" rel="noopener" href="https://wiki.archlinux.org/index.php/Firewall">é˜²ç«å¢™</a> çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œæ˜¯ <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Netfilter">netfilter</a> é¡¹ç›®çš„ä¸€éƒ¨åˆ†ã€‚ å¯ä»¥ç›´æ¥é…ç½®ï¼Œä¹Ÿå¯ä»¥é€šè¿‡è®¸å¤šå‰ç«¯å’Œå›¾å½¢ç•Œé¢é…ç½®ã€‚</p>
<p>iptables ä¹Ÿç»å¸¸ä»£æŒ‡è¯¥å†…æ ¸çº§é˜²ç«å¢™ã€‚iptables ç”¨äº <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Ipv4">ipv4</a>ï¼Œ<em>ip6tables</em> ç”¨äº <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Ipv6">ipv6</a>ã€‚</p>
<p><a target="_blank" rel="noopener" href="https://wiki.archlinux.org/index.php/Nftables">nftables</a> å·²ç»åŒ…å«åœ¨ <a target="_blank" rel="noopener" href="http://www.phoronix.com/scan.php?page=news_item&px=MTQ5MDU">Linux kernel 3.13</a> ä¸­ï¼Œä»¥åä¼šå–ä»£ iptables æˆä¸ºä¸»è¦çš„ Linux é˜²ç«å¢™å·¥å…·ã€‚</p>
<p>ç¯å¢ƒï¼šCentOS7</p>
</blockquote>
<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p><strong>iptables å¯ä»¥æ£€æµ‹ã€ä¿®æ”¹ã€è½¬å‘ã€é‡å®šå‘å’Œä¸¢å¼ƒ IPv4 æ•°æ®åŒ…</strong>ã€‚</p>
<p>è¿‡æ»¤ IPv4 æ•°æ®åŒ…çš„ä»£ç å·²ç»å†…ç½®äºå†…æ ¸ä¸­ï¼Œå¹¶ä¸”æŒ‰ç…§ä¸åŒçš„ç›®çš„è¢«ç»„ç»‡æˆ <strong>è¡¨</strong> çš„é›†åˆã€‚<strong>è¡¨</strong> ç”±ä¸€ç»„é¢„å…ˆå®šä¹‰çš„ <strong>é“¾</strong> ç»„æˆï¼Œ<strong>é“¾</strong>åŒ…å«éå†é¡ºåºè§„åˆ™ã€‚æ¯ä¸€æ¡è§„åˆ™åŒ…å«ä¸€ä¸ªè°“è¯çš„æ½œåœ¨åŒ¹é…å’Œç›¸åº”çš„åŠ¨ä½œï¼ˆç§°ä¸º <strong>ç›®æ ‡</strong>ï¼‰ï¼Œå¦‚æœè°“è¯ä¸ºçœŸï¼Œè¯¥åŠ¨ä½œä¼šè¢«æ‰§è¡Œã€‚ä¹Ÿå°±æ˜¯è¯´æ¡ä»¶åŒ¹é…ã€‚</p>
<h2 id="å®‰è£…-iptables"><a href="#å®‰è£…-iptables" class="headerlink" title="å®‰è£… iptables"></a>å®‰è£… iptables</h2><p>ï¼ˆ1ï¼‰ç¦ç”¨ firewalld</p>
<p>CentOS 7 ä¸Šé»˜è®¤å®‰è£…äº† firewalld ä½œä¸ºé˜²ç«å¢™ï¼Œä½¿ç”¨ iptables å»ºè®®å…³é—­å¹¶ç¦ç”¨ firewalldã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">systemctl stop firewalld</span><br><span class="line">systemctl <span class="built_in">disable</span> firewalld</span><br></pre></td></tr></table></figure>

<p>ï¼ˆ2ï¼‰å®‰è£… iptables</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum <span class="keyword">install</span> -y iptables-services</span><br></pre></td></tr></table></figure>

<p>ï¼ˆ3ï¼‰æœåŠ¡ç®¡ç†</p>
<ul>
<li>æŸ¥çœ‹æœåŠ¡çŠ¶æ€ï¼š<code>systemctl status iptables</code></li>
<li>å¯ç”¨æœåŠ¡ï¼š<code>systemctl enable iptables</code></li>
<li>ç¦ç”¨æœåŠ¡ï¼š<code>systemctl disable iptables</code></li>
<li>å¯åŠ¨æœåŠ¡ï¼š<code>systemctl start iptables</code></li>
<li>é‡å¯æœåŠ¡ï¼š<code>systemctl restart iptables</code></li>
<li>å…³é—­æœåŠ¡: <code>systemctl stop iptables</code></li>
</ul>
<h2 id="å‘½ä»¤"><a href="#å‘½ä»¤" class="headerlink" title="å‘½ä»¤"></a>å‘½ä»¤</h2><p>åŸºæœ¬è¯­æ³•ï¼š</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">iptables</span><span class="params">(é€‰é¡¹)</span><span class="params">(å‚æ•°)</span></span></span><br></pre></td></tr></table></figure>

<p>åŸºæœ¬é€‰é¡¹è¯´æ˜ï¼š</p>
<table>
<thead>
<tr>
<th>å‚æ•°</th>
<th>ä½œç”¨</th>
</tr>
</thead>
<tbody><tr>
<td>-P</td>
<td>è®¾ç½®é»˜è®¤ç­–ç•¥:iptables -P INPUT (DROP</td>
</tr>
<tr>
<td>-F</td>
<td>æ¸…ç©ºè§„åˆ™é“¾</td>
</tr>
<tr>
<td>-L</td>
<td>æŸ¥çœ‹è§„åˆ™é“¾</td>
</tr>
<tr>
<td>-A</td>
<td>åœ¨è§„åˆ™é“¾çš„æœ«å°¾åŠ å…¥æ–°è§„åˆ™</td>
</tr>
<tr>
<td>-I</td>
<td>num åœ¨è§„åˆ™é“¾çš„å¤´éƒ¨åŠ å…¥æ–°è§„åˆ™</td>
</tr>
<tr>
<td>-D</td>
<td>num åˆ é™¤æŸä¸€æ¡è§„åˆ™</td>
</tr>
<tr>
<td>-s</td>
<td>åŒ¹é…æ¥æºåœ°å€ IP&#x2F;MASKï¼ŒåŠ å¹å·â€!â€è¡¨ç¤ºé™¤è¿™ä¸ª IP å¤–ã€‚</td>
</tr>
<tr>
<td>-d</td>
<td>åŒ¹é…ç›®æ ‡åœ°å€</td>
</tr>
<tr>
<td>-i</td>
<td>ç½‘å¡åç§° åŒ¹é…ä»è¿™å—ç½‘å¡æµå…¥çš„æ•°æ®</td>
</tr>
<tr>
<td>-o</td>
<td>ç½‘å¡åç§° åŒ¹é…ä»è¿™å—ç½‘å¡æµå‡ºçš„æ•°æ®</td>
</tr>
<tr>
<td>-p</td>
<td>åŒ¹é…åè®®,å¦‚ tcp,udp,icmp</td>
</tr>
<tr>
<td>â€“dport num</td>
<td>åŒ¹é…ç›®æ ‡ç«¯å£å·</td>
</tr>
<tr>
<td>â€“sport num</td>
<td>åŒ¹é…æ¥æºç«¯å£å·</td>
</tr>
</tbody></table>
<p>é¡ºåºï¼š</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iptables -t è¡¨å &lt;-<span class="selector-tag">A</span>/<span class="selector-tag">I</span>/D/<span class="attribute">R</span>&gt; è§„åˆ™é“¾å <span class="selector-attr">[è§„åˆ™å·]</span> &lt;-<span class="selector-tag">i</span>/o ç½‘å¡å&gt; -<span class="selector-tag">p</span> åè®®å &lt;-s æºIP/æºå­ç½‘&gt; <span class="attr">--sport</span> æºç«¯å£ &lt;-d ç›®æ ‡IP/ç›®æ ‡å­ç½‘&gt; <span class="attr">--dport</span> ç›®æ ‡ç«¯å£ -j åŠ¨ä½œ</span><br></pre></td></tr></table></figure>

<h2 id="iptables-ç¤ºä¾‹"><a href="#iptables-ç¤ºä¾‹" class="headerlink" title="iptables ç¤ºä¾‹"></a>iptables ç¤ºä¾‹</h2><h3 id="æ¸…ç©ºå½“å‰çš„æ‰€æœ‰è§„åˆ™å’Œè®¡æ•°"><a href="#æ¸…ç©ºå½“å‰çš„æ‰€æœ‰è§„åˆ™å’Œè®¡æ•°" class="headerlink" title="æ¸…ç©ºå½“å‰çš„æ‰€æœ‰è§„åˆ™å’Œè®¡æ•°"></a>æ¸…ç©ºå½“å‰çš„æ‰€æœ‰è§„åˆ™å’Œè®¡æ•°</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">iptables -F  # æ¸…ç©ºæ‰€æœ‰çš„é˜²ç«å¢™è§„åˆ™</span><br><span class="line">iptables -X  # åˆ é™¤ç”¨æˆ·è‡ªå®šä¹‰çš„ç©ºé“¾</span><br><span class="line">iptables -Z  # æ¸…ç©ºè®¡æ•°</span><br></pre></td></tr></table></figure>

<h3 id="é…ç½®å…è®¸-ssh-ç«¯å£è¿æ¥"><a href="#é…ç½®å…è®¸-ssh-ç«¯å£è¿æ¥" class="headerlink" title="é…ç½®å…è®¸ ssh ç«¯å£è¿æ¥"></a>é…ç½®å…è®¸ ssh ç«¯å£è¿æ¥</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">iptables -A INPUT -s 192.168.1.0/24 -p tcp --dport 22 -j ACCEPT</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">22ä¸ºä½ çš„sshç«¯å£ï¼Œ -s 192.168.1.0/24è¡¨ç¤ºå…è®¸è¿™ä¸ªç½‘æ®µçš„æœºå™¨æ¥è¿æ¥ï¼Œå…¶å®ƒç½‘æ®µçš„ipåœ°å€æ˜¯ç™»é™†ä¸äº†ä½ çš„æœºå™¨çš„ã€‚ -j ACCEPTè¡¨ç¤ºæ¥å—è¿™æ ·çš„è¯·æ±‚</span></span><br></pre></td></tr></table></figure>

<h3 id="å…è®¸æœ¬åœ°å›ç¯åœ°å€å¯ä»¥æ­£å¸¸ä½¿ç”¨"><a href="#å…è®¸æœ¬åœ°å›ç¯åœ°å€å¯ä»¥æ­£å¸¸ä½¿ç”¨" class="headerlink" title="å…è®¸æœ¬åœ°å›ç¯åœ°å€å¯ä»¥æ­£å¸¸ä½¿ç”¨"></a>å…è®¸æœ¬åœ°å›ç¯åœ°å€å¯ä»¥æ­£å¸¸ä½¿ç”¨</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">iptables -A INPUT -i lo -j ACCEPT</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">æœ¬åœ°åœ†ç¯åœ°å€å°±æ˜¯é‚£ä¸ª127.0.0.1ï¼Œæ˜¯æœ¬æœºä¸Šä½¿ç”¨çš„,å®ƒè¿›ä¸å‡ºéƒ½è®¾ç½®ä¸ºå…è®¸</span></span><br><span class="line">iptables -A OUTPUT -o lo -j ACCEPT</span><br></pre></td></tr></table></figure>

<h3 id="è®¾ç½®é»˜è®¤çš„è§„åˆ™"><a href="#è®¾ç½®é»˜è®¤çš„è§„åˆ™" class="headerlink" title="è®¾ç½®é»˜è®¤çš„è§„åˆ™"></a>è®¾ç½®é»˜è®¤çš„è§„åˆ™</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">iptables -P INPUT DROP # é…ç½®é»˜è®¤çš„ä¸è®©è¿›</span><br><span class="line">iptables -P FORWARD DROP # é»˜è®¤çš„ä¸å…è®¸è½¬å‘</span><br><span class="line">iptables -P OUTPUT ACCEPT # é»˜è®¤çš„å¯ä»¥å‡ºå»</span><br></pre></td></tr></table></figure>

<h3 id="é…ç½®ç™½åå•"><a href="#é…ç½®ç™½åå•" class="headerlink" title="é…ç½®ç™½åå•"></a>é…ç½®ç™½åå•</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">iptables -A INPUT -p all -s 192.168.1.0/24 -j ACCEPT  # å…è®¸æœºæˆ¿å†…ç½‘æœºå™¨å¯ä»¥è®¿é—®</span><br><span class="line">iptables -A INPUT -p all -s 192.168.140.0/24 -j ACCEPT  # å…è®¸æœºæˆ¿å†…ç½‘æœºå™¨å¯ä»¥è®¿é—®</span><br><span class="line">iptables -A INPUT -p tcp -s 183.121.3.7 --dport 3380 -j ACCEPT # å…è®¸183.121.3.7è®¿é—®æœ¬æœºçš„3380ç«¯å£</span><br></pre></td></tr></table></figure>

<h3 id="å¼€å¯ç›¸åº”çš„æœåŠ¡ç«¯å£"><a href="#å¼€å¯ç›¸åº”çš„æœåŠ¡ç«¯å£" class="headerlink" title="å¼€å¯ç›¸åº”çš„æœåŠ¡ç«¯å£"></a>å¼€å¯ç›¸åº”çš„æœåŠ¡ç«¯å£</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">iptables -A INPUT -p tcp --dport 80 -j ACCEPT # å¼€å¯80ç«¯å£ï¼Œå› ä¸ºwebå¯¹å¤–éƒ½æ˜¯è¿™ä¸ªç«¯å£</span><br><span class="line">iptables -A INPUT -p icmp --icmp-type 8 -j ACCEPT # å…è®¸è¢«ping</span><br><span class="line">iptables -A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT # å·²ç»å»ºç«‹çš„è¿æ¥å¾—è®©å®ƒè¿›æ¥</span><br></pre></td></tr></table></figure>

<h3 id="ä¿å­˜è§„åˆ™åˆ°é…ç½®æ–‡ä»¶ä¸­"><a href="#ä¿å­˜è§„åˆ™åˆ°é…ç½®æ–‡ä»¶ä¸­" class="headerlink" title="ä¿å­˜è§„åˆ™åˆ°é…ç½®æ–‡ä»¶ä¸­"></a>ä¿å­˜è§„åˆ™åˆ°é…ç½®æ–‡ä»¶ä¸­</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cp /etc/sysconfig/iptables /etc/sysconfig/iptables.bak # ä»»ä½•æ”¹åŠ¨ä¹‹å‰å…ˆå¤‡ä»½ï¼Œè¯·ä¿æŒè¿™ä¸€ä¼˜ç§€çš„ä¹ æƒ¯</span><br><span class="line">iptables-save &gt; /etc/sysconfig/iptables</span><br><span class="line">cat /etc/sysconfig/iptables</span><br></pre></td></tr></table></figure>

<h3 id="åˆ—å‡ºå·²è®¾ç½®çš„è§„åˆ™"><a href="#åˆ—å‡ºå·²è®¾ç½®çš„è§„åˆ™" class="headerlink" title="åˆ—å‡ºå·²è®¾ç½®çš„è§„åˆ™"></a>åˆ—å‡ºå·²è®¾ç½®çš„è§„åˆ™</h3><blockquote>
<p>iptables -L [-t è¡¨å][é“¾å]</p>
</blockquote>
<ul>
<li>å››ä¸ªè¡¨å <code>raw</code>ï¼Œ<code>nat</code>ï¼Œ<code>filter</code>ï¼Œ<code>mangle</code></li>
<li>äº”ä¸ªè§„åˆ™é“¾å <code>INPUT</code>ã€<code>OUTPUT</code>ã€<code>FORWARD</code>ã€<code>PREROUTING</code>ã€<code>POSTROUTING</code></li>
<li>filter è¡¨åŒ…å«<code>INPUT</code>ã€<code>OUTPUT</code>ã€<code>FORWARD</code>ä¸‰ä¸ªè§„åˆ™é“¾</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">iptables -L -t nat                  # åˆ—å‡º nat ä¸Šé¢çš„æ‰€æœ‰è§„åˆ™</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">           ^ -t å‚æ•°æŒ‡å®šï¼Œå¿…é¡»æ˜¯ rawï¼Œ natï¼Œfilterï¼Œmangle ä¸­çš„ä¸€ä¸ª</span></span><br><span class="line">iptables -L -t nat  --line-numbers  # è§„åˆ™å¸¦ç¼–å·</span><br><span class="line">iptables -L INPUT</span><br><span class="line"></span><br><span class="line">iptables -L -nv  # æŸ¥çœ‹ï¼Œè¿™ä¸ªåˆ—è¡¨çœ‹èµ·æ¥æ›´è¯¦ç»†</span><br></pre></td></tr></table></figure>

<h3 id="æ¸…é™¤å·²æœ‰è§„åˆ™"><a href="#æ¸…é™¤å·²æœ‰è§„åˆ™" class="headerlink" title="æ¸…é™¤å·²æœ‰è§„åˆ™"></a>æ¸…é™¤å·²æœ‰è§„åˆ™</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">iptables -F INPUT  # æ¸…ç©ºæŒ‡å®šé“¾ INPUT ä¸Šé¢çš„æ‰€æœ‰è§„åˆ™</span><br><span class="line">iptables -X INPUT  # åˆ é™¤æŒ‡å®šçš„é“¾ï¼Œè¿™ä¸ªé“¾å¿…é¡»æ²¡æœ‰è¢«å…¶å®ƒä»»ä½•è§„åˆ™å¼•ç”¨ï¼Œè€Œä¸”è¿™æ¡ä¸Šå¿…é¡»æ²¡æœ‰ä»»ä½•è§„åˆ™ã€‚</span><br><span class="line">                   # å¦‚æœæ²¡æœ‰æŒ‡å®šé“¾åï¼Œåˆ™ä¼šåˆ é™¤è¯¥è¡¨ä¸­æ‰€æœ‰éå†…ç½®çš„é“¾ã€‚</span><br><span class="line">iptables -Z INPUT  # æŠŠæŒ‡å®šé“¾ï¼Œæˆ–è€…è¡¨ä¸­çš„æ‰€æœ‰é“¾ä¸Šçš„æ‰€æœ‰è®¡æ•°å™¨æ¸…é›¶ã€‚</span><br></pre></td></tr></table></figure>

<h3 id="åˆ é™¤å·²æ·»åŠ çš„è§„åˆ™"><a href="#åˆ é™¤å·²æ·»åŠ çš„è§„åˆ™" class="headerlink" title="åˆ é™¤å·²æ·»åŠ çš„è§„åˆ™"></a>åˆ é™¤å·²æ·»åŠ çš„è§„åˆ™</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ·»åŠ ä¸€æ¡è§„åˆ™</span></span><br><span class="line">iptables -A INPUT -s 192.168.1.5 -j DROP</span><br></pre></td></tr></table></figure>

<p>å°†æ‰€æœ‰ iptables ä»¥åºå·æ ‡è®°æ˜¾ç¤ºï¼Œæ‰§è¡Œï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iptables -L -n --line-numbers</span><br></pre></td></tr></table></figure>

<p>æ¯”å¦‚è¦åˆ é™¤ INPUT é‡Œåºå·ä¸º 8 çš„è§„åˆ™ï¼Œæ‰§è¡Œï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iptables -D INPUT 8</span><br></pre></td></tr></table></figure>

<h3 id="å¼€æ”¾æŒ‡å®šçš„ç«¯å£"><a href="#å¼€æ”¾æŒ‡å®šçš„ç«¯å£" class="headerlink" title="å¼€æ”¾æŒ‡å®šçš„ç«¯å£"></a>å¼€æ”¾æŒ‡å®šçš„ç«¯å£</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">iptables -A INPUT -s 127.0.0.1 -d 127.0.0.1 -j ACCEPT               #å…è®¸æœ¬åœ°å›ç¯æ¥å£(å³è¿è¡Œæœ¬æœºè®¿é—®æœ¬æœº)</span><br><span class="line">iptables -A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT    #å…è®¸å·²å»ºç«‹çš„æˆ–ç›¸å…³è¿çš„é€šè¡Œ</span><br><span class="line">iptables -A OUTPUT -j ACCEPT         #å…è®¸æ‰€æœ‰æœ¬æœºå‘å¤–çš„è®¿é—®</span><br><span class="line">iptables -A INPUT -p tcp --dport 22 -j ACCEPT    #å…è®¸è®¿é—®22ç«¯å£</span><br><span class="line">iptables -A INPUT -p tcp --dport 80 -j ACCEPT    #å…è®¸è®¿é—®80ç«¯å£</span><br><span class="line">iptables -A INPUT -p tcp --dport 21 -j ACCEPT    #å…è®¸ftpæœåŠ¡çš„21ç«¯å£</span><br><span class="line">iptables -A INPUT -p tcp --dport 20 -j ACCEPT    #å…è®¸FTPæœåŠ¡çš„20ç«¯å£</span><br><span class="line">iptables -A INPUT -j reject       #ç¦æ­¢å…¶ä»–æœªå…è®¸çš„è§„åˆ™è®¿é—®</span><br><span class="line">iptables -A FORWARD -j REJECT     #ç¦æ­¢å…¶ä»–æœªå…è®¸çš„è§„åˆ™è®¿é—®</span><br></pre></td></tr></table></figure>

<h3 id="å±è”½-IP"><a href="#å±è”½-IP" class="headerlink" title="å±è”½ IP"></a>å±è”½ IP</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">iptables -A INPUT -p tcp -m tcp -s 192.168.0.8 -j DROP  # å±è”½æ¶æ„ä¸»æœºï¼ˆæ¯”å¦‚ï¼Œ192.168.0.8</span><br><span class="line">iptables -I INPUT -s 123.45.6.7 -j DROP       #å±è”½å•ä¸ªIPçš„å‘½ä»¤</span><br><span class="line">iptables -I INPUT -s 123.0.0.0/8 -j DROP      #å°æ•´ä¸ªæ®µå³ä»123.0.0.1åˆ°123.255.255.254çš„å‘½ä»¤</span><br><span class="line">iptables -I INPUT -s 124.45.0.0/16 -j DROP    #å°IPæ®µå³ä»123.45.0.1åˆ°123.45.255.254çš„å‘½ä»¤</span><br><span class="line">iptables -I INPUT -s 123.45.6.0/24 -j DROP    #å°IPæ®µå³ä»123.45.6.1åˆ°123.45.6.254çš„å‘½ä»¤æ˜¯</span><br></pre></td></tr></table></figure>

<h3 id="æŒ‡å®šæ•°æ®åŒ…å‡ºå»çš„ç½‘ç»œæ¥å£"><a href="#æŒ‡å®šæ•°æ®åŒ…å‡ºå»çš„ç½‘ç»œæ¥å£" class="headerlink" title="æŒ‡å®šæ•°æ®åŒ…å‡ºå»çš„ç½‘ç»œæ¥å£"></a>æŒ‡å®šæ•°æ®åŒ…å‡ºå»çš„ç½‘ç»œæ¥å£</h3><p>åªå¯¹ OUTPUTï¼ŒFORWARDï¼ŒPOSTROUTING ä¸‰ä¸ªé“¾èµ·ä½œç”¨ã€‚</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iptables -A FORWARD -o eth0</span><br></pre></td></tr></table></figure>

<h3 id="æŸ¥çœ‹å·²æ·»åŠ çš„è§„åˆ™"><a href="#æŸ¥çœ‹å·²æ·»åŠ çš„è§„åˆ™" class="headerlink" title="æŸ¥çœ‹å·²æ·»åŠ çš„è§„åˆ™"></a>æŸ¥çœ‹å·²æ·»åŠ çš„è§„åˆ™</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">iptables -L -n -v</span><br><span class="line">Chain INPUT (policy DROP 48106 packets, 2690K bytes)</span><br><span class="line"> pkts bytes target     prot opt in     out     source               destination</span><br><span class="line"> 5075  589K ACCEPT     all  --  lo     *       0.0.0.0/0            0.0.0.0/0</span><br><span class="line"> 191K   90M ACCEPT     tcp  --  *      *       0.0.0.0/0            0.0.0.0/0           tcp dpt:22</span><br><span class="line">1499K  133M ACCEPT     tcp  --  *      *       0.0.0.0/0            0.0.0.0/0           tcp dpt:80</span><br><span class="line">4364K 6351M ACCEPT     all  --  *      *       0.0.0.0/0            0.0.0.0/0           state RELATED,ESTABLISHED</span><br><span class="line"> 6256  327K ACCEPT     icmp --  *      *       0.0.0.0/0            0.0.0.0/0</span><br><span class="line"></span><br><span class="line">Chain FORWARD (policy ACCEPT 0 packets, 0 bytes)</span><br><span class="line"> pkts bytes target     prot opt in     out     source               destination</span><br><span class="line"></span><br><span class="line">Chain OUTPUT (policy ACCEPT 3382K packets, 1819M bytes)</span><br><span class="line"> pkts bytes target     prot opt in     out     source               destination</span><br><span class="line"> 5075  589K ACCEPT     all  --  *      lo      0.0.0.0/0            0.0.0.0/0</span><br></pre></td></tr></table></figure>

<h3 id="å¯åŠ¨ç½‘ç»œè½¬å‘è§„åˆ™"><a href="#å¯åŠ¨ç½‘ç»œè½¬å‘è§„åˆ™" class="headerlink" title="å¯åŠ¨ç½‘ç»œè½¬å‘è§„åˆ™"></a>å¯åŠ¨ç½‘ç»œè½¬å‘è§„åˆ™</h3><p>å…¬ç½‘<code>210.14.67.7</code>è®©å†…ç½‘<code>192.168.188.0/24</code>ä¸Šç½‘</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iptables -t nat -A POSTROUTING -s 192.168.188.0/24 -j SNAT --to-source 210.14.67.127</span><br></pre></td></tr></table></figure>

<h3 id="ç«¯å£æ˜ å°„"><a href="#ç«¯å£æ˜ å°„" class="headerlink" title="ç«¯å£æ˜ å°„"></a>ç«¯å£æ˜ å°„</h3><p>æœ¬æœºçš„ 2222 ç«¯å£æ˜ å°„åˆ°å†…ç½‘ è™šæ‹Ÿæœºçš„ 22 ç«¯å£</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iptables -t nat -A PREROUTING -d 210.14.67.127 -p tcp --dport 2222  -j DNAT --to-dest 192.168.188.115:22</span><br></pre></td></tr></table></figure>

<h3 id="å­—ç¬¦ä¸²åŒ¹é…"><a href="#å­—ç¬¦ä¸²åŒ¹é…" class="headerlink" title="å­—ç¬¦ä¸²åŒ¹é…"></a>å­—ç¬¦ä¸²åŒ¹é…</h3><p>æ¯”å¦‚ï¼Œæˆ‘ä»¬è¦è¿‡æ»¤æ‰€æœ‰ TCP è¿æ¥ä¸­çš„å­—ç¬¦ä¸²<code>test</code>ï¼Œä¸€æ—¦å‡ºç°å®ƒæˆ‘ä»¬å°±ç»ˆæ­¢è¿™ä¸ªè¿æ¥ï¼Œæˆ‘ä»¬å¯ä»¥è¿™ä¹ˆåšï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">iptables -A INPUT -p tcp -m string --algo kmp --string &quot;test&quot; -j REJECT --reject-with tcp-reset</span><br><span class="line">iptables -L</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Chain INPUT (policy ACCEPT)</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">target     prot opt <span class="built_in">source</span>               destination</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">REJECT     tcp  --  anywhere             anywhere            STRING match <span class="string">&quot;test&quot;</span> ALGO name kmp TO 65535 reject-with tcp-reset</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># Chain FORWARD (policy ACCEPT)</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">target     prot opt <span class="built_in">source</span>               destination</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># Chain OUTPUT (policy ACCEPT)</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">target     prot opt <span class="built_in">source</span>               destination</span></span><br></pre></td></tr></table></figure>

<h3 id="é˜»æ­¢-Windows-è •è™«çš„æ”»å‡»"><a href="#é˜»æ­¢-Windows-è •è™«çš„æ”»å‡»" class="headerlink" title="é˜»æ­¢ Windows è •è™«çš„æ”»å‡»"></a>é˜»æ­¢ Windows è •è™«çš„æ”»å‡»</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iptables -I INPUT -j DROP -p tcp -s 0.0.0.0/0 -m string --algo kmp --string &quot;cmd.exe&quot;</span><br></pre></td></tr></table></figure>

<h3 id="é˜²æ­¢-SYN-æ´ªæ°´æ”»å‡»"><a href="#é˜²æ­¢-SYN-æ´ªæ°´æ”»å‡»" class="headerlink" title="é˜²æ­¢ SYN æ´ªæ°´æ”»å‡»"></a>é˜²æ­¢ SYN æ´ªæ°´æ”»å‡»</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iptables -A INPUT -p tcp --syn -m limit --limit 5/second -j ACCEPT</span><br></pre></td></tr></table></figure>

<h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><ul>
<li><a target="_blank" rel="noopener" href="https://wiki.archlinux.org/index.php/iptables_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)">https://wiki.archlinux.org/index.php/iptables_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)</a></li>
<li><a target="_blank" rel="noopener" href="https://wangchujiang.com/linux-command/c/iptables.html">https://wangchujiang.com/linux-command/c/iptables.html</a></li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://dunwu.github.io/blog/pages/6193c337/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/blog/uploads/avatar.gif">
      <meta itemprop="name" content="é’æ‚Ÿ â—¾ Dunwu">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Dunwu Blog">
      <meta itemprop="description" content="é’æ‚Ÿçš„ä¸ªäººåšå®¢">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content=" | Dunwu Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/blog/pages/6193c337/" class="post-title-link" itemprop="url">Spring Framework ç»¼è¿°</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">å‘è¡¨äº</span>

      <time title="åˆ›å»ºæ—¶é—´ï¼š2019-11-22 10:46:02" itemprop="dateCreated datePublished" datetime="2019-11-22T10:46:02+08:00">2019-11-22</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">æ›´æ–°äº</span>
      <time title="ä¿®æ”¹æ—¶é—´ï¼š2025-09-13 17:56:53" itemprop="dateModified" datetime="2025-09-13T17:56:53+08:00">2025-09-13</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">åˆ†ç±»äº</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/blog/categories/Java/" itemprop="url" rel="index"><span itemprop="name">Java</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/blog/categories/Java/%E6%A1%86%E6%9E%B6/" itemprop="url" rel="index"><span itemprop="name">æ¡†æ¶</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/blog/categories/Java/%E6%A1%86%E6%9E%B6/Spring/" itemprop="url" rel="index"><span itemprop="name">Spring</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/blog/categories/Java/%E6%A1%86%E6%9E%B6/Spring/Spring%E7%BB%BC%E5%90%88/" itemprop="url" rel="index"><span itemprop="name">Springç»¼åˆ</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
      <span>4.8k</span>
    </span>
    <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
      <span>4 åˆ†é’Ÿ</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="Spring-Framework-ç»¼è¿°"><a href="#Spring-Framework-ç»¼è¿°" class="headerlink" title="Spring Framework ç»¼è¿°"></a>Spring Framework ç»¼è¿°</h1><h2 id="Spring-Framework-ç®€ä»‹"><a href="#Spring-Framework-ç®€ä»‹" class="headerlink" title="Spring Framework ç®€ä»‹"></a>Spring Framework ç®€ä»‹</h2><p>Spring Framework æ˜¯æœ€å—æ¬¢è¿çš„ä¼ä¸šçº§ Java åº”ç”¨ç¨‹åºå¼€å‘æ¡†æ¶ã€‚ç”¨äºæ„å»ºä¼ä¸šçº§åº”ç”¨çš„è½»é‡çº§ã€ä¸€ç«™å¼è§£å†³æ–¹æ¡ˆã€‚</p>
<p>å½“è°ˆè®ºåˆ°å¤§å°å’Œé€æ˜åº¦æ—¶ï¼Œ Spring æ˜¯è½»é‡çº§çš„ã€‚ Spring æ¡†æ¶çš„åŸºç¡€ç‰ˆæœ¬æ˜¯åœ¨ 2 MB å·¦å³çš„ã€‚</p>
<p>Spring æ¡†æ¶çš„æ ¸å¿ƒç‰¹æ€§å¯ä»¥ç”¨äºå¼€å‘ä»»ä½• Java åº”ç”¨ç¨‹åºï¼Œä½†æ˜¯åœ¨ Java EE å¹³å°ä¸Šæ„å»º web åº”ç”¨ç¨‹åºæ˜¯éœ€è¦æ‰©å±•çš„ã€‚ Spring æ¡†æ¶çš„ç›®æ ‡æ˜¯ä½¿ J2EE å¼€å‘å˜å¾—æ›´å®¹æ˜“ä½¿ç”¨ï¼Œé€šè¿‡å¯ç”¨åŸºäº POJO ç¼–ç¨‹æ¨¡å‹æ¥ä¿ƒè¿›è‰¯å¥½çš„ç¼–ç¨‹å®è·µã€‚</p>
<p>Spring Framework è®¾è®¡ç†å¿µå¦‚ä¸‹ï¼š</p>
<ul>
<li>åŠ›äº‰è®©é€‰æ‹©æ— å¤„ä¸åœ¨</li>
<li>ä½“ç°æµ·çº³ç™¾å·çš„ç²¾ç¥</li>
<li>ä¿æŒåå‘å…¼å®¹æ€§</li>
<li>ä¸“æ³¨ API è®¾è®¡</li>
<li>è¿½æ±‚ä¸¥è‹›çš„ä»£ç è´¨é‡</li>
</ul>
<h2 id="ä¸ºä»€ä¹ˆä½¿ç”¨-Spring"><a href="#ä¸ºä»€ä¹ˆä½¿ç”¨-Spring" class="headerlink" title="ä¸ºä»€ä¹ˆä½¿ç”¨ Spring"></a>ä¸ºä»€ä¹ˆä½¿ç”¨ Spring</h2><p>ä¸‹é¢åˆ—å‡ºçš„æ˜¯ä½¿ç”¨ Spring æ¡†æ¶ä¸»è¦çš„å¥½å¤„ï¼š</p>
<ul>
<li>Spring å¯ä»¥ä½¿å¼€å‘äººå‘˜ä½¿ç”¨ POJOs å¼€å‘ä¼ä¸šçº§çš„åº”ç”¨ç¨‹åºã€‚åªä½¿ç”¨ POJOs çš„å¥½å¤„æ˜¯ä½ ä¸éœ€è¦ä¸€ä¸ª EJB å®¹å™¨äº§å“ï¼Œæ¯”å¦‚ä¸€ä¸ªåº”ç”¨ç¨‹åºæœåŠ¡å™¨ï¼Œä½†æ˜¯ä½ å¯ä»¥é€‰æ‹©ä½¿ç”¨ä¸€ä¸ªå¥å£®çš„ servlet å®¹å™¨ï¼Œæ¯”å¦‚ Tomcat æˆ–è€…ä¸€äº›å•†ä¸šäº§å“ã€‚</li>
<li>Spring åœ¨ä¸€ä¸ªå•å…ƒæ¨¡å¼ä¸­æ˜¯æœ‰ç»„ç»‡çš„ã€‚å³ä½¿åŒ…å’Œç±»çš„æ•°é‡éå¸¸å¤§ï¼Œä½ åªéœ€è¦é€‰æ‹©ä½ éœ€è¦çš„éƒ¨åˆ†ï¼Œè€Œå¿½ç•¥å‰©ä½™çš„é‚£éƒ¨åˆ†ã€‚</li>
<li>Spring ä¸ä¼šè®©ä½ ç™½è´¹åŠ›æ°”åšé‡å¤å·¥ä½œï¼Œå®ƒçœŸæ­£çš„åˆ©ç”¨äº†ä¸€äº›ç°æœ‰çš„æŠ€æœ¯ï¼Œåƒå‡ ä¸ª ORM æ¡†æ¶ã€æ—¥å¿—æ¡†æ¶ã€JEEã€Quartz å’Œ JDK è®¡æ—¶å™¨ï¼Œå…¶ä»–è§†å›¾æŠ€æœ¯ã€‚</li>
<li>æµ‹è¯•ä¸€ä¸ªç”¨ Spring ç¼–å†™çš„åº”ç”¨ç¨‹åºå¾ˆå®¹æ˜“ï¼Œå› ä¸º environment-dependent ä»£ç è¢«æ”¾è¿›äº†è¿™ä¸ªæ¡†æ¶ä¸­ã€‚æ­¤å¤–ï¼Œé€šè¿‡ä½¿ç”¨ JavaBean-style POJOsï¼Œå®ƒåœ¨ä½¿ç”¨ä¾èµ–æ³¨å…¥æ³¨å…¥æµ‹è¯•æ•°æ®æ—¶å˜å¾—æ›´å®¹æ˜“ã€‚</li>
<li>Spring çš„ web æ¡†æ¶æ˜¯ä¸€ä¸ªè®¾è®¡è‰¯å¥½çš„ web MVC æ¡†æ¶ï¼Œå®ƒä¸º web æ¡†æ¶ï¼Œæ¯”å¦‚ Structs æˆ–è€…å…¶ä»–å·¥ç¨‹ä¸Šçš„æˆ–è€…å¾ˆå°‘å—æ¬¢è¿çš„ web æ¡†æ¶ï¼Œæä¾›äº†ä¸€ä¸ªå¾ˆå¥½çš„ä¾›æ›¿ä»£çš„é€‰æ‹©ã€‚</li>
<li>ä¸ºå°†ç‰¹å®šæŠ€æœ¯çš„å¼‚å¸¸ï¼ˆä¾‹å¦‚ï¼Œç”± JDBCã€Hibernateï¼Œæˆ–è€… JDO æŠ›å‡ºçš„å¼‚å¸¸ï¼‰ç¿»è¯‘æˆä¸€è‡´çš„ï¼Œ Spring æä¾›äº†ä¸€ä¸ªæ–¹ä¾¿çš„ APIï¼Œè€Œè¿™äº›éƒ½æ˜¯æœªç»æ£€éªŒçš„å¼‚å¸¸ã€‚</li>
<li>è½»é‡çº§çš„ IOC å®¹å™¨å¾€å¾€æ˜¯è½»é‡çº§çš„ï¼Œä¾‹å¦‚ï¼Œç‰¹åˆ«æ˜¯å½“ä¸ EJB å®¹å™¨ç›¸æ¯”çš„æ—¶å€™ã€‚è¿™æœ‰åˆ©äºåœ¨å†…å­˜å’Œ CPU èµ„æºæœ‰é™çš„è®¡ç®—æœºä¸Šå¼€å‘å’Œéƒ¨ç½²åº”ç”¨ç¨‹åºã€‚</li>
<li>Spring æä¾›äº†ä¸€ä¸ªä¸€è‡´çš„äº‹åŠ¡ç®¡ç†ç•Œé¢ï¼Œè¯¥ç•Œé¢å¯ä»¥ç¼©å°æˆä¸€ä¸ªæœ¬åœ°äº‹åŠ¡ï¼ˆä¾‹å¦‚ï¼Œä½¿ç”¨ä¸€ä¸ªå•ä¸€çš„æ•°æ®åº“ï¼‰å’Œæ‰©å±•æˆä¸€ä¸ªå…¨å±€äº‹åŠ¡ï¼ˆä¾‹å¦‚ï¼Œä½¿ç”¨ JTAï¼‰ã€‚</li>
</ul>
<h2 id="æ ¸å¿ƒæ€æƒ³"><a href="#æ ¸å¿ƒæ€æƒ³" class="headerlink" title="æ ¸å¿ƒæ€æƒ³"></a>æ ¸å¿ƒæ€æƒ³</h2><p>Spring æœ€æ ¸å¿ƒçš„ä¸¤ä¸ªæŠ€æœ¯æ€æƒ³æ˜¯ï¼šIoC å’Œ Aop</p>
<h3 id="IoC"><a href="#IoC" class="headerlink" title="IoC"></a>IoC</h3><p><code>IoC</code> å³ <code>Inversion of Control</code> ï¼Œæ„ä¸ºæ§åˆ¶åè½¬ã€‚</p>
<p>Spring æœ€è®¤åŒçš„æŠ€æœ¯æ˜¯æ§åˆ¶åè½¬çš„<strong>ä¾èµ–æ³¨å…¥ï¼ˆDIï¼‰</strong>æ¨¡å¼ã€‚æ§åˆ¶åè½¬ï¼ˆIoCï¼‰æ˜¯ä¸€ä¸ªé€šç”¨çš„æ¦‚å¿µï¼Œå®ƒå¯ä»¥ç”¨è®¸å¤šä¸åŒçš„æ–¹å¼å»è¡¨è¾¾ï¼Œä¾èµ–æ³¨å…¥ä»…ä»…æ˜¯æ§åˆ¶åè½¬çš„ä¸€ä¸ªå…·ä½“çš„ä¾‹å­ã€‚</p>
<p>å½“ç¼–å†™ä¸€ä¸ªå¤æ‚çš„ Java åº”ç”¨ç¨‹åºæ—¶ï¼Œåº”ç”¨ç¨‹åºç±»åº”è¯¥å°½å¯èƒ½çš„ç‹¬ç«‹äºå…¶ä»–çš„ Java ç±»æ¥å¢åŠ è¿™äº›ç±»å¯é‡ç”¨å¯èƒ½æ€§ï¼Œå½“è¿›è¡Œå•å…ƒæµ‹è¯•æ—¶ï¼Œå¯ä»¥ä½¿å®ƒä»¬ç‹¬ç«‹äºå…¶ä»–ç±»è¿›è¡Œæµ‹è¯•ã€‚ä¾èµ–æ³¨å…¥ï¼ˆæˆ–è€…æœ‰æ—¶è¢«ç§°ä¸ºé…çº¿ï¼‰æœ‰åŠ©äºå°†è¿™äº›ç±»ç²˜åˆåœ¨ä¸€èµ·ï¼Œå¹¶ä¸”åœ¨åŒä¸€æ—¶é—´è®©å®ƒä»¬ä¿æŒç‹¬ç«‹ã€‚</p>
<p>åˆ°åº•ä»€ä¹ˆæ˜¯ä¾èµ–æ³¨å…¥ï¼Ÿè®©æˆ‘ä»¬å°†è¿™ä¸¤ä¸ªè¯åˆ†å¼€æ¥çœ‹ä¸€çœ‹ã€‚è¿™é‡Œå°†ä¾èµ–å…³ç³»éƒ¨åˆ†è½¬åŒ–ä¸ºä¸¤ä¸ªç±»ä¹‹é—´çš„å…³è”ã€‚ä¾‹å¦‚ï¼Œç±» A ä¾èµ–äºç±» Bã€‚ç°åœ¨ï¼Œè®©æˆ‘ä»¬çœ‹ä¸€çœ‹ç¬¬äºŒéƒ¨åˆ†ï¼Œæ³¨å…¥ã€‚æ‰€æœ‰è¿™ä¸€åˆ‡éƒ½æ„å‘³ç€ç±» B å°†é€šè¿‡ IoC è¢«æ³¨å…¥åˆ°ç±» A ä¸­ã€‚</p>
<p>ä¾èµ–æ³¨å…¥å¯ä»¥ä»¥å‘æ„é€ å‡½æ•°ä¼ é€’å‚æ•°çš„æ–¹å¼å‘ç”Ÿï¼Œæˆ–è€…é€šè¿‡ä½¿ç”¨ setter æ–¹æ³• post-constructionã€‚ç”±äºä¾èµ–æ³¨å…¥æ˜¯ Spring æ¡†æ¶çš„æ ¸å¿ƒéƒ¨åˆ†ï¼Œæ‰€ä»¥æˆ‘å°†åœ¨ä¸€ä¸ªå•ç‹¬çš„ç« èŠ‚ä¸­åˆ©ç”¨å¾ˆå¥½çš„ä¾‹å­å»è§£é‡Šè¿™ä¸€æ¦‚å¿µã€‚</p>
<h3 id="Aop"><a href="#Aop" class="headerlink" title="Aop"></a>Aop</h3><p>Spring æ¡†æ¶çš„ä¸€ä¸ªå…³é”®ç»„ä»¶æ˜¯<strong>é¢å‘æ–¹é¢çš„ç¨‹åºè®¾è®¡ï¼ˆAOPï¼‰</strong>æ¡†æ¶ã€‚ä¸€ä¸ªç¨‹åºä¸­è·¨è¶Šå¤šä¸ªç‚¹çš„åŠŸèƒ½è¢«ç§°ä¸º<strong>æ¨ªåˆ‡å…³æ³¨ç‚¹</strong>ï¼Œè¿™äº›æ¨ªåˆ‡å…³æ³¨ç‚¹åœ¨æ¦‚å¿µä¸Šç‹¬ç«‹äºåº”ç”¨ç¨‹åºçš„ä¸šåŠ¡é€»è¾‘ã€‚æœ‰å„ç§å„æ ·å¸¸è§çš„å¾ˆå¥½çš„å…³äºæ–¹é¢çš„ä¾‹å­ï¼Œæ¯”å¦‚æ—¥å¿—è®°å½•ã€å£°æ˜æ€§äº‹åŠ¡ã€å®‰å…¨æ€§ï¼Œå’Œç¼“å­˜ç­‰ç­‰ã€‚</p>
<p>åœ¨ OOP ä¸­æ¨¡å—åŒ–çš„å…³é”®å•å…ƒæ˜¯ç±»ï¼Œè€Œåœ¨ AOP ä¸­æ¨¡å—åŒ–çš„å…³é”®å•å…ƒæ˜¯æ–¹é¢ã€‚AOP å¸®åŠ©ä½ å°†æ¨ªåˆ‡å…³æ³¨ç‚¹ä»å®ƒä»¬æ‰€å½±å“çš„å¯¹è±¡ä¸­åˆ†ç¦»å‡ºæ¥ï¼Œç„¶è€Œä¾èµ–æ³¨å…¥å¸®åŠ©ä½ å°†ä½ çš„åº”ç”¨ç¨‹åºå¯¹è±¡ä»å½¼æ­¤ä¸­åˆ†ç¦»å‡ºæ¥ã€‚</p>
<p>Spring æ¡†æ¶çš„ AOP æ¨¡å—æä¾›äº†é¢å‘æ–¹é¢çš„ç¨‹åºè®¾è®¡å®ç°ï¼Œå…è®¸ä½ å®šä¹‰æ‹¦æˆªå™¨æ–¹æ³•å’Œåˆ‡å…¥ç‚¹ï¼Œå¯ä»¥å®ç°å°†åº”è¯¥è¢«åˆ†å¼€çš„ä»£ç å¹²å‡€çš„åˆ†å¼€åŠŸèƒ½ã€‚æˆ‘å°†åœ¨ä¸€ä¸ªç‹¬ç«‹çš„ç« èŠ‚ä¸­è®¨è®ºæ›´å¤šå…³äº Spring AOP çš„æ¦‚å¿µã€‚</p>
<h2 id="Spring-ä½“ç³»ç»“æ„"><a href="#Spring-ä½“ç³»ç»“æ„" class="headerlink" title="Spring ä½“ç³»ç»“æ„"></a>Spring ä½“ç³»ç»“æ„</h2><p>Spring å½“å‰æ¡†æ¶æœ‰<strong>20</strong>ä¸ª jar åŒ…ï¼Œå¤§è‡´å¯ä»¥åˆ†ä¸º<strong>6</strong>å¤§æ¨¡å—:</p>
<ul>
<li><ol>
<li>ä¸ºä»€ä¹ˆä½¿ç”¨ Spring</li>
</ol>
</li>
<li><ol start="2">
<li>æ ¸å¿ƒæ€æƒ³</li>
</ol>
<ul>
<li>2.1. IoC</li>
<li>2.2. Aop</li>
</ul>
</li>
<li><ol start="3">
<li>Spring ä½“ç³»ç»“æ„</li>
</ol>
<ul>
<li>3.1. Core Container<ul>
<li>3.1.1. BeanFactory</li>
<li>3.1.2. ApplicationContext</li>
</ul>
</li>
<li>3.2. AOP and Instrumentation</li>
<li>3.3. Messaging</li>
<li>3.4. Data Access &#x2F; Integaration</li>
<li>3.5. Web</li>
<li>3.6. Test</li>
</ul>
</li>
<li><ol start="4">
<li>æœ¯è¯­</li>
</ol>
</li>
</ul>
<p>Spring æ¡†æ¶æä¾›äº†éå¸¸ä¸°å¯Œçš„åŠŸèƒ½ï¼Œå› æ­¤æ•´ä¸ªæ¶æ„ä¹Ÿå¾ˆåºå¤§ã€‚<br>åœ¨æˆ‘ä»¬å®é™…çš„åº”ç”¨å¼€å‘ä¸­ï¼Œå¹¶ä¸ä¸€å®šè¦ä½¿ç”¨æ‰€æœ‰çš„åŠŸèƒ½ï¼Œè€Œæ˜¯å¯ä»¥æ ¹æ®éœ€è¦é€‰æ‹©åˆé€‚çš„ Spring æ¨¡å—ã€‚</p>
<p><img src="https://raw.githubusercontent.com/dunwu/images/master/cs/java/spring/spring-framework.png" alt="img"></p>
<h3 id="Core-Container"><a href="#Core-Container" class="headerlink" title="Core Container"></a>Core Container</h3><p>IoC å®¹å™¨æ˜¯ Spring æ¡†æ¶çš„æ ¸å¿ƒã€‚spring å®¹å™¨ä½¿ç”¨ä¾èµ–æ³¨å…¥ç®¡ç†æ„æˆåº”ç”¨çš„ç»„ä»¶ï¼Œå®ƒä¼šåˆ›å»ºç›¸äº’åä½œçš„ç»„ä»¶ä¹‹é—´çš„å…³è”ã€‚æ¯«æ— ç–‘é—®ï¼Œè¿™äº›å¯¹è±¡æ›´ç®€å•å¹²å‡€ï¼Œæ›´å®¹æ˜“ç†è§£ï¼Œä¹Ÿæ›´å®¹æ˜“é‡ç”¨å’Œæµ‹è¯•ã€‚<br>Spring è‡ªå¸¦äº†å‡ ç§å®¹å™¨çš„å®ç°ï¼Œå¯å½’çº³ä¸ºä¸¤ç§ç±»å‹ï¼š</p>
<h4 id="BeanFactory"><a href="#BeanFactory" class="headerlink" title="BeanFactory"></a>BeanFactory</h4><p>ç”± org.springframework.beans.factory.BeanFactory æ¥å£å®šä¹‰ã€‚<br>å®ƒæ˜¯æœ€ç®€å•çš„å®¹å™¨ï¼Œæä¾›åŸºæœ¬çš„ DI æ”¯æŒã€‚</p>
<h4 id="ApplicationContext"><a href="#ApplicationContext" class="headerlink" title="ApplicationContext"></a>ApplicationContext</h4><p>ç”± org.springframework.context.ApplicationContext æ¥å£å®šä¹‰ã€‚<br>å®ƒæ˜¯åŸºäº BeanFactory ä¹‹ä¸Šæ„å»ºï¼Œå¹¶æä¾›é¢å‘åº”ç”¨çš„æœåŠ¡ï¼Œä¾‹å¦‚ä»å±æ€§æ–‡ä»¶è§£ææ–‡æœ¬ä¿¡æ¯çš„èƒ½åŠ›ï¼Œä»¥åŠå‘å¸ƒåº”ç”¨äº‹ä»¶ç»™æ„Ÿå…´è¶£çš„äº‹ä»¶ç›‘å¬è€…çš„èƒ½åŠ›ã€‚<br><strong><em>æ³¨ï¼šBean å·¥å‚å¯¹äºå¤§å¤šæ•°åº”ç”¨æ¥è¯´å¾€å¾€å¤ªä½çº§äº†ï¼Œæ‰€ä»¥åº”ç”¨ä¸Šä¸‹æ–‡ä½¿ç”¨æ›´å¹¿æ³›ã€‚æ¨èåœ¨å¼€å‘ä¸­ä½¿ç”¨åº”ç”¨ä¸Šä¸‹æ–‡å®¹å™¨ã€‚</em></strong></p>
<p>Spring è‡ªå¸¦äº†å¤šç§åº”ç”¨ä¸Šä¸‹æ–‡ï¼Œæœ€å¯èƒ½é‡åˆ°çš„æœ‰ä»¥ä¸‹å‡ ç§ï¼š<br><code>ClassPathXmlApplicationContext</code>ï¼šä»ç±»è·¯å¾„ä¸‹çš„ XML é…ç½®æ–‡ä»¶ä¸­åŠ è½½ä¸Šä¸‹æ–‡å®šä¹‰ï¼ŒæŠŠåº”ç”¨ä¸Šä¸‹æ–‡å®šä¹‰æ–‡ä»¶å½“åšç±»èµ„æºã€‚<br><code>FileSystemXmlApplicationContext</code>ï¼šè¯»å–æ–‡ä»¶ç³»ç»Ÿä¸‹çš„ XML é…ç½®æ–‡ä»¶å¹¶åŠ è½½ä¸Šä¸‹æ–‡å®šä¹‰ã€‚<br><code>XmlWebApplicationContext</code>ï¼šè¯»å– Web åº”ç”¨ä¸‹çš„ XML é…ç½®æ–‡ä»¶å¹¶è£…è½½ä¸Šä¸‹æ–‡å®šä¹‰ã€‚</p>
<p><strong><em>èŒƒä¾‹</em></strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileSystemXmlApplicationContext</span>(<span class="string">&quot;D:\Temp\build.xml&quot;</span>);</span><br><span class="line"><span class="type">ApplicationContext</span> <span class="variable">context2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;build.xml&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ°ï¼ŒåŠ è½½ <code>FileSystemXmlApplicationContext</code> å’Œ <code>ClassPathXmlApplicationContext</code> ååˆ†ç›¸ä¼¼ã€‚<br>å·®å¼‚åœ¨äºï¼šå‰è€…åœ¨æŒ‡å®šæ–‡ä»¶ç³»ç»Ÿè·¯å¾„ä¸‹æŸ¥æ‰¾ build.xml æ–‡ä»¶ï¼›è€Œååœ¨æ‰€æœ‰ç±»è·¯å¾„ï¼ˆåŒ…å« JAR æ–‡ä»¶ï¼‰ä¸‹æŸ¥æ‰¾ build.xml æ–‡ä»¶ã€‚<br>é€šè¿‡å¼•ç”¨åº”ç”¨ä¸Šä¸‹æ–‡ï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿çš„è°ƒç”¨ getBean() æ–¹æ³•ä» Spring å®¹å™¨ä¸­è·å– Beanã€‚</p>
<p><strong>ç›¸å…³ jar åŒ…</strong></p>
<ul>
<li><p><code>spring-core</code>, <code>spring-beans</code>, æä¾›æ¡†æ¶çš„åŸºç¡€éƒ¨åˆ†ï¼ŒåŒ…æ‹¬ IoC å’Œä¾èµ–æ³¨å…¥ç‰¹æ€§ã€‚</p>
</li>
<li><p><code>spring-context</code>, åœ¨<code>spring-core</code>, <code>spring-beans</code>åŸºç¡€ä¸Šæ„å»ºã€‚å®ƒæä¾›ä¸€ç§æ¡†æ¶å¼çš„è®¿é—®å¯¹è±¡çš„æ–¹æ³•ã€‚å®ƒä¹Ÿæ”¯æŒç±»ä¼¼ Java EE ç‰¹æ€§ï¼Œä¾‹å¦‚ï¼šEJBï¼ŒJMX å’ŒåŸºæœ¬ remotingã€‚ApplicationContext æ¥å£æ˜¯å®ƒçš„èšç„¦ç‚¹ã€‚</p>
</li>
<li><p><code>springcontext-support</code>, é›†æˆç¬¬ä¸‰æ–¹åº“åˆ° Spring application contextã€‚</p>
</li>
<li><p><code>spring-expression</code>ï¼Œæä¾›ä¸€ç§å¼ºæœ‰åŠ›çš„è¡¨è¾¾è¯­è¨€åœ¨è¿è¡Œæ—¶æ¥æŸ¥è¯¢å’Œæ“çºµä¸€ä¸ªå¯¹è±¡å›¾ã€‚</p>
</li>
</ul>
<h3 id="AOP-and-Instrumentation"><a href="#AOP-and-Instrumentation" class="headerlink" title="AOP and Instrumentation"></a>AOP and Instrumentation</h3><p><strong>ç›¸å…³ jar åŒ…</strong></p>
<ul>
<li><code>spring-aop</code>ï¼Œæä¾›äº†å¯¹é¢å‘åˆ‡é¢ç¼–ç¨‹çš„ä¸°å¯Œæ”¯æŒã€‚</li>
<li><code>spring-aspects</code>ï¼Œæä¾›äº†å¯¹ AspectJ çš„é›†æˆã€‚</li>
<li><code>spring-instrument</code>ï¼Œæä¾›äº†å¯¹ç±» instrumentation çš„æ”¯æŒå’Œç±»åŠ è½½å™¨ã€‚</li>
<li><code>spring-instrument-tomcat</code>ï¼ŒåŒ…å«äº† Spring å¯¹ Tomcat çš„ instrumentation ä»£ç†ã€‚</li>
</ul>
<h3 id="Messaging"><a href="#Messaging" class="headerlink" title="Messaging"></a>Messaging</h3><p><strong>ç›¸å…³ jar åŒ…</strong></p>
<ul>
<li><code>spring-messaging</code>ï¼ŒåŒ…å« spring çš„æ¶ˆæ¯å¤„ç†åŠŸèƒ½ï¼Œå¦‚ Messageï¼ŒMessageChannelï¼ŒMessageHandlerã€‚</li>
</ul>
<h3 id="Data-Access-Integaration"><a href="#Data-Access-Integaration" class="headerlink" title="Data Access &#x2F; Integaration"></a>Data Access &#x2F; Integaration</h3><p>Data Access&#x2F;Integration å±‚åŒ…å«äº† JDBC &#x2F; ORM &#x2F; OXM &#x2F; JMS å’Œ Transaction æ¨¡å—ã€‚</p>
<p><strong>ç›¸å…³ jar åŒ…</strong></p>
<ul>
<li><p><code>spring-jdbc</code>ï¼Œæä¾›äº†ä¸€ä¸ª JDBC æŠ½è±¡å±‚ã€‚</p>
</li>
<li><p><code>spring-tx</code>ï¼Œæ”¯æŒç¼–ç¨‹å’Œå£°æ˜å¼äº‹åŠ¡ç®¡ç†ç±»ã€‚</p>
</li>
<li><p><code>spring-orm</code>ï¼Œæä¾›äº†æµè¡Œçš„å¯¹è±¡å…³ç³»å‹æ˜ å°„ API é›†ï¼Œå¦‚ JPAï¼ŒJDOï¼ŒHibernateã€‚</p>
</li>
<li><p><code>spring-oxm</code>ï¼Œæä¾›äº†ä¸€ä¸ªæŠ½è±¡å±‚ä»¥æ”¯æŒå¯¹è±¡&#x2F;XML æ˜ å°„çš„å®ç°ï¼Œå¦‚ JAXBï¼ŒCastorï¼ŒXMLBeansï¼ŒJiBX å’Œ XStream.</p>
</li>
<li><p><code>spring-jms</code>ï¼ŒåŒ…å«äº†ç”Ÿäº§å’Œæ¶ˆè´¹æ¶ˆæ¯çš„åŠŸèƒ½ã€‚</p>
</li>
</ul>
<h3 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h3><p><strong>ç›¸å…³ jar åŒ…</strong></p>
<ul>
<li><p><code>spring-web</code>ï¼Œæä¾›äº†åŸºæœ¬çš„é¢å‘ web çš„åŠŸèƒ½ï¼Œå¦‚å¤šæ–‡ä»¶ä¸Šä¼ ã€ä½¿ç”¨ Servlet ç›‘å¬å™¨çš„ Ioc å®¹å™¨çš„åˆå§‹åŒ–ã€‚ä¸€ä¸ªé¢å‘ web çš„åº”ç”¨å±‚ä¸Šä¸‹æ–‡ã€‚</p>
</li>
<li><p><code>spring-webmvc</code>ï¼ŒåŒ…æ‹¬ MVC å’Œ REST web æœåŠ¡å®ç°ã€‚</p>
</li>
<li><p><code>spring-webmvc-portlet</code>ï¼Œæä¾›åœ¨ Protlet ç¯å¢ƒçš„ MVC å®ç°å’Œ<code>spring-webmvc</code>åŠŸèƒ½çš„é•œåƒã€‚</p>
</li>
</ul>
<h3 id="Test"><a href="#Test" class="headerlink" title="Test"></a>Test</h3><p><strong>ç›¸å…³ jar åŒ…</strong></p>
<ul>
<li><code>spring-test</code>ï¼Œä»¥ Junit å’Œ TestNG æ¥æ”¯æŒ spring ç»„ä»¶çš„å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•ã€‚</li>
</ul>
<h2 id="æœ¯è¯­"><a href="#æœ¯è¯­" class="headerlink" title="æœ¯è¯­"></a>æœ¯è¯­</h2><ul>
<li><strong>åº”ç”¨ç¨‹åº</strong>ï¼šæ˜¯èƒ½å®Œæˆæˆ‘ä»¬æ‰€éœ€è¦åŠŸèƒ½çš„æˆå“ï¼Œæ¯”å¦‚è´­ç‰©ç½‘ç«™ã€OA ç³»ç»Ÿã€‚</li>
<li><strong>æ¡†æ¶</strong>ï¼šæ˜¯èƒ½å®Œæˆä¸€å®šåŠŸèƒ½çš„åŠæˆå“ï¼Œæ¯”å¦‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ¡†æ¶è¿›è¡Œè´­ç‰©ç½‘ç«™å¼€å‘ï¼›æ¡†æ¶åšä¸€éƒ¨åˆ†åŠŸèƒ½ï¼Œæˆ‘ä»¬è‡ªå·±åšä¸€éƒ¨åˆ†åŠŸèƒ½ï¼Œè¿™æ ·åº”ç”¨ç¨‹åºå°±åˆ›å»ºå‡ºæ¥äº†ã€‚è€Œä¸”æ¡†æ¶è§„å®šäº†ä½ åœ¨å¼€å‘åº”ç”¨ç¨‹åºæ—¶çš„æ•´ä½“æ¶æ„ï¼Œæä¾›äº†ä¸€äº›åŸºç¡€åŠŸèƒ½ï¼Œè¿˜è§„å®šäº†ç±»å’Œå¯¹è±¡çš„å¦‚ä½•åˆ›å»ºã€å¦‚ä½•åä½œç­‰ï¼Œä»è€Œç®€åŒ–æˆ‘ä»¬å¼€å‘ï¼Œè®©æˆ‘ä»¬ä¸“æ³¨äºä¸šåŠ¡é€»è¾‘å¼€å‘ã€‚</li>
<li><strong>éä¾µå…¥å¼è®¾è®¡</strong>ï¼šä»æ¡†æ¶è§’åº¦å¯ä»¥è¿™æ ·ç†è§£ï¼Œæ— éœ€ç»§æ‰¿æ¡†æ¶æä¾›çš„ç±»ï¼Œè¿™ç§è®¾è®¡å°±å¯ä»¥çœ‹ä½œæ˜¯éä¾µå…¥å¼è®¾è®¡ï¼Œå¦‚æœç»§æ‰¿äº†è¿™äº›æ¡†æ¶ç±»ï¼Œå°±æ˜¯ä¾µå…¥è®¾è®¡ï¼Œå¦‚æœä»¥åæƒ³æ›´æ¢æ¡†æ¶ä¹‹å‰å†™è¿‡çš„ä»£ç å‡ ä¹æ— æ³•é‡ç”¨ï¼Œå¦‚æœéä¾µå…¥å¼è®¾è®¡åˆ™ä¹‹å‰å†™è¿‡çš„ä»£ç ä»ç„¶å¯ä»¥ç»§ç»­ä½¿ç”¨ã€‚</li>
<li><strong>è½»é‡çº§åŠé‡é‡çº§</strong>ï¼šè½»é‡çº§æ˜¯ç›¸å¯¹äºé‡é‡çº§è€Œè¨€çš„ï¼Œè½»é‡çº§ä¸€èˆ¬å°±æ˜¯éå…¥ä¾µæ€§çš„ã€æ‰€ä¾èµ–çš„ä¸œè¥¿éå¸¸å°‘ã€èµ„æºå ç”¨éå¸¸å°‘ã€éƒ¨ç½²ç®€å•ç­‰ç­‰ï¼Œå…¶å®å°±æ˜¯æ¯”è¾ƒå®¹æ˜“ä½¿ç”¨ï¼Œè€Œé‡é‡çº§æ­£å¥½ç›¸åã€‚</li>
<li><strong>POJO</strong>ï¼šPOJOï¼ˆPlain Old Java Objectsï¼‰ç®€å•çš„ Java å¯¹è±¡ï¼Œå®ƒå¯ä»¥åŒ…å«ä¸šåŠ¡é€»è¾‘æˆ–æŒä¹…åŒ–é€»è¾‘ï¼Œä½†ä¸æ‹…å½“ä»»ä½•ç‰¹æ®Šè§’è‰²ä¸”ä¸ç»§æ‰¿æˆ–ä¸å®ç°ä»»ä½•å…¶å®ƒ Java æ¡†æ¶çš„ç±»æˆ–æ¥å£ã€‚</li>
<li><strong>å®¹å™¨</strong>ï¼šåœ¨æ—¥å¸¸ç”Ÿæ´»ä¸­å®¹å™¨å°±æ˜¯ä¸€ç§ç››æ”¾ä¸œè¥¿çš„å™¨å…·ï¼Œä»ç¨‹åºè®¾è®¡è§’åº¦çœ‹å°±æ˜¯è£…å¯¹è±¡çš„çš„å¯¹è±¡ï¼Œå› ä¸ºå­˜åœ¨æ”¾å…¥ã€æ‹¿å‡ºç­‰æ“ä½œï¼Œæ‰€ä»¥å®¹å™¨è¿˜è¦ç®¡ç†å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸã€‚</li>
<li><strong>æ§åˆ¶åè½¬ï¼š</strong>å³ Inversion of Controlï¼Œç¼©å†™ä¸º IoCï¼Œæ§åˆ¶åè½¬è¿˜æœ‰ä¸€ä¸ªåå­—å«åšä¾èµ–æ³¨å…¥ï¼ˆDependency Injectionï¼‰ï¼Œå°±æ˜¯ç”±å®¹å™¨æ§åˆ¶ç¨‹åºä¹‹é—´çš„å…³ç³»ï¼Œè€Œéä¼ ç»Ÿå®ç°ä¸­ï¼Œç”±ç¨‹åºä»£ç ç›´æ¥æ“æ§ã€‚</li>
<li><strong>JavaBean</strong>ï¼šä¸€èˆ¬æŒ‡å®¹å™¨ç®¡ç†å¯¹è±¡ï¼Œåœ¨ Spring ä¸­æŒ‡ Spring IoC å®¹å™¨ç®¡ç†å¯¹è±¡ã€‚</li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://dunwu.github.io/blog/pages/ed55a426/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/blog/uploads/avatar.gif">
      <meta itemprop="name" content="é’æ‚Ÿ â—¾ Dunwu">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Dunwu Blog">
      <meta itemprop="description" content="é’æ‚Ÿçš„ä¸ªäººåšå®¢">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content=" | Dunwu Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/blog/pages/ed55a426/" class="post-title-link" itemprop="url">è®¡ç®—æœºç½‘ç»œé¢è¯•æ€»ç»“</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">å‘è¡¨äº</span>

      <time title="åˆ›å»ºæ—¶é—´ï¼š2019-11-21 20:13:00" itemprop="dateCreated datePublished" datetime="2019-11-21T20:13:00+08:00">2019-11-21</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">æ›´æ–°äº</span>
      <time title="ä¿®æ”¹æ—¶é—´ï¼š2025-09-13 17:56:53" itemprop="dateModified" datetime="2025-09-13T17:56:53+08:00">2025-09-13</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">åˆ†ç±»äº</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/blog/categories/%E7%BD%91%E7%BB%9C/" itemprop="url" rel="index"><span itemprop="name">ç½‘ç»œ</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/blog/categories/%E7%BD%91%E7%BB%9C/%E7%BD%91%E7%BB%9C%E7%BB%BC%E5%90%88/" itemprop="url" rel="index"><span itemprop="name">ç½‘ç»œç»¼åˆ</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
      <span>3.8k</span>
    </span>
    <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
      <span>3 åˆ†é’Ÿ</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="è®¡ç®—æœºç½‘ç»œé¢è¯•æ€»ç»“"><a href="#è®¡ç®—æœºç½‘ç»œé¢è¯•æ€»ç»“" class="headerlink" title="è®¡ç®—æœºç½‘ç»œé¢è¯•æ€»ç»“"></a>è®¡ç®—æœºç½‘ç»œé¢è¯•æ€»ç»“</h1><blockquote>
<p>å¦‚æœä½ ä¸æ˜¯ä»äº‹äºé€šä¿¡é¢†åŸŸï¼Œé¢è¯•æ—¶é—®åŠè®¡ç®—æœºç½‘ç»œçš„çŸ¥è¯†ï¼Œä¸€èˆ¬ä¹Ÿå°±é™å®šåœ¨ï¼šHTTPï¼ˆå« HTTPSã€Cookieã€Sessionï¼‰ã€TCPã€UDPã€Socket è¿™äº›</p>
</blockquote>
<h2 id="ç»¼åˆ"><a href="#ç»¼åˆ" class="headerlink" title="ç»¼åˆ"></a>ç»¼åˆ</h2><h3 id="è®¡ç®—æœºç½‘ç»œå¦‚ä½•åˆ†å±‚ï¼Ÿ"><a href="#è®¡ç®—æœºç½‘ç»œå¦‚ä½•åˆ†å±‚ï¼Ÿ" class="headerlink" title="è®¡ç®—æœºç½‘ç»œå¦‚ä½•åˆ†å±‚ï¼Ÿ"></a>è®¡ç®—æœºç½‘ç»œå¦‚ä½•åˆ†å±‚ï¼Ÿ</h3><blockquote>
<p>â“ é—®é¢˜ï¼šè®¡ç®—æœºç½‘ç»œå¦‚ä½•åˆ†å±‚ï¼Ÿå„å±‚çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿå„å±‚çš„ä¸»è¦åè®®ã€è®¾å¤‡åˆ†åˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</p>
<p>è¿™æ˜¯å­¦ä¹ è®¡ç®—æœºç½‘ç»œçŸ¥è¯†å®è§‚å±‚é¢å¿…é¡»è¦äº†è§£çš„æ ¸å¿ƒç‚¹ã€‚çŸ¥é“äº†è¿™äº›ï¼Œå¯¹äºç½‘ç»œçš„ä½“ç³»ç»“æ„å°±åŸºæœ¬ä¸Šäº†è§£äº†ã€‚</p>
</blockquote>
<p><img src="https://raw.githubusercontent.com/dunwu/images/master/cs/network/overview/network-layers.png" alt="img"></p>
<p>è®¡ç®—æœºç½‘ç»œåˆ†å±‚ä¸€èˆ¬æœ‰ä¸‰ç§åˆ’åˆ†ä½“ç³»ï¼šOSI åˆ†å±‚ï¼›äº”å±‚åè®®åˆ†å±‚ï¼›TCP&#x2F;IP åè®®åˆ†å±‚ã€‚</p>
<ul>
<li>OSI çš„ä¸ƒå±‚ä½“ç³»ç»“æ„æ¦‚å¿µæ¸…æ¥šï¼Œç†è®ºå®Œæ•´ï¼Œä½†æ˜¯æ¯”è¾ƒå¤æ‚ä¸”ä¸å®ç”¨ï¼Œæ‰€ä»¥å¹¶ä¸æµè¡Œã€‚</li>
<li>äº”å±‚åè®®åˆ†å±‚æ˜¯ä¸€ç§æŠ˜ä¸­æ–¹æ¡ˆï¼Œåœ¨ç°å®ä¸­æ›´ä¸ºæµè¡Œã€‚</li>
</ul>
<p><img src="https://raw.githubusercontent.com/dunwu/images/master/cs/network/overview/%E7%BD%91%E7%BB%9C%E5%88%86%E5%B1%82%E6%9E%B6%E6%9E%84%E5%9B%BE.png" alt="img"></p>
<p><strong>ç‰©ç†å±‚</strong></p>
<blockquote>
<p>ç‰©ç†å±‚ï¼ˆPhysical Layerï¼‰åªæ¥æ”¶å’Œå‘é€ä¸€ä¸²æ¯”ç‰¹(bit)æµï¼Œä¸è€ƒè™‘ä¿¡æ¯çš„æ„ä¹‰å’Œä¿¡æ¯ç»“æ„ã€‚</p>
<p>æ‰©å±•é˜…è¯»ï¼š<a href="11.%E7%89%A9%E7%90%86%E5%B1%82.md">è®¡ç®—æœºç½‘ç»œä¹‹ç‰©ç†å±‚</a></p>
</blockquote>
<ul>
<li>å…³é”®è¯ï¼šè°ƒåˆ¶ã€è§£è°ƒã€æ•°å­—ä¿¡å·ã€æ¨¡æ‹Ÿä¿¡å·ã€é€šä¿¡åª’ä»‹ã€ä¿¡é“å¤ç”¨</li>
<li>æ•°æ®å•å…ƒï¼šæ¯”ç‰¹æµã€‚</li>
<li>å…¸å‹è®¾å¤‡ï¼šå…‰çº¤ã€åŒè½´ç”µç¼†ã€åŒç»çº¿ã€ä¸­ç»§å™¨å’Œé›†çº¿å™¨ã€‚</li>
</ul>
<p><strong>æ•°æ®é“¾è·¯å±‚</strong></p>
<blockquote>
<p>ç½‘ç»œå±‚é’ˆå¯¹çš„è¿˜æ˜¯ä¸»æœºä¹‹é—´çš„æ•°æ®ä¼ è¾“æœåŠ¡ï¼Œè€Œä¸»æœºä¹‹é—´å¯ä»¥æœ‰å¾ˆå¤šé“¾è·¯ï¼Œæ•°æ®é“¾è·¯å±‚ï¼ˆData Link Layerï¼‰å°±æ˜¯ä¸ºåŒä¸€é“¾è·¯çš„ä¸»æœºæä¾›æ•°æ®ä¼ è¾“æœåŠ¡ã€‚æ•°æ®é“¾è·¯å±‚æŠŠç½‘ç»œå±‚ä¼ ä¸‹æ¥çš„åˆ†ç»„å°è£…æˆå¸§ã€‚</p>
<p>æ‰©å±•é˜…è¯»ï¼š<a href="12.%E6%95%B0%E6%8D%AE%E9%93%BE%E8%B7%AF%E5%B1%82.md">è®¡ç®—æœºç½‘ç»œä¹‹æ•°æ®é“¾è·¯å±‚</a></p>
</blockquote>
<ul>
<li>å…³é”®è¯ï¼šç‚¹å¯¹ç‚¹ä¿¡é“ã€å¹¿æ’­ä¿¡é“ã€<code>PPP</code>ã€<code>CSMA/CD</code>ã€å±€åŸŸç½‘ã€ä»¥å¤ªç½‘ã€<code>MAC</code>ã€é€‚é…å™¨ã€é›†çº¿å™¨ã€ç½‘æ¡¥ã€äº¤æ¢æœº</li>
<li>ä¸»è¦åè®®ï¼š<code>PPP</code>ã€<code>CSMA/CD</code> ç­‰ã€‚</li>
<li>æ•°æ®å•å…ƒï¼šå¸§ï¼ˆframeï¼‰ã€‚</li>
<li>å…¸å‹è®¾å¤‡ï¼šäºŒå±‚äº¤æ¢æœºã€ç½‘æ¡¥ã€ç½‘å¡ã€‚</li>
</ul>
<p><strong>ç½‘ç»œå±‚</strong></p>
<blockquote>
<p>ç½‘ç»œå±‚ï¼ˆnetwork layerï¼‰ä¸ºåˆ†ç»„äº¤æ¢ç½‘ä¸Šçš„ä¸åŒä¸»æœºæä¾›é€šä¿¡æœåŠ¡ã€‚åœ¨å‘é€æ•°æ®æ—¶ï¼Œç½‘ç»œå±‚æŠŠè¿è¾“å±‚äº§ç”Ÿçš„æŠ¥æ–‡æ®µæˆ–ç”¨æˆ·æ•°æ®æŠ¥å°è£…æˆåˆ†ç»„æˆ–åŒ…è¿›è¡Œä¼ é€ã€‚</p>
<p>æ‰©å±•é˜…è¯»ï¼š<a href="13.%E7%BD%91%E7%BB%9C%E5%B1%82.md">è®¡ç®—æœºç½‘ç»œä¹‹ç½‘ç»œå±‚</a></p>
</blockquote>
<ul>
<li>å…³é”®è¯ï¼š<code>IP</code>ã€<code>ICMP</code>ã€<code>ARP</code>ã€è·¯ç”±</li>
<li>ä¸»è¦åè®®ï¼š<code>IP</code>ã€‚</li>
<li>æ•°æ®å•å…ƒï¼šIP æ•°æ®æŠ¥ï¼ˆpacketï¼‰ã€‚</li>
<li>å…¸å‹è®¾å¤‡ï¼šç½‘å…³ã€è·¯ç”±å™¨ã€‚</li>
</ul>
<p><strong>ä¼ è¾“å±‚</strong></p>
<blockquote>
<p>ä¼ è¾“å±‚ï¼ˆtransport layerï¼‰ä¸ºä¸¤å°ä¸»æœºä¸­è¿›ç¨‹é—´çš„é€šä¿¡æä¾›é€šç”¨çš„æ•°æ®ä¼ è¾“æœåŠ¡ã€‚</p>
<p>æ‰©å±•é˜…è¯»ï¼š<a href="14.%E4%BC%A0%E8%BE%93%E5%B1%82.md">è®¡ç®—æœºç½‘ç»œä¹‹ä¼ è¾“å±‚</a></p>
</blockquote>
<ul>
<li>å…³é”®è¯ï¼š<code>UDP</code>ã€<code>TCP</code>ã€æ»‘åŠ¨çª—å£ã€æ‹¥å¡æ§åˆ¶ã€ä¸‰æ¬¡æ¡æ‰‹</li>
<li>ä¸»è¦åè®®ï¼š<code>TCP</code>ã€<code>UDP</code>ã€‚</li>
<li>æ•°æ®å•å…ƒï¼šæŠ¥æ–‡æ®µï¼ˆsegmentï¼‰æˆ–ç”¨æˆ·æ•°æ®æŠ¥ã€‚</li>
</ul>
<p><del>\</del><strong>ä¼šè¯å±‚</strong>~~</p>
<blockquote>
<p>~~ä¼šè¯å±‚ï¼ˆSession Layerï¼‰ä¸å‚ä¸å…·ä½“çš„ä¼ è¾“ï¼Œå®ƒæä¾›åŒ…æ‹¬è®¿é—®éªŒè¯å’Œä¼šè¯ç®¡ç†åœ¨å†…çš„å»ºç«‹å’Œç»´æŠ¤åº”ç”¨ä¹‹é—´é€šä¿¡çš„æœºåˆ¶ã€‚~~</p>
</blockquote>
<p><del>\</del><strong>è¡¨ç¤ºå±‚</strong>~~</p>
<blockquote>
<p>~~è¡¨ç¤ºå±‚ï¼ˆPresentation Layerï¼‰æ˜¯ä¸ºåœ¨åº”ç”¨è¿‡ç¨‹ä¹‹é—´ä¼ é€çš„ä¿¡æ¯æä¾›è¡¨ç¤ºæ–¹æ³•çš„æœåŠ¡ï¼Œå®ƒå…³å¿ƒçš„åªæ˜¯å‘å‡ºä¿¡æ¯çš„è¯­æ³•ä¸è¯­ä¹‰ã€‚è¡¨ç¤ºå±‚è¦å®ŒæˆæŸäº›ç‰¹å®šçš„åŠŸèƒ½ï¼Œä¸»è¦æœ‰ä¸åŒæ•°æ®ç¼–ç æ ¼å¼çš„è½¬æ¢ï¼Œæä¾›æ•°æ®å‹ç¼©ã€è§£å‹ç¼©æœåŠ¡ï¼Œå¯¹æ•°æ®è¿›è¡ŒåŠ å¯†ã€è§£å¯†ã€‚~~</p>
</blockquote>
<p><strong>åº”ç”¨å±‚</strong></p>
<blockquote>
<p>åº”ç”¨å±‚ï¼ˆapplication layerï¼‰é€šè¿‡åº”ç”¨è¿›ç¨‹é—´çš„äº¤äº’æ¥å®Œæˆç‰¹å®šç½‘ç»œåº”ç”¨ã€‚åº”ç”¨å±‚åè®®å®šä¹‰çš„æ˜¯åº”ç”¨è¿›ç¨‹é—´é€šä¿¡å’Œäº¤äº’çš„è§„åˆ™ã€‚</p>
<p>æ‰©å±•é˜…è¯»ï¼š<a href="15.%E5%BA%94%E7%94%A8%E5%B1%82.md">è®¡ç®—æœºç½‘ç»œä¹‹åº”ç”¨å±‚</a></p>
</blockquote>
<ul>
<li>å…³é”®è¯ï¼š<code>HTTP</code>ã€<code>DNS</code>ã€<code>FTP</code>ã€<code>TELNET</code>ã€<code>DHCP</code></li>
<li>ä¸»è¦åè®®ï¼š<code>HTTP</code>ã€<code>DNS</code>ã€<code>SMTP</code>ã€<code>Telnet</code>ã€<code>FTP</code>ã€<code>SNMP</code> ç­‰ã€‚</li>
<li>æ•°æ®å•å…ƒï¼šæŠ¥æ–‡ï¼ˆmessageï¼‰ã€‚</li>
</ul>
<h2 id="HTTP"><a href="#HTTP" class="headerlink" title="HTTP"></a>HTTP</h2><blockquote>
<p>æ‰©å±•é˜…è¯»ï¼š<a href="../02.%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE/01.HTTP.md">è¶…æ–‡æœ¬ä¼ è¾“åè®® HTTP</a></p>
</blockquote>
<h2 id="DNS"><a href="#DNS" class="headerlink" title="DNS"></a>DNS</h2><blockquote>
<p>æ‰©å±•é˜…è¯»ï¼š<a href="../02.%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE/02.DNS">åŸŸåç³»ç»Ÿåè®® DNS</a></p>
</blockquote>
<h2 id="TCP-UDP"><a href="#TCP-UDP" class="headerlink" title="TCP&#x2F;UDP"></a>TCP&#x2F;UDP</h2><blockquote>
<p>æ‰©å±•é˜…è¯»ï¼š<a href="../02.%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE/03.TCP.md">ä¼ è¾“æ§åˆ¶åè®® TCP</a>ï¼Œ<a href="../02.%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE/04.UDP.md">ç”¨æˆ·æ•°æ®æŠ¥åè®® UDP</a></p>
</blockquote>
<h3 id="ä»€ä¹ˆæ˜¯-TCPï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯-TCPï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯ TCPï¼Ÿ"></a>ä»€ä¹ˆæ˜¯ TCPï¼Ÿ</h3><p><strong>TCPï¼ˆTransmission Control Protocolï¼‰ï¼Œå³ä¼ è¾“æ§åˆ¶åè®®ï¼Œå®ƒæ˜¯ä¸€ç§<code>é¢å‘è¿æ¥çš„</code>ã€<code>å¯é çš„</code>ã€<code>åŸºäºå­—èŠ‚æµçš„</code>ä¼ è¾“å±‚é€šä¿¡åè®®</strong>ã€‚</p>
<h3 id="TCP-çš„ç‰¹æ€§æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#TCP-çš„ç‰¹æ€§æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="TCP çš„ç‰¹æ€§æ˜¯ä»€ä¹ˆï¼Ÿ"></a>TCP çš„ç‰¹æ€§æ˜¯ä»€ä¹ˆï¼Ÿ</h3><ul>
<li><code>é¢å‘è¿æ¥çš„</code> - é¢å‘è¿æ¥æ˜¯æŒ‡ TCP éœ€è¦é€šè¿‡ä¸‰æ¬¡æ¡æ‰‹ã€å››æ¬¡æŒ¥æ‰‹åŸåˆ™å»ºç«‹å’Œæ–­å¼€åŒå‘è¿æ¥ã€‚</li>
<li><code>å¯é çš„</code> - å¯é æ˜¯æŒ‡ TCP ä¼ è¾“çš„æ•°æ®åŒ…ä¿è¯ä»¥åŸå§‹é¡ºåºåˆ°è¾¾ç›®çš„åœ°ï¼Œä¸”æ•°æ®åŒ…ä¸è¢«æŸåã€‚ä¸ºäº†å®ç°è¿™ç‚¹ï¼ŒTCP é€šè¿‡ä»¥ä¸‹æŠ€æœ¯æ¥ä¿è¯ï¼š<ul>
<li>æ•°æ®åŒ…çš„åºåˆ—å·å’Œæ ¡éªŒç </li>
<li>ç¡®è®¤åŒ…å’Œè‡ªåŠ¨é‡ä¼ <ul>
<li>å¦‚æœå‘é€è€…æ²¡æœ‰æ”¶åˆ°æ­£ç¡®çš„å“åº”ï¼Œå®ƒå°†é‡æ–°å‘é€æ•°æ®åŒ…ã€‚å¦‚æœå¤šæ¬¡è¶…æ—¶ï¼Œè¿æ¥å°±ä¼šæ–­å¼€ã€‚</li>
<li>TCP å®è¡Œæµé‡æ§åˆ¶å’Œæ‹¥å¡æ§åˆ¶ã€‚è¿™äº›ç¡®ä¿æªæ–½ä¼šå¯¼è‡´å»¶è¿Ÿï¼Œè€Œä¸”é€šå¸¸å¯¼è‡´ä¼ è¾“æ•ˆç‡æ¯” UDP ä½ã€‚</li>
</ul>
</li>
</ul>
</li>
<li><code>åŸºäºå­—èŠ‚æµçš„</code><ul>
<li>è™½ç„¶åº”ç”¨ç¨‹åºå’Œ TCP çš„äº¤äº’æ˜¯ä¸€æ¬¡ä¸€ä¸ªæ•°æ®å—ï¼ˆå¤§å°ä¸ç­‰ï¼‰ï¼Œä½† TCP æŠŠåº”ç”¨ç¨‹åºçœ‹æˆæ˜¯ä¸€è¿ä¸²çš„æ— ç»“æ„çš„å­—èŠ‚æµã€‚TCP æœ‰ä¸€ä¸ªç¼“å†²ï¼Œå½“åº”ç”¨ç¨‹åºä¼ é€çš„æ•°æ®å—å¤ªé•¿ï¼ŒTCP å°±å¯ä»¥æŠŠå®ƒåˆ’åˆ†çŸ­ä¸€äº›å†ä¼ é€ã€‚å¦‚æœåº”ç”¨ç¨‹åºä¸€æ¬¡åªå‘é€ä¸€ä¸ªå­—èŠ‚ï¼ŒTCP ä¹Ÿå¯ä»¥ç­‰å¾…ç§¯ç´¯æœ‰è¶³å¤Ÿå¤šçš„å­—èŠ‚åå†æ„æˆæŠ¥æ–‡æ®µå‘é€å‡ºå»ã€‚</li>
<li>åœ¨ TCP å»ºç«‹è¿æ¥å‰ä¸¤æ¬¡æ¡æ‰‹çš„ SYN æŠ¥æ–‡ä¸­é€‰é¡¹å­—æ®µçš„ MSS å€¼ï¼Œé€šä¿¡åŒæ–¹å•†å®šé€šä¿¡çš„æœ€å¤§æŠ¥æ–‡é•¿åº¦ã€‚å¦‚æœåº”ç”¨å±‚äº¤ä»˜ä¸‹æ¥çš„æ•°æ®è¿‡å¤§ï¼Œå°±ä¼šå¯¹æ•°æ®åˆ†æ®µï¼Œç„¶åå‘é€ï¼›å¦åˆ™é€šè¿‡æ»‘åŠ¨çª—å£æ¥æ§åˆ¶é€šä¿¡åŒå‘çš„æ•°æ®ã€‚</li>
</ul>
</li>
</ul>
<h3 id="TCP-ä¸‰æ¬¡æ¡æ‰‹"><a href="#TCP-ä¸‰æ¬¡æ¡æ‰‹" class="headerlink" title="TCP ä¸‰æ¬¡æ¡æ‰‹"></a>TCP ä¸‰æ¬¡æ¡æ‰‹</h3><blockquote>
<p>â“ é—®é¢˜ï¼šä¸‰æ¬¡æ¡æ‰‹æœ‰ä»€ä¹ˆç”¨ï¼Ÿä»€ä¹ˆæ˜¯ä¸‰æ¬¡æ¡æ‰‹ï¼Ÿä¸ºä»€ä¹ˆéœ€è¦ä¸‰æ¬¡æ¡æ‰‹ï¼Ÿ</p>
</blockquote>
<p>ï¼ˆ1ï¼‰ä¸‰æ¬¡æ¡æ‰‹æœ‰ä»€ä¹ˆç”¨ï¼Ÿ</p>
<ul>
<li>ä¸‰æ¬¡æ¡æ‰‹è´Ÿè´£å»ºç«‹ TCP åŒå‘è¿æ¥ã€‚</li>
</ul>
<p>ï¼ˆ2ï¼‰ä»€ä¹ˆæ˜¯ä¸‰æ¬¡æ¡æ‰‹ï¼Ÿ</p>
<p><img src="https://raw.githubusercontent.com/dunwu/images/master/cs/network/transport/%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B.gif" alt="img"></p>
<p>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œä¸‰æ¬¡æ¡æ‰‹æµç¨‹å¦‚ä¸‹ï¼š</p>
<ol>
<li>ç¬¬ä¸€æ¬¡æ¡æ‰‹ - å®¢æˆ·ç«¯å‘æœåŠ¡ç«¯å‘é€å¸¦æœ‰ SYN æ ‡å¿—çš„æ•°æ®åŒ…ã€‚</li>
<li>ç¬¬äºŒæ¬¡æ¡æ‰‹ - æœåŠ¡ç«¯å‘å®¢æˆ·ç«¯å‘é€å¸¦æœ‰ SYN&#x2F;ACK æ ‡å¿—çš„æ•°æ®åŒ…ã€‚</li>
<li>ç¬¬ä¸‰æ¬¡æ¡æ‰‹ - å®¢æˆ·ç«¯å‘æœåŠ¡ç«¯å‘é€å¸¦æœ‰å¸¦æœ‰ ACK æ ‡å¿—çš„æ•°æ®åŒ…ã€‚</li>
</ol>
<p>è‡³æ­¤ï¼ŒTCP ä¸‰æ¬¡æ¡æ‰‹å®Œæˆï¼Œå®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯å·²å»ºç«‹åŒå‘è¿æ¥ã€‚</p>
<blockquote>
<p>ğŸ’¡ è¯´æ˜ï¼šSYN ä¸º synchronize çš„ç¼©å†™ï¼ŒACK ä¸º acknowledgment çš„ç¼©å†™ã€‚</p>
</blockquote>
<p>ï¼ˆ3ï¼‰ä¸ºä»€ä¹ˆéœ€è¦ä¸‰æ¬¡æ¡æ‰‹ï¼Ÿ</p>
<p>ä¸ºäº†ä¾¿äºè¯´æ˜ï¼Œå‡è®¾å®¢æˆ·ç«¯ä¸º A, æœåŠ¡ç«¯ä¸º Bã€‚</p>
<ol>
<li>ç¬¬ä¸€æ¬¡æ¡æ‰‹ï¼ŒA å‘ B å‘åŒæ­¥æ¶ˆæ¯ã€‚B æ”¶åˆ°æ¶ˆæ¯åï¼ŒB è®¤ä¸ºï¼šA å‘æ¶ˆæ¯æ²¡é—®é¢˜ï¼›B æ”¶æ¶ˆæ¯æ²¡é—®é¢˜ã€‚</li>
<li>ç¬¬äºŒæ¬¡æ¡æ‰‹ï¼ŒB å‘ A å‘åŒæ­¥æ¶ˆæ¯å’Œç¡®è®¤æ¶ˆæ¯ã€‚A æ”¶åˆ°æ¶ˆæ¯åï¼ŒA è®¤ä¸ºï¼šA å‘æ¶ˆæ¯ã€æ”¶æ¶ˆæ¯éƒ½æ²¡é—®é¢˜ï¼›B å‘æ¶ˆæ¯ã€æ”¶æ¶ˆæ¯éƒ½æ²¡é—®é¢˜ã€‚<strong>ä½†æ˜¯ï¼Œæ­¤æ—¶ B ä¸ç¡®å®šè‡ªå·±å‘æ¶ˆæ¯æ˜¯å¦æ²¡é—®é¢˜</strong>ï¼Œæ‰€ä»¥å°±éœ€è¦ç¬¬ä¸‰æ¬¡æ¡æ‰‹ã€‚</li>
<li>ç¬¬ä¸‰æ¬¡æ¡æ‰‹ï¼ŒA å‘ B å‘ç¡®è®¤æ¶ˆæ¯ã€‚B æ”¶åˆ°æ¶ˆæ¯åã€‚B è®¤ä¸ºï¼šB å‘æ¶ˆæ¯æ²¡é—®é¢˜ã€‚</li>
</ol>
<h3 id="TCP-å››æ¬¡æŒ¥æ‰‹"><a href="#TCP-å››æ¬¡æŒ¥æ‰‹" class="headerlink" title="TCP å››æ¬¡æŒ¥æ‰‹"></a>TCP å››æ¬¡æŒ¥æ‰‹</h3><blockquote>
<p>â“ é—®é¢˜ï¼šå››æ¬¡æŒ¥æ‰‹æœ‰ä»€ä¹ˆç”¨ï¼Ÿä»€ä¹ˆæ˜¯å››æ¬¡æŒ¥æ‰‹ï¼Ÿä¸ºä»€ä¹ˆå»ºç«‹è¿æ¥æ˜¯ä¸‰æ¬¡æ¡æ‰‹ï¼Œå…³é—­è¿æ¥ç¡®æ˜¯å››æ¬¡æŒ¥æ‰‹å‘¢ï¼Ÿ</p>
</blockquote>
<p>ï¼ˆ1ï¼‰å››æ¬¡æŒ¥æ‰‹æœ‰ä»€ä¹ˆç”¨ï¼Ÿ</p>
<ul>
<li>å››æ¬¡æŒ¥æ‰‹è´Ÿè´£æ–­å¼€ TCP è¿æ¥ã€‚</li>
</ul>
<p>ï¼ˆ2ï¼‰ä»€ä¹ˆæ˜¯å››æ¬¡æŒ¥æ‰‹ï¼Ÿ</p>
<p>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œå››æ¬¡æŒ¥æ‰‹æµç¨‹å¦‚ä¸‹ï¼š</p>
<p><img src="https://raw.githubusercontent.com/dunwu/images/master/cs/network/transport/%E5%9B%9B%E6%AC%A1%E6%8C%A5%E6%89%8B.gif" alt="img"></p>
<ol>
<li>ç¬¬ä¸€æ¬¡æŒ¥æ‰‹ - å®¢æˆ·ç«¯å‘æœåŠ¡ç«¯å‘é€ä¸€ä¸ª FIN åŒ…ï¼Œç”¨æ¥å…³é—­å®¢æˆ·ç«¯åˆ°æœåŠ¡ç«¯çš„æ•°æ®ä¼ é€ã€‚</li>
<li>ç¬¬äºŒæ¬¡æŒ¥æ‰‹ - æœåŠ¡ç«¯æ”¶åˆ°è¿™ä¸ª FIN åŒ…ï¼Œå‘å®¢æˆ·ç«¯å‘é€ä¸€ä¸ª ACK åŒ…ï¼Œç¡®è®¤åºå·ä¸ºæ”¶åˆ°çš„åºå·åŠ  1ã€‚å’Œ SYN ä¸€æ ·ï¼Œä¸€ä¸ª FIN å°†å ç”¨ä¸€ä¸ªåºå·ã€‚</li>
<li>ç¬¬ä¸‰æ¬¡æŒ¥æ‰‹ - æœåŠ¡ç«¯å…³é—­ä¸å®¢æˆ·ç«¯çš„è¿æ¥ï¼Œå‘å®¢æˆ·ç«¯å‘é€ä¸€ä¸ª FIN åŒ…ã€‚</li>
<li>ç¬¬å››æ¬¡æŒ¥æ‰‹ - å®¢æˆ·ç«¯å‘æœåŠ¡ç«¯å‘é€ ACK åŒ…ï¼Œå¹¶å°†ç¡®è®¤åºå·è®¾ç½®ä¸ºæ”¶åˆ°åºå·åŠ  1ã€‚</li>
</ol>
<p>ï¼ˆ3ï¼‰ä¸ºä»€ä¹ˆå»ºç«‹è¿æ¥æ˜¯ä¸‰æ¬¡æ¡æ‰‹ï¼Œå…³é—­è¿æ¥ç¡®æ˜¯å››æ¬¡æŒ¥æ‰‹å‘¢ï¼Ÿ</p>
<ul>
<li>å»ºç«‹è¿æ¥çš„æ—¶å€™ï¼Œ æœåŠ¡å™¨åœ¨ LISTEN çŠ¶æ€ä¸‹ï¼Œæ”¶åˆ°å»ºç«‹è¿æ¥è¯·æ±‚çš„ SYN æŠ¥æ–‡åï¼ŒæŠŠ ACK å’Œ SYN æ”¾åœ¨ä¸€ä¸ªæŠ¥æ–‡é‡Œå‘é€ç»™å®¢æˆ·ç«¯ã€‚</li>
<li>è€Œå…³é—­è¿æ¥æ—¶ï¼ŒæœåŠ¡å™¨æ”¶åˆ°å¯¹æ–¹çš„ FIN æŠ¥æ–‡æ—¶ï¼Œä»…ä»…è¡¨ç¤ºå¯¹æ–¹ä¸å†å‘é€æ•°æ®äº†ä½†æ˜¯è¿˜èƒ½æ¥æ”¶æ•°æ®ï¼Œè€Œè‡ªå·±ä¹Ÿæœªå¿…å…¨éƒ¨æ•°æ®éƒ½å‘é€ç»™å¯¹æ–¹äº†ï¼Œæ‰€ä»¥å·±æ–¹å¯ä»¥ç«‹å³å…³é—­ï¼Œä¹Ÿå¯ä»¥å‘é€ä¸€äº›æ•°æ®ç»™å¯¹æ–¹åï¼Œå†å‘é€ FIN æŠ¥æ–‡ç»™å¯¹æ–¹æ¥è¡¨ç¤ºåŒæ„ç°åœ¨å…³é—­è¿æ¥ï¼Œå› æ­¤ï¼Œå·±æ–¹ ACK å’Œ FIN ä¸€èˆ¬éƒ½ä¼šåˆ†å¼€å‘é€ï¼Œä»è€Œå¯¼è‡´å¤šäº†ä¸€æ¬¡ã€‚</li>
</ul>
<h3 id="TCP-æ»‘åŠ¨çª—å£"><a href="#TCP-æ»‘åŠ¨çª—å£" class="headerlink" title="TCP æ»‘åŠ¨çª—å£"></a>TCP æ»‘åŠ¨çª—å£</h3><blockquote>
<p>â“ é—®é¢˜ï¼šä»€ä¹ˆæ˜¯æ»‘åŠ¨çª—å£ï¼Ÿæ»‘åŠ¨çª—å£åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ</p>
</blockquote>
<p>ä»€ä¹ˆæ˜¯æ»‘åŠ¨çª—å£ï¼Ÿ</p>
<p><strong>æ»‘åŠ¨çª—å£æ˜¯ TCP çš„ä¸€ç§æ§åˆ¶ç½‘ç»œæµé‡çš„æŠ€æœ¯ã€‚</strong></p>
<p><strong>TCP å¿…éœ€è¦è§£å†³çš„å¯é ä¼ è¾“ä»¥åŠåŒ…ä¹±åºï¼ˆreorderingï¼‰çš„é—®é¢˜</strong>ï¼Œæ‰€ä»¥ï¼ŒTCP å¿…éœ€è¦çŸ¥é“ç½‘ç»œå®é™…çš„æ•°æ®å¤„ç†å¸¦å®½æˆ–æ˜¯æ•°æ®å¤„ç†é€Ÿåº¦ï¼Œè¿™æ ·æ‰ä¸ä¼šå¼•èµ·ç½‘ç»œæ‹¥å¡ï¼Œå¯¼è‡´ä¸¢åŒ…ã€‚</p>
<p>TCP å¤´é‡Œæœ‰ä¸€ä¸ªå­—æ®µå« Windowï¼Œåˆå« Advertised-Windowï¼Œè¿™ä¸ªå­—æ®µæ˜¯æ¥æ”¶ç«¯å‘Šè¯‰å‘é€ç«¯è‡ªå·±è¿˜æœ‰å¤šå°‘ç¼“å†²åŒºå¯ä»¥æ¥æ”¶æ•°æ®ã€‚<strong>äºæ˜¯å‘é€ç«¯å°±å¯ä»¥æ ¹æ®è¿™ä¸ªæ¥æ”¶ç«¯çš„å¤„ç†èƒ½åŠ›æ¥å‘é€æ•°æ®ï¼Œè€Œä¸ä¼šå¯¼è‡´æ¥æ”¶ç«¯å¤„ç†ä¸è¿‡æ¥</strong>ã€‚</p>
<p>æ»‘åŠ¨çª—å£åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ</p>
<p><img src="https://raw.githubusercontent.com/dunwu/images/master/snap/1559265819762.png" alt="img"></p>
<ol>
<li>å·²å‘é€å·²ç¡®è®¤ - æ•°æ®æµä¸­æœ€æ—©çš„å­—èŠ‚å·²ç»å‘é€å¹¶å¾—åˆ°ç¡®è®¤ã€‚è¿™äº›æ•°æ®æ˜¯ç«™åœ¨å‘é€ç«¯çš„è§’åº¦æ¥çœ‹çš„ã€‚ä¸Šå›¾ä¸­çš„ 31 ä¸ªå­—èŠ‚å·²ç»å‘é€å¹¶ç¡®è®¤ã€‚</li>
<li>å·²å‘é€ä½†å°šæœªç¡®è®¤ - å·²å‘é€ä½†å°šæœªå¾—åˆ°ç¡®è®¤çš„å­—èŠ‚ã€‚å‘é€æ–¹åœ¨ç¡®è®¤ä¹‹å‰ï¼Œä¸è®¤ä¸ºè¿™äº›æ•°æ®å·²ç»è¢«å¤„ç†ã€‚ä¸Šå›¾ä¸­çš„ 32 ~ 45 å­—èŠ‚ä¸ºç¬¬ 2 ç±»ã€‚</li>
<li>æœªå‘é€è€Œæ¥æ”¶æ–¹å·² Ready - è®¾å¤‡å°šæœªå°†æ•°æ®å‘å‡º ï¼Œä½†æ¥æ”¶æ–¹æ ¹æ®æœ€è¿‘ä¸€æ¬¡å…³äºå‘é€æ–¹ä¸€æ¬¡è¦å‘é€å¤šå°‘å­—èŠ‚ç¡®è®¤è‡ªå·±æœ‰è¶³å¤Ÿç©ºé—´ã€‚å‘é€æ–¹ä¼šç«‹å³å°è¯•å‘é€ã€‚ä¸Šå›¾ä¸­çš„ 46 ~ 51 å­—èŠ‚ä¸ºç¬¬ 3 ç±»ã€‚</li>
<li>æœªå‘é€è€Œæ¥æ”¶æ–¹ Not Ready - ç”±äºæ¥æ”¶æ–¹ not readyï¼Œè¿˜ä¸å…è®¸å°†è¿™éƒ¨åˆ†æ•°æ®å‘å‡ºã€‚ä¸Šå›¾ä¸­çš„ 52 ä»¥åçš„å­—èŠ‚ä¸ºç¬¬ 4 ç±»ã€‚</li>
</ol>
<p><img src="https://raw.githubusercontent.com/dunwu/images/master/snap/1559265927658.png" alt="img"></p>
<p>è¿™å¼ å›¾ç‰‡ç›¸å¯¹äºä¸Šä¸€å¼ å›¾ç‰‡ï¼Œæ»‘åŠ¨çª—å£åç§»äº† 5 ä¸ªå­—èŠ‚ï¼Œæ„å‘³ç€æœ‰ 5 ä¸ªå·²å‘é€çš„å­—èŠ‚å¾—åˆ°äº†ç¡®è®¤ã€‚</p>
<h3 id="TCP-é‡ä¼ æœºåˆ¶"><a href="#TCP-é‡ä¼ æœºåˆ¶" class="headerlink" title="TCP é‡ä¼ æœºåˆ¶"></a>TCP é‡ä¼ æœºåˆ¶</h3><blockquote>
<p>â“ é—®é¢˜ï¼šä¸ºä»€ä¹ˆéœ€è¦é‡ä¼ æœºåˆ¶ï¼ŸTCP æœ‰å“ªäº›é‡ä¼ æœºåˆ¶ï¼ŒåŸç†æ˜¯ä»€ä¹ˆï¼Ÿ</p>
</blockquote>
<p>TCP è¦ä¿è¯æ‰€æœ‰çš„æ•°æ®åŒ…éƒ½å¯ä»¥åˆ°è¾¾ï¼Œæ‰€ä»¥ï¼Œå¿…éœ€è¦æœ‰é‡ä¼ æœºåˆ¶ã€‚</p>
<p>TCP é‡ä¼ æœºåˆ¶ä¸»è¦æœ‰ä¸¤ç§ï¼š</p>
<ul>
<li>è¶…æ—¶é‡ä¼ æœºåˆ¶</li>
<li>å¿«é€Ÿé‡ä¼ æœºåˆ¶</li>
</ul>
<p>ï¼ˆ1ï¼‰è¶…æ—¶é‡ä¼ æœºåˆ¶</p>
<p>è¶…æ—¶é‡ä¼ æœºåˆ¶æ˜¯æŒ‡ï¼šå‘é€æ•°æ®åŒ…åœ¨ä¸€å®šçš„æ—¶é—´å‘¨æœŸå†…æ²¡æœ‰æ”¶åˆ°ç›¸åº”çš„ ACKï¼Œç­‰å¾…ä¸€å®šçš„æ—¶é—´ï¼Œè¶…æ—¶ä¹‹åå°±è®¤ä¸ºè¿™ä¸ªæ•°æ®åŒ…ä¸¢å¤±ï¼Œå°±ä¼šé‡æ–°å‘é€ã€‚è¿™ä¸ªç­‰å¾…æ—¶é—´è¢«ç§°ä¸º RTO(Retransmission TimeOut)ï¼Œå³é‡ä¼ è¶…æ—¶æ—¶é—´ã€‚</p>
<p>æ²¡æœ‰ç¡®è®¤çš„æ•°æ®åŒ…ä¸ä¼šä»çª—å£ä¸­ç§»èµ°ï¼Œå®šæ—¶å™¨åœ¨é‡ä¼ æ—¶é—´åˆ°æœŸå†…ï¼Œæ¯ä¸ªç‰‡æ®µçš„ä½ç½®ä¸å˜ã€‚</p>
<p>è¿™ç§æœºåˆ¶çš„é‡ç‚¹æ˜¯ RTO çš„è®¾ç½®ï¼š</p>
<ul>
<li>RTO è®¾é•¿äº†ï¼Œé‡å‘å°±æ…¢ï¼Œä¸¢äº†è€åŠå¤©æ‰é‡å‘ï¼Œæ²¡æœ‰æ•ˆç‡ï¼Œæ€§èƒ½å·®ï¼›</li>
<li>RTO è®¾çŸ­äº†ï¼Œä¼šå¯¼è‡´å¯èƒ½å¹¶æ²¡æœ‰ä¸¢å°±é‡å‘ã€‚äºæ˜¯é‡å‘çš„å°±å¿«ï¼Œä¼šå¢åŠ ç½‘ç»œæ‹¥å¡ï¼Œå¯¼è‡´æ›´å¤šçš„è¶…æ—¶ï¼Œæ›´å¤šçš„è¶…æ—¶å¯¼è‡´æ›´å¤šçš„é‡å‘</li>
</ul>
<p>ï¼ˆ2ï¼‰å¿«é€Ÿé‡ä¼ æœºåˆ¶</p>
<p>å¿«é€Ÿé‡ä¼ æœºåˆ¶ï¼Œå®ç°äº†å¦å¤–çš„ä¸€ç§ä¸¢åŒ…è¯„å®šæ ‡å‡†ï¼Œå³å¦‚æœè¿ç»­æ”¶åˆ° 3 æ¬¡é‡å¤ ACKï¼Œå‘é€æ–¹å°±è®¤ä¸ºè¿™ä¸ª seq çš„åŒ…ä¸¢å¤±äº†ï¼Œç«‹åˆ»è¿›è¡Œé‡ä¼ ã€‚</p>
<p>å½“æ¥æ”¶æ–¹æ”¶åˆ°ä¹±åºç‰‡æ®µæ—¶ï¼Œéœ€è¦é‡å¤å‘é€ ACKã€‚</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://dunwu.github.io/blog/pages/21302e7e/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/blog/uploads/avatar.gif">
      <meta itemprop="name" content="é’æ‚Ÿ â—¾ Dunwu">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Dunwu Blog">
      <meta itemprop="description" content="é’æ‚Ÿçš„ä¸ªäººåšå®¢">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content=" | Dunwu Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/blog/pages/21302e7e/" class="post-title-link" itemprop="url">SpringBoot ä¹‹å‘é€é‚®ä»¶</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">å‘è¡¨äº</span>

      <time title="åˆ›å»ºæ—¶é—´ï¼š2019-11-20 15:20:44" itemprop="dateCreated datePublished" datetime="2019-11-20T15:20:44+08:00">2019-11-20</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">æ›´æ–°äº</span>
      <time title="ä¿®æ”¹æ—¶é—´ï¼š2025-09-13 17:56:53" itemprop="dateModified" datetime="2025-09-13T17:56:53+08:00">2025-09-13</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">åˆ†ç±»äº</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/blog/categories/Java/" itemprop="url" rel="index"><span itemprop="name">Java</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/blog/categories/Java/%E6%A1%86%E6%9E%B6/" itemprop="url" rel="index"><span itemprop="name">æ¡†æ¶</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/blog/categories/Java/%E6%A1%86%E6%9E%B6/Spring/" itemprop="url" rel="index"><span itemprop="name">Spring</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/blog/categories/Java/%E6%A1%86%E6%9E%B6/Spring/SpringIO/" itemprop="url" rel="index"><span itemprop="name">SpringIO</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
      <span>6.1k</span>
    </span>
    <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
      <span>6 åˆ†é’Ÿ</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="SpringBoot-ä¹‹å‘é€é‚®ä»¶"><a href="#SpringBoot-ä¹‹å‘é€é‚®ä»¶" class="headerlink" title="SpringBoot ä¹‹å‘é€é‚®ä»¶"></a>SpringBoot ä¹‹å‘é€é‚®ä»¶</h1><h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>Spring Boot æ”¶å‘é‚®ä»¶æœ€ç®€ä¾¿æ–¹å¼æ˜¯é€šè¿‡ <code>spring-boot-starter-mail</code>ã€‚</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-mail<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>spring-boot-starter-mail æœ¬è´¨ä¸Šæ˜¯ä½¿ç”¨ JavaMail(javax.mail)ã€‚å¦‚æœæƒ³å¯¹ JavaMail æœ‰è¿›ä¸€æ­¥äº†è§£ï¼Œå¯ä»¥å‚è€ƒï¼š <a href="https://dunwu.github.io/java-tutorial/#/javalib/javamail">JavaMail ä½¿ç”¨æŒ‡å—</a></p>
<h2 id="API"><a href="#API" class="headerlink" title="API"></a>API</h2><p>Spring Framework æä¾›äº†ä¸€ä¸ªä½¿ç”¨ <code>JavaMailSender</code> æ¥å£å‘é€ç”µå­é‚®ä»¶çš„ç®€å•æŠ½è±¡ï¼Œè¿™æ˜¯å‘é€é‚®ä»¶çš„æ ¸å¿ƒ APIã€‚</p>
<p><code>JavaMailSender</code> æ¥å£æä¾›çš„ API å¦‚ä¸‹ï¼š</p>
<p><img src="https://raw.githubusercontent.com/dunwu/images/master/snap/20190110111102.png" alt="img"></p>
<h2 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h2><p>Spring Boot ä¸º <code>JavaMailSender</code> æä¾›äº†è‡ªåŠ¨é…ç½®ä»¥åŠå¯åŠ¨å™¨æ¨¡å—ã€‚</p>
<p>å¦‚æœ <code>spring.mail.host</code> å’Œç›¸å…³åº“ï¼ˆç”± spring-boot-starter-mail å®šä¹‰ï¼‰å¯ç”¨ï¼Œåˆ™ Spring Boot ä¼šåˆ›å»ºé»˜è®¤ <code>JavaMailSender</code>ï¼ˆå¦‚æœä¸å­˜åœ¨ï¼‰ã€‚å¯ä»¥é€šè¿‡ <code>spring.mail</code> å‘½åç©ºé—´ä¸­çš„é…ç½®é¡¹è¿›ä¸€æ­¥è‡ªå®šä¹‰å‘ä»¶äººã€‚<br>ç‰¹åˆ«æ˜¯ï¼ŒæŸäº›é»˜è®¤è¶…æ—¶å€¼æ˜¯æ— é™çš„ï¼Œæ‚¨å¯èƒ½å¸Œæœ›æ›´æ”¹å®ƒä»¥é¿å…çº¿ç¨‹è¢«æ— å“åº”çš„é‚®ä»¶æœåŠ¡å™¨é˜»å¡ï¼Œå¦‚ä»¥ä¸‹ç¤ºä¾‹æ‰€ç¤ºï¼š</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring.mail.properties.mail.smtp.connectiontimeout</span>=<span class="string">5000</span></span><br><span class="line"><span class="attr">spring.mail.properties.mail.smtp.timeout</span>=<span class="string">3000</span></span><br><span class="line"><span class="attr">spring.mail.properties.mail.smtp.writetimeout</span>=<span class="string">5000</span></span><br></pre></td></tr></table></figure>

<p>ä¹Ÿå¯ä»¥ä½¿ç”¨ JNDI ä¸­çš„ç°æœ‰ä¼šè¯é…ç½® <code>JavaMailSender</code>ï¼š</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring.mail.jndi-name</span>=mail/Session</span><br></pre></td></tr></table></figure>

<p>ä»¥ä¸‹ä¸º Spring Boot å…³äº Mail çš„é…ç½®ï¼š</p>
<p>æœ‰å…³æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜… <a target="_blank" rel="noopener" href="https://github.com/spring-projects/spring-boot/tree/v2.1.1.RELEASE/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/mail/MailProperties.java"><code>MailProperties</code></a>ã€‚</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Email (MailProperties)</span></span><br><span class="line"><span class="attr">spring.mail.default-encoding</span>=<span class="string">UTF-8 # Default MimeMessage encoding.</span></span><br><span class="line"><span class="attr">spring.mail.host</span>= <span class="string"># SMTP server host. For instance, `smtp.example.com`.</span></span><br><span class="line"><span class="attr">spring.mail.jndi-name</span>= <span class="string"># Session JNDI name. When set, takes precedence over other Session settings.</span></span><br><span class="line"><span class="attr">spring.mail.password</span>= <span class="string"># Login password of the SMTP server.</span></span><br><span class="line"><span class="attr">spring.mail.port</span>= <span class="string"># SMTP server port.</span></span><br><span class="line"><span class="attr">spring.mail.properties.*</span>= <span class="string"># Additional JavaMail Session properties.</span></span><br><span class="line"><span class="attr">spring.mail.protocol</span>=<span class="string">smtp # Protocol used by the SMTP server.</span></span><br><span class="line"><span class="attr">spring.mail.test-connection</span>=<span class="string">false # Whether to test that the mail server is available on startup.</span></span><br><span class="line"><span class="attr">spring.mail.username</span>= <span class="string"># Login user of the SMTP server.</span></span><br></pre></td></tr></table></figure>

<h2 id="å®æˆ˜"><a href="#å®æˆ˜" class="headerlink" title="å®æˆ˜"></a>å®æˆ˜</h2><h3 id="å¼•å…¥ä¾èµ–"><a href="#å¼•å…¥ä¾èµ–" class="headerlink" title="å¼•å…¥ä¾èµ–"></a>å¼•å…¥ä¾èµ–</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-mail<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.github.dozermapper<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>dozer-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>6.4.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="é…ç½®é‚®ä»¶å±æ€§"><a href="#é…ç½®é‚®ä»¶å±æ€§" class="headerlink" title="é…ç½®é‚®ä»¶å±æ€§"></a>é…ç½®é‚®ä»¶å±æ€§</h3><p>åœ¨ <code>src/main/resources</code> ç›®å½•ä¸‹æ·»åŠ  <code>application-163.properties</code> é…ç½®æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring.mail.host</span> = <span class="string">smtp.163.com</span></span><br><span class="line"><span class="attr">spring.mail.username</span> = <span class="string">xxxxxx</span></span><br><span class="line"><span class="attr">spring.mail.password</span> = <span class="string">xxxxxx</span></span><br><span class="line"><span class="attr">spring.mail.properties.mail.smtp.auth</span> = <span class="string">true</span></span><br><span class="line"><span class="attr">spring.mail.properties.mail.smtp.starttls.enable</span> = <span class="string">true</span></span><br><span class="line"><span class="attr">spring.mail.properties.mail.smtp.starttls.required</span> = <span class="string">true</span></span><br><span class="line"><span class="attr">spring.mail.default-encoding</span> = <span class="string">UTF-8</span></span><br><span class="line"></span><br><span class="line"><span class="attr">mail.domain</span> = <span class="string">163.com</span></span><br><span class="line"><span class="attr">mail.from</span> = <span class="string">$&#123;spring.mail.username&#125;@$&#123;mail.domain&#125;</span></span><br></pre></td></tr></table></figure>

<p>æ³¨ï¼šéœ€æ›¿æ¢æœ‰æ•ˆçš„ <code>spring.mail.username</code>ã€<code>spring.mail.password</code>ã€‚</p>
<p><code>application-163.properties</code> é…ç½®æ–‡ä»¶è¡¨ç¤ºä½¿ç”¨ 163 é‚®ç®±æ—¶çš„é…ç½®ï¼Œä¸ºäº†ä½¿ä¹‹ç”Ÿæ•ˆï¼Œéœ€è¦é€šè¿‡ <code>spring.profiles.active = 163</code> æ¥æ¿€æ´»å®ƒã€‚</p>
<p>åœ¨ <code>src/main/resources</code> ç›®å½•ä¸‹æ·»åŠ  <code>application.properties</code> é…ç½®æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring.profiles.active</span> = <span class="string">163</span></span><br></pre></td></tr></table></figure>

<h3 id="Java-ä»£ç "><a href="#Java-ä»£ç " class="headerlink" title="Java ä»£ç "></a>Java ä»£ç </h3><p>é¦–å…ˆï¼Œéœ€è¦è¯»å–éƒ¨åˆ†é…ç½®å±æ€§ï¼Œæ–¹æ³•å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.boot.context.properties.ConfigurationProperties;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"><span class="keyword">import</span> org.springframework.validation.annotation.Validated;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Validated</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@ConfigurationProperties(prefix = &quot;mail&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MailProperties</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String domain;</span><br><span class="line">    <span class="keyword">private</span> String from;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getDomain</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> domain;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setDomain</span><span class="params">(String domain)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.domain = domain;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getFrom</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> from;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setFrom</span><span class="params">(String from)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.from = from;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ¥ç€ï¼Œå®šä¹‰ä¸€ä¸ªé‚®ä»¶å‚æ•°å®ä½“ç±»ï¼ˆä½¿ç”¨ lombok ç®€åŒ–äº† getterã€setterï¼‰ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MailDTO</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String from;</span><br><span class="line">    <span class="keyword">private</span> String replyTo;</span><br><span class="line">    <span class="keyword">private</span> String[] to;</span><br><span class="line">    <span class="keyword">private</span> String[] cc;</span><br><span class="line">    <span class="keyword">private</span> String[] bcc;</span><br><span class="line">    <span class="keyword">private</span> Date sentDate;</span><br><span class="line">    <span class="keyword">private</span> String subject;</span><br><span class="line">    <span class="keyword">private</span> String text;</span><br><span class="line">    <span class="keyword">private</span> String[] filenames;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ¥ç€ï¼Œå®ç°å‘é€é‚®ä»¶çš„åŠŸèƒ½æ¥å£ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.github.dozermapper.core.Mapper;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.lang3.StringUtils;</span><br><span class="line"><span class="keyword">import</span> org.slf4j.Logger;</span><br><span class="line"><span class="keyword">import</span> org.slf4j.LoggerFactory;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.mail.SimpleMailMessage;</span><br><span class="line"><span class="keyword">import</span> org.springframework.mail.javamail.JavaMailSender;</span><br><span class="line"><span class="keyword">import</span> org.springframework.mail.javamail.MimeMessageHelper;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.mail.MessagingException;</span><br><span class="line"><span class="keyword">import</span> javax.mail.internet.MimeBodyPart;</span><br><span class="line"><span class="keyword">import</span> javax.mail.internet.MimeMessage;</span><br><span class="line"><span class="keyword">import</span> javax.mail.internet.MimeMultipart;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MailService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">Logger</span> <span class="variable">log</span> <span class="operator">=</span> LoggerFactory.getLogger(<span class="built_in">this</span>.getClass());</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> MailProperties mailProperties;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> JavaMailSender javaMailSender;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> Mapper mapper;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sendSimpleMailMessage</span><span class="params">(MailDTO mailDTO)</span> &#123;</span><br><span class="line">        <span class="type">SimpleMailMessage</span> <span class="variable">simpleMailMessage</span> <span class="operator">=</span> mapper.map(mailDTO, SimpleMailMessage.class);</span><br><span class="line">        <span class="keyword">if</span> (StringUtils.isEmpty(mailDTO.getFrom())) &#123;</span><br><span class="line">            mailDTO.setFrom(mailProperties.getFrom());</span><br><span class="line">        &#125;</span><br><span class="line">        javaMailSender.send(simpleMailMessage);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sendMimeMessage</span><span class="params">(MailDTO mailDTO)</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">MimeMessage</span> <span class="variable">mimeMessage</span> <span class="operator">=</span> javaMailSender.createMimeMessage();</span><br><span class="line">        MimeMessageHelper messageHelper;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            messageHelper = <span class="keyword">new</span> <span class="title class_">MimeMessageHelper</span>(mimeMessage, <span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (StringUtils.isEmpty(mailDTO.getFrom())) &#123;</span><br><span class="line">                messageHelper.setFrom(mailProperties.getFrom());</span><br><span class="line">            &#125;</span><br><span class="line">            messageHelper.setTo(mailDTO.getTo());</span><br><span class="line">            messageHelper.setSubject(mailDTO.getSubject());</span><br><span class="line"></span><br><span class="line">            mimeMessage = messageHelper.getMimeMessage();</span><br><span class="line">            <span class="type">MimeBodyPart</span> <span class="variable">mimeBodyPart</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MimeBodyPart</span>();</span><br><span class="line">            mimeBodyPart.setContent(mailDTO.getText(), <span class="string">&quot;text/html;charset=UTF-8&quot;</span>);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// æè¿°æ•°æ®å…³ç³»</span></span><br><span class="line">            <span class="type">MimeMultipart</span> <span class="variable">mm</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MimeMultipart</span>();</span><br><span class="line">            mm.setSubType(<span class="string">&quot;related&quot;</span>);</span><br><span class="line">            mm.addBodyPart(mimeBodyPart);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// æ·»åŠ é‚®ä»¶é™„ä»¶</span></span><br><span class="line">            <span class="keyword">for</span> (String filename : mailDTO.getFilenames()) &#123;</span><br><span class="line">                <span class="type">MimeBodyPart</span> <span class="variable">attachPart</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MimeBodyPart</span>();</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    attachPart.attachFile(filename);</span><br><span class="line">                &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">                mm.addBodyPart(attachPart);</span><br><span class="line">            &#125;</span><br><span class="line">            mimeMessage.setContent(mm);</span><br><span class="line">            mimeMessage.saveChanges();</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">catch</span> (MessagingException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        javaMailSender.send(mimeMessage);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="ç¤ºä¾‹æºç "><a href="#ç¤ºä¾‹æºç " class="headerlink" title="ç¤ºä¾‹æºç "></a>ç¤ºä¾‹æºç </h2><blockquote>
<p>ç¤ºä¾‹æºç ï¼š<a target="_blank" rel="noopener" href="https://github.com/dunwu/spring-boot-tutorial/tree/master/codes/spring-boot-mail">spring-boot-mail</a></p>
</blockquote>
<h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><ul>
<li><a target="_blank" rel="noopener" href="https://docs.spring.io/spring-boot/docs/2.1.1.RELEASE/reference/htmlsingle/#boot-features-email">Spring Boot å®˜æ–¹æ–‡æ¡£ä¹‹ Sending Email</a></li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" title="ä¸Šä¸€é¡µ" aria-label="ä¸Šä¸€é¡µ" href="/blog/page/36/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/blog/">1</a><span class="space">&hellip;</span><a class="page-number" href="/blog/page/36/">36</a><span class="page-number current">37</span><a class="page-number" href="/blog/page/38/">38</a><span class="space">&hellip;</span><a class="page-number" href="/blog/page/51/">51</a><a class="extend next" rel="next" title="ä¸‹ä¸€é¡µ" aria-label="ä¸‹ä¸€é¡µ" href="/blog/page/38/"><i class="fa fa-angle-right"></i></a>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 2015 â€“ 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">é’æ‚Ÿ â—¾ Dunwu</span>
  </div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
      <span>ç«™ç‚¹æ€»å­—æ•°ï¼š</span>
    <span title="ç«™ç‚¹æ€»å­—æ•°">4.5m</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span>ç«™ç‚¹é˜…è¯»æ—¶é•¿ &asymp;</span>
    <span title="ç«™ç‚¹é˜…è¯»æ—¶é•¿">68:08</span>
  </span>
</div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="reading-progress-bar"></div>

  <a href="https://github.com/dunwu/blog" class="github-corner" title="åœ¨ GitHub ä¸Šå…³æ³¨æˆ‘" aria-label="åœ¨ GitHub ä¸Šå…³æ³¨æˆ‘" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>
<script src="https://cdn.jsdelivr.net/npm/darkmode-js@1.5.7/lib/darkmode-js.min.js"></script>

<script>
var options = {
  bottom: '64px',
  right: 'unset',
  left: '32px',
  time: '0.5s',
  mixColor: 'transparent',
  backgroundColor: 'transparent',
  buttonColorDark: '#100f2c',
  buttonColorLight: '#fff',
  saveInCookies: true,
  label: 'ğŸŒ“',
  autoMatchOsTheme: true
}
const darkmode = new Darkmode(options);
window.darkmode = darkmode;
darkmode.showWidget();
</script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1.8.0/dist/gitalk.css" integrity="sha256-AJnUHL7dBv6PGaeyPQJcgQPDjt/Hn/PvYZde1iqfp8U=" crossorigin="anonymous">

<script class="next-config" data-name="gitalk" type="application/json">{"enable":true,"github_id":"dunwu","repo":"blog","client_id":"c45bc13ca1d3d3aa4836","client_secret":"1907a9f0c22087badad3938e1d7dcba9078f88ac","admin_user":"dunwu","distraction_free_mode":true,"proxy":"https://cors-anywhere.azm.workers.dev/https://github.com/login/oauth/access_token","language":"zh-CN","js":{"url":"https://cdn.jsdelivr.net/npm/gitalk@1.8.0/dist/gitalk.min.js","integrity":"sha256-MVK9MGD/XJaGyIghSVrONSnoXoGh3IFxLw0zfvzpxR4="},"path_md5":"2850b9ee361a0d5423b2812aed8eebac"}</script>
<script src="/blog/js/third-party/comments/gitalk.js" defer></script>

</body>
</html>
